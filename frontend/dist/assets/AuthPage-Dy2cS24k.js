import{d as B,b as I,J as w,K as V,r as p,u as M,_ as $,M as z,n as N,e as y,j as n,s as _,f as O,h as j,k as E,T as h,x as H,w as q,B as Y,P as J}from"./index-CQi3PHFX.js";import{f as v}from"./firebaseService-Bo3vlP6-.js";import{u as K}from"./useTheme-BwfxRj1I.js";import{T as R}from"./TextField-CUMtBqqa.js";import{B as G}from"./Button-C5D5G1VZ.js";import"./useFormControl-YT1t7aI_.js";import"./ownerWindow-CN4f4NkX.js";import"./debounce-Be36O1Ab.js";import"./Menu-Crt-Zobt.js";import"./List-DliLvTND.js";import"./useControlled-VN5YBWhF.js";function Q(r){return I("MuiLink",r)}const X=B("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),U={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Z=r=>U[r]||r,ee=({theme:r,ownerState:e})=>{const o=Z(e.color),t=w(r,`palette.${o}`,!1)||e.color,i=w(r,`palette.${o}Channel`);return"vars"in r&&i?`rgba(${i} / 0.4)`:V(t,.4)},re=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],te=r=>{const{classes:e,component:o,focusVisible:t,underline:i}=r,s={root:["root",`underline${j(i)}`,o==="button"&&"button",t&&"focusVisible"]};return E(s,Q,e)},oe=_(h,{name:"MuiLink",slot:"Root",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.root,e[`underline${j(o.underline)}`],o.component==="button"&&e.button]}})(({theme:r,ownerState:e})=>y({},e.underline==="none"&&{textDecoration:"none"},e.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},e.underline==="always"&&y({textDecoration:"underline"},e.color!=="inherit"&&{textDecorationColor:ee({theme:r,ownerState:e})},{"&:hover":{textDecorationColor:"inherit"}}),e.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${X.focusVisible}`]:{outline:"auto"}})),ne=p.forwardRef(function(e,o){const t=M({props:e,name:"MuiLink"}),{className:i,color:s="primary",component:m="a",onBlur:x,onFocus:l,TypographyClasses:b,underline:f="always",variant:c="inherit",sx:a}=t,k=$(t,re),{isFocusVisibleRef:u,onBlur:d,onFocus:D,ref:L}=z(),[A,C]=p.useState(!1),F=N(o,L),P=g=>{d(g),u.current===!1&&C(!1),x&&x(g)},T=g=>{D(g),u.current===!0&&C(!0),l&&l(g)},S=y({},t,{color:s,component:m,focusVisible:A,underline:f,variant:c}),W=te(S);return n.jsx(oe,y({color:s,className:O(W.root,i),classes:b,component:m,onBlur:P,onFocus:T,ref:F,ownerState:S,variant:c,sx:[...Object.keys(U).includes(s)?[]:[{color:s}],...Array.isArray(a)?a:[a]]},k))}),be=()=>{const r=K(),[e,o]=p.useState(!0),[t,i]=p.useState(""),[s,m]=p.useState(""),[x,l]=p.useState(""),b=H(),{login:f}=p.useContext(q),c=r.palette.mode==="dark",a={primary:"#0ea5e9",gradient:"linear-gradient(135deg, #0ea5e9 0%, #10b981 100%)",background:r.palette.background.default,surface:r.palette.background.paper,textPrimary:r.palette.text.primary,textSecondary:r.palette.text.secondary},k=async u=>{u.preventDefault(),l("");try{if(e){const d=await v.getUser(t);if(!d){l("User not found. Please register first.");return}if(d.password!==s){l("Invalid password");return}f(t),localStorage.setItem("token","firebase-auth-token"),localStorage.setItem("currentUser",t),b("/scan-id")}else{if(await v.getUser(t)){l("Username already exists. Please login instead.");return}await v.createUser({username:t,password:s,createdAt:new Date().toISOString()}),f(t),localStorage.setItem("token","firebase-auth-token"),localStorage.setItem("currentUser",t),b("/scan-id"),alert("Registration successful! You are now logged in.")}}catch(d){console.error("Auth error:",d),l(d.message||"Something went wrong")}};return n.jsx(Y,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 64px)",backgroundColor:a.background,padding:3},children:n.jsxs(J,{elevation:6,sx:{padding:{xs:3,md:5},borderRadius:"20px",maxWidth:"450px",width:"100%",boxShadow:c?"0 15px 40px rgba(0,0,0,0.4)":"0 15px 40px rgba(0,0,0,0.1)",textAlign:"center",background:a.surface},children:[n.jsx(h,{variant:"h4",sx:{mb:3,fontWeight:700,background:a.gradient,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:e?"Login":"Register"}),x&&n.jsx(h,{color:"error",sx:{mb:2},children:x}),n.jsxs("form",{onSubmit:k,children:[n.jsx(R,{label:"Username",variant:"outlined",fullWidth:!0,margin:"normal",value:t,onChange:u=>i(u.target.value),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:c?"rgba(255, 255, 255, 0.05)":"transparent"}}}),n.jsx(R,{label:"Password",variant:"outlined",type:"password",fullWidth:!0,margin:"normal",value:s,onChange:u=>m(u.target.value),required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px",backgroundColor:c?"rgba(255, 255, 255, 0.05)":"transparent"}}}),n.jsx(G,{type:"submit",variant:"contained",fullWidth:!0,size:"large",sx:{mt:3,py:1.5,background:a.gradient,color:"white",fontWeight:600,borderRadius:"12px",textTransform:"none",fontSize:"1.1rem",boxShadow:c?"0 5px 20px rgba(14, 165, 233, 0.3)":"0 5px 20px rgba(14, 165, 233, 0.2)","&:hover":{transform:"translateY(-2px)",boxShadow:c?"0 10px 25px rgba(14, 165, 233, 0.4)":"0 10px 25px rgba(14, 165, 233, 0.3)"},transition:"all 0.3s ease"},children:e?"Login":"Register"})]}),n.jsxs(h,{variant:"body2",sx:{mt:3,color:a.textSecondary},children:[e?"Don't have an account? ":"Already have an account? ",n.jsx(ne,{component:"button",onClick:()=>o(!e),sx:{color:a.primary,fontWeight:600,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:e?"Register here":"Login here"})]})]})})};export{be as default};
