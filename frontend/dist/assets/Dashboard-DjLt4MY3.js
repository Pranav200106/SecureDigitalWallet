import{b as Q,d as T,r as c,_ as E,e as p,j as e,s as M,f as G,h as B,k as _,N as je,p as pe,l as $,u as re,K as Ce,T as f,w as ye,B as V,C as Y,A as ve,P as ke,E as Pe}from"./index-CQi3PHFX.js";import{c as le,L as K,h as Re,g as De,a as we,p as Se}from"./documentUtils-bJFE2WUb.js";import{D as J,a as X,b as Z,c as ee,s as Fe}from"./submissionStore-CYenvhs3.js";import{S as F,Q as oe}from"./QrCode2-bFD-gP5s.js";import{B as z}from"./Button-C5D5G1VZ.js";import{C as ce}from"./Chip-NFilBpqK.js";import{D as q}from"./Divider-dYpdDvre.js";import{G as se}from"./Grid-6c8eFRQa.js";import{u as ae,f as me}from"./useFormControl-YT1t7aI_.js";import{u as Ie}from"./useControlled-VN5YBWhF.js";import{L as ze}from"./List-DliLvTND.js";import{L as W,a as N}from"./ListItemText-CGSCj51j.js";import"./documentDatabase-BelqUvD4.js";import"./firebaseService-Bo3vlP6-.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./useTheme-BwfxRj1I.js";import"./dividerClasses-DtBGEAXD.js";import"./ownerWindow-CN4f4NkX.js";import"./listItemTextClasses-hyLBwlX_.js";function Be(o){return Q("PrivateSwitchBase",o)}T("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const $e=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Le=o=>{const{classes:s,checked:r,disabled:t,edge:n}=o,i={root:["root",r&&"checked",t&&"disabled",n&&`edge${B(n)}`],input:["input"]};return _(i,Be,s)},Me=M(je,{name:"MuiSwitchBase"})(({ownerState:o})=>p({padding:9,borderRadius:"50%"},o.edge==="start"&&{marginLeft:o.size==="small"?-3:-12},o.edge==="end"&&{marginRight:o.size==="small"?-3:-12})),Ae=M("input",{name:"MuiSwitchBase",shouldForwardProp:pe})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Ue=c.forwardRef(function(s,r){const{autoFocus:t,checked:n,checkedIcon:i,className:d,defaultChecked:v,disabled:x,disableFocusRipple:m=!1,edge:g=!1,icon:w,id:P,inputProps:j,inputRef:C,name:R,onBlur:u,onChange:b,onFocus:y,readOnly:L,required:A=!1,tabIndex:I,type:k,value:a}=s,l=E(s,$e),[h,xe]=Ie({controlled:n,default:!!v,name:"SwitchBase",state:"checked"}),S=ae(),he=D=>{y&&y(D),S&&S.onFocus&&S.onFocus(D)},fe=D=>{u&&u(D),S&&S.onBlur&&S.onBlur(D)},be=D=>{if(D.nativeEvent.defaultPrevented)return;const ie=D.target.checked;xe(ie),b&&b(D,ie)};let U=x;S&&typeof U>"u"&&(U=S.disabled);const ge=k==="checkbox"||k==="radio",H=p({},s,{checked:h,disabled:U,disableFocusRipple:m,edge:g}),ne=Le(H);return e.jsxs(Me,p({component:"span",className:G(ne.root,d),centerRipple:!0,focusRipple:!m,disabled:U,tabIndex:null,role:void 0,onFocus:he,onBlur:fe,ownerState:H,ref:r},l,{children:[e.jsx(Ae,p({autoFocus:t,checked:n,defaultChecked:v,className:ne.input,disabled:U,id:ge?P:void 0,name:R,onChange:be,readOnly:L,ref:C,required:A,ownerState:H,tabIndex:I,type:k},k==="checkbox"&&a===void 0?{}:{value:a},j)),h?i:w]}))}),We=$(e.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Ne=$(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Oe=$(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Ge(o){return Q("MuiCheckbox",o)}const te=T("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Ve=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],qe=o=>{const{classes:s,indeterminate:r,color:t,size:n}=o,i={root:["root",r&&"indeterminate",`color${B(t)}`,`size${B(n)}`]},d=_(i,Ge,s);return p({},s,d)},Qe=M(Ue,{shouldForwardProp:o=>pe(o)||o==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:r}=o;return[s.root,r.indeterminate&&s.indeterminate,s[`size${B(r.size)}`],r.color!=="default"&&s[`color${B(r.color)}`]]}})(({theme:o,ownerState:s})=>p({color:(o.vars||o).palette.text.secondary},!s.disableRipple&&{"&:hover":{backgroundColor:o.vars?`rgba(${s.color==="default"?o.vars.palette.action.activeChannel:o.vars.palette[s.color].mainChannel} / ${o.vars.palette.action.hoverOpacity})`:Ce(s.color==="default"?o.palette.action.active:o.palette[s.color].main,o.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},s.color!=="default"&&{[`&.${te.checked}, &.${te.indeterminate}`]:{color:(o.vars||o).palette[s.color].main},[`&.${te.disabled}`]:{color:(o.vars||o).palette.action.disabled}})),Te=e.jsx(Ne,{}),Ee=e.jsx(We,{}),_e=e.jsx(Oe,{}),He=c.forwardRef(function(s,r){var t,n;const i=re({props:s,name:"MuiCheckbox"}),{checkedIcon:d=Te,color:v="primary",icon:x=Ee,indeterminate:m=!1,indeterminateIcon:g=_e,inputProps:w,size:P="medium",className:j}=i,C=E(i,Ve),R=m?g:x,u=m?g:d,b=p({},i,{color:v,indeterminate:m,size:P}),y=qe(b);return e.jsx(Qe,p({type:"checkbox",inputProps:p({"data-indeterminate":m},w),icon:c.cloneElement(R,{fontSize:(t=R.props.fontSize)!=null?t:P}),checkedIcon:c.cloneElement(u,{fontSize:(n=u.props.fontSize)!=null?n:P}),ownerState:b,ref:r,className:G(y.root,j)},C,{classes:y}))});function Ye(o){return Q("MuiFormControlLabel",o)}const O=T("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Ke=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Je=o=>{const{classes:s,disabled:r,labelPlacement:t,error:n,required:i}=o,d={root:["root",r&&"disabled",`labelPlacement${B(t)}`,n&&"error",i&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",n&&"error"]};return _(d,Ye,s)},Xe=M("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:r}=o;return[{[`& .${O.label}`]:s.label},s.root,s[`labelPlacement${B(r.labelPlacement)}`]]}})(({theme:o,ownerState:s})=>p({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${O.disabled}`]:{cursor:"default"}},s.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},s.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},s.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${O.label}`]:{[`&.${O.disabled}`]:{color:(o.vars||o).palette.text.disabled}}})),Ze=M("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(o,s)=>s.asterisk})(({theme:o})=>({[`&.${O.error}`]:{color:(o.vars||o).palette.error.main}})),eo=c.forwardRef(function(s,r){var t,n;const i=re({props:s,name:"MuiFormControlLabel"}),{className:d,componentsProps:v={},control:x,disabled:m,disableTypography:g,label:w,labelPlacement:P="end",required:j,slotProps:C={}}=i,R=E(i,Ke),u=ae(),b=(t=m??x.props.disabled)!=null?t:u==null?void 0:u.disabled,y=j??x.props.required,L={disabled:b,required:y};["checked","name","onChange","value","inputRef"].forEach(h=>{typeof x.props[h]>"u"&&typeof i[h]<"u"&&(L[h]=i[h])});const A=me({props:i,muiFormControl:u,states:["error"]}),I=p({},i,{disabled:b,labelPlacement:P,required:y,error:A.error}),k=Je(I),a=(n=C.typography)!=null?n:v.typography;let l=w;return l!=null&&l.type!==f&&!g&&(l=e.jsx(f,p({component:"span"},a,{className:G(k.label,a==null?void 0:a.className),children:l}))),e.jsxs(Xe,p({className:G(k.root,d),ownerState:I,ref:r},R,{children:[c.cloneElement(x,L),y?e.jsxs(F,{display:"block",children:[l,e.jsxs(Ze,{ownerState:I,"aria-hidden":!0,className:k.asterisk,children:["â€‰","*"]})]}):l]}))});function oo(o){return Q("MuiFormGroup",o)}T("MuiFormGroup",["root","row","error"]);const so=["className","row"],to=o=>{const{classes:s,row:r,error:t}=o;return _({root:["root",r&&"row",t&&"error"]},oo,s)},ro=M("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(o,s)=>{const{ownerState:r}=o;return[s.root,r.row&&s.row]}})(({ownerState:o})=>p({display:"flex",flexDirection:"column",flexWrap:"wrap"},o.row&&{flexDirection:"row"})),ao=c.forwardRef(function(s,r){const t=re({props:s,name:"MuiFormGroup"}),{className:n,row:i=!1}=t,d=E(t,so),v=ae(),x=me({props:t,muiFormControl:v,states:["error"]}),m=p({},t,{row:i,error:x.error}),g=to(m);return e.jsx(ro,p({className:G(g.root,n),ownerState:m,ref:r},d))}),no=$(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"ErrorOutline"),io=$(e.jsx("path",{d:"M12 2 4 5v6.09c0 5.05 3.41 9.76 8 10.91 4.59-1.15 8-5.86 8-10.91V5zm-1.06 13.54L7.4 12l1.41-1.41 2.12 2.12 4.24-4.24 1.41 1.41z"}),"GppGood"),lo=$(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),de=$(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile"),ue=Pe`
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,Fo=()=>{const{currentUser:o}=c.useContext(ye),[s,r]=c.useState(!1),[t,n]=c.useState(null),[i,d]=c.useState(!1),[v,x]=c.useState(!1),[m,g]=c.useState(!1),[w,P]=c.useState(""),[j,C]=c.useState(!0),[R,u]=c.useState(""),[b,y]=c.useState({name:!1,age:!1,address:!1});c.useEffect(()=>{(async()=>{if(o){if(C(!0),await Re(o.username)){const h=await De(o.username);n(h),r(!0)}C(!1)}})()},[o]);const L=async a=>{const l=a.target.files[0];if(l){C(!0),u("");try{const h=await Se(l,o.username);Fe.addSubmission(h),n(h),r(!0),d(!1),console.log("Document processed and added to admin submissions:",h),setTimeout(()=>{alert("Document uploaded successfully! Your data has been encrypted and submitted to an admin for verification. You can now generate QR codes.")},500)}catch{u("Failed to process document. Please try again with a clearer image.")}finally{C(!1)}}},A=a=>{y(l=>({...l,[a]:!l[a]}))},I=async()=>{if(Object.values(b).filter(Boolean).length===0){u("Please select at least one attribute to generate a QR code.");return}u(""),C(!0);try{const l=await we(t,b);P(l),x(!0)}catch{u("Failed to generate QR code.")}finally{C(!1)}},k={p:{xs:2,sm:4},borderRadius:"24px",boxShadow:"0 8px 40px -12px rgba(0,0,0,0.1)",border:"1px solid",borderColor:"divider",animation:`${ue} 0.5s ease-out`,background:a=>a.palette.mode==="dark"?"rgba(33, 41, 54, 0.7)":"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(20px)"};return j&&!t?e.jsx(V,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsx(Y,{})}):e.jsxs(V,{sx:{maxWidth:1e3,mx:"auto",p:{xs:2,sm:3}},children:[e.jsxs(F,{spacing:2,sx:{mb:4,textAlign:"center",animation:`${ue} 0.5s ease-out`},children:[e.jsx(f,{variant:"h3",component:"h1",sx:{fontWeight:700},children:"User Dashboard"}),e.jsxs(f,{variant:"h6",color:"text.secondary",children:["Welcome back, ",e.jsx(V,{component:"span",sx:{color:"primary.main",fontWeight:"600"},children:o==null?void 0:o.username}),"!"]})]}),R&&e.jsx(ve,{severity:"error",sx:{mb:3,borderRadius:"12px"},onClose:()=>u(""),children:R}),e.jsx(ke,{sx:k,children:s?e.jsxs(F,{spacing:4,children:[e.jsxs(V,{sx:{textAlign:"center"},children:[e.jsx(io,{color:"success",sx:{fontSize:60,mb:1}}),e.jsx(f,{variant:"h5",sx:{fontWeight:600},children:"Document Verified"}),e.jsx(f,{color:"text.secondary",children:"Your document is ready. You can now generate verification QR codes or view details."}),e.jsxs(F,{direction:"row",spacing:1,justifyContent:"center",sx:{mt:2},children:[e.jsx(ce,{label:t.name,icon:e.jsx(lo,{}),variant:"outlined",color:"primary"}),e.jsx(ce,{label:`${le(t.dob)} Years Old`,variant:"outlined",color:"secondary"})]})]}),e.jsx(q,{}),e.jsxs(se,{container:!0,spacing:4,children:[e.jsx(se,{item:!0,xs:12,md:6,children:e.jsxs(F,{spacing:2,children:[e.jsxs(f,{variant:"h6",component:"h3",sx:{fontWeight:600},children:[e.jsx(oe,{sx:{verticalAlign:"bottom",mr:1}}),"Generate Verification QR"]}),e.jsx(f,{variant:"body2",color:"text.secondary",children:"Select which attributes you want to prove to a verifier."}),e.jsx(ao,{children:["name","age","address"].map(a=>e.jsx(eo,{control:e.jsx(He,{checked:b[a],onChange:()=>A(a)}),label:`${a.charAt(0).toUpperCase()+a.slice(1)} Verification`,sx:{"&:hover":{bgcolor:"action.hover"},borderRadius:"8px",p:.5}},a))}),e.jsx(z,{variant:"contained",size:"large",startIcon:e.jsx(oe,{}),onClick:I,disabled:j||Object.values(b).every(a=>!a),sx:{borderRadius:"12px",textTransform:"none",fontSize:"1rem"},children:j?e.jsx(Y,{size:24,color:"inherit"}):"Generate QR"})]})}),e.jsx(se,{item:!0,xs:12,md:6,children:e.jsxs(F,{spacing:2,children:[e.jsxs(f,{variant:"h6",component:"h3",sx:{fontWeight:600},children:[e.jsx(K,{sx:{verticalAlign:"bottom",mr:1}}),"View Document Details"]}),e.jsx(f,{variant:"body2",color:"text.secondary",children:"Check your securely stored address and other information from your document."}),e.jsx(z,{variant:"outlined",size:"large",startIcon:e.jsx(K,{}),onClick:()=>g(!0),sx:{borderRadius:"12px",textTransform:"none",fontSize:"1rem",mt:"auto"},children:"Show Details"})]})})]})]}):e.jsxs(F,{spacing:3,alignItems:"center",sx:{textAlign:"center",py:4},children:[e.jsx(no,{color:"warning",sx:{fontSize:60}}),e.jsx(f,{variant:"h5",sx:{fontWeight:600},children:"Verification Required"}),e.jsx(f,{color:"text.secondary",sx:{maxWidth:"450px"},children:"To access verification features, please upload a government-issued ID like an Aadhaar card."}),e.jsx(F,{direction:{xs:"column",sm:"row"},spacing:2,sx:{pt:2},children:e.jsx(z,{variant:"contained",size:"large",startIcon:e.jsx(de,{}),onClick:()=>d(!0),sx:{borderRadius:"16px",px:4,py:1.5,textTransform:"none",fontSize:"1rem"},children:"Upload Document"})})]})}),e.jsxs(J,{open:i,onClose:()=>d(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(X,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(de,{sx:{mr:1}})," Upload Document"]}),e.jsx(q,{}),e.jsxs(Z,{sx:{py:3},children:[e.jsx(f,{color:"text.secondary",sx:{mb:3},children:"Please select a clear image of your document. Your data will be processed securely and encrypted."}),e.jsxs(z,{variant:"outlined",component:"label",fullWidth:!0,disabled:j,sx:{py:2,borderRadius:"12px"},children:[j?e.jsx(Y,{size:24}):"Choose Image File",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:L})]})]}),e.jsx(ee,{sx:{p:2},children:e.jsx(z,{onClick:()=>d(!1),children:"Cancel"})})]}),e.jsxs(J,{open:v,onClose:()=>x(!1),maxWidth:"xs",fullWidth:!0,children:[e.jsxs(X,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(oe,{sx:{mr:1}})," Verification QR Code"]}),e.jsx(q,{}),e.jsxs(Z,{sx:{py:3,textAlign:"center"},children:[w&&e.jsx("img",{src:w,alt:"Verification QR Code",style:{maxWidth:"100%",borderRadius:"16px"}}),e.jsx(f,{color:"text.secondary",sx:{mt:2},children:"A verifier can scan this to confirm the attributes you selected."})]}),e.jsx(ee,{sx:{p:2},children:e.jsx(z,{onClick:()=>x(!1),children:"Close"})})]}),e.jsxs(J,{open:m,onClose:()=>g(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(X,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(K,{sx:{mr:1}})," Document Details"]}),e.jsx(q,{}),e.jsx(Z,{sx:{py:3},children:t&&e.jsxs(ze,{children:[e.jsx(W,{children:e.jsx(N,{primary:"Name",secondary:t.name})}),e.jsx(W,{children:e.jsx(N,{primary:"Date of Birth",secondary:`${t.dob} (${le(t.dob)} years old)`})}),e.jsx(W,{children:e.jsx(N,{primary:"Mobile",secondary:t.mobile})}),e.jsx(W,{children:e.jsx(N,{primary:"Aadhaar",secondary:t.aadhaar})}),e.jsx(W,{children:e.jsx(N,{primary:"Address",secondary:t.address,secondaryTypographyProps:{style:{whiteSpace:"pre-line"}}})})]})}),e.jsx(ee,{sx:{p:2},children:e.jsx(z,{onClick:()=>g(!1),children:"Close"})})]})]})};export{Fo as default};
