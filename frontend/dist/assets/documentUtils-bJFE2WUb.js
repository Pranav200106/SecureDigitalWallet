import{l as we,j as ye}from"./index-CQi3PHFX.js";import{documentDB as Pt}from"./documentDatabase-BelqUvD4.js";import{c as Ee}from"./_commonjs-dynamic-modules-TDtrdbi3.js";const lr=we(ye.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn");var st={},Ce=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Qt={},z={};let Ot;const Ae=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];z.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};z.getSymbolTotalCodewords=function(e){return Ae[e]};z.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};z.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Ot=e};z.isKanjiModeEnabled=function(){return typeof Ot<"u"};z.toSJIS=function(e){return Ot(e)};var mt={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},t.from=function(n,o){if(t.isValid(n))return n;try{return e(n)}catch{return o}}})(mt);function Zt(){this.buffer=[],this.length=0}Zt.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var ve=Zt;function ct(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}ct.prototype.set=function(t,e,r,n){const o=t*this.size+e;this.data[o]=r,n&&(this.reservedBit[o]=!0)};ct.prototype.get=function(t,e){return this.data[t*this.size+e]};ct.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r};ct.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var be=ct,qt={};(function(t){const e=z.getSymbolSize;t.getRowColCoords=function(n){if(n===1)return[];const o=Math.floor(n/7)+2,a=e(n),s=a===145?26:Math.ceil((a-13)/(2*o-2))*2,c=[a-7];for(let i=1;i<o-1;i++)c[i]=c[i-1]-s;return c.push(6),c.reverse()},t.getPositions=function(n){const o=[],a=t.getRowColCoords(n),s=a.length;for(let c=0;c<s;c++)for(let i=0;i<s;i++)c===0&&i===0||c===0&&i===s-1||c===s-1&&i===0||o.push([a[c],a[i]]);return o}})(qt);var Xt={};const Te=z.getSymbolSize,zt=7;Xt.getPositions=function(e){const r=Te(e);return[[0,0],[r-zt,0],[0,r-zt]]};var te={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(o){return o!=null&&o!==""&&!isNaN(o)&&o>=0&&o<=7},t.from=function(o){return t.isValid(o)?parseInt(o,10):void 0},t.getPenaltyN1=function(o){const a=o.size;let s=0,c=0,i=0,d=null,h=null;for(let C=0;C<a;C++){c=i=0,d=h=null;for(let y=0;y<a;y++){let m=o.get(C,y);m===d?c++:(c>=5&&(s+=e.N1+(c-5)),d=m,c=1),m=o.get(y,C),m===h?i++:(i>=5&&(s+=e.N1+(i-5)),h=m,i=1)}c>=5&&(s+=e.N1+(c-5)),i>=5&&(s+=e.N1+(i-5))}return s},t.getPenaltyN2=function(o){const a=o.size;let s=0;for(let c=0;c<a-1;c++)for(let i=0;i<a-1;i++){const d=o.get(c,i)+o.get(c,i+1)+o.get(c+1,i)+o.get(c+1,i+1);(d===4||d===0)&&s++}return s*e.N2},t.getPenaltyN3=function(o){const a=o.size;let s=0,c=0,i=0;for(let d=0;d<a;d++){c=i=0;for(let h=0;h<a;h++)c=c<<1&2047|o.get(d,h),h>=10&&(c===1488||c===93)&&s++,i=i<<1&2047|o.get(h,d),h>=10&&(i===1488||i===93)&&s++}return s*e.N3},t.getPenaltyN4=function(o){let a=0;const s=o.data.length;for(let i=0;i<s;i++)a+=o.data[i];return Math.abs(Math.ceil(a*100/s/5)-10)*e.N4};function r(n,o,a){switch(n){case t.Patterns.PATTERN000:return(o+a)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return a%3===0;case t.Patterns.PATTERN011:return(o+a)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(a/3))%2===0;case t.Patterns.PATTERN101:return o*a%2+o*a%3===0;case t.Patterns.PATTERN110:return(o*a%2+o*a%3)%2===0;case t.Patterns.PATTERN111:return(o*a%3+(o+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}t.applyMask=function(o,a){const s=a.size;for(let c=0;c<s;c++)for(let i=0;i<s;i++)a.isReserved(i,c)||a.xor(i,c,r(o,i,c))},t.getBestMask=function(o,a){const s=Object.keys(t.Patterns).length;let c=0,i=1/0;for(let d=0;d<s;d++){a(d),t.applyMask(d,o);const h=t.getPenaltyN1(o)+t.getPenaltyN2(o)+t.getPenaltyN3(o)+t.getPenaltyN4(o);t.applyMask(d,o),h<i&&(i=h,c=d)}return c}})(te);var pt={};const V=mt,lt=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ut=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];pt.getBlocksCount=function(e,r){switch(r){case V.L:return lt[(e-1)*4+0];case V.M:return lt[(e-1)*4+1];case V.Q:return lt[(e-1)*4+2];case V.H:return lt[(e-1)*4+3];default:return}};pt.getTotalCodewordsCount=function(e,r){switch(r){case V.L:return ut[(e-1)*4+0];case V.M:return ut[(e-1)*4+1];case V.Q:return ut[(e-1)*4+2];case V.H:return ut[(e-1)*4+3];default:return}};var ee={},wt={};const it=new Uint8Array(512),dt=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)it[r]=e,dt[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)it[r]=it[r-255]})();wt.log=function(e){if(e<1)throw new Error("log("+e+")");return dt[e]};wt.exp=function(e){return it[e]};wt.mul=function(e,r){return e===0||r===0?0:it[dt[e]+dt[r]]};(function(t){const e=wt;t.mul=function(n,o){const a=new Uint8Array(n.length+o.length-1);for(let s=0;s<n.length;s++)for(let c=0;c<o.length;c++)a[s+c]^=e.mul(n[s],o[c]);return a},t.mod=function(n,o){let a=new Uint8Array(n);for(;a.length-o.length>=0;){const s=a[0];for(let i=0;i<o.length;i++)a[i]^=e.mul(o[i],s);let c=0;for(;c<a.length&&a[c]===0;)c++;a=a.slice(c)}return a},t.generateECPolynomial=function(n){let o=new Uint8Array([1]);for(let a=0;a<n;a++)o=t.mul(o,new Uint8Array([1,e.exp(a)]));return o}})(ee);const ne=ee;function Dt(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Dt.prototype.initialize=function(e){this.degree=e,this.genPoly=ne.generateECPolynomial(this.degree)};Dt.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const n=ne.mod(r,this.genPoly),o=this.degree-n.length;if(o>0){const a=new Uint8Array(this.degree);return a.set(n,o),a}return n};var Le=Dt,re={},W={},_t={};_t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var K={};const oe="[0-9]+",Se="[A-Z $%*+\\-./:]+";let at="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";at=at.replace(/u/g,"\\u");const Me="(?:(?![A-Z0-9 $%*+\\-./:]|"+at+`)(?:.|[\r
]))+`;K.KANJI=new RegExp(at,"g");K.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");K.BYTE=new RegExp(Me,"g");K.NUMERIC=new RegExp(oe,"g");K.ALPHANUMERIC=new RegExp(Se,"g");const Ne=new RegExp("^"+at+"$"),Ie=new RegExp("^"+oe+"$"),Re=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");K.testKanji=function(e){return Ne.test(e)};K.testNumeric=function(e){return Ie.test(e)};K.testAlphanumeric=function(e){return Re.test(e)};(function(t){const e=_t,r=K;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(a,s){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!e.isValid(s))throw new Error("Invalid version: "+s);return s>=1&&s<10?a.ccBits[0]:s<27?a.ccBits[1]:a.ccBits[2]},t.getBestModeForData=function(a){return r.testNumeric(a)?t.NUMERIC:r.testAlphanumeric(a)?t.ALPHANUMERIC:r.testKanji(a)?t.KANJI:t.BYTE},t.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},t.isValid=function(a){return a&&a.bit&&a.ccBits};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+o)}}t.from=function(a,s){if(t.isValid(a))return a;try{return n(a)}catch{return s}}})(W);(function(t){const e=z,r=pt,n=mt,o=W,a=_t,s=7973,c=e.getBCHDigit(s);function i(y,m,A){for(let T=1;T<=40;T++)if(m<=t.getCapacity(T,A,y))return T}function d(y,m){return o.getCharCountIndicator(y,m)+4}function h(y,m){let A=0;return y.forEach(function(T){const B=d(T.mode,m);A+=B+T.getBitsLength()}),A}function C(y,m){for(let A=1;A<=40;A++)if(h(y,A)<=t.getCapacity(A,m,o.MIXED))return A}t.from=function(m,A){return a.isValid(m)?parseInt(m,10):A},t.getCapacity=function(m,A,T){if(!a.isValid(m))throw new Error("Invalid QR Code version");typeof T>"u"&&(T=o.BYTE);const B=e.getSymbolTotalCodewords(m),E=r.getTotalCodewordsCount(m,A),p=(B-E)*8;if(T===o.MIXED)return p;const g=p-d(T,m);switch(T){case o.NUMERIC:return Math.floor(g/10*3);case o.ALPHANUMERIC:return Math.floor(g/11*2);case o.KANJI:return Math.floor(g/13);case o.BYTE:default:return Math.floor(g/8)}},t.getBestVersionForData=function(m,A){let T;const B=n.from(A,n.M);if(Array.isArray(m)){if(m.length>1)return C(m,B);if(m.length===0)return 1;T=m[0]}else T=m;return i(T.mode,T.getLength(),B)},t.getEncodedBits=function(m){if(!a.isValid(m)||m<7)throw new Error("Invalid QR Code version");let A=m<<12;for(;e.getBCHDigit(A)-c>=0;)A^=s<<e.getBCHDigit(A)-c;return m<<12|A}})(re);var ie={};const Mt=z,ae=1335,Be=21522,jt=Mt.getBCHDigit(ae);ie.getEncodedBits=function(e,r){const n=e.bit<<3|r;let o=n<<10;for(;Mt.getBCHDigit(o)-jt>=0;)o^=ae<<Mt.getBCHDigit(o)-jt;return(n<<10|o)^Be};var se={};const Pe=W;function Z(t){this.mode=Pe.NUMERIC,this.data=t.toString()}Z.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Z.prototype.getLength=function(){return this.data.length};Z.prototype.getBitsLength=function(){return Z.getBitsLength(this.data.length)};Z.prototype.write=function(e){let r,n,o;for(r=0;r+3<=this.data.length;r+=3)n=this.data.substr(r,3),o=parseInt(n,10),e.put(o,10);const a=this.data.length-r;a>0&&(n=this.data.substr(r),o=parseInt(n,10),e.put(o,a*3+1))};var Oe=Z;const De=W,At=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function q(t){this.mode=De.ALPHANUMERIC,this.data=t}q.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};q.prototype.getLength=function(){return this.data.length};q.prototype.getBitsLength=function(){return q.getBitsLength(this.data.length)};q.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let n=At.indexOf(this.data[r])*45;n+=At.indexOf(this.data[r+1]),e.put(n,11)}this.data.length%2&&e.put(At.indexOf(this.data[r]),6)};var _e=q;const ke=W;function X(t){this.mode=ke.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}X.getBitsLength=function(e){return e*8};X.prototype.getLength=function(){return this.data.length};X.prototype.getBitsLength=function(){return X.getBitsLength(this.data.length)};X.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var Ue=X;const Fe=W,$e=z;function tt(t){this.mode=Fe.KANJI,this.data=t}tt.getBitsLength=function(e){return e*13};tt.prototype.getLength=function(){return this.data.length};tt.prototype.getBitsLength=function(){return tt.getBitsLength(this.data.length)};tt.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=$e.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var ze=tt,ce={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,n,o){var a={},s={};s[n]=0;var c=e.PriorityQueue.make();c.push(n,0);for(var i,d,h,C,y,m,A,T,B;!c.empty();){i=c.pop(),d=i.value,C=i.cost,y=r[d]||{};for(h in y)y.hasOwnProperty(h)&&(m=y[h],A=C+m,T=s[h],B=typeof s[h]>"u",(B||T>A)&&(s[h]=A,c.push(h,A),a[h]=d))}if(typeof o<"u"&&typeof s[o]>"u"){var E=["Could not find a path from ",n," to ",o,"."].join("");throw new Error(E)}return a},extract_shortest_path_from_predecessor_list:function(r,n){for(var o=[],a=n;a;)o.push(a),r[a],a=r[a];return o.reverse(),o},find_path:function(r,n,o){var a=e.single_source_shortest_paths(r,n,o);return e.extract_shortest_path_from_predecessor_list(a,o)},PriorityQueue:{make:function(r){var n=e.PriorityQueue,o={},a;r=r||{};for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a]);return o.queue=[],o.sorter=r.sorter||n.default_sorter,o},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var o={value:r,cost:n};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(ce);var je=ce.exports;(function(t){const e=W,r=Oe,n=_e,o=Ue,a=ze,s=K,c=z,i=je;function d(E){return unescape(encodeURIComponent(E)).length}function h(E,p,g){const w=[];let v;for(;(v=E.exec(g))!==null;)w.push({data:v[0],index:v.index,mode:p,length:v[0].length});return w}function C(E){const p=h(s.NUMERIC,e.NUMERIC,E),g=h(s.ALPHANUMERIC,e.ALPHANUMERIC,E);let w,v;return c.isKanjiModeEnabled()?(w=h(s.BYTE,e.BYTE,E),v=h(s.KANJI,e.KANJI,E)):(w=h(s.BYTE_KANJI,e.BYTE,E),v=[]),p.concat(g,w,v).sort(function(N,O){return N.index-O.index}).map(function(N){return{data:N.data,mode:N.mode,length:N.length}})}function y(E,p){switch(p){case e.NUMERIC:return r.getBitsLength(E);case e.ALPHANUMERIC:return n.getBitsLength(E);case e.KANJI:return a.getBitsLength(E);case e.BYTE:return o.getBitsLength(E)}}function m(E){return E.reduce(function(p,g){const w=p.length-1>=0?p[p.length-1]:null;return w&&w.mode===g.mode?(p[p.length-1].data+=g.data,p):(p.push(g),p)},[])}function A(E){const p=[];for(let g=0;g<E.length;g++){const w=E[g];switch(w.mode){case e.NUMERIC:p.push([w,{data:w.data,mode:e.ALPHANUMERIC,length:w.length},{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.ALPHANUMERIC:p.push([w,{data:w.data,mode:e.BYTE,length:w.length}]);break;case e.KANJI:p.push([w,{data:w.data,mode:e.BYTE,length:d(w.data)}]);break;case e.BYTE:p.push([{data:w.data,mode:e.BYTE,length:d(w.data)}])}}return p}function T(E,p){const g={},w={start:{}};let v=["start"];for(let M=0;M<E.length;M++){const N=E[M],O=[];for(let P=0;P<N.length;P++){const D=N[P],_=""+M+P;O.push(_),g[_]={node:D,lastCount:0},w[_]={};for(let G=0;G<v.length;G++){const k=v[G];g[k]&&g[k].node.mode===D.mode?(w[k][_]=y(g[k].lastCount+D.length,D.mode)-y(g[k].lastCount,D.mode),g[k].lastCount+=D.length):(g[k]&&(g[k].lastCount=D.length),w[k][_]=y(D.length,D.mode)+4+e.getCharCountIndicator(D.mode,p))}}v=O}for(let M=0;M<v.length;M++)w[v[M]].end=0;return{map:w,table:g}}function B(E,p){let g;const w=e.getBestModeForData(E);if(g=e.from(p,w),g!==e.BYTE&&g.bit<w.bit)throw new Error('"'+E+'" cannot be encoded with mode '+e.toString(g)+`.
 Suggested mode is: `+e.toString(w));switch(g===e.KANJI&&!c.isKanjiModeEnabled()&&(g=e.BYTE),g){case e.NUMERIC:return new r(E);case e.ALPHANUMERIC:return new n(E);case e.KANJI:return new a(E);case e.BYTE:return new o(E)}}t.fromArray=function(p){return p.reduce(function(g,w){return typeof w=="string"?g.push(B(w,null)):w.data&&g.push(B(w.data,w.mode)),g},[])},t.fromString=function(p,g){const w=C(p,c.isKanjiModeEnabled()),v=A(w),M=T(v,g),N=i.find_path(M.map,"start","end"),O=[];for(let P=1;P<N.length-1;P++)O.push(M.table[N[P]].node);return t.fromArray(m(O))},t.rawSplit=function(p){return t.fromArray(C(p,c.isKanjiModeEnabled()))}})(se);const yt=z,vt=mt,Ge=ve,He=be,Ke=qt,Ye=Xt,Nt=te,It=pt,Je=Le,ht=re,Ve=ie,We=W,bt=se;function xe(t,e){const r=t.size,n=Ye.getPositions(e);for(let o=0;o<n.length;o++){const a=n[o][0],s=n[o][1];for(let c=-1;c<=7;c++)if(!(a+c<=-1||r<=a+c))for(let i=-1;i<=7;i++)s+i<=-1||r<=s+i||(c>=0&&c<=6&&(i===0||i===6)||i>=0&&i<=6&&(c===0||c===6)||c>=2&&c<=4&&i>=2&&i<=4?t.set(a+c,s+i,!0,!0):t.set(a+c,s+i,!1,!0))}}function Qe(t){const e=t.size;for(let r=8;r<e-8;r++){const n=r%2===0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}function Ze(t,e){const r=Ke.getPositions(e);for(let n=0;n<r.length;n++){const o=r[n][0],a=r[n][1];for(let s=-2;s<=2;s++)for(let c=-2;c<=2;c++)s===-2||s===2||c===-2||c===2||s===0&&c===0?t.set(o+s,a+c,!0,!0):t.set(o+s,a+c,!1,!0)}}function qe(t,e){const r=t.size,n=ht.getEncodedBits(e);let o,a,s;for(let c=0;c<18;c++)o=Math.floor(c/3),a=c%3+r-8-3,s=(n>>c&1)===1,t.set(o,a,s,!0),t.set(a,o,s,!0)}function Tt(t,e,r){const n=t.size,o=Ve.getEncodedBits(e,r);let a,s;for(a=0;a<15;a++)s=(o>>a&1)===1,a<6?t.set(a,8,s,!0):a<8?t.set(a+1,8,s,!0):t.set(n-15+a,8,s,!0),a<8?t.set(8,n-a-1,s,!0):a<9?t.set(8,15-a-1+1,s,!0):t.set(8,15-a-1,s,!0);t.set(n-8,8,1,!0)}function Xe(t,e){const r=t.size;let n=-1,o=r-1,a=7,s=0;for(let c=r-1;c>0;c-=2)for(c===6&&c--;;){for(let i=0;i<2;i++)if(!t.isReserved(o,c-i)){let d=!1;s<e.length&&(d=(e[s]>>>a&1)===1),t.set(o,c-i,d),a--,a===-1&&(s++,a=7)}if(o+=n,o<0||r<=o){o-=n,n=-n;break}}}function tn(t,e,r){const n=new Ge;r.forEach(function(i){n.put(i.mode.bit,4),n.put(i.getLength(),We.getCharCountIndicator(i.mode,t)),i.write(n)});const o=yt.getSymbolTotalCodewords(t),a=It.getTotalCodewordsCount(t,e),s=(o-a)*8;for(n.getLengthInBits()+4<=s&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const c=(s-n.getLengthInBits())/8;for(let i=0;i<c;i++)n.put(i%2?17:236,8);return en(n,t,e)}function en(t,e,r){const n=yt.getSymbolTotalCodewords(e),o=It.getTotalCodewordsCount(e,r),a=n-o,s=It.getBlocksCount(e,r),c=n%s,i=s-c,d=Math.floor(n/s),h=Math.floor(a/s),C=h+1,y=d-h,m=new Je(y);let A=0;const T=new Array(s),B=new Array(s);let E=0;const p=new Uint8Array(t.buffer);for(let N=0;N<s;N++){const O=N<i?h:C;T[N]=p.slice(A,A+O),B[N]=m.encode(T[N]),A+=O,E=Math.max(E,O)}const g=new Uint8Array(n);let w=0,v,M;for(v=0;v<E;v++)for(M=0;M<s;M++)v<T[M].length&&(g[w++]=T[M][v]);for(v=0;v<y;v++)for(M=0;M<s;M++)g[w++]=B[M][v];return g}function nn(t,e,r,n){let o;if(Array.isArray(t))o=bt.fromArray(t);else if(typeof t=="string"){let d=e;if(!d){const h=bt.rawSplit(t);d=ht.getBestVersionForData(h,r)}o=bt.fromString(t,d||40)}else throw new Error("Invalid data");const a=ht.getBestVersionForData(o,r);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=a;else if(e<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const s=tn(e,r,o),c=yt.getSymbolSize(e),i=new He(c);return xe(i,e),Qe(i),Ze(i,e),Tt(i,r,0),e>=7&&qe(i,e),Xe(i,s),isNaN(n)&&(n=Nt.getBestMask(i,Tt.bind(null,i,r))),Nt.applyMask(n,i),Tt(i,r,n),{modules:i,version:e,errorCorrectionLevel:r,maskPattern:n,segments:o}}Qt.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let n=vt.M,o,a;return typeof r<"u"&&(n=vt.from(r.errorCorrectionLevel,vt.M),o=ht.from(r.version),a=Nt.from(r.maskPattern),r.toSJISFunc&&yt.setToSJISFunction(r.toSJISFunc)),nn(e,o,n,a)};var le={},kt={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const o=parseInt(n.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:o&255,hex:"#"+n.slice(0,6).join("")}}t.getOptions=function(n){n||(n={}),n.color||(n.color={});const o=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,s=n.scale||4;return{width:a,scale:a?4:s,margin:o,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},t.getScale=function(n,o){return o.width&&o.width>=n+o.margin*2?o.width/(n+o.margin*2):o.scale},t.getImageWidth=function(n,o){const a=t.getScale(n,o);return Math.floor((n+o.margin*2)*a)},t.qrToImageData=function(n,o,a){const s=o.modules.size,c=o.modules.data,i=t.getScale(s,a),d=Math.floor((s+a.margin*2)*i),h=a.margin*i,C=[a.color.light,a.color.dark];for(let y=0;y<d;y++)for(let m=0;m<d;m++){let A=(y*d+m)*4,T=a.color.light;if(y>=h&&m>=h&&y<d-h&&m<d-h){const B=Math.floor((y-h)/i),E=Math.floor((m-h)/i);T=C[c[B*s+E]?1:0]}n[A++]=T.r,n[A++]=T.g,n[A++]=T.b,n[A]=T.a}}})(kt);(function(t){const e=kt;function r(o,a,s){o.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=s,a.width=s,a.style.height=s+"px",a.style.width=s+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(a,s,c){let i=c,d=s;typeof i>"u"&&(!s||!s.getContext)&&(i=s,s=void 0),s||(d=n()),i=e.getOptions(i);const h=e.getImageWidth(a.modules.size,i),C=d.getContext("2d"),y=C.createImageData(h,h);return e.qrToImageData(y.data,a,i),r(C,d,h),C.putImageData(y,0,0),d},t.renderToDataURL=function(a,s,c){let i=c;typeof i>"u"&&(!s||!s.getContext)&&(i=s,s=void 0),i||(i={});const d=t.render(a,s,i),h=i.type||"image/png",C=i.rendererOpts||{};return d.toDataURL(h,C.quality)}})(le);var ue={};const rn=kt;function Gt(t,e){const r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function Lt(t,e,r){let n=t+e;return typeof r<"u"&&(n+=" "+r),n}function on(t,e,r){let n="",o=0,a=!1,s=0;for(let c=0;c<t.length;c++){const i=Math.floor(c%e),d=Math.floor(c/e);!i&&!a&&(a=!0),t[c]?(s++,c>0&&i>0&&t[c-1]||(n+=a?Lt("M",i+r,.5+d+r):Lt("m",o,0),o=0,a=!1),i+1<e&&t[c+1]||(n+=Lt("h",s),s=0)):o++}return n}ue.render=function(e,r,n){const o=rn.getOptions(r),a=e.modules.size,s=e.modules.data,c=a+o.margin*2,i=o.color.light.a?"<path "+Gt(o.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",d="<path "+Gt(o.color.dark,"stroke")+' d="'+on(s,a,o.margin)+'"/>',h='viewBox="0 0 '+c+" "+c+'"',y='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+h+' shape-rendering="crispEdges">'+i+d+`</svg>
`;return typeof n=="function"&&n(null,y),y};const an=Ce,Rt=Qt,fe=le,sn=ue;function Ut(t,e,r,n,o){const a=[].slice.call(arguments,1),s=a.length,c=typeof a[s-1]=="function";if(!c&&!an())throw new Error("Callback required as last argument");if(c){if(s<2)throw new Error("Too few arguments provided");s===2?(o=r,r=e,e=n=void 0):s===3&&(e.getContext&&typeof o>"u"?(o=n,n=void 0):(o=n,n=r,r=e,e=void 0))}else{if(s<1)throw new Error("Too few arguments provided");return s===1?(r=e,e=n=void 0):s===2&&!e.getContext&&(n=r,r=e,e=void 0),new Promise(function(i,d){try{const h=Rt.create(r,n);i(t(h,e,n))}catch(h){d(h)}})}try{const i=Rt.create(r,n);o(null,t(i,e,n))}catch(i){o(i)}}st.create=Rt.create;st.toCanvas=Ut.bind(null,fe.render);st.toDataURL=Ut.bind(null,fe.renderToDataURL);st.toString=Ut.bind(null,function(t,e,r){return sn.render(t,r)});var cn={exports:{}};(function(t){var e=function(r){var n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(u,l,f){u[l]=f.value},s,c=typeof Symbol=="function"?Symbol:{},i=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function C(u,l,f){return Object.defineProperty(u,l,{value:f,enumerable:!0,configurable:!0,writable:!0}),u[l]}try{C({},"")}catch{C=function(l,f,L){return l[f]=L}}function y(u,l,f,L){var b=l&&l.prototype instanceof g?l:g,R=Object.create(b.prototype),U=new rt(L||[]);return a(R,"_invoke",{value:G(u,f,U)}),R}r.wrap=y;function m(u,l,f){try{return{type:"normal",arg:u.call(l,f)}}catch(L){return{type:"throw",arg:L}}}var A="suspendedStart",T="suspendedYield",B="executing",E="completed",p={};function g(){}function w(){}function v(){}var M={};C(M,i,function(){return this});var N=Object.getPrototypeOf,O=N&&N(N(S([])));O&&O!==n&&o.call(O,i)&&(M=O);var P=v.prototype=g.prototype=Object.create(M);w.prototype=v,a(P,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:w,configurable:!0}),w.displayName=C(v,h,"GeneratorFunction");function D(u){["next","throw","return"].forEach(function(l){C(u,l,function(f){return this._invoke(l,f)})})}r.isGeneratorFunction=function(u){var l=typeof u=="function"&&u.constructor;return l?l===w||(l.displayName||l.name)==="GeneratorFunction":!1},r.mark=function(u){return Object.setPrototypeOf?Object.setPrototypeOf(u,v):(u.__proto__=v,C(u,h,"GeneratorFunction")),u.prototype=Object.create(P),u},r.awrap=function(u){return{__await:u}};function _(u,l){function f(R,U,F,j){var $=m(u[R],u,U);if($.type==="throw")j($.arg);else{var Ct=$.arg,ot=Ct.value;return ot&&typeof ot=="object"&&o.call(ot,"__await")?l.resolve(ot.__await).then(function(x){f("next",x,F,j)},function(x){f("throw",x,F,j)}):l.resolve(ot).then(function(x){Ct.value=x,F(Ct)},function(x){return f("throw",x,F,j)})}}var L;function b(R,U){function F(){return new l(function(j,$){f(R,U,j,$)})}return L=L?L.then(F,F):F()}a(this,"_invoke",{value:b})}D(_.prototype),C(_.prototype,d,function(){return this}),r.AsyncIterator=_,r.async=function(u,l,f,L,b){b===void 0&&(b=Promise);var R=new _(y(u,l,f,L),b);return r.isGeneratorFunction(l)?R:R.next().then(function(U){return U.done?U.value:R.next()})};function G(u,l,f){var L=A;return function(R,U){if(L===B)throw new Error("Generator is already running");if(L===E){if(R==="throw")throw U;return I()}for(f.method=R,f.arg=U;;){var F=f.delegate;if(F){var j=k(F,f);if(j){if(j===p)continue;return j}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(L===A)throw L=E,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);L=B;var $=m(u,l,f);if($.type==="normal"){if(L=f.done?E:T,$.arg===p)continue;return{value:$.arg,done:f.done}}else $.type==="throw"&&(L=E,f.method="throw",f.arg=$.arg)}}}function k(u,l){var f=l.method,L=u.iterator[f];if(L===s)return l.delegate=null,f==="throw"&&u.iterator.return&&(l.method="return",l.arg=s,k(u,l),l.method==="throw")||f!=="return"&&(l.method="throw",l.arg=new TypeError("The iterator does not provide a '"+f+"' method")),p;var b=m(L,u.iterator,l.arg);if(b.type==="throw")return l.method="throw",l.arg=b.arg,l.delegate=null,p;var R=b.arg;if(!R)return l.method="throw",l.arg=new TypeError("iterator result is not an object"),l.delegate=null,p;if(R.done)l[u.resultName]=R.value,l.next=u.nextLoc,l.method!=="return"&&(l.method="next",l.arg=s);else return R;return l.delegate=null,p}D(P),C(P,h,"Generator"),C(P,i,function(){return this}),C(P,"toString",function(){return"[object Generator]"});function Et(u){var l={tryLoc:u[0]};1 in u&&(l.catchLoc=u[1]),2 in u&&(l.finallyLoc=u[2],l.afterLoc=u[3]),this.tryEntries.push(l)}function nt(u){var l=u.completion||{};l.type="normal",delete l.arg,u.completion=l}function rt(u){this.tryEntries=[{tryLoc:"root"}],u.forEach(Et,this),this.reset(!0)}r.keys=function(u){var l=Object(u),f=[];for(var L in l)f.push(L);return f.reverse(),function b(){for(;f.length;){var R=f.pop();if(R in l)return b.value=R,b.done=!1,b}return b.done=!0,b}};function S(u){if(u){var l=u[i];if(l)return l.call(u);if(typeof u.next=="function")return u;if(!isNaN(u.length)){var f=-1,L=function b(){for(;++f<u.length;)if(o.call(u,f))return b.value=u[f],b.done=!1,b;return b.value=s,b.done=!0,b};return L.next=L}}return{next:I}}r.values=S;function I(){return{value:s,done:!0}}return rt.prototype={constructor:rt,reset:function(u){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(nt),!u)for(var l in this)l.charAt(0)==="t"&&o.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=s)},stop:function(){this.done=!0;var u=this.tryEntries[0],l=u.completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(u){if(this.done)throw u;var l=this;function f(j,$){return R.type="throw",R.arg=u,l.next=j,$&&(l.method="next",l.arg=s),!!$}for(var L=this.tryEntries.length-1;L>=0;--L){var b=this.tryEntries[L],R=b.completion;if(b.tryLoc==="root")return f("end");if(b.tryLoc<=this.prev){var U=o.call(b,"catchLoc"),F=o.call(b,"finallyLoc");if(U&&F){if(this.prev<b.catchLoc)return f(b.catchLoc,!0);if(this.prev<b.finallyLoc)return f(b.finallyLoc)}else if(U){if(this.prev<b.catchLoc)return f(b.catchLoc,!0)}else if(F){if(this.prev<b.finallyLoc)return f(b.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(u,l){for(var f=this.tryEntries.length-1;f>=0;--f){var L=this.tryEntries[f];if(L.tryLoc<=this.prev&&o.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var b=L;break}}b&&(u==="break"||u==="continue")&&b.tryLoc<=l&&l<=b.finallyLoc&&(b=null);var R=b?b.completion:{};return R.type=u,R.arg=l,b?(this.method="next",this.next=b.finallyLoc,p):this.complete(R)},complete:function(u,l){if(u.type==="throw")throw u.arg;return u.type==="break"||u.type==="continue"?this.next=u.arg:u.type==="return"?(this.rval=this.arg=u.arg,this.method="return",this.next="end"):u.type==="normal"&&l&&(this.next=l),p},finish:function(u){for(var l=this.tryEntries.length-1;l>=0;--l){var f=this.tryEntries[l];if(f.finallyLoc===u)return this.complete(f.completion,f.afterLoc),nt(f),p}},catch:function(u){for(var l=this.tryEntries.length-1;l>=0;--l){var f=this.tryEntries[l];if(f.tryLoc===u){var L=f.completion;if(L.type==="throw"){var b=L.arg;nt(f)}return b}}throw new Error("illegal catch attempt")},delegateYield:function(u,l,f){return this.delegate={iterator:S(u),resultName:l,nextLoc:f},this.method==="next"&&(this.arg=s),p}},r}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(cn);var Ft=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const ln=Ft;let Ht=0;var de=({id:t,action:e,payload:r={}})=>{let n=t;return typeof n>"u"&&(n=ln("Job",Ht),Ht+=1),{id:n,action:e,payload:r}},et={};let $t=!1;et.logging=$t;et.setLogging=t=>{$t=t};et.log=(...t)=>$t?console.log.apply(void 0,t):null;const un=de,{log:ft}=et,fn=Ft;let Kt=0;var dn=()=>{const t=fn("Scheduler",Kt),e={},r={};let n=[];Kt+=1;const o=()=>n.length,a=()=>Object.keys(e).length,s=()=>{if(n.length!==0){const C=Object.keys(e);for(let y=0;y<C.length;y+=1)if(typeof r[C[y]]>"u"){n[0](e[C[y]]);break}}},c=(C,y)=>new Promise((m,A)=>{const T=un({action:C,payload:y});n.push(async B=>{n.shift(),r[B.id]=T;try{m(await B[C].apply(void 0,[...y,T.id]))}catch(E){A(E)}finally{delete r[B.id],s()}}),ft(`[${t}]: Add ${T.id} to JobQueue`),ft(`[${t}]: JobQueue length=${n.length}`),s()});return{addWorker:C=>(e[C.id]=C,ft(`[${t}]: Add ${C.id}`),ft(`[${t}]: Number of workers=${a()}`),s(),C.id),addJob:async(C,...y)=>{if(a()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return c(C,y)},terminate:async()=>{Object.keys(e).forEach(async C=>{await e[C].terminate()}),n=[]},getQueueLen:o,getNumWorkers:a}},hn=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof Ee=="function"&&(e.type="node"),typeof t>"u"?e:e[t]};const gn=hn("type")==="browser",mn=gn?t=>new URL(t,window.location.href).href:t=>t;var pn=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach(r=>{t[r]&&(e[r]=mn(e[r]))}),e},he={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const wn="6.0.1",yn={version:wn};var En={workerBlobURL:!0,logger:()=>{}};const Cn=yn.version,An=En;var vn={...An,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Cn}/dist/worker.min.js`},bn=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const n=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(n))}else r=new Worker(t);return r},Tn=t=>{t.terminate()},Ln=(t,e)=>{t.onmessage=({data:r})=>{e(r)}},Sn=async(t,e)=>{t.postMessage(e)};const St=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=({target:{error:{code:o}}})=>{r(Error(`File could not be read! Code=${o}`))},n.readAsArrayBuffer(t)}),Bt=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(r=>r.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await Bt(t.src)),t.tagName==="VIDEO"&&(e=await Bt(t.poster)),t.tagName==="CANVAS"&&await new Promise(r=>{t.toBlob(async n=>{e=await St(n),r()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const r=await t.convertToBlob();e=await St(r)}else(t instanceof File||t instanceof Blob)&&(e=await St(t));return new Uint8Array(e)};var Mn=Bt;const Nn=vn,In=bn,Rn=Tn,Bn=Ln,Pn=Sn,On=Mn;var Dn={defaultOptions:Nn,spawnWorker:In,terminateWorker:Rn,onMessage:Bn,send:Pn,loadImage:On};const _n=pn,H=de,{log:Yt}=et,kn=Ft,Q=he,{defaultOptions:Un,spawnWorker:Fn,terminateWorker:$n,onMessage:zn,loadImage:Jt,send:jn}=Dn;let Vt=0;var ge=async(t="eng",e=Q.LSTM_ONLY,r={},n={})=>{const o=kn("Worker",Vt),{logger:a,errorHandler:s,...c}=_n({...Un,...r}),i={},d=typeof t=="string"?t.split("+"):t;let h=e,C=n;const y=[Q.DEFAULT,Q.LSTM_ONLY].includes(e)&&!c.legacyCore;let m,A;const T=new Promise((S,I)=>{A=S,m=I}),B=S=>{m(S.message)};let E=Fn(c);E.onerror=B,Vt+=1;const p=({id:S,action:I,payload:u})=>new Promise((l,f)=>{Yt(`[${o}]: Start ${S}, action=${I}`);const L=`${I}-${S}`;i[L]={resolve:l,reject:f},jn(E,{workerId:o,jobId:S,action:I,payload:u})}),g=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),w=S=>p(H({id:S,action:"load",payload:{options:{lstmOnly:y,corePath:c.corePath,logging:c.logging}}})),v=(S,I,u)=>p(H({id:u,action:"FS",payload:{method:"writeFile",args:[S,I]}})),M=(S,I)=>p(H({id:I,action:"FS",payload:{method:"readFile",args:[S,{encoding:"utf8"}]}})),N=(S,I)=>p(H({id:I,action:"FS",payload:{method:"unlink",args:[S]}})),O=(S,I,u)=>p(H({id:u,action:"FS",payload:{method:S,args:I}})),P=(S,I)=>p(H({id:I,action:"loadLanguage",payload:{langs:S,options:{langPath:c.langPath,dataPath:c.dataPath,cachePath:c.cachePath,cacheMethod:c.cacheMethod,gzip:c.gzip,lstmOnly:[Q.DEFAULT,Q.LSTM_ONLY].includes(h)&&!c.legacyLang}}})),D=(S,I,u,l)=>p(H({id:l,action:"initialize",payload:{langs:S,oem:I,config:u}})),_=(S="eng",I,u,l)=>{if(y&&[Q.TESSERACT_ONLY,Q.TESSERACT_LSTM_COMBINED].includes(I))throw Error("Legacy model requested but code missing.");const f=I||h;h=f;const L=u||C;C=L;const R=(typeof S=="string"?S.split("+"):S).filter(U=>!d.includes(U));return d.push(...R),R.length>0?P(R,l).then(()=>D(S,f,L,l)):D(S,f,L,l)},G=(S={},I)=>p(H({id:I,action:"setParameters",payload:{params:S}})),k=async(S,I={},u={text:!0},l)=>p(H({id:l,action:"recognize",payload:{image:await Jt(S),options:I,output:u}})),Et=async(S,I)=>{if(y)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return p(H({id:I,action:"detect",payload:{image:await Jt(S)}}))},nt=async()=>(E!==null&&($n(E),E=null),Promise.resolve());zn(E,({workerId:S,jobId:I,status:u,action:l,data:f})=>{const L=`${l}-${I}`;if(u==="resolve")Yt(`[${S}]: Complete ${I}`),i[L].resolve({jobId:I,data:f}),delete i[L];else if(u==="reject")if(i[L].reject(f),delete i[L],l==="load"&&m(f),s)s(f);else throw Error(f);else u==="progress"&&a({...f,userJobId:I})});const rt={id:o,worker:E,load:g,writeText:v,readText:M,removeFile:N,FS:O,reinitialize:_,setParameters:G,recognize:k,detect:Et,terminate:nt};return w().then(()=>P(t)).then(()=>D(t,e,n)).then(()=>A(rt)).catch(()=>{}),T};const me=ge,Gn=async(t,e,r)=>{const n=await me(e,1,r);return n.recognize(t).finally(async()=>{await n.terminate()})},Hn=async(t,e)=>{const r=await me("osd",0,e);return r.detect(t).finally(async()=>{await r.terminate()})};var Kn={recognize:Gn,detect:Hn},Yn={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},Jn={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const Vn=dn,Wn=ge,xn=Kn,Qn=Yn,Zn=he,qn=Jn,{setLogging:Xn}=et;var tr={languages:Qn,OEM:Zn,PSM:qn,createScheduler:Vn,createWorker:Wn,setLogging:Xn,...xn};let J=null,gt=!1;const pe=async()=>{if(gt&&J)return J;try{return console.log("Initializing Optimized Tesseract OCR..."),J=await tr.createWorker("eng",1,{logger:t=>{t.status==="recognizing text"&&console.log(`OCR Progress: ${Math.round(t.progress*100)}%`)}}),await J.setParameters({tessedit_pageseg_mode:"1",tessedit_ocr_engine_mode:"2",tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789 .,/-:()&",preserve_interword_spaces:"1",tessedit_do_invert:"1"}),gt=!0,console.log("Optimized Tesseract OCR initialized successfully"),J}catch(t){throw console.error("Failed to initialize Optimized Tesseract OCR:",t),new Error("Failed to initialize OCR engine")}},Wt=t=>{if(!t)return t;console.log("Applying advanced preprocessing...");const r=Math.min(1,2e3/Math.max(t.width,t.height)),n=Math.max(1,Math.floor(t.width*r)),o=Math.max(1,Math.floor(t.height*r)),a=document.createElement("canvas");a.width=n,a.height=o;const s=a.getContext("2d");s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.drawImage(t,0,0,n,o);const c=s.getImageData(0,0,n,o),{data:i}=c;let d=0,h=255,C=0;for(let g=0;g<i.length;g+=4){const w=i[g],v=i[g+1],M=i[g+2],N=Math.round(.299*w+.587*v+.114*M);d+=N,h=Math.min(h,N),C=Math.max(C,N),i[g]=N,i[g+1]=N,i[g+2]=N}const y=i.length/4,m=d/y;console.log(`Image stats - Mean: ${m.toFixed(2)}, Min: ${h}, Max: ${C}`);const A=C-h;if(A>0&&A<200){console.log("Applying contrast enhancement...");for(let g=0;g<i.length;g+=4){const w=(i[g]-h)/A,v=Math.round(w*255);i[g]=v,i[g+1]=v,i[g+2]=v}}console.log("Applying adaptive thresholding...");const T=15,B=new Uint8ClampedArray(i);for(let g=0;g<o;g++)for(let w=0;w<n;w++){const v=(g*n+w)*4;let M=0,N=0;for(let _=Math.max(0,g-T);_<Math.min(o,g+T);_++)for(let G=Math.max(0,w-T);G<Math.min(n,w+T);G++){const k=(_*n+G)*4;M+=B[k],N++}const P=M/N*.95,D=B[v]>P?255:0;i[v]=D,i[v+1]=D,i[v+2]=D}console.log("Applying noise reduction...");const E=new Uint8ClampedArray(i),p=3;for(let g=p;g<o-p;g++)for(let w=p;w<n-p;w++){const v=(g*n+w)*4,M=[];for(let O=-p;O<=p;O++)for(let P=-p;P<=p;P++){const D=((g+O)*n+(w+P))*4;M.push(E[D])}M.sort((O,P)=>O-P);const N=M[Math.floor(M.length/2)];i[v]=N,i[v+1]=N,i[v+2]=N}return s.putImageData(c,0,0),console.log("Advanced preprocessing complete"),a},er=t=>{if(!t)return t;const r=Math.min(1,1600/Math.max(t.width,t.height)),n=Math.max(1,Math.floor(t.width*r)),o=Math.max(1,Math.floor(t.height*r)),a=document.createElement("canvas");a.width=n,a.height=o;const s=a.getContext("2d");s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.drawImage(t,0,0,n,o);const c=s.getImageData(0,0,n,o),{data:i}=c;let d=0;for(let m=0;m<i.length;m+=4){const A=i[m],T=i[m+1],B=i[m+2],E=Math.round(.299*A+.587*T+.114*B);d+=E,i[m]=E,i[m+1]=E,i[m+2]=E}const h=i.length/4,C=d/h,y=Math.max(70,Math.min(210,C*.9));for(let m=0;m<i.length;m+=4){const A=i[m]<y?0:255;i[m]=A,i[m+1]=A,i[m+2]=A}return s.putImageData(c,0,0),a},nr=t=>{const e=document.createElement("canvas");return e.width=t.width||t.naturalWidth,e.height=t.height||t.naturalHeight,e.getContext("2d").drawImage(t,0,0),e},rr=async(t,e={})=>{try{gt||await pe(),console.log("Starting Optimized Tesseract OCR recognition...");const r=Date.now();let n;if(typeof t=="string")n=new Image,n.crossOrigin="anonymous",await new Promise((i,d)=>{n.onload=i,n.onerror=d,n.src=t});else if(t instanceof File||t instanceof Blob){const i=URL.createObjectURL(t);n=new Image,await new Promise((d,h)=>{n.onload=()=>{URL.revokeObjectURL(i),d()},n.onerror=()=>{URL.revokeObjectURL(i),h(new Error("Failed to load image"))},n.src=i})}else if(t instanceof HTMLImageElement)n=t;else if(t instanceof HTMLCanvasElement)n=t;else throw new Error("Unsupported image type");let o;e.preprocess==="advanced"?o=Wt(n):e.preprocess==="basic"||e.preprocess===!0?o=er(n):e.preprocess===!1?o=nr(n):o=Wt(n);const a=await J.recognize(o),s=((Date.now()-r)/1e3).toFixed(2);console.log(`OCR completed in ${s}s`),console.log("OCR Confidence:",a.data.confidence.toFixed(2)+"%");const c=a.data.text||"";return console.log("Extracted text length:",c.length,"characters"),c}catch(r){throw console.error("Optimized Tesseract OCR recognition error:",r),new Error(`OCR failed: ${r.message}`)}},or=async()=>{J&&await J.terminate(),J=null,gt=!1,console.log("Optimized Tesseract OCR terminated")},xt={init:pe,recognize:rr,terminate:or},ur=async(t,e)=>{try{console.log("Starting Optimized OCR processing for file:",t.name),await xt.init();const r=await xt.recognize(t,{preprocess:"advanced"});console.log("=== EXTRACTED TEXT FROM DOCUMENT ==="),console.log(r),console.log("=== END EXTRACTED TEXT ===");const n=ir(r);console.log("=== FINAL EXTRACTED DATA ==="),console.log(n),console.log("=== END FINAL DATA ===");const o=await Pt.storeDocument(e,n);return console.log("Document stored with ID:",o),{...n,id:o,username:e,uploadedAt:new Date().toISOString(),originalText:r}}catch(r){throw console.error("Error processing document:",r),new Error("Failed to extract data from document image")}},Y=t=>t?t.replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim().replace(/\b(NAME|Name|name)\b/g,"").trim():"",ir=t=>{const e=t.split(`
`).map(c=>c.trim()).filter(c=>c);let r="",n="",o="",a="",s="";console.log("Processing lines:",e);for(let c=0;c<e.length;c++){const i=e[c];if(!s){const d=i.match(/\b\d{4}[\s\-]?\d{4}[\s\-]?\d{4}\b/);d&&(s=d[0].replace(/[\s\-]/g,""),console.log("Found Aadhaar:",s))}if(!a){const d=i.match(/(\+91[\-\s]?)?[6-9]\d{9}/);d&&(a=d[0].replace(/\+91|[\-\s]/g,""),console.log("Found Mobile:",a))}if(!n){const d=i.match(/(dob|d\.o\.b\.|date of birth|birth date|birth|d o b)[:\-\s]*([\d\/\-\.]+)/i);if(d&&d[2])n=d[2],console.log("Found DOB (label):",n);else{const h=i.match(/(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{4})/);if(h)n=h[1],console.log("Found DOB (format 1):",n);else{const C=i.match(/(\d{4}[\-\/.]\d{1,2}[\-\/.]\d{1,2})/);if(C)n=C[1],console.log("Found DOB (format 2):",n);else{const y=i.match(/(19|20)\d{2}/);y&&(n=y[0],console.log("Found Year:",n))}}}}if(!o&&/road|street|nagar|layout|block|cross|main|colony|area|village|city|state|pin/i.test(i)&&(o=i,console.log("Found Address:",o)),!r){console.log("Looking for name in line:",i);const d=i.match(/^name[:\-]?\s*(.+)/i);if(d)r=Y(d[1]),console.log("Found Name (pattern 1):",r);else if(i===i.toUpperCase()&&i.split(" ").length>=2){const h=e[c+1]||"";/dob|birth|year|gender|father|mother/i.test(h)&&(r=Y(i),console.log("Found Name (pattern 2):",r))}else if(/^[A-Z][a-z]+ [A-Z][a-z]+$/.test(i))r=Y(i),console.log("Found Name (pattern 3):",r);else if(/^[A-Z][a-z]+ [A-Z][a-z]+ [A-Z][a-z]+$/.test(i))r=Y(i),console.log("Found Name (pattern 4):",r);else if(/^[A-Z][a-z]+$/.test(i)&&i.length>3){const h=e[c+1]||"";/^[A-Z][a-z]+$/.test(h)&&h.length>3&&(r=Y(`${i.trim()} ${h.trim()}`),console.log("Found Name (pattern 5):",r))}else/^[A-Z][A-Z\s]+$/.test(i)&&i.split(" ").length>=2?(r=Y(i),console.log("Found Name (pattern 6):",r)):/^[A-Z][a-z]+$/.test(i)&&i.length>3&&i.length<15?(r=Y(i),console.log("Found Name (pattern 7 - single word):",r)):i.length>5&&i.length<50&&/^[A-Z][a-z\s]+$/.test(i)&&(r=Y(i),console.log("Found Name (pattern 8 - mixed case):",r))}}if(n&&n.length===4&&(n=`01/01/${n}`),!r){console.log("No name found with specific patterns, trying fallback...");for(let c=0;c<e.length;c++){const i=e[c];if(i.length>3&&i.length<30&&/^[A-Za-z\s]+$/.test(i)&&!i.includes(":")&&!/aadhaar|mobile|phone|address|dob|birth|year|gender|father|mother|card|number|id/i.test(i.toLowerCase())){r=Y(i),console.log("Found Name (fallback):",r);break}}}return console.log("Final extracted data:",{name:r,dob:n,address:o,mobile:a,aadhaar:s}),{name:r||"Not found",dob:n||"Not found",address:o||"Not found",mobile:a||"Not found",aadhaar:s||"Not found"}},fr=async(t,e)=>{try{const r={docType:"Document Verification",verifiedAt:new Date().toISOString(),username:t.username,name:t.name,dob:t.dob,mobile:t.mobile,aadhaar:t.aadhaar,address:t.address},n={docType:r.docType,verifiedAt:r.verifiedAt,username:r.username,name:r.name,dob:r.dob,mobile:r.mobile,aadhaar:r.aadhaar,address:r.address,verificationRequested:{age:e.age,address:e.address}};console.log("Generating QR with data:",n),console.log("Original document data:",t);const o=`${window.location.origin}/qr-verification?data=${encodeURIComponent(JSON.stringify(n))}`;return await st.toDataURL(o)}catch(r){throw console.error("Error generating QR code:",r),new Error("Failed to generate QR code")}},dr=t=>{if(!t||t==="Not found")return 0;try{let e;if(t.includes("/")){const[a,s,c]=t.split("/");e=new Date(c,s-1,a)}else if(t.includes("-")){const a=t.split("-");if(a[0].length===4)e=new Date(t);else{const[s,c,i]=a;e=new Date(i,c-1,s)}}else t.length===4?e=new Date(t,0,1):e=new Date(t);if(isNaN(e.getTime()))return console.error("Invalid date format:",t),0;const r=new Date;let n=r.getFullYear()-e.getFullYear();const o=r.getMonth()-e.getMonth();return(o<0||o===0&&r.getDate()<e.getDate())&&n--,Math.max(0,n)}catch(e){return console.error("Error calculating age from DOB:",t,e),0}},hr=async t=>await Pt.hasDocument(t),gr=async t=>await Pt.getDocumentByUsername(t);export{lr as L,fr as a,dr as c,gr as g,hr as h,ur as p};
