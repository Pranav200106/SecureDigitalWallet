const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DocumentScanner-DQODrtes.js","assets/react-webcam-BH7rRv44.js","assets/CheckCircle-DODlBGN0.js","assets/ownerWindow-CN4f4NkX.js","assets/debounce-Be36O1Ab.js","assets/useControlled-VN5YBWhF.js","assets/Error-BUZlbj-z.js","assets/useTheme-BwfxRj1I.js","assets/Chip-NFilBpqK.js","assets/Button-C5D5G1VZ.js","assets/FaceAuthentication-D5Zq0sKI.js","assets/useMediaQuery-DXyRXirw.js","assets/Card-ZxPpsMTE.js","assets/CardContent-LfaozUcB.js","assets/Divider-dYpdDvre.js","assets/dividerClasses-DtBGEAXD.js","assets/Header-BsdI_2uF.js","assets/List-DliLvTND.js","assets/ListItemText-CGSCj51j.js","assets/listItemTextClasses-hyLBwlX_.js","assets/Menu-Crt-Zobt.js","assets/MenuItem-D1KdRSwJ.js","assets/TeamPage-CqH-ppam.js","assets/proxy-CRqHtRti.js","assets/HomePage-yv9pXsYx.js","assets/QrCode2-bFD-gP5s.js","assets/Grid-6c8eFRQa.js","assets/VerifiedUser-BgCez8zf.js","assets/AuthPage-Dy2cS24k.js","assets/firebaseService-Bo3vlP6-.js","assets/TextField-CUMtBqqa.js","assets/useFormControl-YT1t7aI_.js","assets/Dashboard-DjLt4MY3.js","assets/documentUtils-bJFE2WUb.js","assets/documentDatabase-BelqUvD4.js","assets/_commonjs-dynamic-modules-TDtrdbi3.js","assets/submissionStore-CYenvhs3.js","assets/QRVerification-C-He5awM.js","assets/AdminDashboard-DyKqnmKi.js","assets/AdminLogin-JDy2ngLx.js"])))=>i.map(i=>d[i]);
function FD(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(t,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var JK=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ci(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var WC={exports:{}},sp={},jC={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lc=Symbol.for("react.element"),LD=Symbol.for("react.portal"),VD=Symbol.for("react.fragment"),BD=Symbol.for("react.strict_mode"),$D=Symbol.for("react.profiler"),UD=Symbol.for("react.provider"),zD=Symbol.for("react.context"),WD=Symbol.for("react.forward_ref"),jD=Symbol.for("react.suspense"),HD=Symbol.for("react.memo"),GD=Symbol.for("react.lazy"),__=Symbol.iterator;function qD(t){return t===null||typeof t!="object"?null:(t=__&&t[__]||t["@@iterator"],typeof t=="function"?t:null)}var HC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GC=Object.assign,qC={};function ku(t,e,n){this.props=t,this.context=e,this.refs=qC,this.updater=n||HC}ku.prototype.isReactComponent={};ku.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ku.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function KC(){}KC.prototype=ku.prototype;function v0(t,e,n){this.props=t,this.context=e,this.refs=qC,this.updater=n||HC}var g0=v0.prototype=new KC;g0.constructor=v0;GC(g0,ku.prototype);g0.isPureReactComponent=!0;var b_=Array.isArray,XC=Object.prototype.hasOwnProperty,y0={current:null},QC={key:!0,ref:!0,__self:!0,__source:!0};function YC(t,e,n){var r,o={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)XC.call(e,r)&&!QC.hasOwnProperty(r)&&(o[r]=e[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Lc,type:t,key:i,ref:a,props:o,_owner:y0.current}}function KD(t,e){return{$$typeof:Lc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function w0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lc}function XD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var E_=/\/+/g;function Qm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?XD(""+t.key):e.toString(36)}function gf(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Lc:case LD:a=!0}}if(a)return a=t,o=o(a),t=r===""?"."+Qm(a,0):r,b_(o)?(n="",t!=null&&(n=t.replace(E_,"$&/")+"/"),gf(o,e,n,"",function(l){return l})):o!=null&&(w0(o)&&(o=KD(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(E_,"$&/")+"/")+t)),e.push(o)),1;if(a=0,r=r===""?".":r+":",b_(t))for(var s=0;s<t.length;s++){i=t[s];var u=r+Qm(i,s);a+=gf(i,e,n,u,o)}else if(u=qD(t),typeof u=="function")for(t=u.call(t),s=0;!(i=t.next()).done;)i=i.value,u=r+Qm(i,s++),a+=gf(i,e,n,u,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Th(t,e,n){if(t==null)return t;var r=[],o=0;return gf(t,r,"","",function(i){return e.call(n,i,o++)}),r}function QD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wn={current:null},yf={transition:null},YD={ReactCurrentDispatcher:Wn,ReactCurrentBatchConfig:yf,ReactCurrentOwner:y0};function JC(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:Th,forEach:function(t,e,n){Th(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Th(t,function(){e++}),e},toArray:function(t){return Th(t,function(e){return e})||[]},only:function(t){if(!w0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=ku;Ve.Fragment=VD;Ve.Profiler=$D;Ve.PureComponent=v0;Ve.StrictMode=BD;Ve.Suspense=jD;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YD;Ve.act=JC;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=GC({},t.props),o=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=y0.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)XC.call(e,u)&&!QC.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Lc,type:t.type,key:o,ref:i,props:r,_owner:a}};Ve.createContext=function(t){return t={$$typeof:zD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:UD,_context:t},t.Consumer=t};Ve.createElement=YC;Ve.createFactory=function(t){var e=YC.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:WD,render:t}};Ve.isValidElement=w0;Ve.lazy=function(t){return{$$typeof:GD,_payload:{_status:-1,_result:t},_init:QD}};Ve.memo=function(t,e){return{$$typeof:HD,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=yf.transition;yf.transition={};try{t()}finally{yf.transition=e}};Ve.unstable_act=JC;Ve.useCallback=function(t,e){return Wn.current.useCallback(t,e)};Ve.useContext=function(t){return Wn.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return Wn.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return Wn.current.useEffect(t,e)};Ve.useId=function(){return Wn.current.useId()};Ve.useImperativeHandle=function(t,e,n){return Wn.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return Wn.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return Wn.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return Wn.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return Wn.current.useReducer(t,e,n)};Ve.useRef=function(t){return Wn.current.useRef(t)};Ve.useState=function(t){return Wn.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return Wn.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return Wn.current.useTransition()};Ve.version="18.3.1";jC.exports=Ve;var F=jC.exports;const Ms=zC(F),mg=FD({__proto__:null,default:Ms},[F]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JD=F,ZD=Symbol.for("react.element"),eN=Symbol.for("react.fragment"),tN=Object.prototype.hasOwnProperty,nN=JD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rN={key:!0,ref:!0,__self:!0,__source:!0};function ZC(t,e,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)tN.call(e,r)&&!rN.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:ZD,type:t,key:i,ref:a,props:o,_owner:nN.current}}sp.Fragment=eN;sp.jsx=ZC;sp.jsxs=ZC;WC.exports=sp;var te=WC.exports,eS={exports:{}},br={},tS={exports:{}},nS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,W){var H=V.length;V.push(W);e:for(;0<H;){var ne=H-1>>>1,oe=V[ne];if(0<o(oe,W))V[ne]=W,V[H]=oe,H=ne;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var W=V[0],H=V.pop();if(H!==W){V[0]=H;e:for(var ne=0,oe=V.length,de=oe>>>1;ne<de;){var me=2*(ne+1)-1,_e=V[me],xe=me+1,Ie=V[xe];if(0>o(_e,H))xe<oe&&0>o(Ie,_e)?(V[ne]=Ie,V[xe]=H,ne=xe):(V[ne]=_e,V[me]=H,ne=me);else if(xe<oe&&0>o(Ie,H))V[ne]=Ie,V[xe]=H,ne=xe;else break e}}return W}function o(V,W){var H=V.sortIndex-W.sortIndex;return H!==0?H:V.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,h=null,f=3,d=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(V){for(var W=n(l);W!==null;){if(W.callback===null)r(l);else if(W.startTime<=V)r(l),W.sortIndex=W.expirationTime,e(u,W);else break;W=n(l)}}function _(V){if(g=!1,x(V),!m)if(n(u)!==null)m=!0,K(S);else{var W=n(l);W!==null&&X(_,W.startTime-V)}}function S(V,W){m=!1,g&&(g=!1,v(E),E=-1),d=!0;var H=f;try{for(x(W),h=n(u);h!==null&&(!(h.expirationTime>W)||V&&!k());){var ne=h.callback;if(typeof ne=="function"){h.callback=null,f=h.priorityLevel;var oe=ne(h.expirationTime<=W);W=t.unstable_now(),typeof oe=="function"?h.callback=oe:h===n(u)&&r(u),x(W)}else r(u);h=n(u)}if(h!==null)var de=!0;else{var me=n(l);me!==null&&X(_,me.startTime-W),de=!1}return de}finally{h=null,f=H,d=!1}}var R=!1,C=null,E=-1,I=5,T=-1;function k(){return!(t.unstable_now()-T<I)}function P(){if(C!==null){var V=t.unstable_now();T=V;var W=!0;try{W=C(!0,V)}finally{W?D():(R=!1,C=null)}}else R=!1}var D;if(typeof w=="function")D=function(){w(P)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,U=$.port2;$.port1.onmessage=P,D=function(){U.postMessage(null)}}else D=function(){y(P,0)};function K(V){C=V,R||(R=!0,D())}function X(V,W){E=y(function(){V(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){m||d||(m=!0,K(S))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var W=3;break;default:W=f}var H=f;f=W;try{return V()}finally{f=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,W){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var H=f;f=V;try{return W()}finally{f=H}},t.unstable_scheduleCallback=function(V,W,H){var ne=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ne+H:ne):H=ne,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=H+oe,V={id:c++,callback:W,priorityLevel:V,startTime:H,expirationTime:oe,sortIndex:-1},H>ne?(V.sortIndex=H,e(l,V),n(u)===null&&V===n(l)&&(g?(v(E),E=-1):g=!0,X(_,H-ne))):(V.sortIndex=oe,e(u,V),m||d||(m=!0,K(S))),V},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(V){var W=f;return function(){var H=f;f=W;try{return V.apply(this,arguments)}finally{f=H}}}})(nS);tS.exports=nS;var oN=tS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iN=F,_r=oN;function re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rS=new Set,Jl={};function ns(t,e){fu(t,e),fu(t+"Capture",e)}function fu(t,e){for(Jl[t]=e,t=0;t<e.length;t++)rS.add(e[t])}var ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vg=Object.prototype.hasOwnProperty,aN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C_={},S_={};function sN(t){return vg.call(S_,t)?!0:vg.call(C_,t)?!1:aN.test(t)?S_[t]=!0:(C_[t]=!0,!1)}function uN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lN(t,e,n,r){if(e===null||typeof e>"u"||uN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jn(t,e,n,r,o,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xn[t]=new jn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xn[e]=new jn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xn[t]=new jn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xn[t]=new jn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xn[t]=new jn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xn[t]=new jn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xn[t]=new jn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xn[t]=new jn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xn[t]=new jn(t,5,!1,t.toLowerCase(),null,!1,!1)});var x0=/[\-:]([a-z])/g;function _0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(x0,_0);xn[e]=new jn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(x0,_0);xn[e]=new jn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(x0,_0);xn[e]=new jn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xn[t]=new jn(t,1,!1,t.toLowerCase(),null,!1,!1)});xn.xlinkHref=new jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xn[t]=new jn(t,1,!1,t.toLowerCase(),null,!0,!0)});function b0(t,e,n,r){var o=xn.hasOwnProperty(e)?xn[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lN(e,n,o,r)&&(n=null),r||o===null?sN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var hi=iN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rh=Symbol.for("react.element"),Os=Symbol.for("react.portal"),Fs=Symbol.for("react.fragment"),E0=Symbol.for("react.strict_mode"),gg=Symbol.for("react.profiler"),oS=Symbol.for("react.provider"),iS=Symbol.for("react.context"),C0=Symbol.for("react.forward_ref"),yg=Symbol.for("react.suspense"),wg=Symbol.for("react.suspense_list"),S0=Symbol.for("react.memo"),Di=Symbol.for("react.lazy"),aS=Symbol.for("react.offscreen"),I_=Symbol.iterator;function hl(t){return t===null||typeof t!="object"?null:(t=I_&&t[I_]||t["@@iterator"],typeof t=="function"?t:null)}var Ct=Object.assign,Ym;function Il(t){if(Ym===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ym=e&&e[1]||""}return`
`+Ym+t}var Jm=!1;function Zm(t,e){if(!t||Jm)return"";Jm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{Jm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Il(t):""}function cN(t){switch(t.tag){case 5:return Il(t.type);case 16:return Il("Lazy");case 13:return Il("Suspense");case 19:return Il("SuspenseList");case 0:case 2:case 15:return t=Zm(t.type,!1),t;case 11:return t=Zm(t.type.render,!1),t;case 1:return t=Zm(t.type,!0),t;default:return""}}function xg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Fs:return"Fragment";case Os:return"Portal";case gg:return"Profiler";case E0:return"StrictMode";case yg:return"Suspense";case wg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iS:return(t.displayName||"Context")+".Consumer";case oS:return(t._context.displayName||"Context")+".Provider";case C0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case S0:return e=t.displayName||null,e!==null?e:xg(t.type)||"Memo";case Di:e=t._payload,t=t._init;try{return xg(t(e))}catch{}}return null}function hN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xg(e);case 8:return e===E0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function na(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function sS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fN(t){var e=sS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ah(t){t._valueTracker||(t._valueTracker=fN(t))}function uS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=sS(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function jf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _g(t,e){var n=e.checked;return Ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function T_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=na(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lS(t,e){e=e.checked,e!=null&&b0(t,"checked",e,!1)}function bg(t,e){lS(t,e);var n=na(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Eg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Eg(t,e.type,na(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function R_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Eg(t,e,n){(e!=="number"||jf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Tl=Array.isArray;function qs(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+na(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function Cg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(re(91));return Ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function A_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(re(92));if(Tl(n)){if(1<n.length)throw Error(re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:na(n)}}function cS(t,e){var n=na(e.value),r=na(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function k_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function hS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?hS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kh,fS=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kh=kh||document.createElement("div"),kh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ml={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dN=["Webkit","ms","Moz","O"];Object.keys(Ml).forEach(function(t){dN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ml[e]=Ml[t]})});function dS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ml.hasOwnProperty(t)&&Ml[t]?(""+e).trim():e+"px"}function pS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=dS(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var pN=Ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ig(t,e){if(e){if(pN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(re(62))}}function Tg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rg=null;function I0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ag=null,Ks=null,Xs=null;function P_(t){if(t=$c(t)){if(typeof Ag!="function")throw Error(re(280));var e=t.stateNode;e&&(e=fp(e),Ag(t.stateNode,t.type,e))}}function mS(t){Ks?Xs?Xs.push(t):Xs=[t]:Ks=t}function vS(){if(Ks){var t=Ks,e=Xs;if(Xs=Ks=null,P_(t),e)for(t=0;t<e.length;t++)P_(e[t])}}function gS(t,e){return t(e)}function yS(){}var ev=!1;function wS(t,e,n){if(ev)return t(e,n);ev=!0;try{return gS(t,e,n)}finally{ev=!1,(Ks!==null||Xs!==null)&&(yS(),vS())}}function ec(t,e){var n=t.stateNode;if(n===null)return null;var r=fp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(re(231,e,typeof n));return n}var kg=!1;if(ei)try{var fl={};Object.defineProperty(fl,"passive",{get:function(){kg=!0}}),window.addEventListener("test",fl,fl),window.removeEventListener("test",fl,fl)}catch{kg=!1}function mN(t,e,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(c){this.onError(c)}}var Ol=!1,Hf=null,Gf=!1,Pg=null,vN={onError:function(t){Ol=!0,Hf=t}};function gN(t,e,n,r,o,i,a,s,u){Ol=!1,Hf=null,mN.apply(vN,arguments)}function yN(t,e,n,r,o,i,a,s,u){if(gN.apply(this,arguments),Ol){if(Ol){var l=Hf;Ol=!1,Hf=null}else throw Error(re(198));Gf||(Gf=!0,Pg=l)}}function rs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function D_(t){if(rs(t)!==t)throw Error(re(188))}function wN(t){var e=t.alternate;if(!e){if(e=rs(t),e===null)throw Error(re(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return D_(o),t;if(i===r)return D_(o),e;i=i.sibling}throw Error(re(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?t:e}function _S(t){return t=wN(t),t!==null?bS(t):null}function bS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bS(t);if(e!==null)return e;t=t.sibling}return null}var ES=_r.unstable_scheduleCallback,N_=_r.unstable_cancelCallback,xN=_r.unstable_shouldYield,_N=_r.unstable_requestPaint,Mt=_r.unstable_now,bN=_r.unstable_getCurrentPriorityLevel,T0=_r.unstable_ImmediatePriority,CS=_r.unstable_UserBlockingPriority,qf=_r.unstable_NormalPriority,EN=_r.unstable_LowPriority,SS=_r.unstable_IdlePriority,up=null,Co=null;function CN(t){if(Co&&typeof Co.onCommitFiberRoot=="function")try{Co.onCommitFiberRoot(up,t,void 0,(t.current.flags&128)===128)}catch{}}var Jr=Math.clz32?Math.clz32:TN,SN=Math.log,IN=Math.LN2;function TN(t){return t>>>=0,t===0?32:31-(SN(t)/IN|0)|0}var Ph=64,Dh=4194304;function Rl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Kf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Rl(s):(i&=a,i!==0&&(r=Rl(i)))}else a=n&~o,a!==0?r=Rl(a):i!==0&&(r=Rl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Jr(e),o=1<<n,r|=t[n],e&=~o;return r}function RN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Jr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=RN(s,e)):u<=e&&(t.expiredLanes|=s),i&=~s}}function Dg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function IS(){var t=Ph;return Ph<<=1,!(Ph&4194240)&&(Ph=64),t}function tv(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jr(e),t[e]=n}function kN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Jr(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function R0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Jr(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var Ze=0;function TS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var RS,A0,AS,kS,PS,Ng=!1,Nh=[],Ui=null,zi=null,Wi=null,tc=new Map,nc=new Map,Mi=[],PN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M_(t,e){switch(t){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":tc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":nc.delete(e.pointerId)}}function dl(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=$c(e),e!==null&&A0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function DN(t,e,n,r,o){switch(e){case"focusin":return Ui=dl(Ui,t,e,n,r,o),!0;case"dragenter":return zi=dl(zi,t,e,n,r,o),!0;case"mouseover":return Wi=dl(Wi,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return tc.set(i,dl(tc.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,nc.set(i,dl(nc.get(i)||null,t,e,n,r,o)),!0}return!1}function DS(t){var e=Fa(t.target);if(e!==null){var n=rs(e);if(n!==null){if(e=n.tag,e===13){if(e=xS(n),e!==null){t.blockedOn=e,PS(t.priority,function(){AS(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Mg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Rg=r,n.target.dispatchEvent(r),Rg=null}else return e=$c(n),e!==null&&A0(e),t.blockedOn=n,!1;e.shift()}return!0}function O_(t,e,n){wf(t)&&n.delete(e)}function NN(){Ng=!1,Ui!==null&&wf(Ui)&&(Ui=null),zi!==null&&wf(zi)&&(zi=null),Wi!==null&&wf(Wi)&&(Wi=null),tc.forEach(O_),nc.forEach(O_)}function pl(t,e){t.blockedOn===e&&(t.blockedOn=null,Ng||(Ng=!0,_r.unstable_scheduleCallback(_r.unstable_NormalPriority,NN)))}function rc(t){function e(o){return pl(o,t)}if(0<Nh.length){pl(Nh[0],t);for(var n=1;n<Nh.length;n++){var r=Nh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ui!==null&&pl(Ui,t),zi!==null&&pl(zi,t),Wi!==null&&pl(Wi,t),tc.forEach(e),nc.forEach(e),n=0;n<Mi.length;n++)r=Mi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Mi.length&&(n=Mi[0],n.blockedOn===null);)DS(n),n.blockedOn===null&&Mi.shift()}var Qs=hi.ReactCurrentBatchConfig,Xf=!0;function MN(t,e,n,r){var o=Ze,i=Qs.transition;Qs.transition=null;try{Ze=1,k0(t,e,n,r)}finally{Ze=o,Qs.transition=i}}function ON(t,e,n,r){var o=Ze,i=Qs.transition;Qs.transition=null;try{Ze=4,k0(t,e,n,r)}finally{Ze=o,Qs.transition=i}}function k0(t,e,n,r){if(Xf){var o=Mg(t,e,n,r);if(o===null)hv(t,e,r,Qf,n),M_(t,r);else if(DN(o,t,e,n,r))r.stopPropagation();else if(M_(t,r),e&4&&-1<PN.indexOf(t)){for(;o!==null;){var i=$c(o);if(i!==null&&RS(i),i=Mg(t,e,n,r),i===null&&hv(t,e,r,Qf,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else hv(t,e,r,null,n)}}var Qf=null;function Mg(t,e,n,r){if(Qf=null,t=I0(r),t=Fa(t),t!==null)if(e=rs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qf=t,null}function NS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bN()){case T0:return 1;case CS:return 4;case qf:case EN:return 16;case SS:return 536870912;default:return 16}default:return 16}}var Fi=null,P0=null,xf=null;function MS(){if(xf)return xf;var t,e=P0,n=e.length,r,o="value"in Fi?Fi.value:Fi.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===o[i-r];r++);return xf=o.slice(t,1<r?1-r:void 0)}function _f(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Mh(){return!0}function F_(){return!1}function Er(t){function e(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Mh:F_,this.isPropagationStopped=F_,this}return Ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Mh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Mh)},persist:function(){},isPersistent:Mh}),e}var Pu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},D0=Er(Pu),Bc=Ct({},Pu,{view:0,detail:0}),FN=Er(Bc),nv,rv,ml,lp=Ct({},Bc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:N0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ml&&(ml&&t.type==="mousemove"?(nv=t.screenX-ml.screenX,rv=t.screenY-ml.screenY):rv=nv=0,ml=t),nv)},movementY:function(t){return"movementY"in t?t.movementY:rv}}),L_=Er(lp),LN=Ct({},lp,{dataTransfer:0}),VN=Er(LN),BN=Ct({},Bc,{relatedTarget:0}),ov=Er(BN),$N=Ct({},Pu,{animationName:0,elapsedTime:0,pseudoElement:0}),UN=Er($N),zN=Ct({},Pu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WN=Er(zN),jN=Ct({},Pu,{data:0}),V_=Er(jN),HN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qN[t])?!!e[t]:!1}function N0(){return KN}var XN=Ct({},Bc,{key:function(t){if(t.key){var e=HN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_f(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:N0,charCode:function(t){return t.type==="keypress"?_f(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_f(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),QN=Er(XN),YN=Ct({},lp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),B_=Er(YN),JN=Ct({},Bc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:N0}),ZN=Er(JN),e4=Ct({},Pu,{propertyName:0,elapsedTime:0,pseudoElement:0}),t4=Er(e4),n4=Ct({},lp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),r4=Er(n4),o4=[9,13,27,32],M0=ei&&"CompositionEvent"in window,Fl=null;ei&&"documentMode"in document&&(Fl=document.documentMode);var i4=ei&&"TextEvent"in window&&!Fl,OS=ei&&(!M0||Fl&&8<Fl&&11>=Fl),$_=" ",U_=!1;function FS(t,e){switch(t){case"keyup":return o4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ls=!1;function a4(t,e){switch(t){case"compositionend":return LS(e);case"keypress":return e.which!==32?null:(U_=!0,$_);case"textInput":return t=e.data,t===$_&&U_?null:t;default:return null}}function s4(t,e){if(Ls)return t==="compositionend"||!M0&&FS(t,e)?(t=MS(),xf=P0=Fi=null,Ls=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return OS&&e.locale!=="ko"?null:e.data;default:return null}}var u4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!u4[t.type]:e==="textarea"}function VS(t,e,n,r){mS(r),e=Yf(e,"onChange"),0<e.length&&(n=new D0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ll=null,oc=null;function l4(t){XS(t,0)}function cp(t){var e=$s(t);if(uS(e))return t}function c4(t,e){if(t==="change")return e}var BS=!1;if(ei){var iv;if(ei){var av="oninput"in document;if(!av){var W_=document.createElement("div");W_.setAttribute("oninput","return;"),av=typeof W_.oninput=="function"}iv=av}else iv=!1;BS=iv&&(!document.documentMode||9<document.documentMode)}function j_(){Ll&&(Ll.detachEvent("onpropertychange",$S),oc=Ll=null)}function $S(t){if(t.propertyName==="value"&&cp(oc)){var e=[];VS(e,oc,t,I0(t)),wS(l4,e)}}function h4(t,e,n){t==="focusin"?(j_(),Ll=e,oc=n,Ll.attachEvent("onpropertychange",$S)):t==="focusout"&&j_()}function f4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return cp(oc)}function d4(t,e){if(t==="click")return cp(e)}function p4(t,e){if(t==="input"||t==="change")return cp(e)}function m4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ro=typeof Object.is=="function"?Object.is:m4;function ic(t,e){if(ro(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!vg.call(e,o)||!ro(t[o],e[o]))return!1}return!0}function H_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function G_(t,e){var n=H_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=H_(n)}}function US(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?US(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function zS(){for(var t=window,e=jf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jf(t.document)}return e}function O0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function v4(t){var e=zS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&US(n.ownerDocument.documentElement,n)){if(r!==null&&O0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=G_(n,i);var a=G_(n,r);o&&a&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var g4=ei&&"documentMode"in document&&11>=document.documentMode,Vs=null,Og=null,Vl=null,Fg=!1;function q_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Fg||Vs==null||Vs!==jf(r)||(r=Vs,"selectionStart"in r&&O0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vl&&ic(Vl,r)||(Vl=r,r=Yf(Og,"onSelect"),0<r.length&&(e=new D0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vs)))}function Oh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bs={animationend:Oh("Animation","AnimationEnd"),animationiteration:Oh("Animation","AnimationIteration"),animationstart:Oh("Animation","AnimationStart"),transitionend:Oh("Transition","TransitionEnd")},sv={},WS={};ei&&(WS=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function hp(t){if(sv[t])return sv[t];if(!Bs[t])return t;var e=Bs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in WS)return sv[t]=e[n];return t}var jS=hp("animationend"),HS=hp("animationiteration"),GS=hp("animationstart"),qS=hp("transitionend"),KS=new Map,K_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fa(t,e){KS.set(t,e),ns(e,[t])}for(var uv=0;uv<K_.length;uv++){var lv=K_[uv],y4=lv.toLowerCase(),w4=lv[0].toUpperCase()+lv.slice(1);fa(y4,"on"+w4)}fa(jS,"onAnimationEnd");fa(HS,"onAnimationIteration");fa(GS,"onAnimationStart");fa("dblclick","onDoubleClick");fa("focusin","onFocus");fa("focusout","onBlur");fa(qS,"onTransitionEnd");fu("onMouseEnter",["mouseout","mouseover"]);fu("onMouseLeave",["mouseout","mouseover"]);fu("onPointerEnter",["pointerout","pointerover"]);fu("onPointerLeave",["pointerout","pointerover"]);ns("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ns("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ns("onBeforeInput",["compositionend","keypress","textInput","paste"]);ns("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ns("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ns("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Al));function X_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,yN(r,e,void 0,t),t.currentTarget=null}function XS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;X_(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;X_(o,s,l),i=u}}}if(Gf)throw t=Pg,Gf=!1,Pg=null,t}function ft(t,e){var n=e[Ug];n===void 0&&(n=e[Ug]=new Set);var r=t+"__bubble";n.has(r)||(QS(e,t,2,!1),n.add(r))}function cv(t,e,n){var r=0;e&&(r|=4),QS(n,t,r,e)}var Fh="_reactListening"+Math.random().toString(36).slice(2);function ac(t){if(!t[Fh]){t[Fh]=!0,rS.forEach(function(n){n!=="selectionchange"&&(x4.has(n)||cv(n,!1,t),cv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fh]||(e[Fh]=!0,cv("selectionchange",!1,e))}}function QS(t,e,n,r){switch(NS(e)){case 1:var o=MN;break;case 4:o=ON;break;default:o=k0}n=o.bind(null,e,n,t),o=void 0,!kg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function hv(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Fa(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}wS(function(){var l=i,c=I0(n),h=[];e:{var f=KS.get(t);if(f!==void 0){var d=D0,m=t;switch(t){case"keypress":if(_f(n)===0)break e;case"keydown":case"keyup":d=QN;break;case"focusin":m="focus",d=ov;break;case"focusout":m="blur",d=ov;break;case"beforeblur":case"afterblur":d=ov;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=L_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=VN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=ZN;break;case jS:case HS:case GS:d=UN;break;case qS:d=t4;break;case"scroll":d=FN;break;case"wheel":d=r4;break;case"copy":case"cut":case"paste":d=WN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=B_}var g=(e&4)!==0,y=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var w=l,x;w!==null;){x=w;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,v!==null&&(_=ec(w,v),_!=null&&g.push(sc(w,_,x)))),y)break;w=w.return}0<g.length&&(f=new d(f,m,null,n,c),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&n!==Rg&&(m=n.relatedTarget||n.fromElement)&&(Fa(m)||m[ti]))break e;if((d||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,d?(m=n.relatedTarget||n.toElement,d=l,m=m?Fa(m):null,m!==null&&(y=rs(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=l),d!==m)){if(g=L_,_="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=B_,_="onPointerLeave",v="onPointerEnter",w="pointer"),y=d==null?f:$s(d),x=m==null?f:$s(m),f=new g(_,w+"leave",d,n,c),f.target=y,f.relatedTarget=x,_=null,Fa(c)===l&&(g=new g(v,w+"enter",m,n,c),g.target=x,g.relatedTarget=y,_=g),y=_,d&&m)t:{for(g=d,v=m,w=0,x=g;x;x=vs(x))w++;for(x=0,_=v;_;_=vs(_))x++;for(;0<w-x;)g=vs(g),w--;for(;0<x-w;)v=vs(v),x--;for(;w--;){if(g===v||v!==null&&g===v.alternate)break t;g=vs(g),v=vs(v)}g=null}else g=null;d!==null&&Q_(h,f,d,g,!1),m!==null&&y!==null&&Q_(h,y,m,g,!0)}}e:{if(f=l?$s(l):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var S=c4;else if(z_(f))if(BS)S=p4;else{S=f4;var R=h4}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=d4);if(S&&(S=S(t,l))){VS(h,S,n,c);break e}R&&R(t,f,l),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&Eg(f,"number",f.value)}switch(R=l?$s(l):window,t){case"focusin":(z_(R)||R.contentEditable==="true")&&(Vs=R,Og=l,Vl=null);break;case"focusout":Vl=Og=Vs=null;break;case"mousedown":Fg=!0;break;case"contextmenu":case"mouseup":case"dragend":Fg=!1,q_(h,n,c);break;case"selectionchange":if(g4)break;case"keydown":case"keyup":q_(h,n,c)}var C;if(M0)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ls?FS(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(OS&&n.locale!=="ko"&&(Ls||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ls&&(C=MS()):(Fi=c,P0="value"in Fi?Fi.value:Fi.textContent,Ls=!0)),R=Yf(l,E),0<R.length&&(E=new V_(E,t,null,n,c),h.push({event:E,listeners:R}),C?E.data=C:(C=LS(n),C!==null&&(E.data=C)))),(C=i4?a4(t,n):s4(t,n))&&(l=Yf(l,"onBeforeInput"),0<l.length&&(c=new V_("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:l}),c.data=C))}XS(h,e)})}function sc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Yf(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=ec(t,n),i!=null&&r.unshift(sc(t,i,o)),i=ec(t,e),i!=null&&r.push(sc(t,i,o))),t=t.return}return r}function vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Q_(t,e,n,r,o){for(var i=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=ec(n,i),u!=null&&a.unshift(sc(n,u,s))):o||(u=ec(n,i),u!=null&&a.push(sc(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var _4=/\r\n?/g,b4=/\u0000|\uFFFD/g;function Y_(t){return(typeof t=="string"?t:""+t).replace(_4,`
`).replace(b4,"")}function Lh(t,e,n){if(e=Y_(e),Y_(t)!==e&&n)throw Error(re(425))}function Jf(){}var Lg=null,Vg=null;function Bg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $g=typeof setTimeout=="function"?setTimeout:void 0,E4=typeof clearTimeout=="function"?clearTimeout:void 0,J_=typeof Promise=="function"?Promise:void 0,C4=typeof queueMicrotask=="function"?queueMicrotask:typeof J_<"u"?function(t){return J_.resolve(null).then(t).catch(S4)}:$g;function S4(t){setTimeout(function(){throw t})}function fv(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),rc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);rc(e)}function ji(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Z_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Du=Math.random().toString(36).slice(2),xo="__reactFiber$"+Du,uc="__reactProps$"+Du,ti="__reactContainer$"+Du,Ug="__reactEvents$"+Du,I4="__reactListeners$"+Du,T4="__reactHandles$"+Du;function Fa(t){var e=t[xo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ti]||n[xo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Z_(t);t!==null;){if(n=t[xo])return n;t=Z_(t)}return e}t=n,n=t.parentNode}return null}function $c(t){return t=t[xo]||t[ti],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $s(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(re(33))}function fp(t){return t[uc]||null}var zg=[],Us=-1;function da(t){return{current:t}}function mt(t){0>Us||(t.current=zg[Us],zg[Us]=null,Us--)}function st(t,e){Us++,zg[Us]=t.current,t.current=e}var ra={},Fn=da(ra),Zn=da(!1),qa=ra;function du(t,e){var n=t.type.contextTypes;if(!n)return ra;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function er(t){return t=t.childContextTypes,t!=null}function Zf(){mt(Zn),mt(Fn)}function eb(t,e,n){if(Fn.current!==ra)throw Error(re(168));st(Fn,e),st(Zn,n)}function YS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(re(108,hN(t)||"Unknown",o));return Ct({},n,r)}function ed(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ra,qa=Fn.current,st(Fn,t),st(Zn,Zn.current),!0}function tb(t,e,n){var r=t.stateNode;if(!r)throw Error(re(169));n?(t=YS(t,e,qa),r.__reactInternalMemoizedMergedChildContext=t,mt(Zn),mt(Fn),st(Fn,t)):mt(Zn),st(Zn,n)}var Go=null,dp=!1,dv=!1;function JS(t){Go===null?Go=[t]:Go.push(t)}function R4(t){dp=!0,JS(t)}function pa(){if(!dv&&Go!==null){dv=!0;var t=0,e=Ze;try{var n=Go;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Go=null,dp=!1}catch(o){throw Go!==null&&(Go=Go.slice(t+1)),ES(T0,pa),o}finally{Ze=e,dv=!1}}return null}var zs=[],Ws=0,td=null,nd=0,Ar=[],kr=0,Ka=null,Xo=1,Qo="";function ka(t,e){zs[Ws++]=nd,zs[Ws++]=td,td=t,nd=e}function ZS(t,e,n){Ar[kr++]=Xo,Ar[kr++]=Qo,Ar[kr++]=Ka,Ka=t;var r=Xo;t=Qo;var o=32-Jr(r)-1;r&=~(1<<o),n+=1;var i=32-Jr(e)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Xo=1<<32-Jr(e)+o|n<<o|r,Qo=i+t}else Xo=1<<i|n<<o|r,Qo=t}function F0(t){t.return!==null&&(ka(t,1),ZS(t,1,0))}function L0(t){for(;t===td;)td=zs[--Ws],zs[Ws]=null,nd=zs[--Ws],zs[Ws]=null;for(;t===Ka;)Ka=Ar[--kr],Ar[kr]=null,Qo=Ar[--kr],Ar[kr]=null,Xo=Ar[--kr],Ar[kr]=null}var yr=null,dr=null,yt=!1,Xr=null;function eI(t,e){var n=Or(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function nb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yr=t,dr=ji(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yr=t,dr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ka!==null?{id:Xo,overflow:Qo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Or(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,yr=t,dr=null,!0):!1;default:return!1}}function Wg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function jg(t){if(yt){var e=dr;if(e){var n=e;if(!nb(t,e)){if(Wg(t))throw Error(re(418));e=ji(n.nextSibling);var r=yr;e&&nb(t,e)?eI(r,n):(t.flags=t.flags&-4097|2,yt=!1,yr=t)}}else{if(Wg(t))throw Error(re(418));t.flags=t.flags&-4097|2,yt=!1,yr=t}}}function rb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yr=t}function Vh(t){if(t!==yr)return!1;if(!yt)return rb(t),yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Bg(t.type,t.memoizedProps)),e&&(e=dr)){if(Wg(t))throw tI(),Error(re(418));for(;e;)eI(t,e),e=ji(e.nextSibling)}if(rb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){dr=ji(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}dr=null}}else dr=yr?ji(t.stateNode.nextSibling):null;return!0}function tI(){for(var t=dr;t;)t=ji(t.nextSibling)}function pu(){dr=yr=null,yt=!1}function V0(t){Xr===null?Xr=[t]:Xr.push(t)}var A4=hi.ReactCurrentBatchConfig;function vl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,t))}return t}function Bh(t,e){throw t=Object.prototype.toString.call(e),Error(re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ob(t){var e=t._init;return e(t._payload)}function nI(t){function e(v,w){if(t){var x=v.deletions;x===null?(v.deletions=[w],v.flags|=16):x.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function o(v,w){return v=Ki(v,w),v.index=0,v.sibling=null,v}function i(v,w,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<w?(v.flags|=2,w):x):(v.flags|=2,w)):(v.flags|=1048576,w)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function s(v,w,x,_){return w===null||w.tag!==6?(w=xv(x,v.mode,_),w.return=v,w):(w=o(w,x),w.return=v,w)}function u(v,w,x,_){var S=x.type;return S===Fs?c(v,w,x.props.children,_,x.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Di&&ob(S)===w.type)?(_=o(w,x.props),_.ref=vl(v,w,x),_.return=v,_):(_=Rf(x.type,x.key,x.props,null,v.mode,_),_.ref=vl(v,w,x),_.return=v,_)}function l(v,w,x,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=_v(x,v.mode,_),w.return=v,w):(w=o(w,x.children||[]),w.return=v,w)}function c(v,w,x,_,S){return w===null||w.tag!==7?(w=ja(x,v.mode,_,S),w.return=v,w):(w=o(w,x),w.return=v,w)}function h(v,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=xv(""+w,v.mode,x),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Rh:return x=Rf(w.type,w.key,w.props,null,v.mode,x),x.ref=vl(v,null,w),x.return=v,x;case Os:return w=_v(w,v.mode,x),w.return=v,w;case Di:var _=w._init;return h(v,_(w._payload),x)}if(Tl(w)||hl(w))return w=ja(w,v.mode,x,null),w.return=v,w;Bh(v,w)}return null}function f(v,w,x,_){var S=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return S!==null?null:s(v,w,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Rh:return x.key===S?u(v,w,x,_):null;case Os:return x.key===S?l(v,w,x,_):null;case Di:return S=x._init,f(v,w,S(x._payload),_)}if(Tl(x)||hl(x))return S!==null?null:c(v,w,x,_,null);Bh(v,x)}return null}function d(v,w,x,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(x)||null,s(w,v,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Rh:return v=v.get(_.key===null?x:_.key)||null,u(w,v,_,S);case Os:return v=v.get(_.key===null?x:_.key)||null,l(w,v,_,S);case Di:var R=_._init;return d(v,w,x,R(_._payload),S)}if(Tl(_)||hl(_))return v=v.get(x)||null,c(w,v,_,S,null);Bh(w,_)}return null}function m(v,w,x,_){for(var S=null,R=null,C=w,E=w=0,I=null;C!==null&&E<x.length;E++){C.index>E?(I=C,C=null):I=C.sibling;var T=f(v,C,x[E],_);if(T===null){C===null&&(C=I);break}t&&C&&T.alternate===null&&e(v,C),w=i(T,w,E),R===null?S=T:R.sibling=T,R=T,C=I}if(E===x.length)return n(v,C),yt&&ka(v,E),S;if(C===null){for(;E<x.length;E++)C=h(v,x[E],_),C!==null&&(w=i(C,w,E),R===null?S=C:R.sibling=C,R=C);return yt&&ka(v,E),S}for(C=r(v,C);E<x.length;E++)I=d(C,v,E,x[E],_),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?E:I.key),w=i(I,w,E),R===null?S=I:R.sibling=I,R=I);return t&&C.forEach(function(k){return e(v,k)}),yt&&ka(v,E),S}function g(v,w,x,_){var S=hl(x);if(typeof S!="function")throw Error(re(150));if(x=S.call(x),x==null)throw Error(re(151));for(var R=S=null,C=w,E=w=0,I=null,T=x.next();C!==null&&!T.done;E++,T=x.next()){C.index>E?(I=C,C=null):I=C.sibling;var k=f(v,C,T.value,_);if(k===null){C===null&&(C=I);break}t&&C&&k.alternate===null&&e(v,C),w=i(k,w,E),R===null?S=k:R.sibling=k,R=k,C=I}if(T.done)return n(v,C),yt&&ka(v,E),S;if(C===null){for(;!T.done;E++,T=x.next())T=h(v,T.value,_),T!==null&&(w=i(T,w,E),R===null?S=T:R.sibling=T,R=T);return yt&&ka(v,E),S}for(C=r(v,C);!T.done;E++,T=x.next())T=d(C,v,E,T.value,_),T!==null&&(t&&T.alternate!==null&&C.delete(T.key===null?E:T.key),w=i(T,w,E),R===null?S=T:R.sibling=T,R=T);return t&&C.forEach(function(P){return e(v,P)}),yt&&ka(v,E),S}function y(v,w,x,_){if(typeof x=="object"&&x!==null&&x.type===Fs&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Rh:e:{for(var S=x.key,R=w;R!==null;){if(R.key===S){if(S=x.type,S===Fs){if(R.tag===7){n(v,R.sibling),w=o(R,x.props.children),w.return=v,v=w;break e}}else if(R.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Di&&ob(S)===R.type){n(v,R.sibling),w=o(R,x.props),w.ref=vl(v,R,x),w.return=v,v=w;break e}n(v,R);break}else e(v,R);R=R.sibling}x.type===Fs?(w=ja(x.props.children,v.mode,_,x.key),w.return=v,v=w):(_=Rf(x.type,x.key,x.props,null,v.mode,_),_.ref=vl(v,w,x),_.return=v,v=_)}return a(v);case Os:e:{for(R=x.key;w!==null;){if(w.key===R)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){n(v,w.sibling),w=o(w,x.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=_v(x,v.mode,_),w.return=v,v=w}return a(v);case Di:return R=x._init,y(v,w,R(x._payload),_)}if(Tl(x))return m(v,w,x,_);if(hl(x))return g(v,w,x,_);Bh(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(n(v,w.sibling),w=o(w,x),w.return=v,v=w):(n(v,w),w=xv(x,v.mode,_),w.return=v,v=w),a(v)):n(v,w)}return y}var mu=nI(!0),rI=nI(!1),rd=da(null),od=null,js=null,B0=null;function $0(){B0=js=od=null}function U0(t){var e=rd.current;mt(rd),t._currentValue=e}function Hg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ys(t,e){od=t,B0=js=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jn=!0),t.firstContext=null)}function Vr(t){var e=t._currentValue;if(B0!==t)if(t={context:t,memoizedValue:e,next:null},js===null){if(od===null)throw Error(re(308));js=t,od.dependencies={lanes:0,firstContext:t}}else js=js.next=t;return e}var La=null;function z0(t){La===null?La=[t]:La.push(t)}function oI(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,z0(e)):(n.next=o.next,o.next=n),e.interleaved=n,ni(t,r)}function ni(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ni=!1;function W0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,He&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,ni(t,n)}return o=r.interleaved,o===null?(e.next=e,z0(r)):(e.next=o.next,o.next=e),r.interleaved=e,ni(t,n)}function bf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R0(t,n)}}function ib(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function id(t,e,n,r){var o=t.updateQueue;Ni=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var h=o.baseState;a=0,c=l=u=null,s=i;do{var f=s.lane,d=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=t,g=s;switch(f=e,d=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(d,h,f);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,f=typeof m=="function"?m.call(d,h,f):m,f==null)break e;h=Ct({},h,f);break e;case 2:Ni=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else d={eventTime:d,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=d,u=h):c=c.next=d,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(u=h),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,e=o.shared.interleaved,e!==null){o=e;do a|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);Qa|=a,t.lanes=a,t.memoizedState=h}}function ab(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(re(191,o));o.call(r)}}}var Uc={},So=da(Uc),lc=da(Uc),cc=da(Uc);function Va(t){if(t===Uc)throw Error(re(174));return t}function j0(t,e){switch(st(cc,e),st(lc,t),st(So,Uc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Sg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Sg(e,t)}mt(So),st(So,e)}function vu(){mt(So),mt(lc),mt(cc)}function aI(t){Va(cc.current);var e=Va(So.current),n=Sg(e,t.type);e!==n&&(st(lc,t),st(So,n))}function H0(t){lc.current===t&&(mt(So),mt(lc))}var xt=da(0);function ad(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var pv=[];function G0(){for(var t=0;t<pv.length;t++)pv[t]._workInProgressVersionPrimary=null;pv.length=0}var Ef=hi.ReactCurrentDispatcher,mv=hi.ReactCurrentBatchConfig,Xa=0,Et=null,Kt=null,sn=null,sd=!1,Bl=!1,hc=0,k4=0;function Cn(){throw Error(re(321))}function q0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ro(t[n],e[n]))return!1;return!0}function K0(t,e,n,r,o,i){if(Xa=i,Et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ef.current=t===null||t.memoizedState===null?M4:O4,t=n(r,o),Bl){i=0;do{if(Bl=!1,hc=0,25<=i)throw Error(re(301));i+=1,sn=Kt=null,e.updateQueue=null,Ef.current=F4,t=n(r,o)}while(Bl)}if(Ef.current=ud,e=Kt!==null&&Kt.next!==null,Xa=0,sn=Kt=Et=null,sd=!1,e)throw Error(re(300));return t}function X0(){var t=hc!==0;return hc=0,t}function po(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Et.memoizedState=sn=t:sn=sn.next=t,sn}function Br(){if(Kt===null){var t=Et.alternate;t=t!==null?t.memoizedState:null}else t=Kt.next;var e=sn===null?Et.memoizedState:sn.next;if(e!==null)sn=e,Kt=t;else{if(t===null)throw Error(re(310));Kt=t,t={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},sn===null?Et.memoizedState=sn=t:sn=sn.next=t}return sn}function fc(t,e){return typeof e=="function"?e(t):e}function vv(t){var e=Br(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=Kt,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((Xa&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var h={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=h,a=r):u=u.next=h,Et.lanes|=c,Qa|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,ro(r,e.memoizedState)||(Jn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,Et.lanes|=i,Qa|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gv(t){var e=Br(),n=e.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=t(i,a.action),a=a.next;while(a!==o);ro(i,e.memoizedState)||(Jn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function sI(){}function uI(t,e){var n=Et,r=Br(),o=e(),i=!ro(r.memoizedState,o);if(i&&(r.memoizedState=o,Jn=!0),r=r.queue,Q0(hI.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||sn!==null&&sn.memoizedState.tag&1){if(n.flags|=2048,dc(9,cI.bind(null,n,r,o,e),void 0,null),un===null)throw Error(re(349));Xa&30||lI(n,e,o)}return o}function lI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function cI(t,e,n,r){e.value=n,e.getSnapshot=r,fI(e)&&dI(t)}function hI(t,e,n){return n(function(){fI(e)&&dI(t)})}function fI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ro(t,n)}catch{return!0}}function dI(t){var e=ni(t,1);e!==null&&Zr(e,t,1,-1)}function sb(t){var e=po();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fc,lastRenderedState:t},e.queue=t,t=t.dispatch=N4.bind(null,Et,t),[e.memoizedState,t]}function dc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function pI(){return Br().memoizedState}function Cf(t,e,n,r){var o=po();Et.flags|=t,o.memoizedState=dc(1|e,n,void 0,r===void 0?null:r)}function pp(t,e,n,r){var o=Br();r=r===void 0?null:r;var i=void 0;if(Kt!==null){var a=Kt.memoizedState;if(i=a.destroy,r!==null&&q0(r,a.deps)){o.memoizedState=dc(e,n,i,r);return}}Et.flags|=t,o.memoizedState=dc(1|e,n,i,r)}function ub(t,e){return Cf(8390656,8,t,e)}function Q0(t,e){return pp(2048,8,t,e)}function mI(t,e){return pp(4,2,t,e)}function vI(t,e){return pp(4,4,t,e)}function gI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yI(t,e,n){return n=n!=null?n.concat([t]):null,pp(4,4,gI.bind(null,e,t),n)}function Y0(){}function wI(t,e){var n=Br();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&q0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function xI(t,e){var n=Br();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&q0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function _I(t,e,n){return Xa&21?(ro(n,e)||(n=IS(),Et.lanes|=n,Qa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jn=!0),t.memoizedState=n)}function P4(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=mv.transition;mv.transition={};try{t(!1),e()}finally{Ze=n,mv.transition=r}}function bI(){return Br().memoizedState}function D4(t,e,n){var r=qi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},EI(t))CI(e,n);else if(n=oI(t,e,n,r),n!==null){var o=zn();Zr(n,t,r,o),SI(n,e,r)}}function N4(t,e,n){var r=qi(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(EI(t))CI(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,ro(s,a)){var u=e.interleaved;u===null?(o.next=o,z0(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=oI(t,e,o,r),n!==null&&(o=zn(),Zr(n,t,r,o),SI(n,e,r))}}function EI(t){var e=t.alternate;return t===Et||e!==null&&e===Et}function CI(t,e){Bl=sd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function SI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,R0(t,n)}}var ud={readContext:Vr,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useInsertionEffect:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useMutableSource:Cn,useSyncExternalStore:Cn,useId:Cn,unstable_isNewReconciler:!1},M4={readContext:Vr,useCallback:function(t,e){return po().memoizedState=[t,e===void 0?null:e],t},useContext:Vr,useEffect:ub,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Cf(4194308,4,gI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Cf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Cf(4,2,t,e)},useMemo:function(t,e){var n=po();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=po();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=D4.bind(null,Et,t),[r.memoizedState,t]},useRef:function(t){var e=po();return t={current:t},e.memoizedState=t},useState:sb,useDebugValue:Y0,useDeferredValue:function(t){return po().memoizedState=t},useTransition:function(){var t=sb(!1),e=t[0];return t=P4.bind(null,t[1]),po().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Et,o=po();if(yt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=e(),un===null)throw Error(re(349));Xa&30||lI(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,ub(hI.bind(null,r,i,t),[t]),r.flags|=2048,dc(9,cI.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=po(),e=un.identifierPrefix;if(yt){var n=Qo,r=Xo;n=(r&~(1<<32-Jr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=hc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=k4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},O4={readContext:Vr,useCallback:wI,useContext:Vr,useEffect:Q0,useImperativeHandle:yI,useInsertionEffect:mI,useLayoutEffect:vI,useMemo:xI,useReducer:vv,useRef:pI,useState:function(){return vv(fc)},useDebugValue:Y0,useDeferredValue:function(t){var e=Br();return _I(e,Kt.memoizedState,t)},useTransition:function(){var t=vv(fc)[0],e=Br().memoizedState;return[t,e]},useMutableSource:sI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1},F4={readContext:Vr,useCallback:wI,useContext:Vr,useEffect:Q0,useImperativeHandle:yI,useInsertionEffect:mI,useLayoutEffect:vI,useMemo:xI,useReducer:gv,useRef:pI,useState:function(){return gv(fc)},useDebugValue:Y0,useDeferredValue:function(t){var e=Br();return Kt===null?e.memoizedState=t:_I(e,Kt.memoizedState,t)},useTransition:function(){var t=gv(fc)[0],e=Br().memoizedState;return[t,e]},useMutableSource:sI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1};function qr(t,e){if(t&&t.defaultProps){e=Ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var mp={isMounted:function(t){return(t=t._reactInternals)?rs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=zn(),o=qi(t),i=Yo(r,o);i.payload=e,n!=null&&(i.callback=n),e=Hi(t,i,o),e!==null&&(Zr(e,t,o,r),bf(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=zn(),o=qi(t),i=Yo(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Hi(t,i,o),e!==null&&(Zr(e,t,o,r),bf(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=zn(),r=qi(t),o=Yo(n,r);o.tag=2,e!=null&&(o.callback=e),e=Hi(t,o,r),e!==null&&(Zr(e,t,r,n),bf(e,t,r))}};function lb(t,e,n,r,o,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!ic(n,r)||!ic(o,i):!0}function II(t,e,n){var r=!1,o=ra,i=e.contextType;return typeof i=="object"&&i!==null?i=Vr(i):(o=er(e)?qa:Fn.current,r=e.contextTypes,i=(r=r!=null)?du(t,o):ra),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=mp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function cb(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&mp.enqueueReplaceState(e,e.state,null)}function qg(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},W0(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Vr(i):(i=er(e)?qa:Fn.current,o.context=du(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Gg(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&mp.enqueueReplaceState(o,o.state,null),id(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function gu(t,e){try{var n="",r=e;do n+=cN(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function yv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var L4=typeof WeakMap=="function"?WeakMap:Map;function TI(t,e,n){n=Yo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){cd||(cd=!0,oy=r),Kg(t,e)},n}function RI(t,e,n){n=Yo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){Kg(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Kg(t,e),typeof r!="function"&&(Gi===null?Gi=new Set([this]):Gi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function hb(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new L4;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=Y4.bind(null,t,e,n),e.then(t,t))}function fb(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function db(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yo(-1,1),e.tag=2,Hi(n,e,1))),n.lanes|=1),t)}var V4=hi.ReactCurrentOwner,Jn=!1;function $n(t,e,n,r){e.child=t===null?rI(e,null,n,r):mu(e,t.child,n,r)}function pb(t,e,n,r,o){n=n.render;var i=e.ref;return Ys(e,o),r=K0(t,e,n,r,i,o),n=X0(),t!==null&&!Jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,ri(t,e,o)):(yt&&n&&F0(e),e.flags|=1,$n(t,e,r,o),e.child)}function mb(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!i1(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,AI(t,e,i,r,o)):(t=Rf(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ic,n(a,r)&&t.ref===e.ref)return ri(t,e,o)}return e.flags|=1,t=Ki(i,r),t.ref=e.ref,t.return=e,e.child=t}function AI(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(ic(i,r)&&t.ref===e.ref)if(Jn=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(Jn=!0);else return e.lanes=t.lanes,ri(t,e,o)}return Xg(t,e,n,r,o)}function kI(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Gs,lr),lr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Gs,lr),lr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,st(Gs,lr),lr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,st(Gs,lr),lr|=r;return $n(t,e,o,n),e.child}function PI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Xg(t,e,n,r,o){var i=er(n)?qa:Fn.current;return i=du(e,i),Ys(e,o),n=K0(t,e,n,r,i,o),r=X0(),t!==null&&!Jn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,ri(t,e,o)):(yt&&r&&F0(e),e.flags|=1,$n(t,e,n,o),e.child)}function vb(t,e,n,r,o){if(er(n)){var i=!0;ed(e)}else i=!1;if(Ys(e,o),e.stateNode===null)Sf(t,e),II(e,n,r),qg(e,n,r,o),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=Vr(l):(l=er(n)?qa:Fn.current,l=du(e,l));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&cb(e,a,r,l),Ni=!1;var f=e.memoizedState;a.state=f,id(e,r,a,o),u=e.memoizedState,s!==r||f!==u||Zn.current||Ni?(typeof c=="function"&&(Gg(e,n,c,r),u=e.memoizedState),(s=Ni||lb(e,n,s,r,f,u,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,iI(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:qr(e.type,s),a.props=l,h=e.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Vr(u):(u=er(n)?qa:Fn.current,u=du(e,u));var d=n.getDerivedStateFromProps;(c=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==h||f!==u)&&cb(e,a,r,u),Ni=!1,f=e.memoizedState,a.state=f,id(e,r,a,o);var m=e.memoizedState;s!==h||f!==m||Zn.current||Ni?(typeof d=="function"&&(Gg(e,n,d,r),m=e.memoizedState),(l=Ni||lb(e,n,l,r,f,m,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Qg(t,e,n,r,i,o)}function Qg(t,e,n,r,o,i){PI(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return o&&tb(e,n,!1),ri(t,e,i);r=e.stateNode,V4.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=mu(e,t.child,null,i),e.child=mu(e,null,s,i)):$n(t,e,s,i),e.memoizedState=r.state,o&&tb(e,n,!0),e.child}function DI(t){var e=t.stateNode;e.pendingContext?eb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&eb(t,e.context,!1),j0(t,e.containerInfo)}function gb(t,e,n,r,o){return pu(),V0(o),e.flags|=256,$n(t,e,n,r),e.child}var Yg={dehydrated:null,treeContext:null,retryLane:0};function Jg(t){return{baseLanes:t,cachePool:null,transitions:null}}function NI(t,e,n){var r=e.pendingProps,o=xt.current,i=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(o&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),st(xt,o&1),t===null)return jg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=yp(a,r,0,null),t=ja(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Jg(n),e.memoizedState=Yg,t):J0(e,a));if(o=t.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return B4(t,e,a,r,s,o,n);if(i){i=r.fallback,a=e.mode,o=t.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ki(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=Ki(s,i):(i=ja(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Jg(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Yg,r}return i=t.child,t=i.sibling,r=Ki(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function J0(t,e){return e=yp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $h(t,e,n,r){return r!==null&&V0(r),mu(e,t.child,null,n),t=J0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function B4(t,e,n,r,o,i,a){if(n)return e.flags&256?(e.flags&=-257,r=yv(Error(re(422))),$h(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=yp({mode:"visible",children:r.children},o,0,null),i=ja(i,o,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&mu(e,t.child,null,a),e.child.memoizedState=Jg(a),e.memoizedState=Yg,i);if(!(e.mode&1))return $h(t,e,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(re(419)),r=yv(i,r,void 0),$h(t,e,a,r)}if(s=(a&t.childLanes)!==0,Jn||s){if(r=un,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,ni(t,o),Zr(r,t,o,-1))}return o1(),r=yv(Error(re(421))),$h(t,e,a,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=J4.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,dr=ji(o.nextSibling),yr=e,yt=!0,Xr=null,t!==null&&(Ar[kr++]=Xo,Ar[kr++]=Qo,Ar[kr++]=Ka,Xo=t.id,Qo=t.overflow,Ka=e),e=J0(e,r.children),e.flags|=4096,e)}function yb(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hg(t.return,e,n)}function wv(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function MI(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if($n(t,e,r.children,n),r=xt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yb(t,n,e);else if(t.tag===19)yb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(xt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ad(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),wv(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ad(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}wv(e,!0,n,null,i);break;case"together":wv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ri(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(re(153));if(e.child!==null){for(t=e.child,n=Ki(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ki(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function $4(t,e,n){switch(e.tag){case 3:DI(e),pu();break;case 5:aI(e);break;case 1:er(e.type)&&ed(e);break;case 4:j0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;st(rd,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(xt,xt.current&1),e.flags|=128,null):n&e.child.childLanes?NI(t,e,n):(st(xt,xt.current&1),t=ri(t,e,n),t!==null?t.sibling:null);st(xt,xt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return MI(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),st(xt,xt.current),r)break;return null;case 22:case 23:return e.lanes=0,kI(t,e,n)}return ri(t,e,n)}var OI,Zg,FI,LI;OI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zg=function(){};FI=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,Va(So.current);var i=null;switch(n){case"input":o=_g(t,o),r=_g(t,r),i=[];break;case"select":o=Ct({},o,{value:void 0}),r=Ct({},r,{value:void 0}),i=[];break;case"textarea":o=Cg(t,o),r=Cg(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Jf)}Ig(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Jl.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Jl.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&ft("scroll",t),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};LI=function(t,e,n,r){n!==r&&(e.flags|=4)};function gl(t,e){if(!yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Sn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function U4(t,e,n){var r=e.pendingProps;switch(L0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(e),null;case 1:return er(e.type)&&Zf(),Sn(e),null;case 3:return r=e.stateNode,vu(),mt(Zn),mt(Fn),G0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xr!==null&&(sy(Xr),Xr=null))),Zg(t,e),Sn(e),null;case 5:H0(e);var o=Va(cc.current);if(n=e.type,t!==null&&e.stateNode!=null)FI(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(re(166));return Sn(e),null}if(t=Va(So.current),Vh(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[xo]=e,r[uc]=i,t=(e.mode&1)!==0,n){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(o=0;o<Al.length;o++)ft(Al[o],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":T_(r,i),ft("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ft("invalid",r);break;case"textarea":A_(r,i),ft("invalid",r)}Ig(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&Lh(r.textContent,s,t),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&Lh(r.textContent,s,t),o=["children",""+s]):Jl.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&ft("scroll",r)}switch(n){case"input":Ah(r),R_(r,i,!0);break;case"textarea":Ah(r),k_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Jf)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=hS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[xo]=e,t[uc]=r,OI(t,e,!1,!1),e.stateNode=t;e:{switch(a=Tg(n,r),n){case"dialog":ft("cancel",t),ft("close",t),o=r;break;case"iframe":case"object":case"embed":ft("load",t),o=r;break;case"video":case"audio":for(o=0;o<Al.length;o++)ft(Al[o],t);o=r;break;case"source":ft("error",t),o=r;break;case"img":case"image":case"link":ft("error",t),ft("load",t),o=r;break;case"details":ft("toggle",t),o=r;break;case"input":T_(t,r),o=_g(t,r),ft("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=Ct({},r,{value:void 0}),ft("invalid",t);break;case"textarea":A_(t,r),o=Cg(t,r),ft("invalid",t);break;default:o=r}Ig(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?pS(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&fS(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Zl(t,u):typeof u=="number"&&Zl(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Jl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ft("scroll",t):u!=null&&b0(t,i,u,a))}switch(n){case"input":Ah(t),R_(t,r,!1);break;case"textarea":Ah(t),k_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+na(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qs(t,!!r.multiple,i,!1):r.defaultValue!=null&&qs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Jf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Sn(e),null;case 6:if(t&&e.stateNode!=null)LI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(re(166));if(n=Va(cc.current),Va(So.current),Vh(e)){if(r=e.stateNode,n=e.memoizedProps,r[xo]=e,(i=r.nodeValue!==n)&&(t=yr,t!==null))switch(t.tag){case 3:Lh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lh(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xo]=e,e.stateNode=r}return Sn(e),null;case 13:if(mt(xt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yt&&dr!==null&&e.mode&1&&!(e.flags&128))tI(),pu(),e.flags|=98560,i=!1;else if(i=Vh(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(re(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(re(317));i[xo]=e}else pu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Sn(e),i=!1}else Xr!==null&&(sy(Xr),Xr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||xt.current&1?Xt===0&&(Xt=3):o1())),e.updateQueue!==null&&(e.flags|=4),Sn(e),null);case 4:return vu(),Zg(t,e),t===null&&ac(e.stateNode.containerInfo),Sn(e),null;case 10:return U0(e.type._context),Sn(e),null;case 17:return er(e.type)&&Zf(),Sn(e),null;case 19:if(mt(xt),i=e.memoizedState,i===null)return Sn(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)gl(i,!1);else{if(Xt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=ad(t),a!==null){for(e.flags|=128,gl(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(xt,xt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Mt()>yu&&(e.flags|=128,r=!0,gl(i,!1),e.lanes=4194304)}else{if(!r)if(t=ad(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),gl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!yt)return Sn(e),null}else 2*Mt()-i.renderingStartTime>yu&&n!==1073741824&&(e.flags|=128,r=!0,gl(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Mt(),e.sibling=null,n=xt.current,st(xt,r?n&1|2:n&1),e):(Sn(e),null);case 22:case 23:return r1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?lr&1073741824&&(Sn(e),e.subtreeFlags&6&&(e.flags|=8192)):Sn(e),null;case 24:return null;case 25:return null}throw Error(re(156,e.tag))}function z4(t,e){switch(L0(e),e.tag){case 1:return er(e.type)&&Zf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return vu(),mt(Zn),mt(Fn),G0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return H0(e),null;case 13:if(mt(xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(re(340));pu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mt(xt),null;case 4:return vu(),null;case 10:return U0(e.type._context),null;case 22:case 23:return r1(),null;case 24:return null;default:return null}}var Uh=!1,kn=!1,W4=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Hs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pt(t,e,r)}else n.current=null}function ey(t,e,n){try{n()}catch(r){Pt(t,e,r)}}var wb=!1;function j4(t,e){if(Lg=Xf,t=zS(),O0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,h=t,f=null;t:for(;;){for(var d;h!==n||o!==0&&h.nodeType!==3||(s=a+o),h!==i||r!==0&&h.nodeType!==3||(u=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===n&&++l===o&&(s=a),f===i&&++c===r&&(u=a),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Vg={focusedElem:t,selectionRange:n},Xf=!1,ce=e;ce!==null;)if(e=ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ce=t;else for(;ce!==null;){e=ce;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:qr(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(_){Pt(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,ce=t;break}ce=e.return}return m=wb,wb=!1,m}function $l(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&ey(e,n,i)}o=o.next}while(o!==r)}}function vp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ty(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VI(t){var e=t.alternate;e!==null&&(t.alternate=null,VI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[xo],delete e[uc],delete e[Ug],delete e[I4],delete e[T4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function BI(t){return t.tag===5||t.tag===3||t.tag===4}function xb(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||BI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ny(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Jf));else if(r!==4&&(t=t.child,t!==null))for(ny(t,e,n),t=t.sibling;t!==null;)ny(t,e,n),t=t.sibling}function ry(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ry(t,e,n),t=t.sibling;t!==null;)ry(t,e,n),t=t.sibling}var fn=null,Kr=!1;function Ri(t,e,n){for(n=n.child;n!==null;)$I(t,e,n),n=n.sibling}function $I(t,e,n){if(Co&&typeof Co.onCommitFiberUnmount=="function")try{Co.onCommitFiberUnmount(up,n)}catch{}switch(n.tag){case 5:kn||Hs(n,e);case 6:var r=fn,o=Kr;fn=null,Ri(t,e,n),fn=r,Kr=o,fn!==null&&(Kr?(t=fn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):fn.removeChild(n.stateNode));break;case 18:fn!==null&&(Kr?(t=fn,n=n.stateNode,t.nodeType===8?fv(t.parentNode,n):t.nodeType===1&&fv(t,n),rc(t)):fv(fn,n.stateNode));break;case 4:r=fn,o=Kr,fn=n.stateNode.containerInfo,Kr=!0,Ri(t,e,n),fn=r,Kr=o;break;case 0:case 11:case 14:case 15:if(!kn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ey(n,e,a),o=o.next}while(o!==r)}Ri(t,e,n);break;case 1:if(!kn&&(Hs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Pt(n,e,s)}Ri(t,e,n);break;case 21:Ri(t,e,n);break;case 22:n.mode&1?(kn=(r=kn)||n.memoizedState!==null,Ri(t,e,n),kn=r):Ri(t,e,n);break;default:Ri(t,e,n)}}function _b(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new W4),e.forEach(function(r){var o=Z4.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Hr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:fn=s.stateNode,Kr=!1;break e;case 3:fn=s.stateNode.containerInfo,Kr=!0;break e;case 4:fn=s.stateNode.containerInfo,Kr=!0;break e}s=s.return}if(fn===null)throw Error(re(160));$I(i,a,o),fn=null,Kr=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){Pt(o,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)UI(e,t),e=e.sibling}function UI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hr(e,t),ho(t),r&4){try{$l(3,t,t.return),vp(3,t)}catch(g){Pt(t,t.return,g)}try{$l(5,t,t.return)}catch(g){Pt(t,t.return,g)}}break;case 1:Hr(e,t),ho(t),r&512&&n!==null&&Hs(n,n.return);break;case 5:if(Hr(e,t),ho(t),r&512&&n!==null&&Hs(n,n.return),t.flags&32){var o=t.stateNode;try{Zl(o,"")}catch(g){Pt(t,t.return,g)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&lS(o,i),Tg(s,a);var l=Tg(s,i);for(a=0;a<u.length;a+=2){var c=u[a],h=u[a+1];c==="style"?pS(o,h):c==="dangerouslySetInnerHTML"?fS(o,h):c==="children"?Zl(o,h):b0(o,c,h,l)}switch(s){case"input":bg(o,i);break;case"textarea":cS(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var d=i.value;d!=null?qs(o,!!i.multiple,d,!1):f!==!!i.multiple&&(i.defaultValue!=null?qs(o,!!i.multiple,i.defaultValue,!0):qs(o,!!i.multiple,i.multiple?[]:"",!1))}o[uc]=i}catch(g){Pt(t,t.return,g)}}break;case 6:if(Hr(e,t),ho(t),r&4){if(t.stateNode===null)throw Error(re(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(g){Pt(t,t.return,g)}}break;case 3:if(Hr(e,t),ho(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rc(e.containerInfo)}catch(g){Pt(t,t.return,g)}break;case 4:Hr(e,t),ho(t);break;case 13:Hr(e,t),ho(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(t1=Mt())),r&4&&_b(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(kn=(l=kn)||c,Hr(e,t),kn=l):Hr(e,t),ho(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!c&&t.mode&1)for(ce=t,c=t.child;c!==null;){for(h=ce=c;ce!==null;){switch(f=ce,d=f.child,f.tag){case 0:case 11:case 14:case 15:$l(4,f,f.return);break;case 1:Hs(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Pt(r,n,g)}}break;case 5:Hs(f,f.return);break;case 22:if(f.memoizedState!==null){Eb(h);continue}}d!==null?(d.return=f,ce=d):Eb(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{o=h.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=h.stateNode,u=h.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=dS("display",a))}catch(g){Pt(t,t.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(g){Pt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Hr(e,t),ho(t),r&4&&_b(t);break;case 21:break;default:Hr(e,t),ho(t)}}function ho(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(BI(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Zl(o,""),r.flags&=-33);var i=xb(t);ry(t,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=xb(t);ny(t,s,a);break;default:throw Error(re(161))}}catch(u){Pt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function H4(t,e,n){ce=t,zI(t)}function zI(t,e,n){for(var r=(t.mode&1)!==0;ce!==null;){var o=ce,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Uh;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||kn;s=Uh;var l=kn;if(Uh=a,(kn=u)&&!l)for(ce=o;ce!==null;)a=ce,u=a.child,a.tag===22&&a.memoizedState!==null?Cb(o):u!==null?(u.return=a,ce=u):Cb(o);for(;i!==null;)ce=i,zI(i),i=i.sibling;ce=o,Uh=s,kn=l}bb(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ce=i):bb(t)}}function bb(t){for(;ce!==null;){var e=ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kn||vp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kn)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:qr(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ab(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ab(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&rc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}kn||e.flags&512&&ty(e)}catch(f){Pt(e,e.return,f)}}if(e===t){ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,ce=n;break}ce=e.return}}function Eb(t){for(;ce!==null;){var e=ce;if(e===t){ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ce=n;break}ce=e.return}}function Cb(t){for(;ce!==null;){var e=ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{vp(4,e)}catch(u){Pt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){Pt(e,o,u)}}var i=e.return;try{ty(e)}catch(u){Pt(e,i,u)}break;case 5:var a=e.return;try{ty(e)}catch(u){Pt(e,a,u)}}}catch(u){Pt(e,e.return,u)}if(e===t){ce=null;break}var s=e.sibling;if(s!==null){s.return=e.return,ce=s;break}ce=e.return}}var G4=Math.ceil,ld=hi.ReactCurrentDispatcher,Z0=hi.ReactCurrentOwner,Lr=hi.ReactCurrentBatchConfig,He=0,un=null,zt=null,wn=0,lr=0,Gs=da(0),Xt=0,pc=null,Qa=0,gp=0,e1=0,Ul=null,Kn=null,t1=0,yu=1/0,Ho=null,cd=!1,oy=null,Gi=null,zh=!1,Li=null,hd=0,zl=0,iy=null,If=-1,Tf=0;function zn(){return He&6?Mt():If!==-1?If:If=Mt()}function qi(t){return t.mode&1?He&2&&wn!==0?wn&-wn:A4.transition!==null?(Tf===0&&(Tf=IS()),Tf):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:NS(t.type)),t):1}function Zr(t,e,n,r){if(50<zl)throw zl=0,iy=null,Error(re(185));Vc(t,n,r),(!(He&2)||t!==un)&&(t===un&&(!(He&2)&&(gp|=n),Xt===4&&Oi(t,wn)),tr(t,r),n===1&&He===0&&!(e.mode&1)&&(yu=Mt()+500,dp&&pa()))}function tr(t,e){var n=t.callbackNode;AN(t,e);var r=Kf(t,t===un?wn:0);if(r===0)n!==null&&N_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&N_(n),e===1)t.tag===0?R4(Sb.bind(null,t)):JS(Sb.bind(null,t)),C4(function(){!(He&6)&&pa()}),n=null;else{switch(TS(r)){case 1:n=T0;break;case 4:n=CS;break;case 16:n=qf;break;case 536870912:n=SS;break;default:n=qf}n=QI(n,WI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function WI(t,e){if(If=-1,Tf=0,He&6)throw Error(re(327));var n=t.callbackNode;if(Js()&&t.callbackNode!==n)return null;var r=Kf(t,t===un?wn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fd(t,r);else{e=r;var o=He;He|=2;var i=HI();(un!==t||wn!==e)&&(Ho=null,yu=Mt()+500,Wa(t,e));do try{X4();break}catch(s){jI(t,s)}while(!0);$0(),ld.current=i,He=o,zt!==null?e=0:(un=null,wn=0,e=Xt)}if(e!==0){if(e===2&&(o=Dg(t),o!==0&&(r=o,e=ay(t,o))),e===1)throw n=pc,Wa(t,0),Oi(t,r),tr(t,Mt()),n;if(e===6)Oi(t,r);else{if(o=t.current.alternate,!(r&30)&&!q4(o)&&(e=fd(t,r),e===2&&(i=Dg(t),i!==0&&(r=i,e=ay(t,i))),e===1))throw n=pc,Wa(t,0),Oi(t,r),tr(t,Mt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(re(345));case 2:Pa(t,Kn,Ho);break;case 3:if(Oi(t,r),(r&130023424)===r&&(e=t1+500-Mt(),10<e)){if(Kf(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){zn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=$g(Pa.bind(null,t,Kn,Ho),e);break}Pa(t,Kn,Ho);break;case 4:if(Oi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var a=31-Jr(r);i=1<<a,a=e[a],a>o&&(o=a),r&=~i}if(r=o,r=Mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*G4(r/1960))-r,10<r){t.timeoutHandle=$g(Pa.bind(null,t,Kn,Ho),r);break}Pa(t,Kn,Ho);break;case 5:Pa(t,Kn,Ho);break;default:throw Error(re(329))}}}return tr(t,Mt()),t.callbackNode===n?WI.bind(null,t):null}function ay(t,e){var n=Ul;return t.current.memoizedState.isDehydrated&&(Wa(t,e).flags|=256),t=fd(t,e),t!==2&&(e=Kn,Kn=n,e!==null&&sy(e)),t}function sy(t){Kn===null?Kn=t:Kn.push.apply(Kn,t)}function q4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!ro(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oi(t,e){for(e&=~e1,e&=~gp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jr(e),r=1<<n;t[n]=-1,e&=~r}}function Sb(t){if(He&6)throw Error(re(327));Js();var e=Kf(t,0);if(!(e&1))return tr(t,Mt()),null;var n=fd(t,e);if(t.tag!==0&&n===2){var r=Dg(t);r!==0&&(e=r,n=ay(t,r))}if(n===1)throw n=pc,Wa(t,0),Oi(t,e),tr(t,Mt()),n;if(n===6)throw Error(re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Pa(t,Kn,Ho),tr(t,Mt()),null}function n1(t,e){var n=He;He|=1;try{return t(e)}finally{He=n,He===0&&(yu=Mt()+500,dp&&pa())}}function Ya(t){Li!==null&&Li.tag===0&&!(He&6)&&Js();var e=He;He|=1;var n=Lr.transition,r=Ze;try{if(Lr.transition=null,Ze=1,t)return t()}finally{Ze=r,Lr.transition=n,He=e,!(He&6)&&pa()}}function r1(){lr=Gs.current,mt(Gs)}function Wa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,E4(n)),zt!==null)for(n=zt.return;n!==null;){var r=n;switch(L0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zf();break;case 3:vu(),mt(Zn),mt(Fn),G0();break;case 5:H0(r);break;case 4:vu();break;case 13:mt(xt);break;case 19:mt(xt);break;case 10:U0(r.type._context);break;case 22:case 23:r1()}n=n.return}if(un=t,zt=t=Ki(t.current,null),wn=lr=e,Xt=0,pc=null,e1=gp=Qa=0,Kn=Ul=null,La!==null){for(e=0;e<La.length;e++)if(n=La[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}La=null}return t}function jI(t,e){do{var n=zt;try{if($0(),Ef.current=ud,sd){for(var r=Et.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}sd=!1}if(Xa=0,sn=Kt=Et=null,Bl=!1,hc=0,Z0.current=null,n===null||n.return===null){Xt=1,pc=e,zt=null;break}e:{var i=t,a=n.return,s=n,u=e;if(e=wn,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=fb(a);if(d!==null){d.flags&=-257,db(d,a,s,i,e),d.mode&1&&hb(i,l,e),e=d,u=l;var m=e.updateQueue;if(m===null){var g=new Set;g.add(u),e.updateQueue=g}else m.add(u);break e}else{if(!(e&1)){hb(i,l,e),o1();break e}u=Error(re(426))}}else if(yt&&s.mode&1){var y=fb(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),db(y,a,s,i,e),V0(gu(u,s));break e}}i=u=gu(u,s),Xt!==4&&(Xt=2),Ul===null?Ul=[i]:Ul.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=TI(i,u,e);ib(i,v);break e;case 1:s=u;var w=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Gi===null||!Gi.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=RI(i,s,e);ib(i,_);break e}}i=i.return}while(i!==null)}qI(n)}catch(S){e=S,zt===n&&n!==null&&(zt=n=n.return);continue}break}while(!0)}function HI(){var t=ld.current;return ld.current=ud,t===null?ud:t}function o1(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),un===null||!(Qa&268435455)&&!(gp&268435455)||Oi(un,wn)}function fd(t,e){var n=He;He|=2;var r=HI();(un!==t||wn!==e)&&(Ho=null,Wa(t,e));do try{K4();break}catch(o){jI(t,o)}while(!0);if($0(),He=n,ld.current=r,zt!==null)throw Error(re(261));return un=null,wn=0,Xt}function K4(){for(;zt!==null;)GI(zt)}function X4(){for(;zt!==null&&!xN();)GI(zt)}function GI(t){var e=XI(t.alternate,t,lr);t.memoizedProps=t.pendingProps,e===null?qI(t):zt=e,Z0.current=null}function qI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=z4(n,e),n!==null){n.flags&=32767,zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xt=6,zt=null;return}}else if(n=U4(n,e,lr),n!==null){zt=n;return}if(e=e.sibling,e!==null){zt=e;return}zt=e=t}while(e!==null);Xt===0&&(Xt=5)}function Pa(t,e,n){var r=Ze,o=Lr.transition;try{Lr.transition=null,Ze=1,Q4(t,e,n,r)}finally{Lr.transition=o,Ze=r}return null}function Q4(t,e,n,r){do Js();while(Li!==null);if(He&6)throw Error(re(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(re(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(kN(t,i),t===un&&(zt=un=null,wn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zh||(zh=!0,QI(qf,function(){return Js(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Lr.transition,Lr.transition=null;var a=Ze;Ze=1;var s=He;He|=4,Z0.current=null,j4(t,n),UI(n,t),v4(Vg),Xf=!!Lg,Vg=Lg=null,t.current=n,H4(n),_N(),He=s,Ze=a,Lr.transition=i}else t.current=n;if(zh&&(zh=!1,Li=t,hd=o),i=t.pendingLanes,i===0&&(Gi=null),CN(n.stateNode),tr(t,Mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(cd)throw cd=!1,t=oy,oy=null,t;return hd&1&&t.tag!==0&&Js(),i=t.pendingLanes,i&1?t===iy?zl++:(zl=0,iy=t):zl=0,pa(),null}function Js(){if(Li!==null){var t=TS(hd),e=Lr.transition,n=Ze;try{if(Lr.transition=null,Ze=16>t?16:t,Li===null)var r=!1;else{if(t=Li,Li=null,hd=0,He&6)throw Error(re(331));var o=He;for(He|=4,ce=t.current;ce!==null;){var i=ce,a=i.child;if(ce.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(ce=l;ce!==null;){var c=ce;switch(c.tag){case 0:case 11:case 15:$l(8,c,i)}var h=c.child;if(h!==null)h.return=c,ce=h;else for(;ce!==null;){c=ce;var f=c.sibling,d=c.return;if(VI(c),c===l){ce=null;break}if(f!==null){f.return=d,ce=f;break}ce=d}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ce=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ce=a;else e:for(;ce!==null;){if(i=ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:$l(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ce=v;break e}ce=i.return}}var w=t.current;for(ce=w;ce!==null;){a=ce;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ce=x;else e:for(a=w;ce!==null;){if(s=ce,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:vp(9,s)}}catch(S){Pt(s,s.return,S)}if(s===a){ce=null;break e}var _=s.sibling;if(_!==null){_.return=s.return,ce=_;break e}ce=s.return}}if(He=o,pa(),Co&&typeof Co.onPostCommitFiberRoot=="function")try{Co.onPostCommitFiberRoot(up,t)}catch{}r=!0}return r}finally{Ze=n,Lr.transition=e}}return!1}function Ib(t,e,n){e=gu(n,e),e=TI(t,e,1),t=Hi(t,e,1),e=zn(),t!==null&&(Vc(t,1,e),tr(t,e))}function Pt(t,e,n){if(t.tag===3)Ib(t,t,n);else for(;e!==null;){if(e.tag===3){Ib(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gi===null||!Gi.has(r))){t=gu(n,t),t=RI(e,t,1),e=Hi(e,t,1),t=zn(),e!==null&&(Vc(e,1,t),tr(e,t));break}}e=e.return}}function Y4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=zn(),t.pingedLanes|=t.suspendedLanes&n,un===t&&(wn&n)===n&&(Xt===4||Xt===3&&(wn&130023424)===wn&&500>Mt()-t1?Wa(t,0):e1|=n),tr(t,e)}function KI(t,e){e===0&&(t.mode&1?(e=Dh,Dh<<=1,!(Dh&130023424)&&(Dh=4194304)):e=1);var n=zn();t=ni(t,e),t!==null&&(Vc(t,e,n),tr(t,n))}function J4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KI(t,n)}function Z4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(e),KI(t,n)}var XI;XI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zn.current)Jn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jn=!1,$4(t,e,n);Jn=!!(t.flags&131072)}else Jn=!1,yt&&e.flags&1048576&&ZS(e,nd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Sf(t,e),t=e.pendingProps;var o=du(e,Fn.current);Ys(e,n),o=K0(null,e,r,t,o,n);var i=X0();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,er(r)?(i=!0,ed(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,W0(e),o.updater=mp,e.stateNode=o,o._reactInternals=e,qg(e,r,t,n),e=Qg(null,e,r,!0,i,n)):(e.tag=0,yt&&i&&F0(e),$n(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Sf(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=t3(r),t=qr(r,t),o){case 0:e=Xg(null,e,r,t,n);break e;case 1:e=vb(null,e,r,t,n);break e;case 11:e=pb(null,e,r,t,n);break e;case 14:e=mb(null,e,r,qr(r.type,t),n);break e}throw Error(re(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qr(r,o),Xg(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qr(r,o),vb(t,e,r,o,n);case 3:e:{if(DI(e),t===null)throw Error(re(387));r=e.pendingProps,i=e.memoizedState,o=i.element,iI(t,e),id(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=gu(Error(re(423)),e),e=gb(t,e,r,n,o);break e}else if(r!==o){o=gu(Error(re(424)),e),e=gb(t,e,r,n,o);break e}else for(dr=ji(e.stateNode.containerInfo.firstChild),yr=e,yt=!0,Xr=null,n=rI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(pu(),r===o){e=ri(t,e,n);break e}$n(t,e,r,n)}e=e.child}return e;case 5:return aI(e),t===null&&jg(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,a=o.children,Bg(r,o)?a=null:i!==null&&Bg(r,i)&&(e.flags|=32),PI(t,e),$n(t,e,a,n),e.child;case 6:return t===null&&jg(e),null;case 13:return NI(t,e,n);case 4:return j0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=mu(e,null,r,n):$n(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qr(r,o),pb(t,e,r,o,n);case 7:return $n(t,e,e.pendingProps,n),e.child;case 8:return $n(t,e,e.pendingProps.children,n),e.child;case 12:return $n(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,a=o.value,st(rd,r._currentValue),r._currentValue=a,i!==null)if(ro(i.value,a)){if(i.children===o.children&&!Zn.current){e=ri(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Yo(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Hg(i.return,n,e),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(re(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Hg(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}$n(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Ys(e,n),o=Vr(o),r=r(o),e.flags|=1,$n(t,e,r,n),e.child;case 14:return r=e.type,o=qr(r,e.pendingProps),o=qr(r.type,o),mb(t,e,r,o,n);case 15:return AI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qr(r,o),Sf(t,e),e.tag=1,er(r)?(t=!0,ed(e)):t=!1,Ys(e,n),II(e,r,o),qg(e,r,o,n),Qg(null,e,r,!0,t,n);case 19:return MI(t,e,n);case 22:return kI(t,e,n)}throw Error(re(156,e.tag))};function QI(t,e){return ES(t,e)}function e3(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(t,e,n,r){return new e3(t,e,n,r)}function i1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function t3(t){if(typeof t=="function")return i1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===C0)return 11;if(t===S0)return 14}return 2}function Ki(t,e){var n=t.alternate;return n===null?(n=Or(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rf(t,e,n,r,o,i){var a=2;if(r=t,typeof t=="function")i1(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Fs:return ja(n.children,o,i,e);case E0:a=8,o|=8;break;case gg:return t=Or(12,n,e,o|2),t.elementType=gg,t.lanes=i,t;case yg:return t=Or(13,n,e,o),t.elementType=yg,t.lanes=i,t;case wg:return t=Or(19,n,e,o),t.elementType=wg,t.lanes=i,t;case aS:return yp(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case oS:a=10;break e;case iS:a=9;break e;case C0:a=11;break e;case S0:a=14;break e;case Di:a=16,r=null;break e}throw Error(re(130,t==null?t:typeof t,""))}return e=Or(a,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function ja(t,e,n,r){return t=Or(7,t,r,e),t.lanes=n,t}function yp(t,e,n,r){return t=Or(22,t,r,e),t.elementType=aS,t.lanes=n,t.stateNode={isHidden:!1},t}function xv(t,e,n){return t=Or(6,t,null,e),t.lanes=n,t}function _v(t,e,n){return e=Or(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function n3(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tv(0),this.expirationTimes=tv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tv(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function a1(t,e,n,r,o,i,a,s,u){return t=new n3(t,e,n,s,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Or(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},W0(i),t}function r3(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Os,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function YI(t){if(!t)return ra;t=t._reactInternals;e:{if(rs(t)!==t||t.tag!==1)throw Error(re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(er(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(re(171))}if(t.tag===1){var n=t.type;if(er(n))return YS(t,n,e)}return e}function JI(t,e,n,r,o,i,a,s,u){return t=a1(n,r,!0,t,o,i,a,s,u),t.context=YI(null),n=t.current,r=zn(),o=qi(n),i=Yo(r,o),i.callback=e??null,Hi(n,i,o),t.current.lanes=o,Vc(t,o,r),tr(t,r),t}function wp(t,e,n,r){var o=e.current,i=zn(),a=qi(o);return n=YI(n),e.context===null?e.context=n:e.pendingContext=n,e=Yo(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Hi(o,e,a),t!==null&&(Zr(t,o,a,i),bf(t,o,a)),a}function dd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Tb(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function s1(t,e){Tb(t,e),(t=t.alternate)&&Tb(t,e)}function o3(){return null}var ZI=typeof reportError=="function"?reportError:function(t){console.error(t)};function u1(t){this._internalRoot=t}xp.prototype.render=u1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(re(409));wp(t,e,null,null)};xp.prototype.unmount=u1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ya(function(){wp(null,t,null,null)}),e[ti]=null}};function xp(t){this._internalRoot=t}xp.prototype.unstable_scheduleHydration=function(t){if(t){var e=kS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Mi.length&&e!==0&&e<Mi[n].priority;n++);Mi.splice(n,0,t),n===0&&DS(t)}};function l1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _p(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rb(){}function i3(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=dd(a);i.call(l)}}var a=JI(e,r,t,0,null,!1,!1,"",Rb);return t._reactRootContainer=a,t[ti]=a.current,ac(t.nodeType===8?t.parentNode:t),Ya(),a}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=dd(u);s.call(l)}}var u=a1(t,0,!1,null,null,!1,!1,"",Rb);return t._reactRootContainer=u,t[ti]=u.current,ac(t.nodeType===8?t.parentNode:t),Ya(function(){wp(e,u,n,r)}),u}function bp(t,e,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=dd(a);s.call(u)}}wp(e,a,t,o)}else a=i3(n,e,t,o,r);return dd(a)}RS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Rl(e.pendingLanes);n!==0&&(R0(e,n|1),tr(e,Mt()),!(He&6)&&(yu=Mt()+500,pa()))}break;case 13:Ya(function(){var r=ni(t,1);if(r!==null){var o=zn();Zr(r,t,1,o)}}),s1(t,1)}};A0=function(t){if(t.tag===13){var e=ni(t,134217728);if(e!==null){var n=zn();Zr(e,t,134217728,n)}s1(t,134217728)}};AS=function(t){if(t.tag===13){var e=qi(t),n=ni(t,e);if(n!==null){var r=zn();Zr(n,t,e,r)}s1(t,e)}};kS=function(){return Ze};PS=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};Ag=function(t,e,n){switch(e){case"input":if(bg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=fp(r);if(!o)throw Error(re(90));uS(r),bg(r,o)}}}break;case"textarea":cS(t,n);break;case"select":e=n.value,e!=null&&qs(t,!!n.multiple,e,!1)}};gS=n1;yS=Ya;var a3={usingClientEntryPoint:!1,Events:[$c,$s,fp,mS,vS,n1]},yl={findFiberByHostInstance:Fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s3={bundleType:yl.bundleType,version:yl.version,rendererPackageName:yl.rendererPackageName,rendererConfig:yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_S(t),t===null?null:t.stateNode},findFiberByHostInstance:yl.findFiberByHostInstance||o3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{up=Wh.inject(s3),Co=Wh}catch{}}br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a3;br.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l1(e))throw Error(re(200));return r3(t,e,null,n)};br.createRoot=function(t,e){if(!l1(t))throw Error(re(299));var n=!1,r="",o=ZI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=a1(t,1,!1,null,null,n,!1,r,o),t[ti]=e.current,ac(t.nodeType===8?t.parentNode:t),new u1(e)};br.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(re(188)):(t=Object.keys(t).join(","),Error(re(268,t)));return t=_S(e),t=t===null?null:t.stateNode,t};br.flushSync=function(t){return Ya(t)};br.hydrate=function(t,e,n){if(!_p(e))throw Error(re(200));return bp(null,t,e,!0,n)};br.hydrateRoot=function(t,e,n){if(!l1(t))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=ZI;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=JI(e,null,t,1,n??null,o,!1,i,a),t[ti]=e.current,ac(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new xp(e)};br.render=function(t,e,n){if(!_p(e))throw Error(re(200));return bp(null,t,e,!1,n)};br.unmountComponentAtNode=function(t){if(!_p(t))throw Error(re(40));return t._reactRootContainer?(Ya(function(){bp(null,null,t,!1,function(){t._reactRootContainer=null,t[ti]=null})}),!0):!1};br.unstable_batchedUpdates=n1;br.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_p(n))throw Error(re(200));if(t==null||t._reactInternals===void 0)throw Error(re(38));return bp(t,e,n,!1,r)};br.version="18.3.1-next-f1338f8080-20240426";function eT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eT)}catch(t){console.error(t)}}eT(),eS.exports=br;var tT=eS.exports;const ZK=zC(tT);var nT,Ab=tT;nT=Ab.createRoot,Ab.hydrateRoot;const u3="modulepreload",l3=function(t){return"/"+t},kb={},Gr=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),s=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=l3(u),u in kb)return;kb[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":u3,l||(h.as="script"),h.crossOrigin="",h.href=u,s&&h.setAttribute("nonce",s),document.head.appendChild(h),l)return new Promise((f,d)=>{h.addEventListener("load",f),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return o.then(a=>{for(const s of a||[])s.status==="rejected"&&i(s.reason);return e().catch(i)})},mc={black:"#000",white:"#fff"},gs={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},ys={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},ws={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},xs={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},_s={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},wl={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},c3={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function vc(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const h3=Object.freeze(Object.defineProperty({__proto__:null,default:vc},Symbol.toStringTag,{value:"Module"})),gc="$$material";function ee(){return ee=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ee.apply(null,arguments)}const f3=Object.freeze(Object.defineProperty({__proto__:null,get default(){return ee}},Symbol.toStringTag,{value:"Module"}));function ut(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function d3(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function p3(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var m3=function(){function t(n){var r=this;this._insertTag=function(o){var i;r.tags.length===0?r.insertionPoint?i=r.insertionPoint.nextSibling:r.prepend?i=r.container.firstChild:i=r.before:i=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(o,i),r.tags.push(o)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(p3(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var i=d3(o);try{i.insertRule(r,i.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var o;return(o=r.parentNode)==null?void 0:o.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Tn="-ms-",pd="-moz-",qe="-webkit-",rT="comm",c1="rule",h1="decl",v3="@import",oT="@keyframes",g3="@layer",y3=Math.abs,Ep=String.fromCharCode,w3=Object.assign;function x3(t,e){return vn(t,0)^45?(((e<<2^vn(t,0))<<2^vn(t,1))<<2^vn(t,2))<<2^vn(t,3):0}function iT(t){return t.trim()}function _3(t,e){return(t=e.exec(t))?t[0]:t}function Ke(t,e,n){return t.replace(e,n)}function uy(t,e){return t.indexOf(e)}function vn(t,e){return t.charCodeAt(e)|0}function yc(t,e,n){return t.slice(e,n)}function go(t){return t.length}function f1(t){return t.length}function jh(t,e){return e.push(t),t}function b3(t,e){return t.map(e).join("")}var Cp=1,wu=1,aT=0,rr=0,Ut=0,Nu="";function Sp(t,e,n,r,o,i,a){return{value:t,root:e,parent:n,type:r,props:o,children:i,line:Cp,column:wu,length:a,return:""}}function xl(t,e){return w3(Sp("",null,null,"",null,null,0),t,{length:-t.length},e)}function E3(){return Ut}function C3(){return Ut=rr>0?vn(Nu,--rr):0,wu--,Ut===10&&(wu=1,Cp--),Ut}function wr(){return Ut=rr<aT?vn(Nu,rr++):0,wu++,Ut===10&&(wu=1,Cp++),Ut}function Io(){return vn(Nu,rr)}function Af(){return rr}function zc(t,e){return yc(Nu,t,e)}function wc(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function sT(t){return Cp=wu=1,aT=go(Nu=t),rr=0,[]}function uT(t){return Nu="",t}function kf(t){return iT(zc(rr-1,ly(t===91?t+2:t===40?t+1:t)))}function S3(t){for(;(Ut=Io())&&Ut<33;)wr();return wc(t)>2||wc(Ut)>3?"":" "}function I3(t,e){for(;--e&&wr()&&!(Ut<48||Ut>102||Ut>57&&Ut<65||Ut>70&&Ut<97););return zc(t,Af()+(e<6&&Io()==32&&wr()==32))}function ly(t){for(;wr();)switch(Ut){case t:return rr;case 34:case 39:t!==34&&t!==39&&ly(Ut);break;case 40:t===41&&ly(t);break;case 92:wr();break}return rr}function T3(t,e){for(;wr()&&t+Ut!==57;)if(t+Ut===84&&Io()===47)break;return"/*"+zc(e,rr-1)+"*"+Ep(t===47?t:wr())}function R3(t){for(;!wc(Io());)wr();return zc(t,rr)}function A3(t){return uT(Pf("",null,null,null,[""],t=sT(t),0,[0],t))}function Pf(t,e,n,r,o,i,a,s,u){for(var l=0,c=0,h=a,f=0,d=0,m=0,g=1,y=1,v=1,w=0,x="",_=o,S=i,R=r,C=x;y;)switch(m=w,w=wr()){case 40:if(m!=108&&vn(C,h-1)==58){uy(C+=Ke(kf(w),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:C+=kf(w);break;case 9:case 10:case 13:case 32:C+=S3(m);break;case 92:C+=I3(Af()-1,7);continue;case 47:switch(Io()){case 42:case 47:jh(k3(T3(wr(),Af()),e,n),u);break;default:C+="/"}break;case 123*g:s[l++]=go(C)*v;case 125*g:case 59:case 0:switch(w){case 0:case 125:y=0;case 59+c:v==-1&&(C=Ke(C,/\f/g,"")),d>0&&go(C)-h&&jh(d>32?Db(C+";",r,n,h-1):Db(Ke(C," ","")+";",r,n,h-2),u);break;case 59:C+=";";default:if(jh(R=Pb(C,e,n,l,c,o,s,x,_=[],S=[],h),i),w===123)if(c===0)Pf(C,e,R,R,_,i,h,s,S);else switch(f===99&&vn(C,3)===110?100:f){case 100:case 108:case 109:case 115:Pf(t,R,R,r&&jh(Pb(t,R,R,0,0,o,s,x,o,_=[],h),S),o,S,h,s,r?_:S);break;default:Pf(C,R,R,R,[""],S,0,s,S)}}l=c=d=0,g=v=1,x=C="",h=a;break;case 58:h=1+go(C),d=m;default:if(g<1){if(w==123)--g;else if(w==125&&g++==0&&C3()==125)continue}switch(C+=Ep(w),w*g){case 38:v=c>0?1:(C+="\f",-1);break;case 44:s[l++]=(go(C)-1)*v,v=1;break;case 64:Io()===45&&(C+=kf(wr())),f=Io(),c=h=go(x=C+=R3(Af())),w++;break;case 45:m===45&&go(C)==2&&(g=0)}}return i}function Pb(t,e,n,r,o,i,a,s,u,l,c){for(var h=o-1,f=o===0?i:[""],d=f1(f),m=0,g=0,y=0;m<r;++m)for(var v=0,w=yc(t,h+1,h=y3(g=a[m])),x=t;v<d;++v)(x=iT(g>0?f[v]+" "+w:Ke(w,/&\f/g,f[v])))&&(u[y++]=x);return Sp(t,e,n,o===0?c1:s,u,l,c)}function k3(t,e,n){return Sp(t,e,n,rT,Ep(E3()),yc(t,2,-2),0)}function Db(t,e,n,r){return Sp(t,e,n,h1,yc(t,0,r),yc(t,r+1,-1),r)}function Zs(t,e){for(var n="",r=f1(t),o=0;o<r;o++)n+=e(t[o],o,t,e)||"";return n}function P3(t,e,n,r){switch(t.type){case g3:if(t.children.length)break;case v3:case h1:return t.return=t.return||t.value;case rT:return"";case oT:return t.return=t.value+"{"+Zs(t.children,r)+"}";case c1:t.value=t.props.join(",")}return go(n=Zs(t.children,r))?t.return=t.value+"{"+n+"}":""}function D3(t){var e=f1(t);return function(n,r,o,i){for(var a="",s=0;s<e;s++)a+=t[s](n,r,o,i)||"";return a}}function N3(t){return function(e){e.root||(e=e.return)&&t(e)}}function lT(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var M3=function(e,n,r){for(var o=0,i=0;o=i,i=Io(),o===38&&i===12&&(n[r]=1),!wc(i);)wr();return zc(e,rr)},O3=function(e,n){var r=-1,o=44;do switch(wc(o)){case 0:o===38&&Io()===12&&(n[r]=1),e[r]+=M3(rr-1,n,r);break;case 2:e[r]+=kf(o);break;case 4:if(o===44){e[++r]=Io()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=Ep(o)}while(o=wr());return e},F3=function(e,n){return uT(O3(sT(e),n))},Nb=new WeakMap,L3=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,o=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!Nb.get(r))&&!o){Nb.set(e,!0);for(var i=[],a=F3(n,i),s=r.props,u=0,l=0;u<a.length;u++)for(var c=0;c<s.length;c++,l++)e.props[l]=i[u]?a[u].replace(/&\f/g,s[c]):s[c]+" "+a[u]}}},V3=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function cT(t,e){switch(x3(t,e)){case 5103:return qe+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return qe+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return qe+t+pd+t+Tn+t+t;case 6828:case 4268:return qe+t+Tn+t+t;case 6165:return qe+t+Tn+"flex-"+t+t;case 5187:return qe+t+Ke(t,/(\w+).+(:[^]+)/,qe+"box-$1$2"+Tn+"flex-$1$2")+t;case 5443:return qe+t+Tn+"flex-item-"+Ke(t,/flex-|-self/,"")+t;case 4675:return qe+t+Tn+"flex-line-pack"+Ke(t,/align-content|flex-|-self/,"")+t;case 5548:return qe+t+Tn+Ke(t,"shrink","negative")+t;case 5292:return qe+t+Tn+Ke(t,"basis","preferred-size")+t;case 6060:return qe+"box-"+Ke(t,"-grow","")+qe+t+Tn+Ke(t,"grow","positive")+t;case 4554:return qe+Ke(t,/([^-])(transform)/g,"$1"+qe+"$2")+t;case 6187:return Ke(Ke(Ke(t,/(zoom-|grab)/,qe+"$1"),/(image-set)/,qe+"$1"),t,"")+t;case 5495:case 3959:return Ke(t,/(image-set\([^]*)/,qe+"$1$`$1");case 4968:return Ke(Ke(t,/(.+:)(flex-)?(.*)/,qe+"box-pack:$3"+Tn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+qe+t+t;case 4095:case 3583:case 4068:case 2532:return Ke(t,/(.+)-inline(.+)/,qe+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(go(t)-1-e>6)switch(vn(t,e+1)){case 109:if(vn(t,e+4)!==45)break;case 102:return Ke(t,/(.+:)(.+)-([^]+)/,"$1"+qe+"$2-$3$1"+pd+(vn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~uy(t,"stretch")?cT(Ke(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(vn(t,e+1)!==115)break;case 6444:switch(vn(t,go(t)-3-(~uy(t,"!important")&&10))){case 107:return Ke(t,":",":"+qe)+t;case 101:return Ke(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+qe+(vn(t,14)===45?"inline-":"")+"box$3$1"+qe+"$2$3$1"+Tn+"$2box$3")+t}break;case 5936:switch(vn(t,e+11)){case 114:return qe+t+Tn+Ke(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return qe+t+Tn+Ke(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return qe+t+Tn+Ke(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return qe+t+Tn+t+t}return t}var B3=function(e,n,r,o){if(e.length>-1&&!e.return)switch(e.type){case h1:e.return=cT(e.value,e.length);break;case oT:return Zs([xl(e,{value:Ke(e.value,"@","@"+qe)})],o);case c1:if(e.length)return b3(e.props,function(i){switch(_3(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Zs([xl(e,{props:[Ke(i,/:(read-\w+)/,":"+pd+"$1")]})],o);case"::placeholder":return Zs([xl(e,{props:[Ke(i,/:(plac\w+)/,":"+qe+"input-$1")]}),xl(e,{props:[Ke(i,/:(plac\w+)/,":"+pd+"$1")]}),xl(e,{props:[Ke(i,/:(plac\w+)/,Tn+"input-$1")]})],o)}return""})}},$3=[B3],hT=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var y=g.getAttribute("data-emotion");y.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var o=e.stylisPlugins||$3,i={},a,s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var y=g.getAttribute("data-emotion").split(" "),v=1;v<y.length;v++)i[y[v]]=!0;s.push(g)});var u,l=[L3,V3];{var c,h=[P3,N3(function(g){c.insert(g)})],f=D3(l.concat(o,h)),d=function(y){return Zs(A3(y),f)};u=function(y,v,w,x){c=w,d(y?y+"{"+v.styles+"}":v.styles),x&&(m.inserted[v.name]=!0)}}var m={key:n,sheet:new m3({key:n,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:u};return m.sheet.hydrate(s),m},fT={exports:{}},et={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hn=typeof Symbol=="function"&&Symbol.for,d1=hn?Symbol.for("react.element"):60103,p1=hn?Symbol.for("react.portal"):60106,Ip=hn?Symbol.for("react.fragment"):60107,Tp=hn?Symbol.for("react.strict_mode"):60108,Rp=hn?Symbol.for("react.profiler"):60114,Ap=hn?Symbol.for("react.provider"):60109,kp=hn?Symbol.for("react.context"):60110,m1=hn?Symbol.for("react.async_mode"):60111,Pp=hn?Symbol.for("react.concurrent_mode"):60111,Dp=hn?Symbol.for("react.forward_ref"):60112,Np=hn?Symbol.for("react.suspense"):60113,U3=hn?Symbol.for("react.suspense_list"):60120,Mp=hn?Symbol.for("react.memo"):60115,Op=hn?Symbol.for("react.lazy"):60116,z3=hn?Symbol.for("react.block"):60121,W3=hn?Symbol.for("react.fundamental"):60117,j3=hn?Symbol.for("react.responder"):60118,H3=hn?Symbol.for("react.scope"):60119;function Cr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case d1:switch(t=t.type,t){case m1:case Pp:case Ip:case Rp:case Tp:case Np:return t;default:switch(t=t&&t.$$typeof,t){case kp:case Dp:case Op:case Mp:case Ap:return t;default:return e}}case p1:return e}}}function dT(t){return Cr(t)===Pp}et.AsyncMode=m1;et.ConcurrentMode=Pp;et.ContextConsumer=kp;et.ContextProvider=Ap;et.Element=d1;et.ForwardRef=Dp;et.Fragment=Ip;et.Lazy=Op;et.Memo=Mp;et.Portal=p1;et.Profiler=Rp;et.StrictMode=Tp;et.Suspense=Np;et.isAsyncMode=function(t){return dT(t)||Cr(t)===m1};et.isConcurrentMode=dT;et.isContextConsumer=function(t){return Cr(t)===kp};et.isContextProvider=function(t){return Cr(t)===Ap};et.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===d1};et.isForwardRef=function(t){return Cr(t)===Dp};et.isFragment=function(t){return Cr(t)===Ip};et.isLazy=function(t){return Cr(t)===Op};et.isMemo=function(t){return Cr(t)===Mp};et.isPortal=function(t){return Cr(t)===p1};et.isProfiler=function(t){return Cr(t)===Rp};et.isStrictMode=function(t){return Cr(t)===Tp};et.isSuspense=function(t){return Cr(t)===Np};et.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ip||t===Pp||t===Rp||t===Tp||t===Np||t===U3||typeof t=="object"&&t!==null&&(t.$$typeof===Op||t.$$typeof===Mp||t.$$typeof===Ap||t.$$typeof===kp||t.$$typeof===Dp||t.$$typeof===W3||t.$$typeof===j3||t.$$typeof===H3||t.$$typeof===z3)};et.typeOf=Cr;fT.exports=et;var G3=fT.exports,pT=G3,q3={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},K3={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},mT={};mT[pT.ForwardRef]=q3;mT[pT.Memo]=K3;var X3=!0;function vT(t,e,n){var r="";return n.split(" ").forEach(function(o){t[o]!==void 0?e.push(t[o]+";"):o&&(r+=o+" ")}),r}var v1=function(e,n,r){var o=e.key+"-"+n.name;(r===!1||X3===!1)&&e.registered[o]===void 0&&(e.registered[o]=n.styles)},g1=function(e,n,r){v1(e,n,r);var o=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var i=n;do e.insert(n===i?"."+o:"",i,e.sheet,!0),i=i.next;while(i!==void 0)}};function Q3(t){for(var e=0,n,r=0,o=t.length;o>=4;++r,o-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(o){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Y3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},J3=/[A-Z]|^ms/g,Z3=/_EMO_([^_]+?)_([^]*?)_EMO_/g,gT=function(e){return e.charCodeAt(1)===45},Mb=function(e){return e!=null&&typeof e!="boolean"},bv=lT(function(t){return gT(t)?t:t.replace(J3,"-$&").toLowerCase()}),Ob=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(Z3,function(r,o,i){return yo={name:o,styles:i,next:yo},o})}return Y3[e]!==1&&!gT(e)&&typeof n=="number"&&n!==0?n+"px":n};function xc(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var o=n;if(o.anim===1)return yo={name:o.name,styles:o.styles,next:yo},o.name;var i=n;if(i.styles!==void 0){var a=i.next;if(a!==void 0)for(;a!==void 0;)yo={name:a.name,styles:a.styles,next:yo},a=a.next;var s=i.styles+";";return s}return eM(t,e,n)}case"function":{if(t!==void 0){var u=yo,l=n(t);return yo=u,xc(t,e,l)}break}}var c=n;if(e==null)return c;var h=e[c];return h!==void 0?h:c}function eM(t,e,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=xc(t,e,n[o])+";";else for(var i in n){var a=n[i];if(typeof a!="object"){var s=a;e!=null&&e[s]!==void 0?r+=i+"{"+e[s]+"}":Mb(s)&&(r+=bv(i)+":"+Ob(i,s)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var u=0;u<a.length;u++)Mb(a[u])&&(r+=bv(i)+":"+Ob(i,a[u])+";");else{var l=xc(t,e,a);switch(i){case"animation":case"animationName":{r+=bv(i)+":"+l+";";break}default:r+=i+"{"+l+"}"}}}return r}var Fb=/label:\s*([^\s;{]+)\s*(;|$)/g,yo;function Wc(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,o="";yo=void 0;var i=t[0];if(i==null||i.raw===void 0)r=!1,o+=xc(n,e,i);else{var a=i;o+=a[0]}for(var s=1;s<t.length;s++)if(o+=xc(n,e,t[s]),r){var u=i;o+=u[s]}Fb.lastIndex=0;for(var l="",c;(c=Fb.exec(o))!==null;)l+="-"+c[1];var h=Q3(o)+l;return{name:h,styles:o,next:yo}}var tM=function(e){return e()},yT=mg.useInsertionEffect?mg.useInsertionEffect:!1,wT=yT||tM,Lb=yT||F.useLayoutEffect,xT=F.createContext(typeof HTMLElement<"u"?hT({key:"css"}):null),nM=xT.Provider,y1=function(e){return F.forwardRef(function(n,r){var o=F.useContext(xT);return e(n,o,r)})},Mu=F.createContext({}),w1={}.hasOwnProperty,cy="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",rM=function(e,n){var r={};for(var o in n)w1.call(n,o)&&(r[o]=n[o]);return r[cy]=e,r},oM=function(e){var n=e.cache,r=e.serialized,o=e.isStringTag;return v1(n,r,o),wT(function(){return g1(n,r,o)}),null},iM=y1(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var o=t[cy],i=[r],a="";typeof t.className=="string"?a=vT(e.registered,i,t.className):t.className!=null&&(a=t.className+" ");var s=Wc(i,void 0,F.useContext(Mu));a+=e.key+"-"+s.name;var u={};for(var l in t)w1.call(t,l)&&l!=="css"&&l!==cy&&(u[l]=t[l]);return u.className=a,n&&(u.ref=n),F.createElement(F.Fragment,null,F.createElement(oM,{cache:e,serialized:s,isStringTag:typeof o=="string"}),F.createElement(o,u))}),aM=iM,Vb=function(e,n){var r=arguments;if(n==null||!w1.call(n,"css"))return F.createElement.apply(void 0,r);var o=r.length,i=new Array(o);i[0]=aM,i[1]=rM(e,n);for(var a=2;a<o;a++)i[a]=r[a];return F.createElement.apply(null,i)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Vb||(Vb={}));var sM=y1(function(t,e){var n=t.styles,r=Wc([n],void 0,F.useContext(Mu)),o=F.useRef();return Lb(function(){var i=e.key+"-global",a=new e.sheet.constructor({key:i,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+i+" "+r.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",i),a.hydrate([u])),o.current=[a,s],function(){a.flush()}},[e]),Lb(function(){var i=o.current,a=i[0],s=i[1];if(s){i[1]=!1;return}if(r.next!==void 0&&g1(e,r.next,!0),a.tags.length){var u=a.tags[a.tags.length-1].nextElementSibling;a.before=u,a.flush()}e.insert("",r,a,!1)},[e,r.name]),null});function Fp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Wc(e)}function Ou(){var t=Fp.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var uM=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,lM=lT(function(t){return uM.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),cM=lM,hM=function(e){return e!=="theme"},Bb=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?cM:hM},$b=function(e,n,r){var o;if(n){var i=n.shouldForwardProp;o=e.__emotion_forwardProp&&i?function(a){return e.__emotion_forwardProp(a)&&i(a)}:i}return typeof o!="function"&&r&&(o=e.__emotion_forwardProp),o},fM=function(e){var n=e.cache,r=e.serialized,o=e.isStringTag;return v1(n,r,o),wT(function(){return g1(n,r,o)}),null},dM=function t(e,n){var r=e.__emotion_real===e,o=r&&e.__emotion_base||e,i,a;n!==void 0&&(i=n.label,a=n.target);var s=$b(e,n,r),u=s||Bb(o),l=!u("as");return function(){var c=arguments,h=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(i!==void 0&&h.push("label:"+i+";"),c[0]==null||c[0].raw===void 0)h.push.apply(h,c);else{var f=c[0];h.push(f[0]);for(var d=c.length,m=1;m<d;m++)h.push(c[m],f[m])}var g=y1(function(y,v,w){var x=l&&y.as||o,_="",S=[],R=y;if(y.theme==null){R={};for(var C in y)R[C]=y[C];R.theme=F.useContext(Mu)}typeof y.className=="string"?_=vT(v.registered,S,y.className):y.className!=null&&(_=y.className+" ");var E=Wc(h.concat(S),v.registered,R);_+=v.key+"-"+E.name,a!==void 0&&(_+=" "+a);var I=l&&s===void 0?Bb(x):u,T={};for(var k in y)l&&k==="as"||I(k)&&(T[k]=y[k]);return T.className=_,w&&(T.ref=w),F.createElement(F.Fragment,null,F.createElement(fM,{cache:v,serialized:E,isStringTag:typeof x=="string"}),F.createElement(x,T))});return g.displayName=i!==void 0?i:"Styled("+(typeof o=="string"?o:o.displayName||o.name||"Component")+")",g.defaultProps=e.defaultProps,g.__emotion_real=g,g.__emotion_base=o,g.__emotion_styles=h,g.__emotion_forwardProp=s,Object.defineProperty(g,"toString",{value:function(){return"."+a}}),g.withComponent=function(y,v){var w=t(y,ee({},n,v,{shouldForwardProp:$b(g,v,!0)}));return w.apply(void 0,h)},g}},pM=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],hy=dM.bind(null);pM.forEach(function(t){hy[t]=hy(t)});function mM(t,e){const n=hT({key:"css",prepend:t});if(e){const r=n.insert;n.insert=(...o)=>(o[1].styles.match(/^@layer\s+[^{]*$/)||(o[1].styles=`@layer mui {${o[1].styles}}`),r(...o))}return n}const Ev=new Map;function vM(t){const{injectFirst:e,enableCssLayer:n,children:r}=t,o=F.useMemo(()=>{const i=`${e}-${n}`;if(typeof document=="object"&&Ev.has(i))return Ev.get(i);const a=mM(e,n);return Ev.set(i,a),a},[e,n]);return e||n?te.jsx(nM,{value:o,children:r}):r}function gM(t){return t==null||Object.keys(t).length===0}function _T(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?o=>e(gM(o)?n:o):e;return te.jsx(sM,{styles:r})}function x1(t,e){return hy(t,e)}const bT=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},Ub=[];function md(t){return Ub[0]=t,Wc(Ub)}const yM=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:_T,StyledEngineProvider:vM,ThemeContext:Mu,css:Fp,default:x1,internal_processStyles:bT,internal_serializeStyles:md,keyframes:Ou},Symbol.toStringTag,{value:"Module"}));function qo(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function ET(t){if(F.isValidElement(t)||!qo(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=ET(t[n])}),e}function eo(t,e,n={clone:!0}){const r=n.clone?ee({},t):t;return qo(t)&&qo(e)&&Object.keys(e).forEach(o=>{F.isValidElement(e[o])?r[o]=e[o]:qo(e[o])&&Object.prototype.hasOwnProperty.call(t,o)&&qo(t[o])?r[o]=eo(t[o],e[o],n):n.clone?r[o]=qo(e[o])?ET(e[o]):e[o]:r[o]=e[o]}),r}const wM=Object.freeze(Object.defineProperty({__proto__:null,default:eo,isPlainObject:qo},Symbol.toStringTag,{value:"Module"})),xM=["values","unit","step"],_M=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ee({},n,{[r.key]:r.val}),{})};function CT(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,o=ut(t,xM),i=_M(e),a=Object.keys(i);function s(f){return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${n})`}function u(f){return`@media (max-width:${(typeof e[f]=="number"?e[f]:f)-r/100}${n})`}function l(f,d){const m=a.indexOf(d);return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${n}) and (max-width:${(m!==-1&&typeof e[a[m]]=="number"?e[a[m]]:d)-r/100}${n})`}function c(f){return a.indexOf(f)+1<a.length?l(f,a[a.indexOf(f)+1]):s(f)}function h(f){const d=a.indexOf(f);return d===0?s(a[1]):d===a.length-1?u(a[d]):l(f,a[a.indexOf(f)+1]).replace("@media","@media not all and")}return ee({keys:a,values:i,up:s,down:u,between:l,only:c,not:h,unit:n},o)}const bM={borderRadius:4};function Wl(t,e){return e?eo(t,e,{clone:!1}):t}const _1={xs:0,sm:600,md:900,lg:1200,xl:1536},zb={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${_1[t]}px)`};function oi(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const i=r.breakpoints||zb;return e.reduce((a,s,u)=>(a[i.up(i.keys[u])]=n(e[u]),a),{})}if(typeof e=="object"){const i=r.breakpoints||zb;return Object.keys(e).reduce((a,s)=>{if(Object.keys(i.values||_1).indexOf(s)!==-1){const u=i.up(s);a[u]=n(e[s],s)}else{const u=s;a[u]=e[u]}return a},{})}return n(e)}function ST(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,o)=>{const i=t.up(o);return r[i]={},r},{}))||{}}function fy(t,e){return t.reduce((n,r)=>{const o=n[r];return(!o||Object.keys(o).length===0)&&delete n[r],n},e)}function eX(t,...e){const n=ST(t),r=[n,...e].reduce((o,i)=>eo(o,i),{});return fy(Object.keys(n),r)}function EM(t,e){if(typeof t!="object")return{};const n={},r=Object.keys(e);return Array.isArray(t)?r.forEach((o,i)=>{i<t.length&&(n[o]=!0)}):r.forEach(o=>{t[o]!=null&&(n[o]=!0)}),n}function tX({values:t,breakpoints:e,base:n}){const r=n||EM(t,e),o=Object.keys(r);if(o.length===0)return t;let i;return o.reduce((a,s,u)=>(Array.isArray(t)?(a[s]=t[u]!=null?t[u]:t[i],i=u):typeof t=="object"?(a[s]=t[s]!=null?t[s]:t[i],i=s):a[s]=t,a),{})}function vt(t){if(typeof t!="string")throw new Error(vc(7));return t.charAt(0).toUpperCase()+t.slice(1)}const CM=Object.freeze(Object.defineProperty({__proto__:null,default:vt},Symbol.toStringTag,{value:"Module"}));function Lp(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((o,i)=>o&&o[i]?o[i]:null,t);if(r!=null)return r}return e.split(".").reduce((r,o)=>r&&r[o]!=null?r[o]:null,t)}function vd(t,e,n,r=n){let o;return typeof t=="function"?o=t(n):Array.isArray(t)?o=t[n]||r:o=Lp(t,n)||r,e&&(o=e(o,r,t)),o}function Lt(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:o}=t,i=a=>{if(a[e]==null)return null;const s=a[e],u=a.theme,l=Lp(u,r)||{};return oi(a,s,h=>{let f=vd(l,o,h);return h===f&&typeof h=="string"&&(f=vd(l,o,`${e}${h==="default"?"":vt(h)}`,h)),n===!1?f:{[n]:f}})};return i.propTypes={},i.filterProps=[e],i}function SM(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const IM={m:"margin",p:"padding"},TM={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Wb={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},RM=SM(t=>{if(t.length>2)if(Wb[t])t=Wb[t];else return[t];const[e,n]=t.split(""),r=IM[e],o=TM[n]||"";return Array.isArray(o)?o.map(i=>r+i):[r+o]}),b1=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],E1=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...b1,...E1];function jc(t,e,n,r){var o;const i=(o=Lp(t,e,!1))!=null?o:n;return typeof i=="number"?a=>typeof a=="string"?a:i*a:Array.isArray(i)?a=>typeof a=="string"?a:i[a]:typeof i=="function"?i:()=>{}}function IT(t){return jc(t,"spacing",8)}function Hc(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function AM(t,e){return n=>t.reduce((r,o)=>(r[o]=Hc(e,n),r),{})}function kM(t,e,n,r){if(e.indexOf(n)===-1)return null;const o=RM(n),i=AM(o,r),a=t[n];return oi(t,a,i)}function TT(t,e){const n=IT(t.theme);return Object.keys(t).map(r=>kM(t,e,r,n)).reduce(Wl,{})}function At(t){return TT(t,b1)}At.propTypes={};At.filterProps=b1;function kt(t){return TT(t,E1)}kt.propTypes={};kt.filterProps=E1;function PM(t=8){if(t.mui)return t;const e=IT({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(i=>{const a=e(i);return typeof a=="number"?`${a}px`:a}).join(" ");return n.mui=!0,n}function Vp(...t){const e=t.reduce((r,o)=>(o.filterProps.forEach(i=>{r[i]=o}),r),{}),n=r=>Object.keys(r).reduce((o,i)=>e[i]?Wl(o,e[i](r)):o,{});return n.propTypes={},n.filterProps=t.reduce((r,o)=>r.concat(o.filterProps),[]),n}function Pr(t){return typeof t!="number"?t:`${t}px solid`}function zr(t,e){return Lt({prop:t,themeKey:"borders",transform:e})}const DM=zr("border",Pr),NM=zr("borderTop",Pr),MM=zr("borderRight",Pr),OM=zr("borderBottom",Pr),FM=zr("borderLeft",Pr),LM=zr("borderColor"),VM=zr("borderTopColor"),BM=zr("borderRightColor"),$M=zr("borderBottomColor"),UM=zr("borderLeftColor"),zM=zr("outline",Pr),WM=zr("outlineColor"),Bp=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=jc(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Hc(e,r)});return oi(t,t.borderRadius,n)}return null};Bp.propTypes={};Bp.filterProps=["borderRadius"];Vp(DM,NM,MM,OM,FM,LM,VM,BM,$M,UM,Bp,zM,WM);const $p=t=>{if(t.gap!==void 0&&t.gap!==null){const e=jc(t.theme,"spacing",8),n=r=>({gap:Hc(e,r)});return oi(t,t.gap,n)}return null};$p.propTypes={};$p.filterProps=["gap"];const Up=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=jc(t.theme,"spacing",8),n=r=>({columnGap:Hc(e,r)});return oi(t,t.columnGap,n)}return null};Up.propTypes={};Up.filterProps=["columnGap"];const zp=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=jc(t.theme,"spacing",8),n=r=>({rowGap:Hc(e,r)});return oi(t,t.rowGap,n)}return null};zp.propTypes={};zp.filterProps=["rowGap"];const jM=Lt({prop:"gridColumn"}),HM=Lt({prop:"gridRow"}),GM=Lt({prop:"gridAutoFlow"}),qM=Lt({prop:"gridAutoColumns"}),KM=Lt({prop:"gridAutoRows"}),XM=Lt({prop:"gridTemplateColumns"}),QM=Lt({prop:"gridTemplateRows"}),YM=Lt({prop:"gridTemplateAreas"}),JM=Lt({prop:"gridArea"});Vp($p,Up,zp,jM,HM,GM,qM,KM,XM,QM,YM,JM);function eu(t,e){return e==="grey"?e:t}const ZM=Lt({prop:"color",themeKey:"palette",transform:eu}),eO=Lt({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:eu}),tO=Lt({prop:"backgroundColor",themeKey:"palette",transform:eu});Vp(ZM,eO,tO);function fr(t){return t<=1&&t!==0?`${t*100}%`:t}const nO=Lt({prop:"width",transform:fr}),C1=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,o;const i=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||_1[n];return i?((o=t.theme)==null||(o=o.breakpoints)==null?void 0:o.unit)!=="px"?{maxWidth:`${i}${t.theme.breakpoints.unit}`}:{maxWidth:i}:{maxWidth:fr(n)}};return oi(t,t.maxWidth,e)}return null};C1.filterProps=["maxWidth"];const rO=Lt({prop:"minWidth",transform:fr}),oO=Lt({prop:"height",transform:fr}),iO=Lt({prop:"maxHeight",transform:fr}),aO=Lt({prop:"minHeight",transform:fr});Lt({prop:"size",cssProperty:"width",transform:fr});Lt({prop:"size",cssProperty:"height",transform:fr});const sO=Lt({prop:"boxSizing"});Vp(nO,C1,rO,oO,iO,aO,sO);const Gc={border:{themeKey:"borders",transform:Pr},borderTop:{themeKey:"borders",transform:Pr},borderRight:{themeKey:"borders",transform:Pr},borderBottom:{themeKey:"borders",transform:Pr},borderLeft:{themeKey:"borders",transform:Pr},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Pr},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Bp},color:{themeKey:"palette",transform:eu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:eu},backgroundColor:{themeKey:"palette",transform:eu},p:{style:kt},pt:{style:kt},pr:{style:kt},pb:{style:kt},pl:{style:kt},px:{style:kt},py:{style:kt},padding:{style:kt},paddingTop:{style:kt},paddingRight:{style:kt},paddingBottom:{style:kt},paddingLeft:{style:kt},paddingX:{style:kt},paddingY:{style:kt},paddingInline:{style:kt},paddingInlineStart:{style:kt},paddingInlineEnd:{style:kt},paddingBlock:{style:kt},paddingBlockStart:{style:kt},paddingBlockEnd:{style:kt},m:{style:At},mt:{style:At},mr:{style:At},mb:{style:At},ml:{style:At},mx:{style:At},my:{style:At},margin:{style:At},marginTop:{style:At},marginRight:{style:At},marginBottom:{style:At},marginLeft:{style:At},marginX:{style:At},marginY:{style:At},marginInline:{style:At},marginInlineStart:{style:At},marginInlineEnd:{style:At},marginBlock:{style:At},marginBlockStart:{style:At},marginBlockEnd:{style:At},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:$p},rowGap:{style:zp},columnGap:{style:Up},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:fr},maxWidth:{style:C1},minWidth:{transform:fr},height:{transform:fr},maxHeight:{transform:fr},minHeight:{transform:fr},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function uO(...t){const e=t.reduce((r,o)=>r.concat(Object.keys(o)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function lO(t,e){return typeof t=="function"?t(e):t}function RT(){function t(n,r,o,i){const a={[n]:r,theme:o},s=i[n];if(!s)return{[n]:r};const{cssProperty:u=n,themeKey:l,transform:c,style:h}=s;if(r==null)return null;if(l==="typography"&&r==="inherit")return{[n]:r};const f=Lp(o,l)||{};return h?h(a):oi(a,r,m=>{let g=vd(f,c,m);return m===g&&typeof m=="string"&&(g=vd(f,c,`${n}${m==="default"?"":vt(m)}`,m)),u===!1?g:{[u]:g}})}function e(n){var r;const{sx:o,theme:i={},nested:a}=n||{};if(!o)return null;const s=(r=i.unstable_sxConfig)!=null?r:Gc;function u(l){let c=l;if(typeof l=="function")c=l(i);else if(typeof l!="object")return l;if(!c)return null;const h=ST(i.breakpoints),f=Object.keys(h);let d=h;return Object.keys(c).forEach(m=>{const g=lO(c[m],i);if(g!=null)if(typeof g=="object")if(s[m])d=Wl(d,t(m,g,i,s));else{const y=oi({theme:i},g,v=>({[m]:v}));uO(y,g)?d[m]=e({sx:g,theme:i,nested:!0}):d=Wl(d,y)}else d=Wl(d,t(m,g,i,s))}),!a&&i.modularCssLayers?{"@layer sx":fy(f,d)}:fy(f,d)}return Array.isArray(o)?o.map(u):u(o)}return e}const Fu=RT();Fu.filterProps=["sx"];function AT(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const cO=["breakpoints","palette","spacing","shape"];function qc(t={},...e){const{breakpoints:n={},palette:r={},spacing:o,shape:i={}}=t,a=ut(t,cO),s=CT(n),u=PM(o);let l=eo({breakpoints:s,direction:"ltr",components:{},palette:ee({mode:"light"},r),spacing:u,shape:ee({},bM,i)},a);return l.applyStyles=AT,l=e.reduce((c,h)=>eo(c,h),l),l.unstable_sxConfig=ee({},Gc,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(h){return Fu({sx:h,theme:this})},l}const hO=Object.freeze(Object.defineProperty({__proto__:null,default:qc,private_createBreakpoints:CT,unstable_applyStyles:AT},Symbol.toStringTag,{value:"Module"}));function fO(t){return Object.keys(t).length===0}function S1(t=null){const e=F.useContext(Mu);return!e||fO(e)?t:e}const dO=qc();function I1(t=dO){return S1(t)}function Cv(t){const e=md(t);return t!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):t}function kT({styles:t,themeId:e,defaultTheme:n={}}){const r=I1(n),o=e&&r[e]||r;let i=typeof t=="function"?t(o):t;return o.modularCssLayers&&(Array.isArray(i)?i=i.map(a=>Cv(typeof a=="function"?a(o):a)):i=Cv(i)),te.jsx(_T,{styles:i})}const pO=["sx"],mO=t=>{var e,n;const r={systemProps:{},otherProps:{}},o=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:Gc;return Object.keys(t).forEach(i=>{o[i]?r.systemProps[i]=t[i]:r.otherProps[i]=t[i]}),r};function T1(t){const{sx:e}=t,n=ut(t,pO),{systemProps:r,otherProps:o}=mO(n);let i;return Array.isArray(e)?i=[r,...e]:typeof e=="function"?i=(...a)=>{const s=e(...a);return qo(s)?ee({},r,s):r}:i=ee({},r,e),ee({},o,{sx:i})}const vO=Object.freeze(Object.defineProperty({__proto__:null,default:Fu,extendSxProp:T1,unstable_createStyleFunctionSx:RT,unstable_defaultSxConfig:Gc},Symbol.toStringTag,{value:"Module"})),jb=t=>t,gO=()=>{let t=jb;return{configure(e){t=e},generate(e){return t(e)},reset(){t=jb}}},PT=gO();function DT(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=DT(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function $t(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=DT(t))&&(r&&(r+=" "),r+=e);return r}const yO=["className","component"];function wO(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:o}=t,i=x1("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})(Fu);return F.forwardRef(function(u,l){const c=I1(n),h=T1(u),{className:f,component:d="div"}=h,m=ut(h,yO);return te.jsx(i,ee({as:d,ref:l,className:$t(f,o?o(r):r),theme:e&&c[e]||c},m))})}const xO={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function fi(t,e,n="Mui"){const r=xO[e];return r?`${n}-${r}`:`${PT.generate(t)}-${e}`}function di(t,e,n="Mui"){const r={};return e.forEach(o=>{r[o]=fi(t,o,n)}),r}var NT={exports:{}},ot={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1=Symbol.for("react.transitional.element"),A1=Symbol.for("react.portal"),Wp=Symbol.for("react.fragment"),jp=Symbol.for("react.strict_mode"),Hp=Symbol.for("react.profiler"),Gp=Symbol.for("react.consumer"),qp=Symbol.for("react.context"),Kp=Symbol.for("react.forward_ref"),Xp=Symbol.for("react.suspense"),Qp=Symbol.for("react.suspense_list"),Yp=Symbol.for("react.memo"),Jp=Symbol.for("react.lazy"),_O=Symbol.for("react.view_transition"),bO=Symbol.for("react.client.reference");function Wr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case R1:switch(t=t.type,t){case Wp:case Hp:case jp:case Xp:case Qp:case _O:return t;default:switch(t=t&&t.$$typeof,t){case qp:case Kp:case Jp:case Yp:return t;case Gp:return t;default:return e}}case A1:return e}}}ot.ContextConsumer=Gp;ot.ContextProvider=qp;ot.Element=R1;ot.ForwardRef=Kp;ot.Fragment=Wp;ot.Lazy=Jp;ot.Memo=Yp;ot.Portal=A1;ot.Profiler=Hp;ot.StrictMode=jp;ot.Suspense=Xp;ot.SuspenseList=Qp;ot.isContextConsumer=function(t){return Wr(t)===Gp};ot.isContextProvider=function(t){return Wr(t)===qp};ot.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===R1};ot.isForwardRef=function(t){return Wr(t)===Kp};ot.isFragment=function(t){return Wr(t)===Wp};ot.isLazy=function(t){return Wr(t)===Jp};ot.isMemo=function(t){return Wr(t)===Yp};ot.isPortal=function(t){return Wr(t)===A1};ot.isProfiler=function(t){return Wr(t)===Hp};ot.isStrictMode=function(t){return Wr(t)===jp};ot.isSuspense=function(t){return Wr(t)===Xp};ot.isSuspenseList=function(t){return Wr(t)===Qp};ot.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Wp||t===Hp||t===jp||t===Xp||t===Qp||typeof t=="object"&&t!==null&&(t.$$typeof===Jp||t.$$typeof===Yp||t.$$typeof===qp||t.$$typeof===Gp||t.$$typeof===Kp||t.$$typeof===bO||t.getModuleId!==void 0)};ot.typeOf=Wr;NT.exports=ot;var Hb=NT.exports;const EO=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function MT(t){const e=`${t}`.match(EO);return e&&e[1]||""}function OT(t,e=""){return t.displayName||t.name||MT(t)||e}function Gb(t,e,n){const r=OT(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function CO(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return OT(t,"Component");if(typeof t=="object")switch(t.$$typeof){case Hb.ForwardRef:return Gb(t,t.render,"ForwardRef");case Hb.Memo:return Gb(t,t.type,"memo");default:return}}}const SO=Object.freeze(Object.defineProperty({__proto__:null,default:CO,getFunctionName:MT},Symbol.toStringTag,{value:"Module"})),IO=["ownerState"],TO=["variants"],RO=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function AO(t){return Object.keys(t).length===0}function kO(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Sv(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function qb(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}const PO=qc(),DO=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Hh({defaultTheme:t,theme:e,themeId:n}){return AO(e)?t:e[n]||e}function NO(t){return t?(e,n)=>n[t]:null}function Df(t,e,n){let{ownerState:r}=e,o=ut(e,IO);const i=typeof t=="function"?t(ee({ownerState:r},o)):t;if(Array.isArray(i))return i.flatMap(a=>Df(a,ee({ownerState:r},o),n));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let u=ut(i,TO);return a.forEach(l=>{let c=!0;if(typeof l.props=="function"?c=l.props(ee({ownerState:r},o,r)):Object.keys(l.props).forEach(h=>{(r==null?void 0:r[h])!==l.props[h]&&o[h]!==l.props[h]&&(c=!1)}),c){Array.isArray(u)||(u=[u]);const h=typeof l.style=="function"?l.style(ee({ownerState:r},o,r)):l.style;u.push(n?qb(md(h),n):h)}}),u}return n?qb(md(i),n):i}function MO(t={}){const{themeId:e,defaultTheme:n=PO,rootShouldForwardProp:r=Sv,slotShouldForwardProp:o=Sv}=t,i=a=>Fu(ee({},a,{theme:Hh(ee({},a,{defaultTheme:n,themeId:e}))}));return i.__mui_systemSx=!0,(a,s={})=>{bT(a,R=>R.filter(C=>!(C!=null&&C.__mui_systemSx)));const{name:u,slot:l,skipVariantsResolver:c,skipSx:h,overridesResolver:f=NO(DO(l))}=s,d=ut(s,RO),m=u&&u.startsWith("Mui")||l?"components":"custom",g=c!==void 0?c:l&&l!=="Root"&&l!=="root"||!1,y=h||!1;let v,w=Sv;l==="Root"||l==="root"?w=r:l?w=o:kO(a)&&(w=void 0);const x=x1(a,ee({shouldForwardProp:w,label:v},d)),_=R=>typeof R=="function"&&R.__emotion_real!==R||qo(R)?C=>{const E=Hh({theme:C.theme,defaultTheme:n,themeId:e});return Df(R,ee({},C,{theme:E}),E.modularCssLayers?m:void 0)}:R,S=(R,...C)=>{let E=_(R);const I=C?C.map(_):[];u&&f&&I.push(P=>{const D=Hh(ee({},P,{defaultTheme:n,themeId:e}));if(!D.components||!D.components[u]||!D.components[u].styleOverrides)return null;const $=D.components[u].styleOverrides,U={};return Object.entries($).forEach(([K,X])=>{U[K]=Df(X,ee({},P,{theme:D}),D.modularCssLayers?"theme":void 0)}),f(P,U)}),u&&!g&&I.push(P=>{var D;const $=Hh(ee({},P,{defaultTheme:n,themeId:e})),U=$==null||(D=$.components)==null||(D=D[u])==null?void 0:D.variants;return Df({variants:U},ee({},P,{theme:$}),$.modularCssLayers?"theme":void 0)}),y||I.push(i);const T=I.length-C.length;if(Array.isArray(R)&&T>0){const P=new Array(T).fill("");E=[...R,...P],E.raw=[...R.raw,...P]}const k=x(E,...I);return a.muiName&&(k.muiName=a.muiName),k};return x.withConfig&&(S.withConfig=x.withConfig),S}}const OO=MO();function gd(t,e){const n=ee({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ee({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const o=t[r]||{},i=e[r];n[r]={},!i||!Object.keys(i)?n[r]=o:!o||!Object.keys(o)?n[r]=i:(n[r]=ee({},i),Object.keys(o).forEach(a=>{n[r][a]=gd(o[a],i[a])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function FO(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:gd(e.components[n].defaultProps,r)}function LO({props:t,name:e,defaultTheme:n,themeId:r}){let o=I1(n);return r&&(o=o[r]||o),FO({theme:o,name:e,props:t})}const FT=typeof window<"u"?F.useLayoutEffect:F.useEffect;function VO(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const BO=Object.freeze(Object.defineProperty({__proto__:null,default:VO},Symbol.toStringTag,{value:"Module"}));function $O(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let Kb=0;function UO(t){const[e,n]=F.useState(t),r=t||e;return F.useEffect(()=>{e==null&&(Kb+=1,n(`mui-${Kb}`))},[e]),r}const Xb=mg.useId;function zO(t){if(Xb!==void 0){const e=Xb();return t??e}return UO(t)}function Gh(t){const e=F.useRef(t);return FT(()=>{e.current=t}),F.useRef((...n)=>(0,e.current)(...n)).current}function dy(...t){return F.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{$O(n,e)})},t)}const Qb={};function WO(t,e){const n=F.useRef(Qb);return n.current===Qb&&(n.current=t(e)),n}const jO=[];function HO(t){F.useEffect(t,jO)}class Zp{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Zp}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function GO(){const t=WO(Zp.create).current;return HO(t.disposeEffect),t}let em=!0,py=!1;const qO=new Zp,KO={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function XO(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&KO[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function QO(t){t.metaKey||t.altKey||t.ctrlKey||(em=!0)}function Iv(){em=!1}function YO(){this.visibilityState==="hidden"&&py&&(em=!0)}function JO(t){t.addEventListener("keydown",QO,!0),t.addEventListener("mousedown",Iv,!0),t.addEventListener("pointerdown",Iv,!0),t.addEventListener("touchstart",Iv,!0),t.addEventListener("visibilitychange",YO,!0)}function ZO(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return em||XO(e)}function eF(){const t=F.useCallback(o=>{o!=null&&JO(o.ownerDocument)},[]),e=F.useRef(!1);function n(){return e.current?(py=!0,qO.start(100,()=>{py=!1}),e.current=!1,!0):!1}function r(o){return ZO(o)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function ma(t,e,n=void 0){const r={};return Object.keys(t).forEach(o=>{r[o]=t[o].reduce((i,a)=>{if(a){const s=e(a);s!==""&&i.push(s),n&&n[a]&&i.push(n[a])}return i},[]).join(" ")}),r}function tF(t){return typeof t=="string"}function nF(t,e,n){return t===void 0||tF(t)?e:ee({},e,{ownerState:ee({},e.ownerState,n)})}function rF(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function Yb(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function oF(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:o,className:i}=t;if(!e){const d=$t(n==null?void 0:n.className,i,o==null?void 0:o.className,r==null?void 0:r.className),m=ee({},n==null?void 0:n.style,o==null?void 0:o.style,r==null?void 0:r.style),g=ee({},n,o,r);return d.length>0&&(g.className=d),Object.keys(m).length>0&&(g.style=m),{props:g,internalRef:void 0}}const a=rF(ee({},o,r)),s=Yb(r),u=Yb(o),l=e(a),c=$t(l==null?void 0:l.className,n==null?void 0:n.className,i,o==null?void 0:o.className,r==null?void 0:r.className),h=ee({},l==null?void 0:l.style,n==null?void 0:n.style,o==null?void 0:o.style,r==null?void 0:r.style),f=ee({},l,n,u,s);return c.length>0&&(f.className=c),Object.keys(h).length>0&&(f.style=h),{props:f,internalRef:l.ref}}function iF(t,e,n){return typeof t=="function"?t(e,n):t}const LT=F.createContext(null);function VT(){return F.useContext(LT)}const aF=typeof Symbol=="function"&&Symbol.for,sF=aF?Symbol.for("mui.nested"):"__THEME_NESTED__";function uF(t,e){return typeof e=="function"?e(t):ee({},t,e)}function lF(t){const{children:e,theme:n}=t,r=VT(),o=F.useMemo(()=>{const i=r===null?n:uF(r,n);return i!=null&&(i[sF]=r!==null),i},[n,r]);return te.jsx(LT.Provider,{value:o,children:e})}const cF=["value"],BT=F.createContext();function hF(t){let{value:e}=t,n=ut(t,cF);return te.jsx(BT.Provider,ee({value:e??!0},n))}const nX=()=>{const t=F.useContext(BT);return t??!1},$T=F.createContext(void 0);function fF({value:t,children:e}){return te.jsx($T.Provider,{value:t,children:e})}function dF(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const o=e.components[n];return o.defaultProps?gd(o.defaultProps,r):!o.styleOverrides&&!o.variants?gd(o,r):r}function pF({props:t,name:e}){const n=F.useContext($T);return dF({props:t,name:e,theme:{components:n}})}function mF(t){const e=S1(),n=zO()||"",{modularCssLayers:r}=t;let o="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!r||e!==null?o="":typeof r=="string"?o=r.replace(/mui(?!\.)/g,o):o=`@layer ${o};`,FT(()=>{const i=document.querySelector("head");if(!i)return;const a=i.firstChild;if(o){var s;if(a&&(s=a.hasAttribute)!=null&&s.call(a,"data-mui-layer-order")&&a.getAttribute("data-mui-layer-order")===n)return;const l=document.createElement("style");l.setAttribute("data-mui-layer-order",n),l.textContent=o,i.prepend(l)}else{var u;(u=i.querySelector(`style[data-mui-layer-order="${n}"]`))==null||u.remove()}},[o,n]),o?te.jsx(kT,{styles:o}):null}const Jb={};function Zb(t,e,n,r=!1){return F.useMemo(()=>{const o=t&&e[t]||e;if(typeof n=="function"){const i=n(o),a=t?ee({},e,{[t]:i}):i;return r?()=>a:a}return t?ee({},e,{[t]:n}):ee({},e,n)},[t,e,n,r])}function vF(t){const{children:e,theme:n,themeId:r}=t,o=S1(Jb),i=VT()||Jb,a=Zb(r,o,n),s=Zb(r,i,n,!0),u=a.direction==="rtl",l=mF(a);return te.jsx(lF,{theme:s,children:te.jsx(Mu.Provider,{value:a,children:te.jsx(hF,{value:u,children:te.jsxs(fF,{value:a==null?void 0:a.components,children:[l,e]})})})})}const gF=["className","component","disableGutters","fixed","maxWidth","classes"],yF=qc(),wF=OO("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${vt(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),xF=t=>LO({props:t,name:"MuiContainer",defaultTheme:yF}),_F=(t,e)=>{const n=u=>fi(e,u),{classes:r,fixed:o,disableGutters:i,maxWidth:a}=t,s={root:["root",a&&`maxWidth${vt(String(a))}`,o&&"fixed",i&&"disableGutters"]};return ma(s,n,r)};function bF(t={}){const{createStyledComponent:e=wF,useThemeProps:n=xF,componentName:r="MuiContainer"}=t,o=e(({theme:a,ownerState:s})=>ee({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!s.disableGutters&&{paddingLeft:a.spacing(2),paddingRight:a.spacing(2),[a.breakpoints.up("sm")]:{paddingLeft:a.spacing(3),paddingRight:a.spacing(3)}}),({theme:a,ownerState:s})=>s.fixed&&Object.keys(a.breakpoints.values).reduce((u,l)=>{const c=l,h=a.breakpoints.values[c];return h!==0&&(u[a.breakpoints.up(c)]={maxWidth:`${h}${a.breakpoints.unit}`}),u},{}),({theme:a,ownerState:s})=>ee({},s.maxWidth==="xs"&&{[a.breakpoints.up("xs")]:{maxWidth:Math.max(a.breakpoints.values.xs,444)}},s.maxWidth&&s.maxWidth!=="xs"&&{[a.breakpoints.up(s.maxWidth)]:{maxWidth:`${a.breakpoints.values[s.maxWidth]}${a.breakpoints.unit}`}}));return F.forwardRef(function(s,u){const l=n(s),{className:c,component:h="div",disableGutters:f=!1,fixed:d=!1,maxWidth:m="lg"}=l,g=ut(l,gF),y=ee({},l,{component:h,disableGutters:f,fixed:d,maxWidth:m}),v=_F(y,r);return te.jsx(o,ee({as:h,ownerState:y,className:$t(v.root,c),ref:u},g))})}function EF(t,e){return ee({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var Vt={},UT={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(UT);var zT=UT.exports;const CF=ci(h3),SF=ci(BO);var WT=zT;Object.defineProperty(Vt,"__esModule",{value:!0});var yd=Vt.alpha=qT;Vt.blend=FF;Vt.colorChannel=void 0;var my=Vt.darken=P1;Vt.decomposeColor=$r;Vt.emphasize=KT;var IF=Vt.getContrastRatio=PF;Vt.getLuminance=wd;Vt.hexToRgb=jT;Vt.hslToRgb=GT;var vy=Vt.lighten=D1;Vt.private_safeAlpha=DF;Vt.private_safeColorChannel=void 0;Vt.private_safeDarken=NF;Vt.private_safeEmphasize=OF;Vt.private_safeLighten=MF;Vt.recomposeColor=Lu;Vt.rgbToHex=kF;var e2=WT(CF),TF=WT(SF);function k1(t,e=0,n=1){return(0,TF.default)(t,e,n)}function jT(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,o)=>o<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function RF(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function $r(t){if(t.type)return t;if(t.charAt(0)==="#")return $r(jT(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,e2.default)(9,t));let r=t.substring(e+1,t.length-1),o;if(n==="color"){if(r=r.split(" "),o=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(o)===-1)throw new Error((0,e2.default)(10,o))}else r=r.split(",");return r=r.map(i=>parseFloat(i)),{type:n,values:r,colorSpace:o}}const HT=t=>{const e=$r(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};Vt.colorChannel=HT;const AF=(t,e)=>{try{return HT(t)}catch{return t}};Vt.private_safeColorChannel=AF;function Lu(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((o,i)=>i<3?parseInt(o,10):o):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function kF(t){if(t.indexOf("#")===0)return t;const{values:e}=$r(t);return`#${e.map((n,r)=>RF(r===3?Math.round(255*n):n)).join("")}`}function GT(t){t=$r(t);const{values:e}=t,n=e[0],r=e[1]/100,o=e[2]/100,i=r*Math.min(o,1-o),a=(l,c=(l+n/30)%12)=>o-i*Math.max(Math.min(c-3,9-c,1),-1);let s="rgb";const u=[Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255)];return t.type==="hsla"&&(s+="a",u.push(e[3])),Lu({type:s,values:u})}function wd(t){t=$r(t);let e=t.type==="hsl"||t.type==="hsla"?$r(GT(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function PF(t,e){const n=wd(t),r=wd(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function qT(t,e){return t=$r(t),e=k1(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Lu(t)}function DF(t,e,n){try{return qT(t,e)}catch{return t}}function P1(t,e){if(t=$r(t),e=k1(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Lu(t)}function NF(t,e,n){try{return P1(t,e)}catch{return t}}function D1(t,e){if(t=$r(t),e=k1(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Lu(t)}function MF(t,e,n){try{return D1(t,e)}catch{return t}}function KT(t,e=.15){return wd(t)>.5?P1(t,e):D1(t,e)}function OF(t,e,n){try{return KT(t,e)}catch{return t}}function FF(t,e,n,r=1){const o=(u,l)=>Math.round((u**(1/r)*(1-n)+l**(1/r)*n)**r),i=$r(t),a=$r(e),s=[o(i.values[0],a.values[0]),o(i.values[1],a.values[1]),o(i.values[2],a.values[2])];return Lu({type:"rgb",values:s})}const LF=["mode","contrastThreshold","tonalOffset"],t2={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:mc.white,default:mc.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Tv={text:{primary:mc.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:mc.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function n2(t,e,n,r){const o=r.light||r,i=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=vy(t.main,o):e==="dark"&&(t.dark=my(t.main,i)))}function VF(t="light"){return t==="dark"?{main:ws[200],light:ws[50],dark:ws[400]}:{main:ws[700],light:ws[400],dark:ws[800]}}function BF(t="light"){return t==="dark"?{main:ys[200],light:ys[50],dark:ys[400]}:{main:ys[500],light:ys[300],dark:ys[700]}}function $F(t="light"){return t==="dark"?{main:gs[500],light:gs[300],dark:gs[700]}:{main:gs[700],light:gs[400],dark:gs[800]}}function UF(t="light"){return t==="dark"?{main:xs[400],light:xs[300],dark:xs[700]}:{main:xs[700],light:xs[500],dark:xs[900]}}function zF(t="light"){return t==="dark"?{main:_s[400],light:_s[300],dark:_s[700]}:{main:_s[800],light:_s[500],dark:_s[900]}}function WF(t="light"){return t==="dark"?{main:wl[400],light:wl[300],dark:wl[700]}:{main:"#ed6c02",light:wl[500],dark:wl[900]}}function jF(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,o=ut(t,LF),i=t.primary||VF(e),a=t.secondary||BF(e),s=t.error||$F(e),u=t.info||UF(e),l=t.success||zF(e),c=t.warning||WF(e);function h(g){return IF(g,Tv.text.primary)>=n?Tv.text.primary:t2.text.primary}const f=({color:g,name:y,mainShade:v=500,lightShade:w=300,darkShade:x=700})=>{if(g=ee({},g),!g.main&&g[v]&&(g.main=g[v]),!g.hasOwnProperty("main"))throw new Error(vc(11,y?` (${y})`:"",v));if(typeof g.main!="string")throw new Error(vc(12,y?` (${y})`:"",JSON.stringify(g.main)));return n2(g,"light",w,r),n2(g,"dark",x,r),g.contrastText||(g.contrastText=h(g.main)),g},d={dark:Tv,light:t2};return eo(ee({common:ee({},mc),mode:e,primary:f({color:i,name:"primary"}),secondary:f({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:f({color:s,name:"error"}),warning:f({color:c,name:"warning"}),info:f({color:u,name:"info"}),success:f({color:l,name:"success"}),grey:c3,contrastThreshold:n,getContrastText:h,augmentColor:f,tonalOffset:r},d[e]),o)}const HF=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function GF(t){return Math.round(t*1e5)/1e5}const r2={textTransform:"uppercase"},o2='"Roboto", "Helvetica", "Arial", sans-serif';function qF(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=o2,fontSize:o=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:s=500,fontWeightBold:u=700,htmlFontSize:l=16,allVariants:c,pxToRem:h}=n,f=ut(n,HF),d=o/14,m=h||(v=>`${v/l*d}rem`),g=(v,w,x,_,S)=>ee({fontFamily:r,fontWeight:v,fontSize:m(w),lineHeight:x},r===o2?{letterSpacing:`${GF(_/w)}em`}:{},S,c),y={h1:g(i,96,1.167,-1.5),h2:g(i,60,1.2,-.5),h3:g(a,48,1.167,0),h4:g(a,34,1.235,.25),h5:g(a,24,1.334,0),h6:g(s,20,1.6,.15),subtitle1:g(a,16,1.75,.15),subtitle2:g(s,14,1.57,.1),body1:g(a,16,1.5,.15),body2:g(a,14,1.43,.15),button:g(s,14,1.75,.4,r2),caption:g(a,12,1.66,.4),overline:g(a,12,2.66,1,r2),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return eo(ee({htmlFontSize:l,pxToRem:m,fontFamily:r,fontSize:o,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:s,fontWeightBold:u},y),f,{clone:!1})}const KF=.2,XF=.14,QF=.12;function gt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${KF})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${XF})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${QF})`].join(",")}const YF=["none",gt(0,2,1,-1,0,1,1,0,0,1,3,0),gt(0,3,1,-2,0,2,2,0,0,1,5,0),gt(0,3,3,-2,0,3,4,0,0,1,8,0),gt(0,2,4,-1,0,4,5,0,0,1,10,0),gt(0,3,5,-1,0,5,8,0,0,1,14,0),gt(0,3,5,-1,0,6,10,0,0,1,18,0),gt(0,4,5,-2,0,7,10,1,0,2,16,1),gt(0,5,5,-3,0,8,10,1,0,3,14,2),gt(0,5,6,-3,0,9,12,1,0,3,16,2),gt(0,6,6,-3,0,10,14,1,0,4,18,3),gt(0,6,7,-4,0,11,15,1,0,4,20,3),gt(0,7,8,-4,0,12,17,2,0,5,22,4),gt(0,7,8,-4,0,13,19,2,0,5,24,4),gt(0,7,9,-4,0,14,21,2,0,5,26,4),gt(0,8,9,-5,0,15,22,2,0,6,28,5),gt(0,8,10,-5,0,16,24,2,0,6,30,5),gt(0,8,11,-5,0,17,26,2,0,6,32,5),gt(0,9,11,-5,0,18,28,2,0,7,34,6),gt(0,9,12,-6,0,19,29,2,0,7,36,6),gt(0,10,13,-6,0,20,31,3,0,8,38,7),gt(0,10,13,-6,0,21,33,3,0,8,40,7),gt(0,10,14,-6,0,22,35,3,0,8,42,7),gt(0,11,14,-7,0,23,36,3,0,9,44,8),gt(0,11,15,-7,0,24,38,3,0,9,46,8)],JF=["duration","easing","delay"],ZF={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},eL={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function i2(t){return`${Math.round(t)}ms`}function tL(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function nL(t){const e=ee({},ZF,t.easing),n=ee({},eL,t.duration);return ee({getAutoHeightDuration:tL,create:(o=["all"],i={})=>{const{duration:a=n.standard,easing:s=e.easeInOut,delay:u=0}=i;return ut(i,JF),(Array.isArray(o)?o:[o]).map(l=>`${l} ${typeof a=="string"?a:i2(a)} ${s} ${typeof u=="string"?u:i2(u)}`).join(",")}},t,{easing:e,duration:n})}const rL={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},oL=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function N1(t={},...e){const{mixins:n={},palette:r={},transitions:o={},typography:i={}}=t,a=ut(t,oL);if(t.vars&&t.generateCssVars===void 0)throw new Error(vc(18));const s=jF(r),u=qc(t);let l=eo(u,{mixins:EF(u.breakpoints,n),palette:s,shadows:YF.slice(),typography:qF(s,i),transitions:nL(o),zIndex:ee({},rL)});return l=eo(l,a),l=e.reduce((c,h)=>eo(c,h),l),l.unstable_sxConfig=ee({},Gc,a==null?void 0:a.unstable_sxConfig),l.unstable_sx=function(h){return Fu({sx:h,theme:this})},l}const XT=N1();var Kc={};const iL=ci(f3);var Rv={exports:{}},a2;function aL(){return a2||(a2=1,function(t){function e(n,r){if(n==null)return{};var o={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(r.indexOf(i)!==-1)continue;o[i]=n[i]}return o}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(Rv)),Rv.exports}const sL=ci(yM),uL=ci(wM),lL=ci(CM),cL=ci(SO),hL=ci(hO),fL=ci(vO);var Vu=zT;Object.defineProperty(Kc,"__esModule",{value:!0});var dL=Kc.default=IL;Kc.shouldForwardProp=Nf;Kc.systemDefaultTheme=void 0;var Tr=Vu(iL),gy=Vu(aL()),xd=xL(sL),pL=uL;Vu(lL);Vu(cL);var mL=Vu(hL),vL=Vu(fL);const gL=["ownerState"],yL=["variants"],wL=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function QT(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(QT=function(r){return r?n:e})(t)}function xL(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=QT(e);if(n&&n.has(t))return n.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=t[i]}return r.default=t,n&&n.set(t,r),r}function _L(t){return Object.keys(t).length===0}function bL(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Nf(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function s2(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}const EL=Kc.systemDefaultTheme=(0,mL.default)(),CL=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function qh({defaultTheme:t,theme:e,themeId:n}){return _L(e)?t:e[n]||e}function SL(t){return t?(e,n)=>n[t]:null}function Mf(t,e,n){let{ownerState:r}=e,o=(0,gy.default)(e,gL);const i=typeof t=="function"?t((0,Tr.default)({ownerState:r},o)):t;if(Array.isArray(i))return i.flatMap(a=>Mf(a,(0,Tr.default)({ownerState:r},o),n));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let u=(0,gy.default)(i,yL);return a.forEach(l=>{let c=!0;if(typeof l.props=="function"?c=l.props((0,Tr.default)({ownerState:r},o,r)):Object.keys(l.props).forEach(h=>{(r==null?void 0:r[h])!==l.props[h]&&o[h]!==l.props[h]&&(c=!1)}),c){Array.isArray(u)||(u=[u]);const h=typeof l.style=="function"?l.style((0,Tr.default)({ownerState:r},o,r)):l.style;u.push(n?s2((0,xd.internal_serializeStyles)(h),n):h)}}),u}return n?s2((0,xd.internal_serializeStyles)(i),n):i}function IL(t={}){const{themeId:e,defaultTheme:n=EL,rootShouldForwardProp:r=Nf,slotShouldForwardProp:o=Nf}=t,i=a=>(0,vL.default)((0,Tr.default)({},a,{theme:qh((0,Tr.default)({},a,{defaultTheme:n,themeId:e}))}));return i.__mui_systemSx=!0,(a,s={})=>{(0,xd.internal_processStyles)(a,R=>R.filter(C=>!(C!=null&&C.__mui_systemSx)));const{name:u,slot:l,skipVariantsResolver:c,skipSx:h,overridesResolver:f=SL(CL(l))}=s,d=(0,gy.default)(s,wL),m=u&&u.startsWith("Mui")||l?"components":"custom",g=c!==void 0?c:l&&l!=="Root"&&l!=="root"||!1,y=h||!1;let v,w=Nf;l==="Root"||l==="root"?w=r:l?w=o:bL(a)&&(w=void 0);const x=(0,xd.default)(a,(0,Tr.default)({shouldForwardProp:w,label:v},d)),_=R=>typeof R=="function"&&R.__emotion_real!==R||(0,pL.isPlainObject)(R)?C=>{const E=qh({theme:C.theme,defaultTheme:n,themeId:e});return Mf(R,(0,Tr.default)({},C,{theme:E}),E.modularCssLayers?m:void 0)}:R,S=(R,...C)=>{let E=_(R);const I=C?C.map(_):[];u&&f&&I.push(P=>{const D=qh((0,Tr.default)({},P,{defaultTheme:n,themeId:e}));if(!D.components||!D.components[u]||!D.components[u].styleOverrides)return null;const $=D.components[u].styleOverrides,U={};return Object.entries($).forEach(([K,X])=>{U[K]=Mf(X,(0,Tr.default)({},P,{theme:D}),D.modularCssLayers?"theme":void 0)}),f(P,U)}),u&&!g&&I.push(P=>{var D;const $=qh((0,Tr.default)({},P,{defaultTheme:n,themeId:e})),U=$==null||(D=$.components)==null||(D=D[u])==null?void 0:D.variants;return Mf({variants:U},(0,Tr.default)({},P,{theme:$}),$.modularCssLayers?"theme":void 0)}),y||I.push(i);const T=I.length-C.length;if(Array.isArray(R)&&T>0){const P=new Array(T).fill("");E=[...R,...P],E.raw=[...R.raw,...P]}const k=x(E,...I);return a.muiName&&(k.muiName=a.muiName),k};return x.withConfig&&(S.withConfig=x.withConfig),S}}function TL(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const RL=t=>TL(t)&&t!=="classes",Hn=dL({themeId:gc,defaultTheme:XT,rootShouldForwardProp:RL}),AL=["theme"];function kL(t){let{theme:e}=t,n=ut(t,AL);const r=e[gc];let o=r||e;return typeof e!="function"&&(r&&!r.vars?o=ee({},r,{vars:null}):e&&!e.vars&&(o=ee({},e,{vars:null}))),te.jsx(vF,ee({},n,{themeId:r?gc:void 0,theme:o}))}const u2=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)};function Lo(t){return pF(t)}function PL(t){return fi("MuiSvgIcon",t)}di("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const DL=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],NL=t=>{const{color:e,fontSize:n,classes:r}=t,o={root:["root",e!=="inherit"&&`color${vt(e)}`,`fontSize${vt(n)}`]};return ma(o,PL,r)},ML=Hn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${vt(n.color)}`],e[`fontSize${vt(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,r,o,i,a,s,u,l,c,h,f,d,m;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(r=n.create)==null?void 0:r.call(n,"fill",{duration:(o=t.transitions)==null||(o=o.duration)==null?void 0:o.shorter}),fontSize:{inherit:"inherit",small:((i=t.typography)==null||(a=i.pxToRem)==null?void 0:a.call(i,20))||"1.25rem",medium:((s=t.typography)==null||(u=s.pxToRem)==null?void 0:u.call(s,24))||"1.5rem",large:((l=t.typography)==null||(c=l.pxToRem)==null?void 0:c.call(l,35))||"2.1875rem"}[e.fontSize],color:(h=(f=(t.vars||t).palette)==null||(f=f[e.color])==null?void 0:f.main)!=null?h:{action:(d=(t.vars||t).palette)==null||(d=d.action)==null?void 0:d.active,disabled:(m=(t.vars||t).palette)==null||(m=m.action)==null?void 0:m.disabled,inherit:void 0}[e.color]}}),yy=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiSvgIcon"}),{children:o,className:i,color:a="inherit",component:s="svg",fontSize:u="medium",htmlColor:l,inheritViewBox:c=!1,titleAccess:h,viewBox:f="0 0 24 24"}=r,d=ut(r,DL),m=F.isValidElement(o)&&o.type==="svg",g=ee({},r,{color:a,component:s,fontSize:u,instanceFontSize:e.fontSize,inheritViewBox:c,viewBox:f,hasSvgAsChild:m}),y={};c||(y.viewBox=f);const v=NL(g);return te.jsxs(ML,ee({as:s,className:$t(v.root,i),focusable:"false",color:l,"aria-hidden":h?void 0:!0,role:h?"img":void 0,ref:n},y,d,m&&o.props,{ownerState:g,children:[m?o.props.children:o,h?te.jsx("title",{children:h}):null]}))});yy.muiName="SvgIcon";function Xc(t,e){function n(r,o){return te.jsx(yy,ee({"data-testid":`${e}Icon`,ref:o},r,{children:t}))}return n.muiName=yy.muiName,F.memo(F.forwardRef(n))}function wy(t,e){return wy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},wy(t,e)}function OL(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,wy(t,e)}const l2=Ms.createContext(null);function FL(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M1(t,e){var n=function(i){return e&&F.isValidElement(i)?e(i):i},r=Object.create(null);return t&&F.Children.map(t,function(o){return o}).forEach(function(o){r[o.key]=n(o)}),r}function LL(t,e){t=t||{},e=e||{};function n(c){return c in e?e[c]:t[c]}var r=Object.create(null),o=[];for(var i in t)i in e?o.length&&(r[i]=o,o=[]):o.push(i);var a,s={};for(var u in e){if(r[u])for(a=0;a<r[u].length;a++){var l=r[u][a];s[r[u][a]]=n(l)}s[u]=n(u)}for(a=0;a<o.length;a++)s[o[a]]=n(o[a]);return s}function Ba(t,e,n){return n[e]!=null?n[e]:t.props[e]}function VL(t,e){return M1(t.children,function(n){return F.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:Ba(n,"appear",t),enter:Ba(n,"enter",t),exit:Ba(n,"exit",t)})})}function BL(t,e,n){var r=M1(t.children),o=LL(e,r);return Object.keys(o).forEach(function(i){var a=o[i];if(F.isValidElement(a)){var s=i in e,u=i in r,l=e[i],c=F.isValidElement(l)&&!l.props.in;u&&(!s||c)?o[i]=F.cloneElement(a,{onExited:n.bind(null,a),in:!0,exit:Ba(a,"exit",t),enter:Ba(a,"enter",t)}):!u&&s&&!c?o[i]=F.cloneElement(a,{in:!1}):u&&s&&F.isValidElement(l)&&(o[i]=F.cloneElement(a,{onExited:n.bind(null,a),in:l.props.in,exit:Ba(a,"exit",t),enter:Ba(a,"enter",t)}))}}),o}var $L=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},UL={component:"div",childFactory:function(e){return e}},O1=function(t){OL(e,t);function e(r,o){var i;i=t.call(this,r,o)||this;var a=i.handleExited.bind(FL(i));return i.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},i}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(o,i){var a=i.children,s=i.handleExited,u=i.firstRender;return{children:u?VL(o,s):BL(o,a,s),firstRender:!1}},n.handleExited=function(o,i){var a=M1(this.props.children);o.key in a||(o.props.onExited&&o.props.onExited(i),this.mounted&&this.setState(function(s){var u=ee({},s.children);return delete u[o.key],{children:u}}))},n.render=function(){var o=this.props,i=o.component,a=o.childFactory,s=ut(o,["component","childFactory"]),u=this.state.contextValue,l=$L(this.state.children).map(a);return delete s.appear,delete s.enter,delete s.exit,i===null?Ms.createElement(l2.Provider,{value:u},l):Ms.createElement(l2.Provider,{value:u},Ms.createElement(i,s,l))},e}(Ms.Component);O1.propTypes={};O1.defaultProps=UL;function zL(t){return fi("MuiPaper",t)}di("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const WL=["className","component","elevation","square","variant"],jL=t=>{const{square:e,elevation:n,variant:r,classes:o}=t,i={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return ma(i,zL,o)},HL=Hn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return ee({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&ee({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${yd("#fff",u2(e.elevation))}, ${yd("#fff",u2(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),GL=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiPaper"}),{className:o,component:i="div",elevation:a=1,square:s=!1,variant:u="elevation"}=r,l=ut(r,WL),c=ee({},r,{component:i,elevation:a,square:s,variant:u}),h=jL(c);return te.jsx(HL,ee({as:i,ownerState:c,className:$t(h.root,o),ref:n},l))}),qL=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],KL=["component","slots","slotProps"],XL=["component"];function c2(t,e){const{className:n,elementType:r,ownerState:o,externalForwardedProps:i,getSlotOwnerState:a,internalForwardedProps:s}=e,u=ut(e,qL),{component:l,slots:c={[t]:void 0},slotProps:h={[t]:void 0}}=i,f=ut(i,KL),d=c[t]||r,m=iF(h[t],o),g=oF(ee({className:n},u,{externalForwardedProps:t==="root"?f:void 0,externalSlotProps:m})),{props:{component:y},internalRef:v}=g,w=ut(g.props,XL),x=dy(v,m==null?void 0:m.ref,e.ref),_=a?a(w):{},S=ee({},o,_),R=t==="root"?y||l:y,C=nF(d,ee({},t==="root"&&!l&&!c[t]&&s,t!=="root"&&!c[t]&&s,w,R&&{as:R},{ref:x}),S);return Object.keys(_).forEach(E=>{delete C[E]}),[d,C]}function QL(t){const{className:e,classes:n,pulsate:r=!1,rippleX:o,rippleY:i,rippleSize:a,in:s,onExited:u,timeout:l}=t,[c,h]=F.useState(!1),f=$t(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),d={width:a,height:a,top:-(a/2)+i,left:-(a/2)+o},m=$t(n.child,c&&n.childLeaving,r&&n.childPulsate);return!s&&!c&&h(!0),F.useEffect(()=>{if(!s&&u!=null){const g=setTimeout(u,l);return()=>{clearTimeout(g)}}},[u,s,l]),te.jsx("span",{className:f,style:d,children:te.jsx("span",{className:m})})}const Rr=di("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),YL=["center","classes","className"];let tm=t=>t,h2,f2,d2,p2;const xy=550,JL=80,ZL=Ou(h2||(h2=tm`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),eV=Ou(f2||(f2=tm`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),tV=Ou(d2||(d2=tm`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),nV=Hn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),rV=Hn(QL,{name:"MuiTouchRipple",slot:"Ripple"})(p2||(p2=tm`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Rr.rippleVisible,ZL,xy,({theme:t})=>t.transitions.easing.easeInOut,Rr.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,Rr.child,Rr.childLeaving,eV,xy,({theme:t})=>t.transitions.easing.easeInOut,Rr.childPulsate,tV,({theme:t})=>t.transitions.easing.easeInOut),oV=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiTouchRipple"}),{center:o=!1,classes:i={},className:a}=r,s=ut(r,YL),[u,l]=F.useState([]),c=F.useRef(0),h=F.useRef(null);F.useEffect(()=>{h.current&&(h.current(),h.current=null)},[u]);const f=F.useRef(!1),d=GO(),m=F.useRef(null),g=F.useRef(null),y=F.useCallback(_=>{const{pulsate:S,rippleX:R,rippleY:C,rippleSize:E,cb:I}=_;l(T=>[...T,te.jsx(rV,{classes:{ripple:$t(i.ripple,Rr.ripple),rippleVisible:$t(i.rippleVisible,Rr.rippleVisible),ripplePulsate:$t(i.ripplePulsate,Rr.ripplePulsate),child:$t(i.child,Rr.child),childLeaving:$t(i.childLeaving,Rr.childLeaving),childPulsate:$t(i.childPulsate,Rr.childPulsate)},timeout:xy,pulsate:S,rippleX:R,rippleY:C,rippleSize:E},c.current)]),c.current+=1,h.current=I},[i]),v=F.useCallback((_={},S={},R=()=>{})=>{const{pulsate:C=!1,center:E=o||S.pulsate,fakeElement:I=!1}=S;if((_==null?void 0:_.type)==="mousedown"&&f.current){f.current=!1;return}(_==null?void 0:_.type)==="touchstart"&&(f.current=!0);const T=I?null:g.current,k=T?T.getBoundingClientRect():{width:0,height:0,left:0,top:0};let P,D,$;if(E||_===void 0||_.clientX===0&&_.clientY===0||!_.clientX&&!_.touches)P=Math.round(k.width/2),D=Math.round(k.height/2);else{const{clientX:U,clientY:K}=_.touches&&_.touches.length>0?_.touches[0]:_;P=Math.round(U-k.left),D=Math.round(K-k.top)}if(E)$=Math.sqrt((2*k.width**2+k.height**2)/3),$%2===0&&($+=1);else{const U=Math.max(Math.abs((T?T.clientWidth:0)-P),P)*2+2,K=Math.max(Math.abs((T?T.clientHeight:0)-D),D)*2+2;$=Math.sqrt(U**2+K**2)}_!=null&&_.touches?m.current===null&&(m.current=()=>{y({pulsate:C,rippleX:P,rippleY:D,rippleSize:$,cb:R})},d.start(JL,()=>{m.current&&(m.current(),m.current=null)})):y({pulsate:C,rippleX:P,rippleY:D,rippleSize:$,cb:R})},[o,y,d]),w=F.useCallback(()=>{v({},{pulsate:!0})},[v]),x=F.useCallback((_,S)=>{if(d.clear(),(_==null?void 0:_.type)==="touchend"&&m.current){m.current(),m.current=null,d.start(0,()=>{x(_,S)});return}m.current=null,l(R=>R.length>0?R.slice(1):R),h.current=S},[d]);return F.useImperativeHandle(n,()=>({pulsate:w,start:v,stop:x}),[w,v,x]),te.jsx(nV,ee({className:$t(Rr.root,i.root,a),ref:g},s,{children:te.jsx(O1,{component:null,exit:!0,children:u})}))});function iV(t){return fi("MuiButtonBase",t)}const aV=di("MuiButtonBase",["root","disabled","focusVisible"]),sV=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],uV=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:o}=t,a=ma({root:["root",e&&"disabled",n&&"focusVisible"]},iV,o);return n&&r&&(a.root+=` ${r}`),a},lV=Hn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${aV.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),cV=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiButtonBase"}),{action:o,centerRipple:i=!1,children:a,className:s,component:u="button",disabled:l=!1,disableRipple:c=!1,disableTouchRipple:h=!1,focusRipple:f=!1,LinkComponent:d="a",onBlur:m,onClick:g,onContextMenu:y,onDragLeave:v,onFocus:w,onFocusVisible:x,onKeyDown:_,onKeyUp:S,onMouseDown:R,onMouseLeave:C,onMouseUp:E,onTouchEnd:I,onTouchMove:T,onTouchStart:k,tabIndex:P=0,TouchRippleProps:D,touchRippleRef:$,type:U}=r,K=ut(r,sV),X=F.useRef(null),V=F.useRef(null),W=dy(V,$),{isFocusVisibleRef:H,onFocus:ne,onBlur:oe,ref:de}=eF(),[me,_e]=F.useState(!1);l&&me&&_e(!1),F.useImperativeHandle(o,()=>({focusVisible:()=>{_e(!0),X.current.focus()}}),[]);const[xe,Ie]=F.useState(!1);F.useEffect(()=>{Ie(!0)},[]);const Pe=xe&&!c&&!l;F.useEffect(()=>{me&&f&&!c&&xe&&V.current.pulsate()},[c,f,me,xe]);function Ee(Se,hs,fs=h){return Gh(_a=>(hs&&hs(_a),!fs&&V.current&&V.current[Se](_a),!0))}const ct=Ee("start",R),Me=Ee("stop",y),je=Ee("stop",v),Fe=Ee("stop",E),tt=Ee("stop",Se=>{me&&Se.preventDefault(),C&&C(Se)}),nt=Ee("start",k),Je=Ee("stop",I),bn=Ee("stop",T),Vn=Ee("stop",Se=>{oe(Se),H.current===!1&&_e(!1),m&&m(Se)},!1),Ge=Gh(Se=>{X.current||(X.current=Se.currentTarget),ne(Se),H.current===!0&&(_e(!0),x&&x(Se)),w&&w(Se)}),it=()=>{const Se=X.current;return u&&u!=="button"&&!(Se.tagName==="A"&&Se.href)},nn=F.useRef(!1),Sr=Gh(Se=>{f&&!nn.current&&me&&V.current&&Se.key===" "&&(nn.current=!0,V.current.stop(Se,()=>{V.current.start(Se)})),Se.target===Se.currentTarget&&it()&&Se.key===" "&&Se.preventDefault(),_&&_(Se),Se.target===Se.currentTarget&&it()&&Se.key==="Enter"&&!l&&(Se.preventDefault(),g&&g(Se))}),Gn=Gh(Se=>{f&&Se.key===" "&&V.current&&me&&!Se.defaultPrevented&&(nn.current=!1,V.current.stop(Se,()=>{V.current.pulsate(Se)})),S&&S(Se),g&&Se.target===Se.currentTarget&&it()&&Se.key===" "&&!Se.defaultPrevented&&g(Se)});let ar=u;ar==="button"&&(K.href||K.to)&&(ar=d);const Dt={};ar==="button"?(Dt.type=U===void 0?"button":U,Dt.disabled=l):(!K.href&&!K.to&&(Dt.role="button"),l&&(Dt["aria-disabled"]=l));const _i=dy(n,de,X),Ir=ee({},r,{centerRipple:i,component:u,disabled:l,disableRipple:c,disableTouchRipple:h,focusRipple:f,tabIndex:P,focusVisible:me}),En=uV(Ir);return te.jsxs(lV,ee({as:ar,className:$t(En.root,s),ownerState:Ir,onBlur:Vn,onClick:g,onContextMenu:Me,onFocus:Ge,onKeyDown:Sr,onKeyUp:Gn,onMouseDown:ct,onMouseLeave:tt,onMouseUp:Fe,onDragLeave:je,onTouchEnd:Je,onTouchMove:bn,onTouchStart:nt,ref:_i,tabIndex:l?-1:P,type:U},Dt,K,{children:[a,Pe?te.jsx(oV,ee({ref:W,center:i},D)):null]}))});function hV(t){return fi("MuiAlert",t)}const m2=di("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function fV(t){return fi("MuiIconButton",t)}const dV=di("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),pV=["edge","children","className","color","disabled","disableFocusRipple","size"],mV=t=>{const{classes:e,disabled:n,color:r,edge:o,size:i}=t,a={root:["root",n&&"disabled",r!=="default"&&`color${vt(r)}`,o&&`edge${vt(o)}`,`size${vt(i)}`]};return ma(a,fV,e)},vV=Hn(cV,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="default"&&e[`color${vt(n.color)}`],n.edge&&e[`edge${vt(n.edge)}`],e[`size${vt(n.size)}`]]}})(({theme:t,ownerState:e})=>ee({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!e.disableRipple&&{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:yd(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.edge==="start"&&{marginLeft:e.size==="small"?-3:-12},e.edge==="end"&&{marginRight:e.size==="small"?-3:-12}),({theme:t,ownerState:e})=>{var n;const r=(n=(t.vars||t).palette)==null?void 0:n[e.color];return ee({},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&e.color!=="default"&&ee({color:r==null?void 0:r.main},!e.disableRipple&&{"&:hover":ee({},r&&{backgroundColor:t.vars?`rgba(${r.mainChannel} / ${t.vars.palette.action.hoverOpacity})`:yd(r.main,t.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),e.size==="small"&&{padding:5,fontSize:t.typography.pxToRem(18)},e.size==="large"&&{padding:12,fontSize:t.typography.pxToRem(28)},{[`&.${dV.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled}})}),gV=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiIconButton"}),{edge:o=!1,children:i,className:a,color:s="default",disabled:u=!1,disableFocusRipple:l=!1,size:c="medium"}=r,h=ut(r,pV),f=ee({},r,{edge:o,color:s,disabled:u,disableFocusRipple:l,size:c}),d=mV(f);return te.jsx(vV,ee({className:$t(d.root,a),centerRipple:!0,focusRipple:!l,disabled:u,ref:n},h,{ownerState:f,children:i}))}),yV=Xc(te.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),wV=Xc(te.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),xV=Xc(te.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),_V=Xc(te.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),bV=Xc(te.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),EV=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],CV=t=>{const{variant:e,color:n,severity:r,classes:o}=t,i={root:["root",`color${vt(n||r)}`,`${e}${vt(n||r)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return ma(i,hV,o)},SV=Hn(GL,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${vt(n.color||n.severity)}`]]}})(({theme:t})=>{const e=t.palette.mode==="light"?my:vy,n=t.palette.mode==="light"?vy:my;return ee({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${r}StandardBg`]:n(t.palette[r].light,.9),[`& .${m2.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.light).map(([r])=>({props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${r}Color`]:e(t.palette[r].light,.6),border:`1px solid ${(t.vars||t).palette[r].light}`,[`& .${m2.icon}`]:t.vars?{color:t.vars.palette.Alert[`${r}IconColor`]}:{color:t.palette[r].main}}})),...Object.entries(t.palette).filter(([,r])=>r.main&&r.dark).map(([r])=>({props:{colorSeverity:r,variant:"filled"},style:ee({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${r}FilledColor`],backgroundColor:t.vars.palette.Alert[`${r}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[r].dark:t.palette[r].main,color:t.palette.getContrastText(t.palette[r].main)})}))]})}),IV=Hn("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),TV=Hn("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),v2=Hn("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),g2={success:te.jsx(yV,{fontSize:"inherit"}),warning:te.jsx(wV,{fontSize:"inherit"}),error:te.jsx(xV,{fontSize:"inherit"}),info:te.jsx(_V,{fontSize:"inherit"})},RV=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiAlert"}),{action:o,children:i,className:a,closeText:s="Close",color:u,components:l={},componentsProps:c={},icon:h,iconMapping:f=g2,onClose:d,role:m="alert",severity:g="success",slotProps:y={},slots:v={},variant:w="standard"}=r,x=ut(r,EV),_=ee({},r,{color:u,severity:g,variant:w,colorSeverity:u||g}),S=CV(_),R={slots:ee({closeButton:l.CloseButton,closeIcon:l.CloseIcon},v),slotProps:ee({},c,y)},[C,E]=c2("closeButton",{elementType:gV,externalForwardedProps:R,ownerState:_}),[I,T]=c2("closeIcon",{elementType:bV,externalForwardedProps:R,ownerState:_});return te.jsxs(SV,ee({role:m,elevation:0,ownerState:_,className:$t(S.root,a),ref:n},x,{children:[h!==!1?te.jsx(IV,{ownerState:_,className:S.icon,children:h||f[g]||g2[g]}):null,te.jsx(TV,{ownerState:_,className:S.message,children:i}),o!=null?te.jsx(v2,{ownerState:_,className:S.action,children:o}):null,o==null&&d?te.jsx(v2,{ownerState:_,className:S.action,children:te.jsx(C,ee({size:"small","aria-label":s,title:s,color:"inherit",onClick:d},E,{children:te.jsx(I,ee({fontSize:"small"},T))}))}):null]}))});function AV(t){return fi("MuiTypography",t)}di("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const kV=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],PV=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:o,variant:i,classes:a}=t,s={root:["root",i,t.align!=="inherit"&&`align${vt(e)}`,n&&"gutterBottom",r&&"noWrap",o&&"paragraph"]};return ma(s,AV,a)},DV=Hn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${vt(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>ee({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),y2={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},NV={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},MV=t=>NV[t]||t,Kh=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiTypography"}),o=MV(r.color),i=T1(ee({},r,{color:o})),{align:a="inherit",className:s,component:u,gutterBottom:l=!1,noWrap:c=!1,paragraph:h=!1,variant:f="body1",variantMapping:d=y2}=i,m=ut(i,kV),g=ee({},i,{align:a,color:o,className:s,component:u,gutterBottom:l,noWrap:c,paragraph:h,variant:f,variantMapping:d}),y=u||(h?"p":d[f]||y2[f])||"span",v=PV(g);return te.jsx(DV,ee({as:y,ref:n,ownerState:g,className:$t(v.root,s)},m))});function OV(t){return te.jsx(kT,ee({},t,{defaultTheme:XT,themeId:gc}))}const FV=di("MuiBox",["root"]),LV=N1(),Xh=wO({themeId:gc,defaultTheme:LV,defaultClassName:FV.root,generateClassName:PT.generate});function VV(t){return fi("MuiCircularProgress",t)}di("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const BV=["className","color","disableShrink","size","style","thickness","value","variant"];let nm=t=>t,w2,x2,_2,b2;const Ai=44,$V=Ou(w2||(w2=nm`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),UV=Ou(x2||(x2=nm`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),zV=t=>{const{classes:e,variant:n,color:r,disableShrink:o}=t,i={root:["root",n,`color${vt(r)}`],svg:["svg"],circle:["circle",`circle${vt(n)}`,o&&"circleDisableShrink"]};return ma(i,VV,e)},WV=Hn("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${vt(n.color)}`]]}})(({ownerState:t,theme:e})=>ee({display:"inline-block"},t.variant==="determinate"&&{transition:e.transitions.create("transform")},t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main}),({ownerState:t})=>t.variant==="indeterminate"&&Fp(_2||(_2=nm`
      animation: ${0} 1.4s linear infinite;
    `),$V)),jV=Hn("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),HV=Hn("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${vt(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(({ownerState:t,theme:e})=>ee({stroke:"currentColor"},t.variant==="determinate"&&{transition:e.transitions.create("stroke-dashoffset")},t.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:t})=>t.variant==="indeterminate"&&!t.disableShrink&&Fp(b2||(b2=nm`
      animation: ${0} 1.4s ease-in-out infinite;
    `),UV)),E2=F.forwardRef(function(e,n){const r=Lo({props:e,name:"MuiCircularProgress"}),{className:o,color:i="primary",disableShrink:a=!1,size:s=40,style:u,thickness:l=3.6,value:c=0,variant:h="indeterminate"}=r,f=ut(r,BV),d=ee({},r,{color:i,disableShrink:a,size:s,thickness:l,value:c,variant:h}),m=zV(d),g={},y={},v={};if(h==="determinate"){const w=2*Math.PI*((Ai-l)/2);g.strokeDasharray=w.toFixed(3),v["aria-valuenow"]=Math.round(c),g.strokeDashoffset=`${((100-c)/100*w).toFixed(3)}px`,y.transform="rotate(-90deg)"}return te.jsx(WV,ee({className:$t(m.root,o),style:ee({width:s,height:s},y,u),ownerState:d,ref:n,role:"progressbar"},v,f,{children:te.jsx(jV,{className:m.svg,ownerState:d,viewBox:`${Ai/2} ${Ai/2} ${Ai} ${Ai}`,children:te.jsx(HV,{className:m.circle,style:g,ownerState:d,cx:Ai,cy:Ai,r:(Ai-l)/2,fill:"none",strokeWidth:l})})}))}),Av=bF({createStyledComponent:Hn("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${vt(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),useThemeProps:t=>Lo({props:t,name:"MuiContainer"})}),GV=(t,e)=>ee({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},e&&!t.vars&&{colorScheme:t.palette.mode}),qV=t=>ee({color:(t.vars||t).palette.text.primary},t.typography.body1,{backgroundColor:(t.vars||t).palette.background.default,"@media print":{backgroundColor:(t.vars||t).palette.common.white}}),KV=(t,e=!1)=>{var n;const r={};e&&t.colorSchemes&&Object.entries(t.colorSchemes).forEach(([a,s])=>{var u;r[t.getColorSchemeSelector(a).replace(/\s*&/,"")]={colorScheme:(u=s.palette)==null?void 0:u.mode}});let o=ee({html:GV(t,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:t.typography.fontWeightBold},body:ee({margin:0},qV(t),{"&::backdrop":{backgroundColor:(t.vars||t).palette.background.default}})},r);const i=(n=t.components)==null||(n=n.MuiCssBaseline)==null?void 0:n.styleOverrides;return i&&(o=[o,i]),o};function XV(t){const e=Lo({props:t,name:"MuiCssBaseline"}),{children:n,enableColorScheme:r=!1}=e;return te.jsxs(F.Fragment,{children:[te.jsx(OV,{styles:o=>KV(o,r)}),n]})}/**
 * react-router v7.9.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var C2="popstate";function QV(t={}){function e(r,o){let{pathname:i,search:a,hash:s}=r.location;return _y("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:_c(o)}return JV(e,n,null,t)}function wt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ur(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function YV(){return Math.random().toString(36).substring(2,10)}function S2(t,e){return{usr:t.state,key:t.key,idx:e}}function _y(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Bu(e):e,state:n,key:e&&e.key||r||YV()}}function _c({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Bu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function JV(t,e,n,r={}){let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s="POP",u=null,l=c();l==null&&(l=0,a.replaceState({...a.state,idx:l},""));function c(){return(a.state||{idx:null}).idx}function h(){s="POP";let y=c(),v=y==null?null:y-l;l=y,u&&u({action:s,location:g.location,delta:v})}function f(y,v){s="PUSH";let w=_y(g.location,y,v);l=c()+1;let x=S2(w,l),_=g.createHref(w);try{a.pushState(x,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;o.location.assign(_)}i&&u&&u({action:s,location:g.location,delta:1})}function d(y,v){s="REPLACE";let w=_y(g.location,y,v);l=c();let x=S2(w,l),_=g.createHref(w);a.replaceState(x,"",_),i&&u&&u({action:s,location:g.location,delta:0})}function m(y){return ZV(y)}let g={get action(){return s},get location(){return t(o,a)},listen(y){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(C2,h),u=y,()=>{o.removeEventListener(C2,h),u=null}},createHref(y){return e(o,y)},createURL:m,encodeLocation(y){let v=m(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:d,go(y){return a.go(y)}};return g}function ZV(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),wt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:_c(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function YT(t,e,n="/"){return eB(t,e,n,!1)}function eB(t,e,n,r){let o=typeof e=="string"?Bu(e):e,i=ii(o.pathname||"/",n);if(i==null)return null;let a=JT(t);tB(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=fB(i);s=cB(a[u],l,r)}return s}function JT(t,e=[],n=[],r="",o=!1){let i=(a,s,u=o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(r)&&u)return;wt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let h=Jo([r,c.relativePath]),f=n.concat(c);a.children&&a.children.length>0&&(wt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),JT(a.children,e,f,h,u)),!(a.path==null&&!a.index)&&e.push({path:h,score:uB(h,a.index),routesMeta:f})};return t.forEach((a,s)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))i(a,s);else for(let l of ZT(a.path))i(a,s,!0,l)}),e}function ZT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=ZT(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>t.startsWith("/")&&u===""?"/":u)}function tB(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:lB(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var nB=/^:[\w-]+$/,rB=3,oB=2,iB=1,aB=10,sB=-2,I2=t=>t==="*";function uB(t,e){let n=t.split("/"),r=n.length;return n.some(I2)&&(r+=sB),e&&(r+=oB),n.filter(o=>!I2(o)).reduce((o,i)=>o+(nB.test(i)?rB:i===""?iB:aB),r)}function lB(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function cB(t,e,n=!1){let{routesMeta:r}=t,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=i==="/"?e:e.slice(i.length)||"/",h=_d({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!h&&l&&n&&!r[r.length-1].route.index&&(h=_d({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!h)return null;Object.assign(o,h.params),a.push({params:o,pathname:Jo([i,h.pathname]),pathnameBase:vB(Jo([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Jo([i,h.pathnameBase]))}return a}function _d(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=hB(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,{paramName:c,isOptional:h},f)=>{if(c==="*"){let m=s[f]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const d=s[f];return h&&!d?l[c]=void 0:l[c]=(d||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:t}}function hB(t,e=!1,n=!0){Ur(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function fB(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ur(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ii(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function dB(t,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?Bu(t):t;return{pathname:n?n.startsWith("/")?n:pB(n,e):e,search:gB(r),hash:yB(o)}}function pB(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function kv(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mB(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function F1(t){let e=mB(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function L1(t,e,n,r=!1){let o;typeof t=="string"?o=Bu(t):(o={...t},wt(!o.pathname||!o.pathname.includes("?"),kv("?","pathname","search",o)),wt(!o.pathname||!o.pathname.includes("#"),kv("#","pathname","hash",o)),wt(!o.search||!o.search.includes("#"),kv("#","search","hash",o)));let i=t===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let h=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;o.pathname=f.join("/")}s=h>=0?e[h]:"/"}let u=dB(o,s),l=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}var Jo=t=>t.join("/").replace(/\/\/+/g,"/"),vB=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),gB=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,yB=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function wB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var eR=["POST","PUT","PATCH","DELETE"];new Set(eR);var xB=["GET",...eR];new Set(xB);var $u=F.createContext(null);$u.displayName="DataRouter";var rm=F.createContext(null);rm.displayName="DataRouterState";F.createContext(!1);var tR=F.createContext({isTransitioning:!1});tR.displayName="ViewTransition";var _B=F.createContext(new Map);_B.displayName="Fetchers";var bB=F.createContext(null);bB.displayName="Await";var io=F.createContext(null);io.displayName="Navigation";var Qc=F.createContext(null);Qc.displayName="Location";var Vo=F.createContext({outlet:null,matches:[],isDataRoute:!1});Vo.displayName="Route";var V1=F.createContext(null);V1.displayName="RouteError";function EB(t,{relative:e}={}){wt(Uu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=F.useContext(io),{hash:o,pathname:i,search:a}=Jc(t,{relative:e}),s=i;return n!=="/"&&(s=i==="/"?n:Jo([n,i])),r.createHref({pathname:s,search:a,hash:o})}function Uu(){return F.useContext(Qc)!=null}function pi(){return wt(Uu(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(Qc).location}var nR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function rR(t){F.useContext(io).static||F.useLayoutEffect(t)}function Yc(){let{isDataRoute:t}=F.useContext(Vo);return t?FB():CB()}function CB(){wt(Uu(),"useNavigate() may be used only in the context of a <Router> component.");let t=F.useContext($u),{basename:e,navigator:n}=F.useContext(io),{matches:r}=F.useContext(Vo),{pathname:o}=pi(),i=JSON.stringify(F1(r)),a=F.useRef(!1);return rR(()=>{a.current=!0}),F.useCallback((u,l={})=>{if(Ur(a.current,nR),!a.current)return;if(typeof u=="number"){n.go(u);return}let c=L1(u,JSON.parse(i),o,l.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Jo([e,c.pathname])),(l.replace?n.replace:n.push)(c,l.state,l)},[e,n,i,o,t])}F.createContext(null);function Jc(t,{relative:e}={}){let{matches:n}=F.useContext(Vo),{pathname:r}=pi(),o=JSON.stringify(F1(n));return F.useMemo(()=>L1(t,JSON.parse(o),r,e==="path"),[t,o,r,e])}function SB(t,e){return oR(t,e)}function oR(t,e,n,r,o){var w;wt(Uu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=F.useContext(io),{matches:a}=F.useContext(Vo),s=a[a.length-1],u=s?s.params:{},l=s?s.pathname:"/",c=s?s.pathnameBase:"/",h=s&&s.route;{let x=h&&h.path||"";iR(l,!h||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let f=pi(),d;if(e){let x=typeof e=="string"?Bu(e):e;wt(c==="/"||((w=x.pathname)==null?void 0:w.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${x.pathname}" was given in the \`location\` prop.`),d=x}else d=f;let m=d.pathname||"/",g=m;if(c!=="/"){let x=c.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=YT(t,{pathname:g});Ur(h||y!=null,`No routes matched location "${d.pathname}${d.search}${d.hash}" `),Ur(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${d.pathname}${d.search}${d.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=kB(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},u,x.params),pathname:Jo([c,i.encodeLocation?i.encodeLocation(x.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Jo([c,i.encodeLocation?i.encodeLocation(x.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:x.pathnameBase])})),a,n,r,o);return e&&v?F.createElement(Qc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...d},navigationType:"POP"}},v):v}function IB(){let t=OB(),e=wB(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=F.createElement(F.Fragment,null,F.createElement("p",null,"💿 Hey developer 👋"),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:i},"ErrorBoundary")," or"," ",F.createElement("code",{style:i},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),n?F.createElement("pre",{style:o},n):null,a)}var TB=F.createElement(IB,null),RB=class extends F.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?F.createElement(Vo.Provider,{value:this.props.routeContext},F.createElement(V1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function AB({routeContext:t,match:e,children:n}){let r=F.useContext($u);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),F.createElement(Vo.Provider,{value:t},n)}function kB(t,e=[],n=null,r=null,o=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,a=n==null?void 0:n.errors;if(a!=null){let l=i.findIndex(c=>c.route.id&&(a==null?void 0:a[c.route.id])!==void 0);wt(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let s=!1,u=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(u=l),c.route.id){let{loaderData:h,errors:f}=n,d=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||d){s=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((l,c,h)=>{let f,d=!1,m=null,g=null;n&&(f=a&&c.route.id?a[c.route.id]:void 0,m=c.route.errorElement||TB,s&&(u<0&&h===0?(iR("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,g=null):u===h&&(d=!0,g=c.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,h+1)),v=()=>{let w;return f?w=m:d?w=g:c.route.Component?w=F.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,F.createElement(AB,{match:c,routeContext:{outlet:l,matches:y,isDataRoute:n!=null},children:w})};return n&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?F.createElement(RB,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0},unstable_onError:r}):v()},null)}function B1(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function PB(t){let e=F.useContext($u);return wt(e,B1(t)),e}function DB(t){let e=F.useContext(rm);return wt(e,B1(t)),e}function NB(t){let e=F.useContext(Vo);return wt(e,B1(t)),e}function $1(t){let e=NB(t),n=e.matches[e.matches.length-1];return wt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function MB(){return $1("useRouteId")}function OB(){var r;let t=F.useContext(V1),e=DB("useRouteError"),n=$1("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function FB(){let{router:t}=PB("useNavigate"),e=$1("useNavigate"),n=F.useRef(!1);return rR(()=>{n.current=!0}),F.useCallback(async(o,i={})=>{Ur(n.current,nR),n.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:e,...i}))},[t,e])}var T2={};function iR(t,e,n){!e&&!T2[t]&&(T2[t]=!0,Ur(!1,n))}F.memo(LB);function LB({routes:t,future:e,state:n,unstable_onError:r}){return oR(t,void 0,n,r,e)}function R2({to:t,replace:e,state:n,relative:r}){wt(Uu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=F.useContext(io);Ur(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=F.useContext(Vo),{pathname:a}=pi(),s=Yc(),u=L1(t,F1(i),a,r==="path"),l=JSON.stringify(u);return F.useEffect(()=>{s(JSON.parse(l),{replace:e,state:n,relative:r})},[s,l,r,e,n]),null}function ur(t){wt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function VB({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:i=!1}){wt(!Uu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),s=F.useMemo(()=>({basename:a,navigator:o,static:i,future:{}}),[a,o,i]);typeof n=="string"&&(n=Bu(n));let{pathname:u="/",search:l="",hash:c="",state:h=null,key:f="default"}=n,d=F.useMemo(()=>{let m=ii(u,a);return m==null?null:{location:{pathname:m,search:l,hash:c,state:h,key:f},navigationType:r}},[a,u,l,c,h,f,r]);return Ur(d!=null,`<Router basename="${a}"> is not able to match the URL "${u}${l}${c}" because it does not start with the basename, so the <Router> won't render anything.`),d==null?null:F.createElement(io.Provider,{value:s},F.createElement(Qc.Provider,{children:e,value:d}))}function BB({children:t,location:e}){return SB(by(t),e)}function by(t,e=[]){let n=[];return F.Children.forEach(t,(r,o)=>{if(!F.isValidElement(r))return;let i=[...e,o];if(r.type===F.Fragment){n.push.apply(n,by(r.props.children,i));return}wt(r.type===ur,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),wt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=by(r.props.children,i)),n.push(a)}),n}var Of="get",Ff="application/x-www-form-urlencoded";function om(t){return t!=null&&typeof t.tagName=="string"}function $B(t){return om(t)&&t.tagName.toLowerCase()==="button"}function UB(t){return om(t)&&t.tagName.toLowerCase()==="form"}function zB(t){return om(t)&&t.tagName.toLowerCase()==="input"}function WB(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function jB(t,e){return t.button===0&&(!e||e==="_self")&&!WB(t)}function Ey(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(o=>[n,o]):[[n,r]])},[]))}function HB(t,e){let n=Ey(t);return e&&e.forEach((r,o)=>{n.has(o)||e.getAll(o).forEach(i=>{n.append(o,i)})}),n}var Qh=null;function GB(){if(Qh===null)try{new FormData(document.createElement("form"),0),Qh=!1}catch{Qh=!0}return Qh}var qB=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Pv(t){return t!=null&&!qB.has(t)?(Ur(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ff}"`),null):t}function KB(t,e){let n,r,o,i,a;if(UB(t)){let s=t.getAttribute("action");r=s?ii(s,e):null,n=t.getAttribute("method")||Of,o=Pv(t.getAttribute("enctype"))||Ff,i=new FormData(t)}else if($B(t)||zB(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||s.getAttribute("action");if(r=u?ii(u,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Of,o=Pv(t.getAttribute("formenctype"))||Pv(s.getAttribute("enctype"))||Ff,i=new FormData(s,t),!GB()){let{name:l,type:c,value:h}=t;if(c==="image"){let f=l?`${l}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else l&&i.append(l,h)}}else{if(om(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Of,r=null,o=Ff,a=t}return i&&o==="text/plain"&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:i,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function U1(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function XB(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&ii(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function QB(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YB(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function JB(t,e,n){let r=await Promise.all(t.map(async o=>{let i=e.routes[o.route.id];if(i){let a=await QB(i,n);return a.links?a.links():[]}return[]}));return n5(r.flat(1).filter(YB).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function A2(t,e,n,r,o,i){let a=(u,l)=>n[l]?u.route.id!==n[l].route.id:!0,s=(u,l)=>{var c;return n[l].pathname!==u.pathname||((c=n[l].route.path)==null?void 0:c.endsWith("*"))&&n[l].params["*"]!==u.params["*"]};return i==="assets"?e.filter((u,l)=>a(u,l)||s(u,l)):i==="data"?e.filter((u,l)=>{var h;let c=r.routes[u.route.id];if(!c||!c.hasLoader)return!1;if(a(u,l)||s(u,l))return!0;if(u.route.shouldRevalidate){let f=u.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function ZB(t,e,{includeHydrateFallback:n}={}){return e5(t.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let i=[o.module];return o.clientActionModule&&(i=i.concat(o.clientActionModule)),o.clientLoaderModule&&(i=i.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(i=i.concat(o.hydrateFallbackModule)),o.imports&&(i=i.concat(o.imports)),i}).flat(1))}function e5(t){return[...new Set(t)]}function t5(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function n5(t,e){let n=new Set;return new Set(e),t.reduce((r,o)=>{let i=JSON.stringify(t5(o));return n.has(i)||(n.add(i),r.push({key:i,link:o})),r},[])}function aR(){let t=F.useContext($u);return U1(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function r5(){let t=F.useContext(rm);return U1(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var z1=F.createContext(void 0);z1.displayName="FrameworkContext";function sR(){let t=F.useContext(z1);return U1(t,"You must render this element inside a <HydratedRouter> element"),t}function o5(t,e){let n=F.useContext(z1),[r,o]=F.useState(!1),[i,a]=F.useState(!1),{onFocus:s,onBlur:u,onMouseEnter:l,onMouseLeave:c,onTouchStart:h}=e,f=F.useRef(null);F.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let g=v=>{v.forEach(w=>{a(w.isIntersecting)})},y=new IntersectionObserver(g,{threshold:.5});return f.current&&y.observe(f.current),()=>{y.disconnect()}}},[t]),F.useEffect(()=>{if(r){let g=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(g)}}},[r]);let d=()=>{o(!0)},m=()=>{o(!1),a(!1)};return n?t!=="intent"?[i,f,{}]:[i,f,{onFocus:_l(s,d),onBlur:_l(u,m),onMouseEnter:_l(l,d),onMouseLeave:_l(c,m),onTouchStart:_l(h,d)}]:[!1,f,{}]}function _l(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function i5({page:t,...e}){let{router:n}=aR(),r=F.useMemo(()=>YT(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?F.createElement(s5,{page:t,matches:r,...e}):null}function a5(t){let{manifest:e,routeModules:n}=sR(),[r,o]=F.useState([]);return F.useEffect(()=>{let i=!1;return JB(t,e,n).then(a=>{i||o(a)}),()=>{i=!0}},[t,e,n]),r}function s5({page:t,matches:e,...n}){let r=pi(),{manifest:o,routeModules:i}=sR(),{basename:a}=aR(),{loaderData:s,matches:u}=r5(),l=F.useMemo(()=>A2(t,e,u,o,r,"data"),[t,e,u,o,r]),c=F.useMemo(()=>A2(t,e,u,o,r,"assets"),[t,e,u,o,r]),h=F.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let m=new Set,g=!1;if(e.forEach(v=>{var x;let w=o.routes[v.route.id];!w||!w.hasLoader||(!l.some(_=>_.route.id===v.route.id)&&v.route.id in s&&((x=i[v.route.id])!=null&&x.shouldRevalidate)||w.hasClientLoader?g=!0:m.add(v.route.id))}),m.size===0)return[];let y=XB(t,a,"data");return g&&m.size>0&&y.searchParams.set("_routes",e.filter(v=>m.has(v.route.id)).map(v=>v.route.id).join(",")),[y.pathname+y.search]},[a,s,r,o,l,e,t,i]),f=F.useMemo(()=>ZB(c,o),[c,o]),d=a5(c);return F.createElement(F.Fragment,null,h.map(m=>F.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...n})),f.map(m=>F.createElement("link",{key:m,rel:"modulepreload",href:m,...n})),d.map(({key:m,link:g})=>F.createElement("link",{key:m,nonce:n.nonce,...g})))}function u5(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var uR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uR&&(window.__reactRouterVersion="7.9.3")}catch{}function l5({basename:t,children:e,window:n}){let r=F.useRef();r.current==null&&(r.current=QV({window:n,v5Compat:!0}));let o=r.current,[i,a]=F.useState({action:o.action,location:o.location}),s=F.useCallback(u=>{F.startTransition(()=>a(u))},[a]);return F.useLayoutEffect(()=>o.listen(s),[o,s]),F.createElement(VB,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:o})}var lR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cR=F.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:i,replace:a,state:s,target:u,to:l,preventScrollReset:c,viewTransition:h,...f},d){let{basename:m}=F.useContext(io),g=typeof l=="string"&&lR.test(l),y,v=!1;if(typeof l=="string"&&g&&(y=l,uR))try{let I=new URL(window.location.href),T=l.startsWith("//")?new URL(I.protocol+l):new URL(l),k=ii(T.pathname,m);T.origin===I.origin&&k!=null?l=k+T.search+T.hash:v=!0}catch{Ur(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=EB(l,{relative:o}),[x,_,S]=o5(r,f),R=d5(l,{replace:a,state:s,target:u,preventScrollReset:c,relative:o,viewTransition:h});function C(I){e&&e(I),I.defaultPrevented||R(I)}let E=F.createElement("a",{...f,...S,href:y||w,onClick:v||i?e:C,ref:u5(d,_),target:u,"data-discover":!g&&n==="render"?"true":void 0});return x&&!g?F.createElement(F.Fragment,null,E,F.createElement(i5,{page:w})):E});cR.displayName="Link";var c5=F.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:i,to:a,viewTransition:s,children:u,...l},c){let h=Jc(a,{relative:l.relative}),f=pi(),d=F.useContext(rm),{navigator:m,basename:g}=F.useContext(io),y=d!=null&&y5(h)&&s===!0,v=m.encodeLocation?m.encodeLocation(h).pathname:h.pathname,w=f.pathname,x=d&&d.navigation&&d.navigation.location?d.navigation.location.pathname:null;n||(w=w.toLowerCase(),x=x?x.toLowerCase():null,v=v.toLowerCase()),x&&g&&(x=ii(x,g)||x);const _=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let S=w===v||!o&&w.startsWith(v)&&w.charAt(_)==="/",R=x!=null&&(x===v||!o&&x.startsWith(v)&&x.charAt(v.length)==="/"),C={isActive:S,isPending:R,isTransitioning:y},E=S?e:void 0,I;typeof r=="function"?I=r(C):I=[r,S?"active":null,R?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let T=typeof i=="function"?i(C):i;return F.createElement(cR,{...l,"aria-current":E,className:I,ref:c,style:T,to:a,viewTransition:s},typeof u=="function"?u(C):u)});c5.displayName="NavLink";var h5=F.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:i,method:a=Of,action:s,onSubmit:u,relative:l,preventScrollReset:c,viewTransition:h,...f},d)=>{let m=v5(),g=g5(s,{relative:l}),y=a.toLowerCase()==="get"?"get":"post",v=typeof s=="string"&&lR.test(s),w=x=>{if(u&&u(x),x.defaultPrevented)return;x.preventDefault();let _=x.nativeEvent.submitter,S=(_==null?void 0:_.getAttribute("formmethod"))||a;m(_||x.currentTarget,{fetcherKey:e,method:S,navigate:n,replace:o,state:i,relative:l,preventScrollReset:c,viewTransition:h})};return F.createElement("form",{ref:d,method:y,action:g,onSubmit:r?u:w,...f,"data-discover":!v&&t==="render"?"true":void 0})});h5.displayName="Form";function f5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hR(t){let e=F.useContext($u);return wt(e,f5(t)),e}function d5(t,{target:e,replace:n,state:r,preventScrollReset:o,relative:i,viewTransition:a}={}){let s=Yc(),u=pi(),l=Jc(t,{relative:i});return F.useCallback(c=>{if(jB(c,e)){c.preventDefault();let h=n!==void 0?n:_c(u)===_c(l);s(t,{replace:h,state:r,preventScrollReset:o,relative:i,viewTransition:a})}},[u,s,l,n,r,e,t,o,i,a])}function rX(t){Ur(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=F.useRef(Ey(t)),n=F.useRef(!1),r=pi(),o=F.useMemo(()=>HB(r.search,n.current?null:e.current),[r.search]),i=Yc(),a=F.useCallback((s,u)=>{const l=Ey(typeof s=="function"?s(new URLSearchParams(o)):s);n.current=!0,i("?"+l,u)},[i,o]);return[o,a]}var p5=0,m5=()=>`__${String(++p5)}__`;function v5(){let{router:t}=hR("useSubmit"),{basename:e}=F.useContext(io),n=MB();return F.useCallback(async(r,o={})=>{let{action:i,method:a,encType:s,formData:u,body:l}=KB(r,e);if(o.navigate===!1){let c=o.fetcherKey||m5();await t.fetch(c,n,o.action||i,{preventScrollReset:o.preventScrollReset,formData:u,body:l,formMethod:o.method||a,formEncType:o.encType||s,flushSync:o.flushSync})}else await t.navigate(o.action||i,{preventScrollReset:o.preventScrollReset,formData:u,body:l,formMethod:o.method||a,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,e,n])}function g5(t,{relative:e}={}){let{basename:n}=F.useContext(io),r=F.useContext(Vo);wt(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),i={...Jc(t||".",{relative:e})},a=pi();if(t==null){i.search=a.search;let s=new URLSearchParams(i.search),u=s.getAll("index");if(u.some(c=>c==="")){s.delete("index"),u.filter(h=>h).forEach(h=>s.append("index",h));let c=s.toString();i.search=c?`?${c}`:""}}return(!t||t===".")&&o.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Jo([n,i.pathname])),_c(i)}function y5(t,{relative:e}={}){let n=F.useContext(tR);wt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=hR("useViewTransitionState"),o=Jc(t,{relative:e});if(!n.isTransitioning)return!1;let i=ii(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=ii(n.nextLocation.pathname,r)||n.nextLocation.pathname;return _d(o.pathname,a)!=null||_d(o.pathname,i)!=null}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fR=function(t,e){return(fR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(t,e)};function ao(t,e){function n(){this.constructor=t}fR(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function he(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(t,[])).next())})}function fe(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(h){c=[6,h],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var w5=function(){function t(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(e,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=e,this.platform=n},t.prototype.registerFlag=function(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){var o=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+o+"."),this.set(e,o)}},t.prototype.get=function(e){return e in this.flags?this.flags[e]:(this.flags[e]=this.evaluateFlag(e),this.flags[e])},t.prototype.getNumber=function(e){return this.get(e)},t.prototype.getBool=function(e){return this.get(e)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(e,n){if(this.flagRegistry[e]==null)throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)},t.prototype.evaluateFlag=function(e){if(this.flagRegistry[e]==null)throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},t.prototype.setFlags=function(e){this.flags=Object.assign({},e)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var e=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return x5(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];e.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},t}();function x5(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Q(){return dR}var dR=null,bd=new Map,Cy=new Map;function pR(t,e){var n=vR(t,e);return bd.get(n)}function _5(t){return Cy.get(t)}function k2(t){for(var e=bd.entries(),n=[];;){var r=e.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===t&&n.push(s)}return n}function mR(t){var e=t.kernelName,n=t.backendName,r=vR(e,n);if(bd.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");bd.set(r,t)}function b5(t){var e=t.kernelName;Cy.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),Cy.set(e,t)}function vR(t,e){return e+"_"+t}function Sy(t,e,n){return Math.max(t,Math.min(e,n))}function gR(t){return t%2==0?t:t+1}function E5(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function O(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Ye(t,e,n){n===void 0&&(n=""),O(ln(t,e),function(){return n+" Shapes "+t+" and "+e+" must match"})}function zu(t){O(t!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function xu(t,e,n){if(e===void 0&&(e=[]),n===void 0&&(n=!1),e==null&&(e=[]),Array.isArray(t)||To(t)&&!n)for(var r=0;r<t.length;++r)xu(t[r],e,n);else e.push(t);return e}function pe(t){if(t.length===0)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function ln(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Ft(t){return t%1==0}function C5(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function Iy(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function tu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function P2(t,e,n){return e===void 0&&(e=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(t())r();else{i++;var s=e(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function S5(t,e){for(var n=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found "+t[o]+" at dim "+o);if(r===-1){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(n===0)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function tn(t,e){var n=e.length;return O((t=t==null?e.map(function(r,o){return o}):[].concat(t)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t}),O(t.every(function(r){return Ft(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?n+r:r})}function Oa(t,e){for(var n=[],r=[],o=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||o?null:tn(e,t).sort(),a=0,s=0;s<t.length;++s){if(i!=null){if(i[a]===s&&t[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(i[a]==null||i[a]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[a]<=s&&a++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function bc(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else{if(t!=="bool")throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function Ed(t,e){var n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else{if(t!=="string")throw new Error("Unknown data type "+t);n=new Array(e)}return n}function I5(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function T5(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function R5(t,e){return e!=="complex64"&&(e!=="float32"||t==="complex64")&&(e!=="int32"||t==="float32"||t==="complex64")&&(e!=="bool"||t!=="bool")}function To(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function yR(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error("Unknown dtype "+t)}function A5(t){if(t==null)return 0;var e=0;return t.forEach(function(n){return e+=n.length}),e}function W1(t){return typeof t=="string"||t instanceof String}function k5(t){return typeof t=="boolean"}function P5(t){return typeof t=="number"}function Zc(t){return Array.isArray(t)?Zc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":P5(t)?"float32":W1(t)?"string":k5(t)?"bool":"float32"}function Ty(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Ry(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Ro(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function wR(t,e,n){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=xu(t)),n&&I5(t,e),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)Math.round(t[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+e)}function D2(t,e){if(t.length===0)return e[0];var n=t.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),h=c.reduce(function(f,d){return f*d});for(l=0;l<u;l++)s[l]=r(o+l*h,c,a)}return s}(0,t,e)}function xR(t,e){for(var n=eh(t,e),r=0;r<n.length;r++)n[r]=1;return n}function eh(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error("Unknown data type "+e)}function wo(){return Q().platform.now()}function _R(t){t.forEach(function(e){O(Number.isInteger(e)&&e>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function D5(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Q().platform.encode(t,e)}function Cd(t,e){return e===void 0&&(e="utf-8"),e=e||"utf-8",Q().platform.decode(t,e)}function N2(t,e,n){if(e===0)return 0;if(e===1)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=n[o]*t[o];return r}function N5(t,e,n){if(e===0)return[];if(e===1)return[t];for(var r=new Array(e),o=0;o<r.length-1;++o)r[o]=Math.floor(t/n[o]),t-=r[o]*n[o];return r[r.length-1]=t,r}var M5=function(){function t(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new O5)}return t.prototype.profileKernel=function(e,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,h){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var d=l[f];if(isNaN(d)||!isFinite(d))return console.warn("Found "+d+" in the result of '"+h+"'"),!0}})(u,s.dtype,e),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(e,s,u,l.kernelMs,n,c)})})}),o},t}(),O5=function(){function t(){}return t.prototype.logKernelProfile=function(e,n,r,o,i,a){var s=typeof o=="number"?tu(o+"ms",9):o.error,u=tu(e,25),l=n.rank,c=n.size,h=tu(n.shape.toString(),14),f="";for(var d in i){var m=i[d].shape||n.shape,g=m.length;f+=d+": "+g+"D "+(g>0?m:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+h+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),M2=20,bl=3,Dv=7;function F5(t,e,n,r){var o=Ro(e),i=function(l,c,h,f){var d=pe(c),m=f[f.length-1],g=new Array(m).fill(0),y=c.length,v=h==="complex64"?Cl(l):l;if(y>1)for(var w=0;w<d/m;w++)for(var x=w*m,_=0;_<m;_++)g[_]=Math.max(g[_],El(v[x+_],0,h).length);return g}(t,e,n,o),a=e.length,s=function l(c,h,f,d,m,g){g===void 0&&(g=!0);var y=f==="complex64"?2:1,v=h[0],w=h.length;if(w===0)return f==="complex64"?[El(Cl(c)[0],0,f)]:f==="bool"?[bR(c[0])]:[c[0].toString()];if(w===1){if(v>M2){var x=bl*y,_=Array.from(c.slice(0,x)),S=Array.from(c.slice((v-bl)*y,v*y));return f==="complex64"&&(_=Cl(_),S=Cl(S)),["["+_.map(function(U,K){return El(U,m[K],f)}).join(", ")+", ..., "+S.map(function(U,K){return El(U,m[v-bl+K],f)}).join(", ")+"]"]}return["["+(f==="complex64"?Cl(c):Array.from(c)).map(function(U,K){return El(U,m[K],f)}).join(", ")+"]"]}var R=h.slice(1),C=d.slice(1),E=d[0]*y,I=[];if(v>M2){for(var T=0;T<bl;T++){var k=(P=T*E)+E;I.push.apply(I,l(c.slice(P,k),R,f,C,m,!1))}for(I.push("..."),T=v-bl;T<v;T++)k=(P=T*E)+E,I.push.apply(I,l(c.slice(P,k),R,f,C,m,T===v-1))}else for(T=0;T<v;T++){var P;k=(P=T*E)+E,I.push.apply(I,l(c.slice(P,k),R,f,C,m,T===v-1))}var D=w===2?",":"";for(I[0]="["+I[0]+D,T=1;T<I.length-1;T++)I[T]=" "+I[T]+D;var $=`,
`;for(T=2;T<w;T++)$+=`
`;return I[I.length-1]=" "+I[I.length-1]+"]"+(g?"":$),I}(t,e,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function El(t,e,n){return tu(Array.isArray(t)?parseFloat(t[0].toFixed(Dv))+" + "+parseFloat(t[1].toFixed(Dv))+"j":W1(t)?"'"+t+"'":n==="bool"?bR(t):parseFloat(t.toFixed(Dv)).toString(),e)}function bR(t){return t===0?"false":"true"}function Cl(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var Ec=function(){function t(e,n,r){var o=this;if(this.dtype=n,this.shape=e.slice(),this.size=pe(e),r!=null){var i=r.length;O(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ed(n,this.size),this.strides=Ro(e)}return t.prototype.set=function(e){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),O(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=e},t.prototype.get=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.length===0&&(e=[0]);for(var r=0,o=0,i=e;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=e[e.length-1],l=0;l<e.length-1;++l)u+=this.strides[l]*e[l];return this.values[u]},t.prototype.locToIndex=function(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n},t.prototype.indexToLoc=function(e){if(this.rank===0)return[];if(this.rank===1)return[e];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return _o().makeTensor(this.values,this.shape,this.dtype)},t}(),_o=null,q=null,ER=null,_t=function(){function t(e,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=pe(e),this.strides=Ro(e),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),O(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(e,n){return this.throwIfDisposed(),this.reshape([e,n])},t.prototype.as3D=function(e,n,r){return this.throwIfDisposed(),this.reshape([e,n,r])},t.prototype.as4D=function(e,n,r,o){return this.throwIfDisposed(),this.reshape([e,n,r,o])},t.prototype.as5D=function(e,n,r,o,i){return this.throwIfDisposed(),this.reshape([e,n,r,o,i])},t.prototype.asType=function(e){return this.throwIfDisposed(),q.cast(this,e)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return he(this,void 0,void 0,function(){var e;return fe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,q.buffer(this.shape,this.dtype,e)]}})})},t.prototype.bufferSync=function(){return q.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return he(this,void 0,void 0,function(){var e;return fe(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return e=n.sent(),[2,D2(this.shape,e)]}})})},t.prototype.arraySync=function(){return D2(this.shape,this.dataSync())},t.prototype.data=function(){return he(this,void 0,void 0,function(){var e,n;return fe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),e=_o().read(this.dataId),this.dtype!=="string"?[3,2]:[4,e];case 1:n=r.sent();try{return[2,n.map(function(o){return Cd(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,e]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var e=_o().readSync(this.dataId);if(this.dtype==="string")try{return e.map(function(n){return Cd(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},t.prototype.bytes=function(){return he(this,void 0,void 0,function(){var e;return fe(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,_o().read(this.dataId)];case 1:return e=n.sent(),this.dtype==="string"?[2,e]:[2,new Uint8Array(e.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(_o().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(e){return e===void 0&&(e=!1),q.print(this,e)},t.prototype.reshape=function(e){return this.throwIfDisposed(),q.reshape(this,e)},t.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},t.prototype.expandDims=function(e){return e===void 0&&(e=0),q.expandDims(this,e)},t.prototype.cumsum=function(e,n,r){return e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1),q.cumsum(this,e,n,r)},t.prototype.squeeze=function(e){return this.throwIfDisposed(),q.squeeze(this,e)},t.prototype.clone=function(){return this.throwIfDisposed(),q.clone(this)},t.prototype.oneHot=function(e,n,r){return this.throwIfDisposed(),q.oneHot(this,e,n,r)},t.prototype.toString=function(e){return e===void 0&&(e=!1),F5(this.dataSync(),this.shape,this.dtype,e)},t.prototype.tile=function(e){return this.throwIfDisposed(),q.tile(this,e)},t.prototype.gather=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.gather(this,e,n)},t.prototype.matMul=function(e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),q.matMul(this,e,n,r)},t.prototype.dot=function(e){return this.throwIfDisposed(),q.dot(this,e)},t.prototype.norm=function(e,n,r){return e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),q.norm(this,e,n,r)},t.prototype.slice=function(e,n){return this.throwIfDisposed(),q.slice(this,e,n)},t.prototype.reverse=function(e){return this.throwIfDisposed(),q.reverse(this,e)},t.prototype.concat=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),q.concat([this].concat(e),n)},t.prototype.split=function(e,n){return n===void 0&&(n=0),this.throwIfDisposed(),q.split(this,e,n)},t.prototype.stack=function(e,n){return n===void 0&&(n=0),q.stack([this,e],n)},t.prototype.unstack=function(e){return e===void 0&&(e=0),q.unstack(this,e)},t.prototype.pad=function(e,n){return n===void 0&&(n=0),q.pad(this,e,n)},t.prototype.batchNormalization=function(e,n,r,o,i){return r===void 0&&(r=.001),ER("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,n,i,o,r)},t.prototype.batchNorm=function(e,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),q.batchNorm(this,e,n,r,o,i)},t.prototype.all=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.all(this,e,n)},t.prototype.any=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.any(this,e,n)},t.prototype.logSumExp=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.logSumExp(this,e,n)},t.prototype.sum=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.sum(this,e,n)},t.prototype.prod=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.prod(this,e,n)},t.prototype.mean=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.mean(this,e,n)},t.prototype.min=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.min(this,e,n)},t.prototype.max=function(e,n){return e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),q.max(this,e,n)},t.prototype.argMin=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),q.argMin(this,e)},t.prototype.argMax=function(e){return e===void 0&&(e=null),this.throwIfDisposed(),q.argMax(this,e)},t.prototype.cast=function(e){return this.throwIfDisposed(),q.cast(this,e)},t.prototype.add=function(e){return this.throwIfDisposed(),q.add(this,e)},t.prototype.addStrict=function(e){return this.throwIfDisposed(),q.addStrict(this,e)},t.prototype.atan2=function(e){return this.throwIfDisposed(),q.atan2(this,e)},t.prototype.sub=function(e){return this.throwIfDisposed(),q.sub(this,e)},t.prototype.subStrict=function(e){return this.throwIfDisposed(),q.subStrict(this,e)},t.prototype.pow=function(e){return this.throwIfDisposed(),q.pow(this,e)},t.prototype.powStrict=function(e){return this.throwIfDisposed(),q.powStrict(this,e)},t.prototype.mul=function(e){return this.throwIfDisposed(),q.mul(this,e)},t.prototype.mulStrict=function(e){return this.throwIfDisposed(),q.mulStrict(this,e)},t.prototype.div=function(e){return this.throwIfDisposed(),q.div(this,e)},t.prototype.divNoNan=function(e){return this.throwIfDisposed(),q.divNoNan(this,e)},t.prototype.floorDiv=function(e){return this.throwIfDisposed(),q.floorDiv(this,e)},t.prototype.divStrict=function(e){return this.throwIfDisposed(),q.divStrict(this,e)},t.prototype.minimum=function(e){return this.throwIfDisposed(),q.minimum(this,e)},t.prototype.minimumStrict=function(e){return this.throwIfDisposed(),q.minimumStrict(this,e)},t.prototype.maximum=function(e){return this.throwIfDisposed(),q.maximum(this,e)},t.prototype.maximumStrict=function(e){return this.throwIfDisposed(),q.maximumStrict(this,e)},t.prototype.mod=function(e){return this.throwIfDisposed(),q.mod(this,e)},t.prototype.modStrict=function(e){return this.throwIfDisposed(),q.modStrict(this,e)},t.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),q.squaredDifferenceStrict(this,e)},t.prototype.transpose=function(e){return this.throwIfDisposed(),q.transpose(this,e)},t.prototype.notEqual=function(e){return this.throwIfDisposed(),q.notEqual(this,e)},t.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),q.notEqualStrict(this,e)},t.prototype.less=function(e){return this.throwIfDisposed(),q.less(this,e)},t.prototype.lessStrict=function(e){return this.throwIfDisposed(),q.lessStrict(this,e)},t.prototype.equal=function(e){return this.throwIfDisposed(),q.equal(this,e)},t.prototype.equalStrict=function(e){return this.throwIfDisposed(),q.equalStrict(this,e)},t.prototype.lessEqual=function(e){return this.throwIfDisposed(),q.lessEqual(this,e)},t.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),q.lessEqualStrict(this,e)},t.prototype.greater=function(e){return this.throwIfDisposed(),q.greater(this,e)},t.prototype.greaterStrict=function(e){return this.throwIfDisposed(),q.greaterStrict(this,e)},t.prototype.greaterEqual=function(e){return this.throwIfDisposed(),q.greaterEqual(this,e)},t.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),q.greaterEqualStrict(this,e)},t.prototype.logicalAnd=function(e){return this.throwIfDisposed(),q.logicalAnd(this,e)},t.prototype.logicalOr=function(e){return this.throwIfDisposed(),q.logicalOr(this,e)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),q.logicalNot(this)},t.prototype.logicalXor=function(e){return this.throwIfDisposed(),q.logicalXor(this,e)},t.prototype.where=function(e,n){return this.throwIfDisposed(),q.where(e,this,n)},t.prototype.neg=function(){return this.throwIfDisposed(),q.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),q.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),q.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),q.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),q.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),q.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),q.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),q.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),q.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),q.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),q.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),q.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),q.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),q.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),q.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),q.abs(this)},t.prototype.clipByValue=function(e,n){return this.throwIfDisposed(),q.clipByValue(this,e,n)},t.prototype.relu=function(){return this.throwIfDisposed(),q.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),q.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),q.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),q.selu(this)},t.prototype.leakyRelu=function(e){return e===void 0&&(e=.2),this.throwIfDisposed(),q.leakyRelu(this,e)},t.prototype.prelu=function(e){return this.throwIfDisposed(),q.prelu(this,e)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),q.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),q.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),q.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),q.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),q.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),q.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),q.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),q.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),q.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),q.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),q.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),q.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),q.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),q.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),q.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),q.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),q.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),q.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),q.round(this)},t.prototype.step=function(e){return e===void 0&&(e=0),this.throwIfDisposed(),q.step(this,e)},t.prototype.softmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),q.softmax(this,e)},t.prototype.logSoftmax=function(e){return e===void 0&&(e=-1),this.throwIfDisposed(),q.logSoftmax(this,e)},t.prototype.resizeBilinear=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeBilinear(this,e,n)},t.prototype.resizeNearestNeighbor=function(e,n){return n===void 0&&(n=!1),this.throwIfDisposed(),q.image.resizeNearestNeighbor(this,e,n)},t.prototype.conv1d=function(e,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),q.conv1d(this,e,n,r,o,i,a)},t.prototype.conv2d=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),q.conv2d(this,e,n,r,o,i,a)},t.prototype.conv2dTranspose=function(e,n,r,o,i){return this.throwIfDisposed(),q.conv2dTranspose(this,e,n,r,o,i)},t.prototype.depthwiseConv2D=function(e,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),q.depthwiseConv2d(this,e,n,r,o,i,a)},t.prototype.separableConv2d=function(e,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),q.separableConv2d(this,e,n,r,o,i,a)},t.prototype.avgPool=function(e,n,r,o){return this.throwIfDisposed(),q.avgPool(this,e,n,r,o)},t.prototype.maxPool=function(e,n,r,o){return this.throwIfDisposed(),q.maxPool(this,e,n,r,o)},t.prototype.localResponseNormalization=function(e,n,r,o){return e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),q.localResponseNormalization(this,e,n,r,o)},t.prototype.pool=function(e,n,r,o,i){return this.throwIfDisposed(),q.pool(this,e,n,r,o,i)},t.prototype.variable=function(e,n,r){return e===void 0&&(e=!0),this.throwIfDisposed(),_o().makeVariable(this,e,n,r)},t.prototype.unsortedSegmentSum=function(e,n){return this.throwIfDisposed(),q.unsortedSegmentSum(this,e,n)},t.prototype.batchToSpaceND=function(e,n){return this.throwIfDisposed(),q.batchToSpaceND(this,e,n)},t.prototype.spaceToBatchND=function(e,n){return this.throwIfDisposed(),q.spaceToBatchND(this,e,n)},t.prototype.topk=function(e,n){return e===void 0&&(e=1),n===void 0&&(n=!0),this.throwIfDisposed(),q.topk(this,e,n)},t.prototype.stridedSlice=function(e,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),q.stridedSlice(this,e,n,r,o,i,a,s,u)},t.prototype.depthToSpace=function(e,n){return this.throwIfDisposed(),q.depthToSpace(this,e,n)},t.prototype.fft=function(){return this.throwIfDisposed(),q.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),q.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),q.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),q.spectral.irfft(this)},t}();Object.defineProperty(_t,Symbol.hasInstance,{value:function(t){return!!t&&t.dataId!=null&&t.shape!=null&&t.dtype!=null}});var O2,Ay,ky,Py,Dy,_u=function(t){function e(n,r,o,i){var a=t.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return ao(e,t),e.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!ln(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");_o().disposeTensor(this),this.dataId=n.dataId,_o().incRef(this,null)},e.prototype.dispose=function(){_o().disposeVariable(this),this.isDisposedInternal=!0},e}(_t);Object.defineProperty(_u,Symbol.hasInstance,{value:function(t){return t instanceof _t&&t.assign!=null&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(O2||(O2={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(Ay||(Ay={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(ky||(ky={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Py||(Py={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Dy||(Dy={}));var L5={float32:Py,int32:Ay,bool:ky,complex64:Dy};function pn(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error("Can not upcast "+t+" with "+e)}return L5[t][e]}function Nv(t){return pn(t,"int32")}function St(t,e){if(t.dtype===e.dtype)return[t,e];var n=pn(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function V5(t,e){O(t.dtype===e.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"})}function CR(t){var e=[];return function n(r,o,i){if(r!=null){if(r instanceof _t)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(t,e,new Set),e}var Mv,F2=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},t}(),B5=function(){function t(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new F2}return t.prototype.ready=function(){return he(this,void 0,void 0,function(){var e,n,r;return fe(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];e=this.getSortedBackends(),n=0,o.label=1;case 1:return n<e.length?(r=e[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var e=this.initializeBackendsAndReturnBest(),n=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(e){return!(e in this.registry)&&(!(e in this.registryFactory)||this.initializeBackend(e).asyncInit)?null:this.registry[e]},t.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},t.prototype.registerBackend=function(e,n,r){return r===void 0&&(r=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:n,priority:r},!0)},t.prototype.setBackend=function(e){return he(this,void 0,void 0,function(){var n,r,o;return fe(this,function(i){switch(i.label){case 0:if(this.registryFactory[e]==null)throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,this.registry[e]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(e),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new M5(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var e=this;k2(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(e.backendInstance)})},t.prototype.disposeRegisteredKernels=function(e){var n=this;k2(e).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[e])})},t.prototype.initializeBackend=function(e){var n=this,r=this.registryFactory[e];if(r==null)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[e]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+e+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var e=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return e.registryFactory[r].priority-e.registryFactory[n].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),n=0;n<e.length;n++){var r=e[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(e,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=e,e.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(e,n){var r,o=this,i=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(e,n,r){e();try{var o=r();return n(),o}catch(i){throw n(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(e){var n=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},t.prototype.runKernel=function(e,n,r,o,i){return this.runKernelFunc(null,n,null,e,r,o,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(e,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+e+"'")},t.prototype.runKernelFunc=function(e,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],h=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,d=function(w){h&&(c=w.map(function(x){return l.keep(l.clone(x))}))},m=this.state.numBytes,g=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var y,v=pR(o,this.backendName);return f=v!=null?function(){var w=l.backend.numDataIds();y=v.kernelFunc({inputs:n,attrs:i,backend:l.backend});var x=Array.isArray(y)?y:[y];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,w,x);var _=x.map(function(R){var C=R.dataId,E=R.shape,I=R.dtype;return l.makeTensorFromDataId(C,E,I)}),S=_.filter(function(R,C){return s[C]});return d((a||[]).slice().concat(S)),_}:function(){var w=l.backend.numDataIds();y=l.tidy(function(){return e(l.backend,d)});var x=Array.isArray(y)?y:[y];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,w,x),x},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),h&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-g,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(w){return n[w].shape}),outputShapes:u.map(function(w){return w.shape})}),Array.isArray(y)?u:u[0]},t.prototype.makeTensor=function(e,n,r,o){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=e;r==="string"&&W1(e[0])&&(i=e.map(function(c){return D5(c)}));var a=o.write(i,n,r),s=new _t(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=A5(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},t.prototype.makeTensorFromDataId=function(e,n,r,o){var i=new _t(n,r=r||"float32",e,this.nextTensorId());return this.incRef(i,o),i},t.prototype.makeVariable=function(e,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==e.dtype&&(e=e.asType(o));var i=new _u(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(e,n){var r=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(o=e.size*yR(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof _u||this.track(e)},t.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,e.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(e.dataId);n.refCount<=1?(e.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var n=this.state.registeredVariables[e];this.disposeVariable(n)}},t.prototype.disposeVariable=function(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]},t.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},t.prototype.profile=function(e){return he(this,void 0,void 0,function(){var n,r;return fe(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},t.prototype.addTapeNode=function(e,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},u=_5(e);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,h){if(c==null){var f=r[h],d=eh(f.size,f.dtype);return a.makeTensor(d,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(e){return e.kept=!0,e},t.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(e){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n},t.prototype.endScope=function(e){for(var n=this,r=CR(e),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},t.prototype.gradients=function(e,n,r,o){var i=this;if(o===void 0&&(o=!1),O(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",e)});O(a instanceof _t,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var h={},f={},d=0;d<l.length;d++)h[l[d].id]=!0;for(d=0;d<u.length;d++){var m=(R=u[d]).inputs;for(var g in m){for(var y=m[g],v=!1,w=0;w<l.length;w++)if(h[y.id]){R.outputs.forEach(function(T){return h[T.id]=!0}),v=!0,f[R.id]=!0;break}if(v)break}}var x={};x[c.id]=!0;var _={};for(d=u.length-1;d>=0;d--)for(m=(R=u[d]).inputs,w=0;w<R.outputs.length;w++)if(x[R.outputs[w].id]){for(var g in m)x[m[g].id]=!0,_[R.id]=!0;break}var S=[];for(d=0;d<u.length;d++){var R;if(f[(R=u[d]).id]&&_[R.id]){var C={};for(var g in R.inputs){var E=R.inputs[g];h[E.id]&&(C[g]=E)}var I=Object.assign({},R);I.inputs=C,I.outputs=R.outputs,S.push(I)}}return S}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=xR(pe(u),"float32"),B.makeTensor(l,u,"float32")),function(f,d,m){for(var g=function(v){var w=d[v],x=[];if(w.outputs.forEach(function(C){var E=f[C.id];E!=null?x.push(E):x.push(null)}),w.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+w.kernelName+".");var _=w.gradient(x),S=function(C){if(!(C in _))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(_)+".");var E=m(function(){return _[C]()});if(E.dtype!=="float32")throw new Error("Error in gradient for op "+w.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+E.dtype+"'");var I=w.inputs[C];if(!ln(E.shape,I.shape))throw new Error("Error in gradient for op "+w.kernelName+". The gradient of input '"+C+"' has shape '"+E.shape+"', which does not match the shape of the input '"+I.shape+"'");if(f[I.id]==null)f[I.id]=E;else{var T=f[I.id];f[I.id]=T.add(E),T.dispose()}};for(var R in w.inputs)S(R)},y=d.length-1;y>=0;y--)g(y)}(c,s,function(f){return i.tidy(f)});var h=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var d=0,m=f.saved;d<m.length;d++)m[d].dispose()}),i.state.activeTape=null),{value:a,grads:h}})},t.prototype.customGrad=function(e){var n=this;return O(Ty(e),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];O(o.every(function(s){return s instanceof _t}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return O((r=e.apply(void 0,o.concat([u]))).value instanceof _t,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),O(Ty(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];O(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),O(c.every(function(f){return f instanceof _t}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var h={};return c.forEach(function(f,d){h[d]=function(){return f}}),h})}},t.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},t.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},t.prototype.time=function(e){return he(this,void 0,void 0,function(){var n,r;return fe(this,function(o){switch(o.label){case 0:return n=wo(),[4,this.backend.time(e)];case 1:return(r=o.sent()).wallMs=wo()-n,[2,r]}})})},t.prototype.track=function(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new F2,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),B=function(){var t=function(){if(Mv==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}Mv=n}return Mv}();if(t._tfengine==null){var e=new w5(t);t._tfengine=new B5(e)}return function(n){dR=n}(t._tfengine.ENV),_o=function(){return t._tfengine},t._tfengine}();function SR(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Wo=Q();Wo.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Wo.registerFlag("IS_BROWSER",function(){return SR()}),Wo.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Wo.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Wo.registerFlag("PROD",function(){return!1}),Wo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Wo.getBool("DEBUG")}),Wo.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Wo.registerFlag("IS_TEST",function(){return!1});var Cc,pr,hr,Da={},Ov={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $5(t,e){Da[t]=e}function Bo(t){t in Da||(Da[t]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Da[n]},!1),n===1?r.getContext("webgl",Ov)||r.getContext("experimental-webgl",Ov):r.getContext("webgl2",Ov)}(t));var e=Da[t];return e.isContextLost()?(delete Da[t],Bo(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Da[t])}function im(t,e){return[e,t]}function jl(t){var e=pe(t);return Iy(Math.ceil(e/4))}function th(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function j1(t,e){var n,r,o,i,a,s,u,l,c,h=t;return Q().getNumber("WEBGL_VERSION")===2?(n=h.R32F,r=h.R16F,o=h.RGBA16F,i=h.RGBA32F,a=h.RED,s=4,u=1,l=h.HALF_FLOAT,c=h.FLOAT):(n=t.RGBA,r=t.RGBA,o=t.RGBA,i=h.RGBA,a=t.RGBA,s=4,u=4,l=e!=null?e.HALF_FLOAT_OES:null,c=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ve(t,e,n){var r=n();return e&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+j5(o,i))}(t),r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Cc||(Cc={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(pr||(pr={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(hr||(hr={}));var U5=596e-10,z5=65504;function W5(t){return!!(Q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||U5<Math.abs(t)&&Math.abs(t)<z5)}function j5(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Yh(t,e,n){return mi(t,e,function(){return t.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function H5(t,e,n){var r=mi(t,e,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ve(t,e,function(){return t.shaderSource(r,n)}),ve(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function G5(t,e,n){var r=mi(t,e,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ve(t,e,function(){return t.shaderSource(r,n)}),ve(t,e,function(){return t.compileShader(r)}),t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw function(o,i){var a=q5.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(y,v){return tu((v+1).toString(),l)+y}),h=0,f=0;f<c.length;f++)h=Math.max(c[f].length,h);var d=c.slice(0,s-1),m=c.slice(s-1,s),g=c.slice(s);console.log(d.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+tu(m[0],h),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Fv,Lv,q5=/ERROR: [0-9]+:([0-9]+):/g;function K5(t,e){return mi(t,e,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function X5(t,e,n){if(ve(t,e,function(){return t.linkProgram(n)}),t.getProgramParameter(n,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Vv(t,e,n){if(ve(t,e,function(){return t.validateProgram(n)}),t.getProgramParameter(n,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Q5(t,e,n){var r=mi(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return ve(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),ve(t,e,function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function Y5(t,e,n){var r=mi(t,e,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return ve(t,e,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),ve(t,e,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)}),r}function J5(t,e){return mi(t,e,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function Z5(t,e){var n=Q().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function e6(t,e){return mi(t,e,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function L2(t,e,n,r,o,i,a,s){var u=t.getAttribLocation(n,r);return u!==-1&&(ve(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,o)}),ve(t,e,function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,a,s)}),ve(t,e,function(){return t.enableVertexAttribArray(u)}),!0)}function t6(t,e,n,r){a6(t,r),ve(t,e,function(){return t.activeTexture(t.TEXTURE0+r)}),ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)})}function n6(t,e,n,r){return mi(t,e,function(){return t.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function r6(t,e,n){return t.getUniformLocation(e,n)}function o6(t,e,n,r,o,i){ve(t,e,function(){return t6(t,e,r,i)}),ve(t,e,function(){return t.uniform1i(o,i)})}function Bv(t,e,n,r){ve(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),ve(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)})}function V2(t,e,n){ve(t,e,function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)}),ve(t,e,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function Jh(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+i6(t,e))}function i6(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function mi(t,e,n,r){var o=ve(t,e,function(){return n()});if(o==null)throw new Error(r);return o}function a6(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Sd(t,e){return e===void 0&&(e=2),pe(t.slice(0,t.length-e))}function Id(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function $v(t){var e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Sd(t)].concat(Id(t))),e}function s6(t,e){var n;e===void 0&&(e=!1);var r=Q().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,(t=t.map(function(l,c){return c>=t.length-2?gR(t[c]):t[c]})).length===1&&(t=[2,t[0]])),t.length!==2){var o=Oa(t);t=o.newShape}var i=pe(t);if(t.length<=1&&i<=r)return[1,i];if(t.length===2&&t[0]<=r&&t[1]<=r)return t;if(t.length===3&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(t.length===3&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(t.length===4&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(t.length===4&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=Sd(t),s=2,u=2;return t.length&&(s=(n=Id(t))[0],u=n[1]),Iy(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return Iy(i)}function Zh(t){return t%2==0}function ef(t,e){if(ln(t=t.slice(-2),e=e.slice(-2))||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||Zh(n)&&Zh(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Zh(t[0])&&Zh(e[0])}function u6(t){if(Fv==null){var e=Bo(t);Fv=e.getParameter(e.MAX_TEXTURE_SIZE)}return Fv}function l6(t){if(Lv==null){var e=Bo(t);Lv=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Lv)}function c6(t){if(t===0)return 0;var e=Bo(t);return Fr(e,"EXT_disjoint_timer_query_webgl2")&&t===2?2:Fr(e,"EXT_disjoint_timer_query")?1:0}function Fr(t,e){return t.getExtension(e)!=null}function B2(t){try{if(Bo(t)!=null)return!0}catch{return!1}return!1}function h6(t){if(t===0)return!1;var e=Bo(t);if(t===1){if(!Fr(e,"OES_texture_float"))return!1}else if(!Fr(e,"EXT_color_buffer_float"))return!1;return Ny(e)}function f6(t){if(t===0)return!1;var e=Bo(t);if(t!==1){if(Fr(e,"EXT_color_buffer_float"))return Ny(e);if(Fr(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=j1(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(e,n)}return!1}return!!Fr(e,"OES_texture_float")&&!!Fr(e,"WEBGL_color_buffer_float")&&Ny(e)}function Ny(t){var e=j1(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),o}function d6(t){return t===2&&Bo(t).fenceSync!=null}var Ce=Q();function IR(t){Q().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function le(t,e){return B.tidy(t,e)}function nr(t){CR(t).forEach(function(e){return e.dispose()})}function p6(t){return B.keep(t)}function Td(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Q().getBool("IS_TEST")||console.warn.apply(console,t)}function va(t,e){var n=t;if(To(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||To(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&Q().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!To(i))return void O(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});O(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),O(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(t,r,[]),r}function $2(t,e,n,r){if(t!=null&&(t!=="numeric"&&t!==e||t==="numeric"&&e==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function N(t,e,n,r){if(r===void 0&&(r="numeric"),t instanceof _t)return $2(r,t.dtype,e,n),t;var o=Zc(t);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),$2(r,o,e,n),t==null||!To(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){var i=t==null?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=va(t,o);To(t)||Array.isArray(t)||(t=[t]);var s=o!=="string"?wR(t,o,Q().getBool("DEBUG")):xu(t,[],!0);return B.makeTensor(s,a,o)}function Rd(t,e,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(o,i){return N(o,e+"["+i+"]",n)},r)}function TR(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function m6(t,e,n){for(var r=t.length+e.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(t[i++]):o.push(e[a++]);return o}function Rn(t,e){for(var n=[],r=t.length,o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);return[n,e.map(function(i){return t[i]})]}function or(t,e){return m6(t,e.map(function(n){return 1}),e)}function cr(t,e,n){O(TR(e,n),function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."})}function $o(t,e){if(TR(t,e))return null;for(var n=[],r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(function(o){return n.push(o)}),n}function H1(t){return t.map(function(e,n){return[n,e]}).sort(function(e,n){return e[1]-n[1]}).map(function(e){return e[0]})}function Uo(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function v6(t,e){var n=t[0].length;t.forEach(function(o,i){O(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),O(e>=0&&e<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=t[0];t.forEach(function(o,i){for(var a=0;a<n;a++)O(a===e||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function bu(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function L(t){var e=Object.keys(t);if(e.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];B.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),B.endScope(s),s}catch(u){throw B.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}Ce.registerFlag("HAS_WEBGL",function(){return Ce.getNumber("WEBGL_VERSION")>0}),Ce.registerFlag("WEBGL_VERSION",function(){return B2(2)?2:B2(1)?1:0}),Ce.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ce.get("WEBGL_VERSION")===2}),Ce.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ce.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ce.registerFlag("WEBGL_PACK",function(){return Ce.getBool("HAS_WEBGL")}),Ce.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_CLIP",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ce.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_PACK_REDUCE",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_CONV_IM2COL",function(){return Ce.getBool("WEBGL_PACK")}),Ce.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return u6(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return l6(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=Ce.getNumber("WEBGL_VERSION");return t===0?0:c6(t)}),Ce.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ce.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),Ce.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return h6(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ce.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ce.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ce.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return f6(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return d6(Ce.getNumber("WEBGL_VERSION"))}),Ce.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ce.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),ER=IR;var dn=L({complex_:function(t,e){var n=N(t,"real","complex"),r=N(e,"imag","complex");return Ye(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),B.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Nr=L({real_:function(t){var e=N(t,"input","real");return B.runKernelFunc(function(n){return n.real(e)},{$input:e})}}),bo=L({imag_:function(t){var e=N(t,"input","imag");return B.runKernelFunc(function(n){return n.imag(e)},{$input:e})}});function gn(t,e,n){return ga(t,e,va(t,n),n)}function ga(t,e,n,r){if(r==null&&(r=Zc(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!To(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){_R(e);var o=pe(e),i=pe(n);O(o===i,function(){return"Based on the provided shape, ["+e+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==pe(e.slice(a));O(n[a]===e[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "})}}return To(t)||Array.isArray(t)||(t=[t]),e=e||n,t=r!=="string"?wR(t,r,Q().getBool("DEBUG")):xu(t,[],!0),B.makeTensor(t,e,r)}function ae(t,e){if((To(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&To(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ga(t,[],[],e)}function Wt(t,e){zu(t);var n=va(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ga(t,null,n,e)}function Xi(t,e,n){if(zu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=va(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ga(t,e,r,n)}function G1(t,e,n){if(zu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=va(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ga(t,e,r,n)}function Xn(t,e,n){if(zu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=va(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ga(t,e,r,n)}function g6(t,e,n){if(zu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=va(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ga(t,e,r,n)}function y6(t,e,n){if(zu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=va(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ga(t,e=e||r,r,n)}function w6(t,e,n,r){return e===void 0&&(e=!0),B.makeVariable(t,e,n,r)}function Wu(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=Wu(t,"float32"),r=dt(t,"float32");return dn(n,r)}var o=xR(pe(t),e);return B.makeTensor(o,t,e)}function dt(t,e){if(e===void 0&&(e="float32"),e==="complex64"){var n=dt(t,"float32"),r=dt(t,"float32");return dn(n,r)}var o=eh(pe(t),e);return B.makeTensor(o,t,e)}function Ao(t,e,n){return B.runKernelFunc(function(r){return r.fill(t,e,n)},{})}function x6(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return B.runKernelFunc(function(r){return r.linspace(t,e,n)},{})}function Ad(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return dt([0],r);var o=eh(Math.abs(Math.ceil((e-t)/n)),r);e<t&&n===1&&(n=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return Wt(o,r)}var RR=L({onesLike_:function(t){var e=N(t,"x","onesLike");if(e.dtype==="complex64"){var n=RR(Nr(e)),r=We(bo(e));return dn(n,r)}return B.runKernelFunc(function(o){return o.onesLike(e)},{$x:e},function(o,i){return{$x:function(){return We(o)}}})}}),We=L({zerosLike_:function(t){var e=N(t,"x","zerosLike");return B.runKernelFunc(function(n){return n.zerosLike(e)},{$x:e},function(n,r){return{$x:function(){return We(n)}}})}}),Qt=L({concat_:function(t,e){e===void 0&&(e=0),O(t.length>=1,function(){return"Pass at least one tensor to concat"});var n=Rd(t,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),e=tn(e,n[0].shape)[0];var r=bu(n.map(function(s){return s.shape}),e);if(pe(r)===0)return gn([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});v6(o,e);var i=n,a={axis:e};return B.runKernelFunc(function(s){return s.concat(n,e)},i,function(s){var u=o.map(function(l){return l[e]});return q1(s,u,e).map(function(l){return function(){return l}})},"Concat",a)}}),_6=L({concat1d_:function(t){return Qt(t,0)}}),b6=L({concat2d_:function(t,e){return Qt(t,e)}}),E6=L({concat3d_:function(t,e){return Qt(t,e)}}),C6=L({concat4d_:function(t,e){return Qt(t,e)}}),q1=L({split_:function(t,e,n){n===void 0&&(n=0);var r,o=N(t,"x","split");return n=tn(n,o.shape)[0],typeof e=="number"?(O(o.shape[n]%e==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(e).fill(o.shape[n]/e)):(O(o.shape[n]===e.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=e),B.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return Qt(i,n)}}})}});function os(t,e){return t(e={exports:{}},e.exports),e.exports}var S6=os(function(t){(function(e,n,r){function o(s){var u,l=this,c=(u=4022871197,function(h){h=h.toString();for(var f=0;f<h.length;f++){var d=.02519603282416938*(u+=h.charCodeAt(f));d-=u=d>>>0,u=(d*=u)>>>0,u+=4294967296*(d-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var h=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=h-(l.c=0|h)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,h=l.next;return h.int32=function(){return 4294967296*l.next()|0},h.double=function(){return h()+11102230246251565e-32*(2097152*h()|0)},h.quick=h,c&&(typeof c=="object"&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.alea=a})(0,t)}),I6=os(function(t){(function(e,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.xor128=a})(0,t)}),T6=os(function(t){(function(e,n,r){function o(s){var u=this,l="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^h^h<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.xorwow=a})(0,t)}),R6=os(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var l,c,h=u.x,f=u.i;return l=h[f],c=(l^=l>>>7)^l<<24,c^=(l=h[f+1&7])^l>>>10,c^=(l=h[f+3&7])^l>>>3,c^=(l=h[f+4&7])^l<<7,l=h[f+7&7],c^=(l^=l<<13)^l<<9,h[f]=c,u.i=f+1&7,c},function(l,c){var h,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,h=0;h<c.length;++h)f[7&h]=f[7&h]<<15^c.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],l.x=f,l.i=0,h=256;h>0;--h)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=l.next,h.quick=h,c&&(c.x&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.xorshift7=a})(0,t)}),A6=os(function(t){(function(e,n,r){function o(s){var u=this;u.next=function(){var l,c,h=u.w,f=u.X,d=u.i;return u.w=h=h+1640531527|0,c=f[d+34&127],l=f[d=d+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[d]=c^l,u.i=d,c+(h^h>>>16)|0},function(l,c){var h,f,d,m,g,y=[],v=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,v=Math.max(v,c.length)),d=0,m=-32;m<v;++m)c&&(f^=c.charCodeAt((m+32)%c.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,d=(h=y[127&m]^=f+g)==0?d+1:0);for(d>=128&&(y[127&(c&&c.length||0)]=-1),d=127,m=512;m>0;--m)f=y[d+34&127],h=y[d=d+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[d]=f^h;l.w=g,l.X=y,l.i=d}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=l.next,h.quick=h,c&&(c.X&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.xor4096=a})(0,t)}),k6=os(function(t){(function(e,n,r){function o(s){var u=this,l="";u.next=function(){var h=u.b,f=u.c,d=u.d,m=u.a;return h=h<<25^h>>>7^f,f=f-d|0,d=d<<24^d>>>8^m,m=m-h|0,u.b=h=h<<20^h>>>12^f,u.c=f=f-d|0,u.d=d<<16^f>>>16^m,u.a=m-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,h=function(){return(l.next()>>>0)/4294967296};return h.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},h.int32=l.next,h.quick=h,c&&(typeof c=="object"&&i(c,l),h.state=function(){return i(l,{})}),h}n&&n.exports?n.exports=a:this.tychei=a})(0,t)}),Na=os(function(t){(function(e,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,h=i-1;function f(v,w,x){var _=[],S=g(function E(I,T){var k,P=[],D=typeof I;if(T&&D=="object")for(k in I)try{P.push(E(I[k],T-1))}catch{}return P.length?P:D=="string"?I:I+"\0"}((w=w==1?{entropy:!0}:w||{}).entropy?[v,y(e)]:v??function(){try{var E;return r&&(E=r.randomBytes)?E=E(i):(E=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(E)),y(E)}catch{var I=o.navigator,T=I&&I.plugins;return[+new Date,o,T,o.screen,y(e)]}}(),3),_),R=new d(_),C=function(){for(var E=R.g(a),I=u,T=0;E<l;)E=(E+T)*i,I*=i,T=R.g(1);for(;E>=c;)E/=2,I/=2,T>>>=1;return(E+T)/I};return C.int32=function(){return 0|R.g(4)},C.quick=function(){return R.g(4)/4294967296},C.double=C,g(y(R.S),e),(w.pass||x||function(E,I,T,k){return k&&(k.S&&m(k,R),E.state=function(){return m(R,{})}),T?(n[s]=E,I):E})(C,S,"global"in w?w.global:this==n,w.state)}function d(v){var w,x=v.length,_=this,S=0,R=_.i=_.j=0,C=_.S=[];for(x||(v=[x++]);S<i;)C[S]=S++;for(S=0;S<i;S++)C[S]=C[R=h&R+v[S%x]+(w=C[S])],C[R]=w;(_.g=function(E){for(var I,T=0,k=_.i,P=_.j,D=_.S;E--;)I=D[k=h&k+1],T=T*i+D[h&(D[k]=D[P=h&P+I])+(D[P]=I)];return _.i=k,_.j=P,T})(i)}function m(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function g(v,w){for(var x,_=v+"",S=0;S<_.length;)w[h&S]=h&(x^=19*w[h&S])+_.charCodeAt(S++);return y(w)}function y(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=f,g(n.random(),e),t.exports){t.exports=f;try{r=require("crypto")}catch{}}})([],Math)});Na.alea=S6,Na.xor128=I6,Na.xorwow=T6,Na.xorshift7=R6,Na.xor4096=A6,Na.tychei=k6;var am=Na.alea,K1=function(){function t(e,n,r,o,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=am(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},t.prototype.convertValue=function(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)},t.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},t}(),P6=function(){function t(e,n,r,o){this.alpha=e,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=am(i.toString()),this.randn=new K1(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var e,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(e=o*o)*e,r=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(e){return this.dtype==="float32"?e:Math.round(e)},t}(),D6=function(){function t(e,n,r,o){var i=this;if(e===void 0&&(e=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=e,this.range=n-e,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+n+" <= 1 and dtype is not float");this.random=am(o)}return t.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Ae(t,e,n){return e===void 0&&(e="float32"),e=e||"float32",_R(t),new Ec(t,e,n)}function N6(t,e){e===void 0&&(e=!1),console.log(t.toString(e))}var AR=L({batchToSpaceND_:function(t,e,n){var r=N(t,"x","batchToSpaceND"),o=e.reduce(function(i,a){return i*a});return O(r.rank>=1+e.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length}),O(n.length===e.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length}),O(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+o}),B.runKernelFunc(function(i){return i.batchToSpaceND(r,e,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(e,n)}}})}}),M6=L({broadcastTo_:function(t,e){var n=N(t,"broadcastTo","x"),r=n.shape;if(e.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var o=n.shape.slice();o.length<e.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(e),a=e.length-1;a>=0;a--)if(n.shape[a]===e[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():B.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),O6=L({cast_:function(t,e){var n=N(t,"x","cast");if(!T5(e))throw new Error("Failed to cast to unknown dtype "+e);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:e};return B.runKernelFunc(function(o){return o.cast(n,e)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),F6=L({clone_:function(t){var e=N(t,"x","clone",null);return B.runKernelFunc(function(){return B.makeTensorFromDataId(e.dataId,e.shape,e.dtype)},{$x:e},function(n){return{$x:function(){return n.toFloat()}}})}}),L6=L({cumsum_:function(t,e,n,r){e===void 0&&(e=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=N(t,"x","cumsum"),i=$o([e|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Uo(1,o.rank)[0],u=B.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(e,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),V6=L({depthToSpace_:function(t,e,n){n===void 0&&(n="NHWC");var r=N(t,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return O(o*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+e+`  for depthToSpace with input shape
      `+r.shape}),O(i*e>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+e+` for depthToSpace with input shape
          `+r.shape}),O(a%(e*e)==0,function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape}),B.runKernelFunc(function(s){return s.depthToSpace(r,e,n)},{$x:r})}}),Dr=L({expandDims_:function(t,e){e===void 0&&(e=0);var n=N(t,"x","expandDims",null);O(e<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return e<0&&(O(-(n.rank+1)<=e,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),e=n.rank+e+1),r.splice(e,0,1),Yr(n,r)}}),kR=L({eye_:function(t,e,n,r){r===void 0&&(r="float32"),e==null&&(e=t);for(var o=Ae([t,e],r),i=t<=e?t:e,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(t,e);if(n==null)return s;if(n.length===1)return nu(Dr(s,0),[n[0],1,1]);if(n.length===2)return nu(Dr(Dr(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return nu(Dr(Dr(Dr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),B6=L({multinomial_:function(t,e,n,r){r===void 0&&(r=!1);var o=N(t,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=B.runKernelFunc(function(l){return l.multinomial(s,r,e,n)},{logits2D:s});return a===1?u.as1D():u}}),My=L({oneHot_:function(t,e,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var o=N(t,"indices","oneHot","int32"),i=o.shape.concat([e]);return o=o.flatten(),B.runKernelFunc(function(a){return a.oneHot(o,e,n,r)},{$indices:o},function(a){return{$indices:function(){return dt(o.shape,"float32")}}}).reshape(i)}}),is=L({pad_:function(t,e,n){n===void 0&&(n=0);var r=N(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:e,constantValue:n};return B.runKernelFunc(function(i){return i.pad(r,e,n)},{x:r},function(i){var a=e.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),$6=L({pad1d_:function(t,e,n){return n===void 0&&(n=0),O(e.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),is(t,[e],n)}}),U6=L({pad2d_:function(t,e,n){return n===void 0&&(n=0),O(e.length===2&&e[0].length===2&&e[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),is(t,e,n)}}),z6=L({pad3d_:function(t,e,n){return n===void 0&&(n=0),O(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),is(t,e,n)}}),W6=L({pad4d_:function(t,e,n){return n===void 0&&(n=0),O(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),is(t,e,n)}}),j6=L({rand_:function(t,e,n){var r=pe(t),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=e();return B.makeTensor(o,t,n)}}),H6=L({randomNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new K1(e,n,r,!1,o),a=Ae(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),G6=L({randomGamma_:function(t,e,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new P6(e,n,r,o),a=Ae(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),PR=L({randomUniform_:function(t,e,n,r,o){e===void 0&&(e=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Ae(t,r),a=new D6(e,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Yr=L({reshape_:function(t,e){var n=N(t,"x","reshape",null);e=S5(e,n.size),O(n.size===pe(e),function(){return"new shape and old shape must have the same number of elements."});var r={shape:e};return B.runKernelFunc(function(o){return o.reshape(n,e)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),DR=L({spaceToBatchND_:function(t,e,n){var r=N(t,"x","spaceToBatchND");return O(r.rank>=1+e.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length}),O(n.length===e.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length}),O(r.shape.reduce(function(o,i,a){return a>0&&a<=e.length?o&&(i+n[a-1][0]+n[a-1][1])%e[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()}),B.runKernelFunc(function(o){return o.spaceToBatchND(r,e,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(e,n)}}})}}),NR=L({squeeze_:function(t,e){var n=N(t,"x","squeeze");return Yr(n,Oa(n.shape,e).newShape)}}),xr=L({stack_:function(t,e){e===void 0&&(e=0);var n=Rd(t,"tensors","stack");if(O(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(e);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;O(e<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Ye(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){O(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(e)});return Qt(a,e)}}),nu=L({tile_:function(t,e){var n=N(t,"x","tile",null);O(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."});var r=[n],o={reps:e};return B.runKernelFunc(function(i,a){var s=i.tile(n,e);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=We(s);if(s.rank===1)for(var l=0;l<e[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<e[0];++l)for(var c=0;c<e[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<e[0];++l)for(c=0;c<e[1];++c)for(var h=0;h<e[2];++h)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],h*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<e[0];++l)for(c=0;c<e[1];++c)for(h=0;h<e[2];++h)for(var f=0;f<e[3];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],h*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),q6=L({truncatedNormal_:function(t,e,n,r,o){if(e===void 0&&(e=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new K1(e,n,r,!0,o),a=Ae(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Yt=L({unstack_:function(t,e){e===void 0&&(e=0),e=e||0;var n=N(t,"x","unstack");O(e>=-n.shape.length&&e<n.shape.length,function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),e<0&&(e+=n.shape.length);var r={axis:e};return B.runKernelFunc(function(o){return o.unstack(n,e)},{x:n},function(o){return{x:function(){return xr(o,e)}}},"Unpack",r)}}),K6=function(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,h;return fe(this,function(f){switch(f.label){case 0:return n=N(t,"x","setdiff1d"),r=N(e,"y","setdiff1d"),O(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),O(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),O(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new Ec([s],n.dtype),l=new Ec([s],"int32"),c=0,h=0;c<o.length;c++)a.has(o[c])||(u.values[h]=o[c],l.values[h]=c,h++);return[2,[u.toTensor(),l.toTensor()]]}})})};function kd(t,e,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(e.slice(0))).push(t[0]/n),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var i=e.length,a=0;a<i;++a)o=o.concat([t[a+1]/e[a],e[a]]);o=o.concat(t.slice(i+1))}return o}function Pd(t,e,n){n===void 0&&(n=!0);var r=[];if(n){r.push(e);for(var o=e+1;o<t;++o)o<=2*e?(r.push(o),r.push(o-(e+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<t;++o)o>=2*e+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Dd(t,e,n,r){r===void 0&&(r=!0);var o=[];r?o.push(t[0]/n):o.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?o.push(e[i-1]*t[i]):o.push(t[i]/e[i-1]):o.push(t[i]);return o}function MR(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function OR(t,e,n){for(var r=t.slice(0,1),o=0;o<n;++o)r.push(t[o+1]-e[o][0]-e[o][1]);return r}function FR(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(e.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(t.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=a[i],s.push(a[i]);var l=Ro(t.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var LR=30;function Uv(t){return t<=LR?t:Ry(t,Math.floor(Math.sqrt(t)))}function X6(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,o=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(t.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+t.length-r)throw new Error(i+" update.rank != "+(o+t.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==e.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==t[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+t[a+o]+")")}function Q6(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if(e.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(e.size===0)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(t.size===0)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}X6(n,e,t)}function Nd(t,e,n){for(var r=e.shape.length,o=r>1?e.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:pe(e.shape)/u,sliceSize:a,strides:Ro(n.slice(0,o)).concat([1]),outputSize:pe(n)}}function Y6(t,e,n){O(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."}),O(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."});for(var r=function(i){O(e[i]+n[i]<=t.shape[i],function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(e[i]+n[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"})},o=0;o<t.rank;++o)r(o)}function U2(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function X1(t,e,n){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((e[o]-t[o])/n[o]);return r}function J6(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=Sy(0,i,s-1)}function Z6(t,e,n,r,o){var i=e[o],a=n[o]||1;(t&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?Sy(0,i,s):Sy(-1,i,s-1)}function VR(t,e,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(e[o]>0||n[o]!==t[o])return!1;return!0}function BR(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function e$(t,e){O(Ty(t),function(){return"The f passed in variableGrads(f) must be a function"}),O(e==null||Array.isArray(e)&&e.every(function(c){return c instanceof _u}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=e!=null;if(!n)for(var r in e=[],B.registeredVariables)e.push(B.registeredVariables[r]);var o=n?e.filter(function(c){return!c.trainable}):null,i=e.length;O((e=e.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=B.gradients(t,e,null,!0),s=a.value,u=a.grads;O(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),O(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return e.forEach(function(c,h){u[h]!=null&&(l[c.name]=u[h])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function sm(t){return B.customGrad(t)}var vi=L({softmax_:function(t,e){e===void 0&&(e=-1);var n=N(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return B.runKernelFunc(function(r,o){var i=r.softmax(n,e);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([e],!0).mul(i))}}},"Softmax",{dim:e},[],[!0])}}),t$=L({logSoftmax_:function(t,e){e===void 0&&(e=-1);var n=N(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return sm(function(r,o){var i=r.max(e,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(e,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(e,!0).mul(c))}}})(n)}}),$R=function(){function t(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},t.prototype.set=function(e,n){this.dataIdsCount++,this.data.set(e,n)},t.prototype.has=function(e){return this.data.has(e)},t.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),UR=function(){function t(){}return t.prototype.time=function(e){return j("time")},t.prototype.read=function(e){return j("read")},t.prototype.readSync=function(e){return j("readSync")},t.prototype.numDataIds=function(){return j("numDataIds")},t.prototype.disposeData=function(e){return j("disposeData")},t.prototype.write=function(e,n,r){return j("write")},t.prototype.move=function(e,n,r,o){return j("move")},t.prototype.memory=function(){return j("memory")},t.prototype.floatPrecision=function(){return j("floatPrecision")},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.batchMatMul=function(e,n,r,o){return j("batchMatMul")},t.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,j("fusedBatchMatMul")},t.prototype.slice=function(e,n,r){return j("slice")},t.prototype.stridedSlice=function(e,n,r,o){return j("stridedSlice")},t.prototype.unstack=function(e,n){return j("unstack")},t.prototype.reverse=function(e,n){return j("reverse")},t.prototype.concat=function(e,n){return j("concat")},t.prototype.neg=function(e){return j("neg")},t.prototype.add=function(e,n){return j("add")},t.prototype.addN=function(e){return j("addN")},t.prototype.subtract=function(e,n){return j("subtract")},t.prototype.multiply=function(e,n){return j("multiply")},t.prototype.realDivide=function(e,n){return j("realDivide")},t.prototype.floorDiv=function(e,n){return j("floorDiv")},t.prototype.sum=function(e,n){return j("sum")},t.prototype.prod=function(e,n){return j("prod")},t.prototype.unsortedSegmentSum=function(e,n,r){return j("unsortedSegmentSum")},t.prototype.argMin=function(e,n){return j("argMin")},t.prototype.argMax=function(e,n){return j("argMax")},t.prototype.equal=function(e,n){return j("equal")},t.prototype.notEqual=function(e,n){return j("notEqual")},t.prototype.less=function(e,n){return j("less")},t.prototype.lessEqual=function(e,n){return j("lessEqual")},t.prototype.greater=function(e,n){return j("greater")},t.prototype.greaterEqual=function(e,n){return j("greaterEqual")},t.prototype.logicalNot=function(e){return j("logicalNot")},t.prototype.logicalAnd=function(e,n){return j("logicalAnd")},t.prototype.logicalOr=function(e,n){return j("logicalOr")},t.prototype.where=function(e){return j("where")},t.prototype.select=function(e,n,r){return j("select")},t.prototype.topk=function(e,n,r){return j("topk")},t.prototype.min=function(e,n){return j("min")},t.prototype.minimum=function(e,n){return j("minimum")},t.prototype.mod=function(e,n){return j("mod")},t.prototype.max=function(e,n){return j("max")},t.prototype.maximum=function(e,n){return j("maximum")},t.prototype.all=function(e,n){return j("all")},t.prototype.any=function(e,n){return j("any")},t.prototype.squaredDifference=function(e,n){return j("squaredDifference")},t.prototype.ceil=function(e){return j("ceil")},t.prototype.floor=function(e){return j("floor")},t.prototype.round=function(e){return j("round")},t.prototype.sign=function(e){return j("sign")},t.prototype.isNaN=function(e){return j("isNaN")},t.prototype.isInf=function(e){return j("isInf")},t.prototype.isFinite=function(e){return j("isFinite")},t.prototype.pow=function(e,n){return j("pow")},t.prototype.exp=function(e){return j("exp")},t.prototype.expm1=function(e){return j("expm1")},t.prototype.softmax=function(e,n){return j("softmax")},t.prototype.log=function(e){return j("log")},t.prototype.log1p=function(e){return j("log1p")},t.prototype.sqrt=function(e){return j("sqrt")},t.prototype.rsqrt=function(e){return j("rsqrt")},t.prototype.square=function(e){return j("square")},t.prototype.reciprocal=function(e){return j("reciprocal")},t.prototype.relu=function(e){return j("relu")},t.prototype.relu6=function(e){return j("relu6")},t.prototype.prelu=function(e,n){return j("prelu")},t.prototype.elu=function(e){return j("elu")},t.prototype.eluDer=function(e,n){return j("eluDer")},t.prototype.selu=function(e){return j("selu")},t.prototype.int=function(e){return j("int")},t.prototype.clip=function(e,n,r){return j("clip")},t.prototype.abs=function(e){return j("abs")},t.prototype.complexAbs=function(e){return j("complexAbs")},t.prototype.sigmoid=function(e){return j("sigmoid")},t.prototype.softplus=function(e){return j("softplus")},t.prototype.sin=function(e){return j("sin")},t.prototype.cos=function(e){return j("cos")},t.prototype.tan=function(e){return j("tan")},t.prototype.asin=function(e){return j("asin")},t.prototype.acos=function(e){return j("acos")},t.prototype.atan=function(e){return j("atan")},t.prototype.atan2=function(e,n){return j("atan2")},t.prototype.sinh=function(e){return j("sinh")},t.prototype.cosh=function(e){return j("cosh")},t.prototype.tanh=function(e){return j("tanh")},t.prototype.asinh=function(e){return j("asinh")},t.prototype.acosh=function(e){return j("acosh")},t.prototype.atanh=function(e){return j("atanh")},t.prototype.erf=function(e){return j("erf")},t.prototype.step=function(e,n){return j("step")},t.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,j("fusedConv2d")},t.prototype.conv2d=function(e,n,r){return j("conv2d")},t.prototype.conv2dDerInput=function(e,n,r){return j("conv2dDerInput")},t.prototype.conv2dDerFilter=function(e,n,r){return j("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,j("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(e,n,r){return j("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(e,n,r){return j("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(e,n,r){return j("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(e,n,r){return j("conv3d")},t.prototype.conv3dDerInput=function(e,n,r){return j("conv3dDerInput")},t.prototype.conv3dDerFilter=function(e,n,r){return j("conv3dDerFilter")},t.prototype.maxPool=function(e,n){return j("maxPool")},t.prototype.maxPoolBackprop=function(e,n,r,o){return j("maxPoolBackprop")},t.prototype.avgPool=function(e,n){return j("avgPool")},t.prototype.avgPoolBackprop=function(e,n,r){return j("avgPoolBackprop")},t.prototype.avgPool3d=function(e,n){return j("avgPool3d")},t.prototype.avgPool3dBackprop=function(e,n,r){return j("avgPool3dBackprop")},t.prototype.maxPool3d=function(e,n){return j("maxPool3d")},t.prototype.maxPool3dBackprop=function(e,n,r,o){return j("maxPool3dBackprop")},t.prototype.reshape=function(e,n){return j("reshape")},t.prototype.cast=function(e,n){return j("cast")},t.prototype.tile=function(e,n){return j("tile")},t.prototype.pad=function(e,n,r){return j("pad")},t.prototype.transpose=function(e,n){return j("transpose")},t.prototype.gather=function(e,n,r){return j("gather")},t.prototype.gatherND=function(e,n){return j("gatherND")},t.prototype.scatterND=function(e,n,r){return j("scatterND")},t.prototype.batchToSpaceND=function(e,n,r){return j("batchToSpaceND")},t.prototype.spaceToBatchND=function(e,n,r){return j("spaceToBatchND")},t.prototype.resizeBilinear=function(e,n,r,o){return j("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(e,n,r){return j("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(e,n,r,o){return j("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(e,n,r){return j("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(e,n,r,o,i,a){return j("batchNormalization")},t.prototype.localResponseNormalization4D=function(e,n,r,o,i){return j("localResponseNormalization4D")},t.prototype.LRNGrad=function(e,n,r,o,i,a,s){return j("LRNGrad")},t.prototype.multinomial=function(e,n,r,o){return j("multinomial")},t.prototype.oneHot=function(e,n,r,o){return j("oneHot")},t.prototype.cumsum=function(e,n,r,o){return j("cumsum")},t.prototype.nonMaxSuppression=function(e,n,r,o,i){return j("nonMaxSuppression")},t.prototype.fft=function(e){return j("fft")},t.prototype.ifft=function(e){return j("ifft")},t.prototype.complex=function(e,n){return j("complex")},t.prototype.real=function(e){return j("real")},t.prototype.imag=function(e){return j("imag")},t.prototype.cropAndResize=function(e,n,r,o,i,a){return j("cropAndResize")},t.prototype.depthToSpace=function(e,n,r){return j("depthToSpace")},t.prototype.split=function(e,n,r){return j("split")},t.prototype.sparseToDense=function(e,n,r,o){return j("sparseToDense")},t.prototype.diag=function(e){return j("diag")},t.prototype.fill=function(e,n,r){return j("fill")},t.prototype.onesLike=function(e){return j("onesLike")},t.prototype.zerosLike=function(e){return j("zerosLike")},t.prototype.linspace=function(e,n,r){return j("linspace")},t.prototype.dispose=function(){return j("dispose")},t}();function j(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Vi(t,e){for(var n=t.length,r=[],o=0;o<n;o++){var i=n-1-o,a=t[i]||1;(e[e.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function Zt(t,e){for(var n=[],r=0;r<e.length;r++){var o=t[t.length-r-1],i=e.length-r-1,a=e[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Le(t,e){for(var n=[],r=Math.max(t.length,e.length),o=0;o<r;o++){var i=t[t.length-o-1];i==null&&(i=1);var a=e[e.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}function Sc(t,e,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=Fd(e),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,t[3],t[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,t[1],t[1]]}return as(t,s,n,r,o,i,!1,a)}function Md(t,e,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=Oy(e),c=l[0],h=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,h,f,t[4],t[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,h,f,t[1],t[1]]}return Od(t,s,n,r,o,!1,u,i)}function as(t,e,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],f=u[3];if(s==="channelsLast")l=t[0],c=t[1],h=t[2],f=t[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=t[0],f=t[1],c=t[2],h=t[3]}var d,m=e[0],g=e[1],y=e[3],v=Fd(n),w=v[0],x=v[1],_=Fd(r),S=_[0],R=_[1],C=ru(m,S),E=ru(g,R),I=function($,U,K,X,V,W,H,ne){var oe,de,me;if(typeof $=="number"){oe={top:$,bottom:$,left:$,right:$,type:$===0?"VALID":"NUMBER"};var _e=function(Me,je,Fe,tt,nt){tt==null&&(tt=zR(Me,je,Fe));var Je=Me[0],bn=Me[1],Vn=Hl((Je-je+2*tt)/Fe+1,nt);O(Ft(Vn),function(){return"The output # of rows ("+Vn+") must be an integer. Change the stride and/or zero pad parameters"});var Ge=Hl((bn-je+2*tt)/Fe+1,nt);return O(Ft(Ge),function(){return"The output # of columns ("+Ge+") must be an integer. Change the stride and/or zero pad parameters"}),[Vn,Ge]}([U,K],W,X,$,ne);de=_e[0],me=_e[1]}else if($==="same"){de=Math.ceil(U/X),me=Math.ceil(K/V);var xe=Math.max(0,(de-1)*X+W-U),Ie=Math.max(0,(me-1)*V+H-K),Pe=Math.floor(xe/2),Ee=xe-Pe,ct=Math.floor(Ie/2);oe={top:Pe,bottom:Ee,left:ct,right:Ie-ct,type:"SAME"}}else{if($!=="valid")throw Error("Unknown padding parameter: "+$);oe={top:0,bottom:0,left:0,right:0,type:"VALID"},de=Math.ceil((U-W+1)/X),me=Math.ceil((K-H+1)/V)}return{padInfo:oe,outHeight:de,outWidth:me}}(o,c,h,w,x,C,E,i),T=I.padInfo,k=I.outHeight,P=I.outWidth,D=a?y*f:y;return s==="channelsFirst"?d=[l,D,k,P]:s==="channelsLast"&&(d=[l,k,P,D]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:h,inChannels:f,outHeight:k,outWidth:P,outChannels:D,padInfo:T,strideHeight:w,strideWidth:x,filterHeight:m,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:E,dilationHeight:S,dilationWidth:R,inShape:t,outShape:d,filterShape:e}}function Od(t,e,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],f=u[3],d=u[4];if(a==="channelsLast")l=t[0],c=t[1],h=t[2],f=t[3],d=t[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=t[0],d=t[1],c=t[2],h=t[3],f=t[4]}var m,g=e[0],y=e[1],v=e[2],w=e[4],x=Oy(n),_=x[0],S=x[1],R=x[2],C=Oy(r),E=C[0],I=C[1],T=C[2],k=ru(g,E),P=ru(y,I),D=ru(v,T),$=function(H,ne,oe,de,me,_e,xe,Ie,Pe,Ee,ct){var Me,je,Fe,tt;if(typeof H=="number"){Me={top:H,bottom:H,left:H,right:H,front:H,back:H,type:H===0?"VALID":"NUMBER"};var nt=function(ar,Dt,_i,Ir,En,Se){En==null&&(En=zR(ar,Dt,Ir));var hs=ar[0],fs=ar[1],_a=ar[2],uo=Hl((hs-Dt+2*En)/Ir+1,Se);O(Ft(uo),function(){return"The output # of depths ("+uo+") must be an integer. Change the stride and/or zero pad parameters"});var ba=Hl((fs-Dt+2*En)/Ir+1,Se);O(Ft(ba),function(){return"The output # of rows ("+ba+") must be an integer. Change the stride and/or zero pad parameters"});var Ea=Hl((_a-Dt+2*En)/Ir+1,Se);return O(Ft(Ea),function(){return"The output # of columns ("+Ea+") must be an integer. Change the stride and/or zero pad parameters"}),[uo,ba,Ea,_i]}([ne,oe,de,1],Ie,1,me,H,ct);je=nt[0],Fe=nt[1],tt=nt[2]}else if(H==="same"){je=Math.ceil(ne/me),Fe=Math.ceil(oe/_e),tt=Math.ceil(de/xe);var Je=(je-1)*me+Ie-ne,bn=(Fe-1)*_e+Pe-oe,Vn=(tt-1)*xe+Ee-de,Ge=Math.floor(Je/2),it=Je-Ge,nn=Math.floor(bn/2),Sr=bn-nn,Gn=Math.floor(Vn/2);Me={top:nn,bottom:Sr,left:Gn,right:Vn-Gn,front:Ge,back:it,type:"SAME"}}else{if(H!=="valid")throw Error("Unknown padding parameter: "+H);Me={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},je=Math.ceil((ne-Ie+1)/me),Fe=Math.ceil((oe-Pe+1)/_e),tt=Math.ceil((de-Ee+1)/xe)}return{padInfo:Me,outDepth:je,outHeight:Fe,outWidth:tt}}(o,c,h,f,_,S,R,k,P,D,s),U=$.padInfo,K=$.outDepth,X=$.outHeight,V=$.outWidth,W=i?w*d:w;return a==="channelsFirst"?m=[l,W,K,X,V]:a==="channelsLast"&&(m=[l,K,X,V,W]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:f,inChannels:d,outDepth:K,outHeight:X,outWidth:V,outChannels:W,padInfo:U,strideDepth:_,strideHeight:S,strideWidth:R,filterDepth:g,filterHeight:y,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:P,effectiveFilterWidth:D,dilationDepth:E,dilationHeight:I,dilationWidth:T,inShape:t,outShape:m,filterShape:e}}function zR(t,e,n,r){r===void 0&&(r=1);var o=ru(e,r);return Math.floor((t[0]*(n-1)-n+o)/2)}function Fd(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Oy(t){return typeof t=="number"?[t,t,t]:t}function ru(t,e){return e<=1?t:t+(t-1)*(e-1)}function Hl(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function Eu(t){var e=Fd(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function ir(t,e){return Eu(t)||Eu(e)}function Q1(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function WR(t,e,n){if(e==="complex64"){if(t.dtype==="complex64")return t.clone();var r=dt(t.shape),o=t.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!R5(t.dtype,e))return B.makeTensorFromDataId(t.dataId,t.shape,e);if(t.dtype==="complex64"){var a=n.real(t);return i=a.cast(e),a.dispose(),i}if(e==="int32")return n.int(t);if(e==="bool"){var s=ae(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Fy(t,e){return B.makeTensorFromDataId(t.dataId,e,t.dtype)}function jR(t,e,n){var r=(e-t)/(n-1),o=eh(n,"float32");o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return Wt(o,"float32")}function Ly(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function z2(t,e){return{real:t[2*e],imag:t[2*e+1]}}function n$(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function r$(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function o$(t,e,n){var r=function(i,a,s){return function(u,l,c){for(var h=0,f=u.length,d=0,m=!1;h<f;){var g=c(l,u[d=h+(f-h>>>1)]);g>0?h=d+1:(f=d,m=!g)}return m?h:-h-1}(i,a,s||i$)}(t,e,n),o=r<0?-(r+1):r;t.splice(o,0,e)}function i$(t,e){return t>e?1:t<e?-1:0}function Y1(t,e,n,r,o){return HR(t,e,n,r,o,0).selectedIndices}function J1(t,e,n,r,o,i){var a=HR(t,e,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function HR(t,e,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(e).map(function(_,S){return{score:_,boxIndex:S,suppressBeginIndex:0}}).filter(function(_){return _.score>o}).sort(W2),l=i>0?-.5/i:0,c=[],h=[];c.length<n&&u.length>0;){var f=u.pop(),d=f.score,m=f.boxIndex,g=f.suppressBeginIndex;if(d<o)break;for(var y=!1,v=c.length-1;v>=g;--v){var w=a$(t,m,c[v]);if(w>=r){y=!0;break}if(f.score=f.score*s$(r,l,w),f.score<=o)break}f.suppressBeginIndex=c.length,y||(f.score===d?(c.push(m),h.push(f.score)):f.score>o&&o$(u,f,W2))}var x=c.length;return s&&(c.fill(0,x),h.fill(0,x)),{selectedIndices:Wt(c,"int32"),selectedScores:Wt(h,"float32"),numValidOutputs:ae(x,"int32")}}function a$(t,e,n){var r=t.subarray(4*e,4*e+4),o=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),h=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),d=(s-i)*(u-a),m=(h-l)*(f-c);if(d<=0||m<=0)return 0;var g=Math.max(i,l),y=Math.max(a,c),v=Math.min(s,h),w=Math.min(u,f),x=Math.max(v-g,0)*Math.max(w-y,0);return x/(d+m-x)}function s$(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function W2(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function GR(t,e,n){var r=new Array(t.rank).fill(0),o=t.shape.slice();return e.map(function(i){o[n]=i;var a=t.slice(r,o);return r[n]+=i,a})}function qR(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var o=Ae(n,t.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=i[s]%t.shape[s];var u=t.locToIndex(a);o.values[r]=t.values[u]}return o.toTensor()}function KR(t,e,n,r,o){for(var i=e[e.length-1],a=[t.length/i,i],s=a[0],u=a[1],l=bc(n,s*r),c=bc("int32",s*r),h=0;h<s;h++){for(var f=h*u,d=t.subarray(f,f+u),m=[],g=0;g<d.length;g++)m.push({value:d[g],index:g});m.sort(function(_,S){return S.value-_.value});var y=h*r,v=l.subarray(y,y+r),w=c.subarray(y,y+r);for(g=0;g<r;g++)v[g]=m[g].value,w[g]=m[g].index}var x=e.slice();return x[x.length-1]=r,[gn(l,x,n),gn(c,x,"int32")]}function Z1(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var o=Ae(t,"int32"),i=Ae([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*t.length;i.values.set(a,s)}return i.toTensor()}var u$=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},l$=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},c$=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,o=t.batchSize,i=t.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=e==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function XR(t,e){return["x","y","z","w","u","v"].slice(0,e).map(function(n){return t+"."+n})}function Qn(t,e){return e===1?[t]:XR(t,e)}function Nn(){var t,e,n,r,o,i,a,s,u,l;return Q().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function $a(t,e,n){n===void 0&&(n="index");var r=Ro(e);return r.map(function(o,i){return"int "+t[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+o:"index -= "+t[i]+" * "+o)+";"}).join("")}function ew(t){var e=Ro(t).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+e[0]+" + coords.y * "+e[1]+` + coords.z;
  }
`}var QR=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function h$(t,e,n,r){var o=[];t.forEach(function(d){var m=pe(d.shapeInfo.logicalShape);d.shapeInfo.isUniform?o.push("uniform float "+d.name+(m>1?"["+m+"]":"")+";"):(o.push("uniform sampler2D "+d.name+";"),o.push("uniform int offset"+d.name+";"))});var i,a,s=o.join(`
`),u=t.map(function(d){return function(m,g,y){y===void 0&&(y=!1);var v="";v+=y?YR(m):Is(m);var w=m.shapeInfo.logicalShape,x=g.logicalShape;return w.length<=x.length&&(v+=y?function(_,S){var R,C=_.name,E=C.charAt(0).toUpperCase()+C.slice(1),I="get"+E+"AtOutCoords",T=_.shapeInfo.logicalShape.length,k=S.logicalShape.length,P=Vi(_.shapeInfo.logicalShape,S.logicalShape),D=lt(k),$=k-T,U=["x","y","z","w","u","v"];R=T===0?"":k<2&&P.length>=1?"coords = 0;":P.map(function(oe){return"coords."+U[oe+$]+" = 0;"}).join(`
`);var K="";K=k<2&&T>0?"coords":_.shapeInfo.logicalShape.map(function(oe,de){return"coords."+U[de+$]}).join(", ");var X="return outputValue;",V=pe(_.shapeInfo.logicalShape)===1,W=pe(S.logicalShape)===1;if(T!==1||V||W){if(V&&!W)X=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(P.length){var H=T-2,ne=T-1;P.indexOf(H)>-1&&P.indexOf(ne)>-1?X="return vec4(outputValue.x);":P.indexOf(H)>-1?X="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(ne)>-1&&(X="return vec4(outputValue.xx, outputValue.zz);")}}else X=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+I+`() {
      `+D+` coords = getOutputCoords();
      `+R+`
      vec4 outputValue = get`+E+"("+K+`);
      `+X+`
    }
  `}(m,g):function(_,S){var R=_.name,C=R.charAt(0).toUpperCase()+R.slice(1),E="get"+C+"AtOutCoords",I=S.texShape,T=_.shapeInfo.texShape,k=_.shapeInfo.logicalShape.length,P=S.logicalShape.length;if(!_.shapeInfo.isUniform&&k===P&&_.shapeInfo.flatOffset==null&&ln(T,I))return`
      float `+E+`() {
        return sampleTexture(`+R+`, resultUV);
      }
    `;var D,$=lt(P),U=Vi(_.shapeInfo.logicalShape,S.logicalShape),K=P-k,X=["x","y","z","w","u","v"];D=k===0?"":P<2&&U.length>=1?"coords = 0;":U.map(function(W){return"coords."+X[W+K]+" = 0;"}).join(`
`);var V="";return V=P<2&&k>0?"coords":_.shapeInfo.logicalShape.map(function(W,H){return"coords."+X[H+K]}).join(", "),`
    float `+E+`() {
      `+$+` coords = getOutputCoords();
      `+D+`
      return get`+C+"("+V+`);
    }
  `}(m,g)),v}(d,e,r)}).join(`
`),l=e.texShape,c=Nn(),h=function(d){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+d.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(d){return d.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+d.varyingFs+` vec2 resultUV;
    `+d.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+d.defineSpecialNaN+`
    `+d.defineSpecialInf+`
    `+d.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+f$+`
    `+d$+`
    `+p$+`
  `}(c);return e.isPacked?(i=function(d,m){switch(d.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(_,S){var R=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];return R[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+R[1]+`.0);
      }
    `:R[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+R[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+R[0]+", "+R[1]+`));
      return 2 * (resTexRC.x * `+R[1]+` + resTexRC.y);
    }
  `}(0,m);case 2:return function(_,S){var R=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)];if(ln(_,S))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+R[0]+", "+R[1]+`));
      }
    `;var C=Math.ceil(_[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+R[0]+", "+R[1]+`));

      int index = resTexRC.x * `+R[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(d,m);case 3:return g=d,y=m,v=[Math.ceil(y[0]/2),Math.ceil(y[1]/2)],w=Math.ceil(g[2]/2),x=w*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+w+`);
      int c = imod(index, `+w+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(_,S){for(var R=[Math.ceil(S[0]/2),Math.ceil(S[1]/2)],C=Math.ceil(_[_.length-1]/2),E=C*Math.ceil(_[_.length-2]/2),I=E,T="",k="b, r, c",P=2;P<_.length-1;P++)I*=_[_.length-P-1],T=`
      int b`+P+" = index / "+I+`;
      index -= b`+P+" * "+I+`;
    `+T,k="b"+P+", "+k;return`
    ivec`+_.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+R[0]+", "+R[1]+`));
      int index = resTexRC.x * `+R[1]+` + resTexRC.y;

      `+T+`

      int b = index / `+E+`;
      index -= b * `+E+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+_.length+"("+k+`);
    }
  `}(d,m)}var g,y,v,w,x}(e.logicalShape,l),a=function(d){return`
    void setOutput(vec4 val) {
      `+d.output+` = val;
    }
  `}(c)):(i=function(d,m){switch(d.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,w){return w[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+w[1]+`.0);
      }
    `:w[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+w[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      return resTexRC.x * `+w[1]+` + resTexRC.y;
    }
  `}(0,m);case 2:return function(v,w){return ln(v,w)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+w[0]+", "+w[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+w[0]+", "+w[1]+`));
        int index = resTexRC.x * `+w[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+w[0]+", "+w[1]+`));
        int index = resTexRC.x * `+w[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(d,m);case 3:return g=m,y=$a(["r","c","d"],d),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+y+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,w){var x=$a(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(d,m);case 5:return function(v,w){var x=$a(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+w[0]+`,
                             `+w[1]+`));

      int index = resTexRC.x * `+w[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(d,m);case 6:return function(v,w){var x=$a(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+w[0]+", "+w[1]+`));
      int index = resTexRC.x * `+w[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(d,m);default:throw new Error(d.length+"-D output sampling is not yet supported")}var g,y}(e.logicalShape,l),a=function(d){return`
    void setOutput(float val) {
      `+d.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=m$),[f,h,a,s,i,u,n].join(`
`)}function Is(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],h=Aa(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+h+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+bs(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Aa(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(t);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&ln(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=Oa(r),c=l.newShape,h=l.keptDims,f=c;if(f.length<r.length){var d=Ts(n,f);return`
      `+Is(d)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Rs(["row","col"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+bs(n)+`
      }
    `;var m=a[0],g=a[1],y=Aa(o);return g===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+y+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+y+`;
    vec2 uv = uvFromFlat(`+m+", "+g+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(t);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=Oa(r),l=u.newShape,c=u.keptDims,h=l;if(h.length<r.length){var f=Ts(n,h);return`
        `+Is(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Rs(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+bs(n)+`
      }
    `;var d=n.shapeInfo.texShape,m=d[0],g=d[1],y=n.shapeInfo.flatOffset;if(g===a&&y==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+m+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(g===s&&y==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+m+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var v=Aa(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+m+", "+g+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(t);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=Oa(r),c=l.newShape,h=l.keptDims;if(c.length<r.length){var f=Ts(n,c);return`
      `+Is(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Rs(["row","col","depth","depth2"],h)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+bs(n)+`
      }
    `;var d=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],y=m[1];if(y===u&&d==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===a&&d==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var v=Aa(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+y+", index + "+v+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=Oa(r),h=c.newShape,f=c.keptDims;if(h.length<r.length){var d=Ts(n,h);return`
      `+Is(d)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Rs(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+bs(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,y=g[0],v=g[1];if(v===l&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+y+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(v===a&&m==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+y+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var w=Aa(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+w+`;
      vec2 uv = uvFromFlat(`+y+", "+v+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=Oa(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=Ts(n,s);return`
      `+Is(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Rs(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],h=r[4]*c,f=r[3]*h,d=r[2]*f,m=r[1]*d;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+m+", "+d+", "+f+", "+h+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+bs(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,y=n.shapeInfo.texShape,v=y[0],w=y[1];if(w===m&&g==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+d+", "+f+", "+h+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(w===c&&g==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=Aa(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+m+" + col * "+d+" + depth * "+f+` +
          depth2 * `+h+" + depth3 * "+c+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+v+", "+w+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function YR(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Nn(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+e+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Nn();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(t);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],h=Nn();if(u!=null&&ln(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+h.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],d=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+d+", "+f[0]+", "+f[1]+`, row, col);
      return `+h.texture2D+"("+a+`, uv);
    }
  `}(t);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),h=Ts(o,c);return`
        `+YR(h)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Rs(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],d=l[1],m=Math.ceil(i[2]/2),g=m*Math.ceil(i[1]/2),y=Nn();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+d+", "+g+", "+m+`, b, row, col);
      return `+y.texture2D+"("+a+`, uv);
    }
  `}(t);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],h=c[0],f=c[1],d=Math.ceil(i[a-1]/2),m=d*Math.ceil(i[a-2]/2),g="int b, int row, int col",y="b * "+m+" + (row / 2) * "+d+" + (col / 2)",v=2;v<a-1;v++)g="int b"+v+", "+g,m*=i[a-v-1],y="b"+v+" * "+m+" + "+y;var w=Nn();return`
    vec4 `+u+"("+g+`) {
      int index = `+y+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+h+`);
      return `+w.texture2D+"("+s+`, uv);
    }
  `}(t)}}var f$=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,d$=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,p$=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,m$=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Aa(t){return"offset"+t}function bs(t){var e=t.name,n=pe(t.shapeInfo.logicalShape);return n<2?"return "+e+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+e+`[i];
      }
    }
  `}function lt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function Ts(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Rs(t,e){return e.map(function(n){return t[n]}).join(", ")}var v$=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,O(t.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=t[t.length-1],i=Math.ceil(o/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=lt(l),h=Qn("coords",l);if(i===1){var f=lt(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+h.join()+`, 0);
        ++`+h[l-1]+`;
        `+f+" sourceLocG = "+f+"("+h.join()+`, 0);
        ++`+h[l-2]+`;
        `+f+" sourceLocA = "+f+"("+h.join()+`, 0);
        --`+h[l-1]+`;
        `+f+" sourceLocB = "+f+"("+h.join()+`, 0);
        --`+h[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+h[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+h[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+h[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+h[l-2]+";";var d=["x","y","z","w","u","v"].slice(0,s),m="."+d[s-1],g=d.map(function(E){return"int "+E}),y=Qn("sourceLocR",s-1).concat("inIdx.r"),v=Qn("sourceLocG",s-1).concat("inIdx.g"),w=Qn("sourceLocB",s-1).concat("inIdx.b"),x=Qn("sourceLocA",s-1).concat("inIdx.a"),_=n==="max"?"greaterThan":"lessThan",S=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",R=`vec4(
            getAChannel(`+y.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+w.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",C=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+d.join()+`),
                                          vec2(`+d.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+d.join()+`),
                               vec2(`+d.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+h[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+h[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+m+", sourceLocG"+m+`,
          sourceLocB`+m+", sourceLocA"+m+") * "+e+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+R+`;

        for (int i = 0; i < `+e+`; i++) {
          inIdx = srcIdx;
          `+S+`
          vec4 candidate = `+R+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+_+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},g$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=s-1-t.padInfo.top,c=u-1-t.padInfo.left,h=1/(e*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+h+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},y$=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=c-1-t.padInfo.front,m=h-1-t.padInfo.top,g=f-1-t.padInfo.left,y=1/(e*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+d+", "+m+", "+g+`);
      const float avgMultiplier = float(`+y+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+h+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},w$=function(t,e,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Le(t,e),Le(t,n);var a="0.0";r!=null&&(Le(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Le(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},x$=function(t,e,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Le(t,e),Le(t,n);var a="vec4(0.0)";r!=null&&(Le(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Le(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},_$="return areal * breal - aimag * bimag;",b$="return areal * bimag + aimag * breal;",j2=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Le(e,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+t+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},zv="return a + b;",Wv="return a - b;",H2="return a * b;",JR="return (a < 0.) ? b * a : a;",Rt=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Le(e,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+t+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},ZR=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,jo=function(t,e,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Le(e,n);var o=this.outputShape.length,i="";if(r)if(o===0||pe(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+lt(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=Qn("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+t+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},E$=function(){function t(e){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),C$=function(){function t(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return t.prototype.getCustomSetupFunc=function(e,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,e),o.gl.uniform1f(r.maxLoc,n)}},t}(),S$=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},I$=function(t){this.outputShape=[],this.outputShape=bu(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var o=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=e.length,a=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},T$=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=bu(t,e);var n=this.outputShape,r=n.length,o=lt(r),i=Qn("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(y,v){return"T"+v});var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var l=a[e],c=a.slice(-2),h=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+h+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var d=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+tf(a,l,d)+`),
            vec2(`+tf(c,l,d)+`));
        }`}var m=s.length,g=s[s.length-1];f+=`
        return getChannel(
          getT`+m+"("+tf(a,l,g)+`),
          vec2(`+tf(c,l,g)+"));",this.userCode=`
      float getValue(`+a.map(function(y){return"int "+y})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function tf(t,e,n){var r=t.indexOf(e);return t.map(function(o,i){return i===r?o+" - "+n:o}).join()}var R$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},A$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=t.dataFormat==="channelsLast",a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},k$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,a=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yF = 0; yF < `+t.outDepth+`; yF++) {
            int xF = wF + yF * `+e+" - "+o+`;

            if (xF < 0 || xF >= `+t.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+t.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+t.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},P$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,l=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+e+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+t.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+e+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+t.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},D$=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+t.batchSize+`; b++) {
          for (int yR = 0; yR < `+t.outHeight+`; yR++) {
            int xR = wR + yR * `+e+" - "+r+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+t.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},N$=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,i=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+e+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+e+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},G2=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),d=t.inChannels%4,m=t.dataFormat==="channelsLast",g=m?1:2,y=m?2:3,v=m?3:1,w="",x="";n&&(w=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var _=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+y+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+t.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+m+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(d===1)+`) {

              if (`+m+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(d===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+m+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(d===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+m+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+_+`
        `+x+`
        setOutput(result);
      }
    `},M$=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+e+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+d+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(m===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+d+`) *
                  getW(wF, wR, wC, `+d+`, d2);
              } else if (`+(m===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+d+`),
                  getX(batch, xF, xR, xC, `+d+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+d+`, d2),
                  getW(wF, wR, wC, `+d+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(m===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+d+`),
                  getX(batch, xF, xR, xC, `+d+` + 1),
                  getX(batch, xF, xR, xC, `+d+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+d+`, d2),
                  getW(wF, wR, wC, `+d+` + 1, d2),
                  getW(wF, wR, wC, `+d+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},q2=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,m=t.outChannels/t.inChannels,g="",y="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,y="result = activation(result);");var v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+m+`;
        int q = d2 - d1 * `+m+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+y+`
        setOutput(result);
      }
    `},K2=function(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,m=d,g="int xR; int xC; int xCOffset;",y=0;y<f;y++)for(var v=0;v<d;v++)g+=`
          vec4 xTexelR`+y+"C"+2*v+` = vec4(0.);
          vec4 wR`+y+"C"+v+` = vec4(0.);
          vec4 xR`+y+"C"+v+" = vec4(0.);";for(y=0;y<f;y++)for(var w=0;w<m;w++){if(g+=`
          xR = xRCorner + `+y*c+`;
          xC = xCCorner + `+(v=2*w)*h+`;
        `,l===1){if(v<d&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+y+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+y+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+y+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+y+"C"+v+" = vec4(previous.zw, xTexelR"+y+"C"+v+`.xy);
                } else {
                  xR`+y+"C"+v+" = vec4(0, 0, xTexelR"+y+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+y+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+v+` = vec4(0.);
                }

                xR`+y+"C"+v+" = xTexelR"+y+"C"+v+`;
              `,v+1<d)){var x=s%2==0?gR(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,h>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+y+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+y+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+y+"C"+(v+1)+` = vec4(
                    xTexelR`+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+y+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+y+"C"+(v+1)+" = xTexelR"+y+"C"+(v+2)+`;
                `}}else v<d&&(g+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+y+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+y+"C"+(v+2)+` = vec4(0.);
                }

                xR`+y+"C"+v+` = vec4(
                  xTexelR`+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+`.zw);
              `,v+1<d&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+y+"C"+(v+1)+" = vec4(xTexelR"+y+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+y+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+y+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+y+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+y+"C"+(v+2)+` = vec4(0.);
                }

                xR`+y+"C"+v+` = vec4(
                  xTexelR`+y+"C"+v+".xy, xTexelR"+y+"C"+(v+2)+`.xy);
              `,v+1<d&&(g+=`
                  xR`+y+"C"+(v+1)+` = vec4(
                    xTexelR`+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+`.zw);
                `)),g+="}");v<d&&(g+=`
            vec4 wTexelR`+y+"C"+v+" = getW("+y+", "+v+`, d1, q);
            wR`+y+"C"+v+" = vec4(wTexelR"+y+"C"+v+".xz, wTexelR"+y+"C"+v+`.xz);
          `,v+1<d&&(g+=`
              vec4 wTexelR`+y+"C"+(v+1)+" = getW("+y+", "+(v+1)+`, d1, q);
              wR`+y+"C"+(v+1)+` =
                vec4(wTexelR`+y+"C"+(v+1)+".xz, wTexelR"+y+"C"+(v+1)+".xz);"))}for(y=0;y<f;y++)for(v=0;v<d;v++)g+="dotProd += xR"+y+"C"+v+" * wR"+y+"C"+v+";";var _="",S="";n&&(_=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,S="result = activation(result);");var R=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+_+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+R+`
        `+S+`
        setOutput(result);
      }
    `},O$=function(t,e,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],a=t[1],s=t[2],u=t[3],l=e[0],c=n[0],h=n[1];this.outputShape=[l,c,h,u];var f=r==="bilinear"?1:0,d=[a-1+".0",s-1+".0"],m=d[0],g=d[1],y=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],v=y[0],w=y[1],x=y[2],_=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],S=_[0],R=_[1],C=_[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+S+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+w+`;
        float width_scale = `+R+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},F$=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=t[t.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+lt(r)+` coords = getOutputCoords();
        int end = `+X2(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+e+`) {
            continue;
          }
          `+X2(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function X2(t,e){if(t===1)return""+e;if(t===2)return e+".y";if(t===3)return e+".z";if(t===4)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var L$=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Cc.DENSE;var e=jl(t),n=Nn();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+$a(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},V$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Cc.DENSE;var e=jl(t),n=Nn();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+$a(["r","c","d"],t)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+e[0]+", "+e[1]+`));
        int index = 4 * (resTexRC.x * `+e[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},B$=function(){function t(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return t.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),$$=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},U$=function(t){this.variableNames=["A"],this.outTexUsage=pr.DOWNLOAD;var e=Nn();this.outputShape=t,this.userCode=`
      `+QR+`

      void main() {
        float x = getAAtOutCoords();
        `+e.output+` = encode_float(x);
      }
    `},z$=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=pr.DOWNLOAD;var e=Nn();this.outputShape=t,this.userCode=`
      `+QR+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+e.output+` = encode_float(x);
      }
    `},W$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Nn(),o=e[0],i=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+ew(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},j$=function(t,e,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Nn(),o=e[0],i=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+t[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+t[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+ew(t)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},H$="return real * expR - imag * expI;",G$="return real * expI + imag * expR;",Q2=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+t+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},q$=function(){function t(e,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,e)}},t}(),K$=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var o=lt(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],h=0;h<a.length;h++)h===s?c.push("int(getIndices("+l[h]+"))"):c.push(""+l[h]);return c.join()}(t,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},X$=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=lt(e.length),o=lt(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function Q$(t,e){var n=Nn();return H5(t,e,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function Y$(t,e){return Q5(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function J$(t,e){return Y5(t,e,new Uint16Array([0,1,2,2,1,3]))}function nh(t,e,n,r,o,i,a){Z5(n,r);var s=J5(t,e),u=t.TEXTURE_2D;return ve(t,e,function(){return t.bindTexture(u,s)}),ve(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),ve(t,e,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),ve(t,e,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),ve(t,e,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),ve(t,e,function(){return t.texImage2D(u,0,o,n,r,0,i,a,null)}),ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function Z$(t,e,n,r,o){var i=im(n,r);return nh(t,e,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function eU(t,e,n,r,o){var i=im(n,r);return nh(t,e,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function tU(t,e,n,r,o){var i=im(n,r);return nh(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function nU(t,e,n,r,o){var i=th(n,r);return nh(t,e,i[0],i[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function rU(t,e,n,r,o){var i=th(n,r);return nh(t,e,i[0],i[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function oU(t,e,n,r){return ve(t,e,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),L2(t,e,n,"clipSpacePos",r,3,20,0)&&L2(t,e,n,"uv",r,2,20,12)}function iU(t,e,n,r,o,i,a){var s,u,l;ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,l=a.internalFormatPackedFloat),s.set(i),ve(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,o,0,t.RGBA,u,s)}),ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function aU(t,e,n,r){ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ve(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):ve(t,e,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),ve(t,e,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function sU(t,e,n,r,o){var i=t.createBuffer();ve(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return ve(t,e,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),ve(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)}),ve(t,e,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),i}function uU(t,e,n){var r=t,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function lU(t,e,n,r,o){var i=im(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return ve(t,e,function(){return t.readPixels(0,0,a,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function cU(t,e,n,r,o,i,a,s){var u=t,l=new Float32Array(function(c,h){var f=th(c,h);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function hU(t,e,n,r){var o=new Float32Array(n*r*4);return ve(t,e,function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,o)}),o}var fU=function(){function t(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Q().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,$5(n,e)):this.gl=Bo(n);var r="WEBGL_color_buffer_float";if(Q().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Yh(this.gl,this.debug,"OES_texture_float"),Fr(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Yh(this.gl,this.debug,"OES_texture_half_float");else if(Q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Fr(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Yh(this.gl,this.debug,"EXT_color_buffer_half_float");else if(Q().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Fr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Fr(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Y$(this.gl,this.debug),this.indexBuffer=J$(this.gl,this.debug),this.framebuffer=e6(this.gl,this.debug),this.textureConfig=j1(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return Q().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ve(n,this.debug,function(){return n.finish()}),ve(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ve(n,this.debug,function(){return n.deleteFramebuffer(e.framebuffer)}),ve(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ve(n,this.debug,function(){return n.deleteBuffer(e.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(e,n){return this.throwIfDisposed(),Z$(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(e,n){return this.throwIfDisposed(),eU(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(e,n){return this.throwIfDisposed(),tU(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(e,n){this.throwIfDisposed(),aU(this.gl,this.debug,e,n)},t.prototype.uploadDenseMatrixToTexture=function(e,n,r,o){this.throwIfDisposed(),iU(this.gl,this.debug,e,n,r,o,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(e,n){return this.throwIfDisposed(),rU(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(e,n){return this.throwIfDisposed(),nU(this.gl,this.debug,e,n,this.textureConfig)},t.prototype.deleteMatrixTexture=function(e){var n=this;this.throwIfDisposed(),this.outputTexture===e&&(V2(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ve(this.gl,this.debug,function(){return n.gl.deleteTexture(e)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return lU(o.gl,o.debug,n,r,o.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(e,n,r,o,i,a){return cU(this.gl,e,0,0,0,i,a,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(e,n){return uU(this.gl,e,n)},t.prototype.createBufferFromTexture=function(e,n,r){this.bindTextureToFrameBuffer(e);var o=sU(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},t.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},t.prototype.createFence=function(e){var n,r,o=this;if(Q().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(e,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return hU(o.gl,o.debug,n,r)})},t.prototype.createProgram=function(e){this.throwIfDisposed();var n=this.gl,r=G5(n,this.debug,e),o=Q$(n,this.debug),i=K5(n,this.debug);return ve(n,this.debug,function(){return n.attachShader(i,o)}),ve(n,this.debug,function(){return n.attachShader(i,r)}),X5(n,this.debug,i),this.debug&&Vv(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=oU(n,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(e){var n=this;this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&ve(this.gl,this.debug,function(){return n.gl.deleteProgram(e)})},t.prototype.setProgram=function(e){var n=this;this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Vv(this.gl,this.debug,this.program),ve(this.gl,this.debug,function(){return n.gl.useProgram(e)})},t.prototype.getUniformLocation=function(e,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?n6(this.gl,this.debug,e,n):r6(this.gl,e,n)},t.prototype.getAttributeLocation=function(e,n){var r=this;return this.throwIfDisposed(),ve(this.gl,this.debug,function(){return r.gl.getAttribLocation(e,n)})},t.prototype.getUniformLocationNoThrow=function(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)},t.prototype.setInputMatrixTexture=function(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),o6(this.gl,this.debug,this.program,e,n,r)},t.prototype.setOutputMatrixTexture=function(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)},t.prototype.setOutputPackedMatrixTexture=function(e,n,r){this.throwIfDisposed();var o=th(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(e,i,a)},t.prototype.setOutputMatrixWriteRegion=function(e,n,r,o){this.setOutputMatrixWriteRegionDriver(r,e,o,n)},t.prototype.setOutputPackedMatrixWriteRegion=function(e,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){this.program!=null&&Vv(this.gl,this.debug,this.program),Jh(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),ve(e,this.debug,function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return e.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Yh(this.gl,this.debug,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(e){return he(this,void 0,void 0,function(){var n=this;return fe(this,function(r){switch(r.label){case 0:return[4,P2(function(){return n.disposed||n.isQueryAvailable(e,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(e,Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(e,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(e,o.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(e,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(e){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return e.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var e=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=e;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},t.prototype.addItemToPoll=function(e,n){var r=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1||P2(function(){return r.pollItems(),r.itemsToPoll.length===0})},t.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Bv(this.gl,this.debug,e,this.framebuffer),this.debug&&Jh(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Bv(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Jh(this.gl)):V2(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(e,n){this.bindTextureToFrameBuffer(e);var r=n();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(e,n,r){this.throwIfDisposed();var o=this.gl;Bv(o,this.debug,e,this.framebuffer),this.debug&&Jh(o),this.outputTexture=e,ve(o,this.debug,function(){return o.viewport(0,0,n,r)}),ve(o,this.debug,function(){return o.scissor(0,0,n,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(e,n,r,o){var i=this;this.throwIfDisposed(),ve(this.gl,this.debug,function(){return i.gl.scissor(e,n,r,o)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},t}();function Y2(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach(function(n,r){var o=n.logicalShape,i=e[r],a=i.shape;if(!ln(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!ln(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var dU=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,h=n.dataFormat,f=s.left,d=s.top,m=o*r,g=Nn(),y=h==="channelsLast",v=y?0:1,w=y?1:2,x="",_=0;_<=1;_++)for(var S=0;S<=1;S++)x+=`
          blockIndex = rc.y + `+S+`;
          pos = rc.x + `+_+`;

          if(blockIndex < `+t[1]+" && pos < "+t[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+d+`;
            d0 = offsetY + `+c+" * (pos / "+m+`);

            if(d0 < `+e[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+m+".) / "+o+`.));

              if(d1 < `+e[w]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+y+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*_+S)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*_+S)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+g.output+` = result;
      }
    `},pU=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},mU=function(t,e,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+e+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+e+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},vU=function(t,e,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},gU=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,a=o-1-t.padInfo.top,s=i-1-t.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+e+`.0;

          if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},yU=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=s-1-t.padInfo.front,h=u-1-t.padInfo.top,f=l-1-t.padInfo.left,d=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+h+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+e+`.0;

          if (dyD < 0.0 || dyD >= `+t.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+t.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+t.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+d+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},jv=function(t,e,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",m="";i&&(d=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,m="result = activation(result);");var g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+d+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+h[0]+" * "+f[0]+`);
          result += (`+h[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+m+`

        setOutput(result);
      }
    `},wU=function(){function t(e,n,r){this.variableNames=["probs"],this.outputShape=[e,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,e)}},t}(),xU=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},_U=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(e===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=Qn("rc",e),r=lt(e),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",h=s-2;h<s;h++)c+=l[h]+" >= "+u[h],h<s-1&&(c+="||");return c}(e,t,n),i=function(s,u,l,c){if(s===1)return"";var h=c.slice(-2);return`
    int r = `+h[0]+`;
    int c = `+h[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(e,t[t.length-1],t[t.length-2],n),a=function(s,u){var l=s.length,c=function(h,f){for(var d=[],m=0;m<=1;m++)for(var g=0;g<=1;g++){for(var y=(m===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<h;v++)y=f[f.length-1-v]+","+y;d.push(y)}return d}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(t,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},bU=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map(function(u,l){return u[0]+t[l]+u[1]});var r=t.length,o=lt(r),i=e.map(function(u){return u[0]}).join(","),a=e.map(function(u,l){return u[0]+t[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},EU=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map(function(y,v){return y[0]+t[v]+y[1]});for(var r=t.length,o=lt(r),i=e.map(function(y){return y[0]}).join(","),a=e.map(function(y,v){return y[0]+t[v]}).join(","),s=Qn("rc",r),u=Qn("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",h=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",m=0,g=r===1?2:4;m<g;m++)d+=`
        `+h[m]+`
        if (`+f+`) {
          result[`+m+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+m+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;d+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+d+`
        setOutput(result);
      }
    `},Hv=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var f=e==="avg",d="0.0";if(f||(d="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+t.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var m=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(m="avgValue / count");var g=4*Math.floor(r/4),y=r%4,v=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+h+`);
      const float initializationValue = `+d+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+d+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+t.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+g+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+v+`
          }

          int xC = xCCorner + `+g+`;
          if (`+(y===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(y===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+v+`
          } else if (`+(y===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+v+`
          }
        }
        setOutput(`+m+`);
      }
    `}},Gv=function(t,e,n){if(this.variableNames=["x"],e==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,m=t.padInfo.top,g=t.padInfo.left;this.outputShape=t.outShape;var y=e==="avg",v="0.0";if(y||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+d+", "+m+", "+g+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+t.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+t.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+t.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+h+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var w=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="avg"&&(w="avgValue / count");var x=4*Math.floor(r/4),_=r%4,S=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+d+", "+m+", "+g+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+t.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+t.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+t.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+S+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(_===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(_===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+S+`
            } else if (`+(_===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+S+`
            }
          }
          setOutput(`+w+`);
        }
      }
    `}},CU=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";e==="prod"?a="1.0":e==="min"?(a="1.0 / 1e-20",s="min"):e==="max"&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";e==="sum"?u="sumValue":e==="prod"?u="prodValue":e==="all"?u="allValue":e==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,h=`
      if (`+(e==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(e==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";e==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):e==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+d+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+h+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+h+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+h+`
        }
        setOutput(`+u+`);
      }
    `},SU=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+$a(["r","c","d"],e)+`
      return ivec3(r, c, d);
    }
  
      `+ew(t)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+t[1]+`;
        int cols = `+t[2]+`;

        `+n+`

        setOutput(result);
      }
    `},IU=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],f=l[1]/c[1],d=1/h,m=1/f,g=2*Math.ceil(d)+2,y=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+d+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},TU=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},RU=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},AU=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],f=l[1]/c[1],d=1/h,m=1/f,g=2*Math.ceil(d)+2,y=2*Math.ceil(m)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+h+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+d+`);
        const float invWidthScale = float(`+m+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+y+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},kU=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var o=t[0],i=t[1],a=t[2],s=t[3];this.outputShape=[o,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},PU=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,n!==1){var r=t.map(function(i,a){return function(s){return e.indexOf(s)!==-1&&t[s]!==1?t[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=lt(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+t[0]+` - coord - 1));
        }
      `},DU=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Qn("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=lt(n);function s(u){var l=t.map(function(c,h){return function(f,d){return e.indexOf(f)!==-1&&t[f]!==1?t[f]+" - "+d[f]+" - 1":""+d[f]}(h,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+t[0]+` - rc - 1),
            `+t[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+t[0]+` - (rc  + 1) - 1),
                `+t[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},J2=function(t,e,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=lt(o.length),u=lt(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",h="";r===1?h="i":r===2&&(h="i, coords[1]");var f="getUpdates("+h+")",d=e>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+t+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+e+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+d+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},NU=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+h+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},MU=function(t,e,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=lt(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},OU=function(){function t(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var n,r=lt(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return qv.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+e.map(function(a,s){return"sourceLoc."+qv[s]+" = start["+s+"] + coords."+qv[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),qv=["x","y","z","w","u","v"],FU=function(){function t(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var n=lt(this.rank),r=Qn("coords",this.rank),o=Qn("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+e[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+e[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+e.map(function(c,h){return"start["+h+"]"}).join()+");":e.map(function(c,h){return o[h]+" = "+r[h]+" + start["+h+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return t.prototype.getCustomSetupFunc=function(e){var n=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,e)}},t}(),LU=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=lt(n.length),i=lt(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+t+`);
      `+o+" strides = "+o+"("+e+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},VU=function(){function t(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(e,n,r){var o,i=Z2(n,r),a=eE(e,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===hr.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===hr.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===hr.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===hr.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===hr.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),o},t.prototype.releaseTexture=function(e,n,r,o){if(this.freeTextures!=null){var i=eE(n,Z2(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(e);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var e=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){e.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){e.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function Z2(t,e){if(t===pr.UPLOAD)return hr.PACKED_2X2_FLOAT32;if(t===pr.RENDER||t==null)return function(n){return Q().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?hr.PACKED_2X2_FLOAT32:hr.UNPACKED_FLOAT32:n?hr.PACKED_2X2_FLOAT16:hr.UNPACKED_FLOAT16}(e);if(t===pr.DOWNLOAD||t===pr.PIXELS)return hr.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function eE(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var BU=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var o=lt(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(t);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},$U=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var o=lt(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(e);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},UU=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=lt(this.rank),i=XR("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},tw=1.7580993408473768,nw=1.0507009873554805,De=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        `+e+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},so="if (isnan(x)) return x;",zU="return x;",tE="return abs(x);",eA=so+`
  return (x < 0.0) ? 0.0 : x;
`,tA=so+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,nA="return (x >= 0.0) ? x : (exp(x) - 1.0);",WU=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+tw+`;
  float scale = `+nw+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,nE="return -x;",rE="return ceil(x);",oE="return floor(x);",iE="return exp(x);",aE="return exp(x) - 1.0;",jU=so+`
  return sin(x);
`,HU=so+`
  return cos(x);
`,GU=so+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,qU=so+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,KU=so+`
  return atan(x);
`,XU=so+"return log(x + sqrt(x * x + 1.0));",QU=so+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,YU=so+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,nf="return x;",JU="return x;",rA=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,oA=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,iA=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Sl=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+e+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},ZU=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=Qn("rc",e),r=lt(e),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(e,n),i=n.slice(-2),a=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},rf={};function of(t,e){if(e===void 0&&(e=!1),t==="linear")return e?JU:zU;if(t==="relu")return e?rA:eA;if(t==="elu")return e?iA:nA;if(t==="relu6")return e?oA:tA;if(t==="prelu")return e?ZR:JR;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var ez=600,tz=function(t){function e(n){var r,o=t.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!Q().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Bo(Q().getNumber("WEBGL_VERSION"));o.binaryCache=((r=Q().getNumber("WEBGL_VERSION"))in rf||(rf[r]={}),rf[r]),o.gpgpu=new fU(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new VU(o.gpgpu),o.numMBBeforeWarning=Q().global.screen==null?1024:Q().global.screen.height*Q().global.screen.width*window.devicePixelRatio*ez/1024/1024,o.texData=new $R(o,B),o}return ao(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(n,r,o){if(Q().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:pr.UPLOAD}),i},e.prototype.move=function(n,r,o,i){if(Q().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:pr.UPLOAD})},e.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Sl(u,nf):new De(u,nf);var h=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(h.dataId);return this.disposeData(h.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var d,m,g=this.activeTimers!=null;return g&&(d=wo()),i==="complex64"?m=Ly(a.real.dataSync(),a.imag.dataSync()):m=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=wo()-d),this.convertAndCacheOnCPU(n,m)},e.prototype.read=function(n){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,h,f,d,m,g,y,v,w,x,_,S,R,C,E;return fe(this,function(I){switch(I.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(T){return r.push(T)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return h=void 0,h=c?new Sl(a,nf):new De(a,nf),f=this.runWebGLProgram(h,[{dataId:n,shape:a,dtype:u}],u),d=this.read(f.dataId),this.disposeData(f.dataId),[2,d];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!Q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Q().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,u!=="complex64"&&Q().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),y=this.texData.get(g.dataId),m=(E=this.gpgpu).createBufferFromTexture.apply(E,[y.texture].concat(jl(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:I.sent(),I.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return w=I.sent(),x=w[0],_=w[1],v=Ly(x,_),[3,5];case 4:m==null?v=this.getValuesFromTexture(n):(S=pe(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(m,S)),I.label=5;case 5:return g!=null&&this.disposeData(g.dataId),R=this.convertAndCacheOnCPU(n,v),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(T){return T(R)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,R]}})})},e.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!W5(o))throw Q().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},e.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=pe(i);if(Q().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),h=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(jl(i))).subarray(0,u);return this.disposeData(l.dataId),h}var f=Q().getBool("WEBGL_PACK")&&s===!0,d=f?$v(i):i,m=f?new z$(d):new U$(d),g=this.runWebGLProgram(m,[{shape:d,dtype:a,dataId:n}],"float32"),y=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(y.texture,y.texShape[0],y.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},e.prototype.time=function(n){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return fe(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=xu(this.activeTimers.map(function(h){return h.query})).filter(function(h){return h!=null}),s=xu(this.activeTimers.map(function(h){return h.name})).filter(function(h){return h!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=E5(l),u.getExtraProfileInfo=function(){return l.map(function(h,f){return{name:s[f],ms:h}}).map(function(h){return h.name+": "+h.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:wo(),endMs:null}},e.prototype.endTimer=function(n){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=wo(),n)},e.prototype.getQueryTime=function(n){return he(this,void 0,void 0,function(){var r;return fe(this,function(o){return Q().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},e.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},e.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,h=this.dataRefCount.get(c);h>1?this.dataRefCount.set(c,h-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},e.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},e.prototype.getDataInfo=function(n){return this.texData.get(n)},e.prototype.getCPUBackend=function(){return Q().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=B.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:B.keep(n.clone()),imag:B.keep(r.clone())},o},e.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(pe(o)===0)return gn([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=VR(n.shape,r,o);if(i||!a){var s=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FU(o):new OU(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},e.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=BR(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},e.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=X1(r,o,i);if(a.some(function(u){return u===0}))return gn([],a);var s=new LU(r,i,a);return this.compileAndRun(s,[n])},e.prototype.reverse=function(n,r){var o=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new DU(n.shape,r):new PU(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(d){return Nr(d)}),i=n.map(function(d){return bo(d)});return dn(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>Q().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new T$(n.map(function(d){return d.shape}),r);return this.compileAndRun(l,n)}var c=bu(n.map(function(d){return d.shape}),r),h=n.map(function(d){return d.as2D(-1,pe(d.shape.slice(r)))}),f=new I$(h.map(function(d){return d.shape}));return this.compileAndRun(f,h).reshape(c)},e.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,nE,n.dtype);var r=new De(n.shape,nE);return this.compileAndRun(r,[n])},e.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),h=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(h,!0)}var d=pn(n.dtype,r.dtype),m=new jv(n.shape,[l,a,s],o,i);return this.compileAndRun(m,[n,r],d)},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],h=a?o.shape[1]:o.shape[2],f=r.shape[0],d=pn(r.dtype,o.dtype),m=s!=null,g=l!=null,y=u?of(u,!0):null,v=new jv(r.shape,[f,c,h],i,a,m,y,g),w=[r,o];return s&&w.push(s),l&&w.push(l),this.compileAndRun(v,w,d)},e.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new j2(_$,n.shape,r.shape),s=new j2(b$,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),h=this.complex(l,c);return l.dispose(),c.dispose(),h}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,H2,n.dtype);var f=new Rt(H2,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),Q().getBool("WEBGL_PACK_NORMALIZATION")){var h=new x$(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(h,u)}var f=new w$(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=Q().getBool("WEBGL_PACK_NORMALIZATION")?new vU(n.shape,r,o,i,a):new pU(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new mU(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},e.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Cd(a)});return qR(Ae(n.shape,n.dtype,o),r)}var i=new BU(n.shape,r);return this.compileAndRun(i,[n])},e.prototype.pad=function(n,r,o){var i=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EU(n.shape,r,o):new bU(n.shape,r,o);return this.compileAndRun(i,[n])},e.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=Q().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UU(n.shape,r):new $U(n.shape,r);return this.compileAndRun(o,[n])},e.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new K$(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},e.prototype.batchToSpaceND=function(n,r,o){O(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(h,f){return h*f}),a=kd(n.shape,r,i),s=Pd(a.length,r.length),u=Dd(n.shape,r,i),l=MR(o,r.length),c=OR(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(n,r,o){O(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,d){return f*d}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=kd(u.shape,r,i,!1),c=Pd(l.length,r.length,!1),h=Dd(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(h)},e.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Uv(a),u=new CU({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},e.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Uv(a),u=new c$({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},e.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Uv(i[i.length-1]),s=new v$(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},e.prototype.sum=function(n,r){cr("sum",r,n.rank);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a),u=Nv(n.dtype);return this.reduce(s,"sum",u).reshape(i)},e.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a),u=Nv(n.dtype);return this.reduce(s,"prod",u).reshape(i)},e.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=$o([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Uo(1,n.rank)[0]);var u=function(d,m,g){for(var y=[],v=d.length,w=0;w<v;w++)w!==m?y.push(d[w]):y.push(g);return y}(s.shape,i,o),l=pe([s.shape[i]]),c=s.as2D(-1,l),h=Nv(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,h,o).reshape(u);return a!=null&&(f=f.transpose(H1(a))),f},e.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(f,d){var m,g=!1;for(f<=LR?(m=f,g=!0):m=Ry(f,Math.floor(Math.sqrt(f)));!g;)m>d||m===f?g=!0:m=Ry(f,m+1);return m}(u,a),c=new NU({windowSize:l,inSize:u,batchSize:s,numSegments:a}),h=this.compileAndRun(c,[n,o],i);return h.shape[1]===a?h:(o=Ad(0,a).tile([u/l]),this.segOpCompute(h,r,o,i,a))},e.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(cr("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!Q().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Rn(n.shape,i),s=a[0],u=pe(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},e.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},e.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},e.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new F$(n.shape,o,i);return this.compileAndRun(a,[n])},e.prototype.equal=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new Rt("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.notEqual=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new Rt("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new Rt("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.lessEqual=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new Rt("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new Rt("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.greaterEqual=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new Rt("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalNot=function(n){var r=new De(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},e.prototype.logicalAnd=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new Rt("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.logicalOr=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new Rt("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},e.prototype.select=function(n,r,o){var i=new MU(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],pn(r.dtype,o.dtype))},e.prototype.where=function(n){Td("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Z1(n.shape,r)},e.prototype.topk=function(n,r,o){return KR(n.dataSync(),n.shape,n.dtype,r)},e.prototype.min=function(n,r){cr("min",r,n.rank);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},e.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Rt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.mod=function(n,r){var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Rt(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);cr("max",r,n.rank);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},e.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Rt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.all=function(n,r){cr("all",r,n.rank);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},e.prototype.any=function(n,r){cr("any",r,n.rank);var o=Rn(n.shape,r),i=o[0],a=pe(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},e.prototype.realDivide=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new Rt(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},e.prototype.floorDiv=function(n,r){if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new Rt(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},e.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,zv);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=pn(n.dtype,r.dtype);if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,zv,o);var i=new Rt(zv,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.packedUnaryOp=function(n,r,o){var i=new Sl(n.shape,r);return this.compileAndRun(i,[n],o)},e.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new jo(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},e.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var d=f[0],m=f[1],g=i.makeComplexComponentTensorInfo(n,d),y=i.makeComplexComponentTensorInfo(r,m),v=new Rt(o,n.shape,r.shape);return i.compileAndRun(v,[g,y],pn(d.dtype,m.dtype))}),l=u[0],c=u[1],h=this.complex(l,c);return l.dispose(),c.dispose(),h},e.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},e.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>Q().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return pn(l,c)}),s=n.map(function(l){return l.shape}),u=Q().getBool("WEBGL_PACK")?new l$(n[0].shape,s):new u$(n[0].shape,s);return this.compileAndRun(u,n,a)},e.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Wv);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=pn(n.dtype,r.dtype);if(Q().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Wv,n.dtype);var i=new Rt(Wv,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},e.prototype.pow=function(n,r){var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Rt(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=pn(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},e.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,rE,n.dtype);var r=new De(n.shape,rE);return this.compileAndRun(r,[n])},e.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,oE,n.dtype);var r=new De(n.shape,oE);return this.compileAndRun(r,[n])},e.prototype.sign=function(n){var r=new De(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},e.prototype.isNaN=function(n){var r=new De(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isInf=function(n){var r=new De(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.isFinite=function(n){var r=new De(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},e.prototype.round=function(n){var r=new De(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},e.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,iE,n.dtype);var r=new De(n.shape,iE);return this.compileAndRun(r,[n])},e.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,aE,n.dtype);var r=new De(n.shape,aE);return this.compileAndRun(r,[n])},e.prototype.softmax=function(n,r){var o=tn([r],n.shape),i=this.max(n,o),a=or(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},e.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new De(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},e.prototype.log1p=function(n){var r=new De(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},e.prototype.sqrt=function(n){var r=new De(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},e.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new De(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},e.prototype.reciprocal=function(n){var r=new De(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},e.prototype.relu=function(n){var r;return r=Q().getBool("WEBGL_PACK")?new Sl(n.shape,rA):new De(n.shape,eA),this.compileAndRun(r,[n])},e.prototype.relu6=function(n){var r;return r=Q().getBool("WEBGL_PACK")?new Sl(n.shape,oA):new De(n.shape,tA),this.compileAndRun(r,[n])},e.prototype.prelu=function(n,r){var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(ZR,n.shape,r.shape):new Rt(JR,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.elu=function(n){if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,iA,n.dtype);var r=new De(n.shape,nA);return this.compileAndRun(r,[n])},e.prototype.eluDer=function(n,r){var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Rt("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.selu=function(n){var r=new De(n.shape,WU);return this.compileAndRun(r,[n])},e.prototype.int=function(n){var r=new De(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},e.prototype.clip=function(n,r,o){var i,a=(i=Q().getBool("WEBGL_PACK_CLIP")?new C$(n.shape):new E$(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},e.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(Q().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,tE,n.dtype);var r=new De(n.shape,tE);return this.compileAndRun(r,[n])},e.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new S$(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},e.prototype.sigmoid=function(n){var r=new De(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},e.prototype.softplus=function(n){var r=new De(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},e.prototype.sin=function(n){var r=new De(n.shape,jU);return this.compileAndRun(r,[n])},e.prototype.cos=function(n){var r=new De(n.shape,HU);return this.compileAndRun(r,[n])},e.prototype.tan=function(n){var r=new De(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},e.prototype.asin=function(n){var r=new De(n.shape,GU);return this.compileAndRun(r,[n])},e.prototype.acos=function(n){var r=new De(n.shape,qU);return this.compileAndRun(r,[n])},e.prototype.atan=function(n){var r=new De(n.shape,KU);return this.compileAndRun(r,[n])},e.prototype.atan2=function(n,r){var o=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Rt(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},e.prototype.sinh=function(n){var r=new De(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.cosh=function(n){var r=new De(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},e.prototype.tanh=function(n){var r=new De(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},e.prototype.asinh=function(n){var r=new De(n.shape,XU);return this.compileAndRun(r,[n])},e.prototype.acosh=function(n){var r=new De(n.shape,QU);return this.compileAndRun(r,[n])},e.prototype.atanh=function(n){var r=new De(n.shape,YU);return this.compileAndRun(r,[n])},e.prototype.erf=function(n){var r=new De(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},e.prototype.step=function(n,r){var o=new De(n.shape,function(i){return i===void 0&&(i=0),so+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},e.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,h=u[0]*u[1]*u[2],f=o.outChannels,d=o.dataFormat==="channelsLast",m=(h===1||f===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(m||!Q().getBool("WEBGL_LAZILY_UNPACK")||!Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var y=d?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,y,o.inChannels]),w=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:w,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=d?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),_={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},S=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,O(ef(l.shape,_.shape),function(){return"packed reshape "+l.shape+" to "+_.shape+" isn't free"});var R=this.reshape(r,[1,o.inChannels,o.outChannels]),C=this.fusedBatchMatMul({a:_,b:R,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),E=this.texData.get(C.dataId);return O(E.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=S,E.shape=o.outShape,B.makeTensorFromDataId(C.dataId,o.outShape,C.dtype)},e.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,h=o.outWidth,f=o.outHeight,d=o.dataFormat==="channelsLast",m=u*l*c,g=f*h,y=[m,g],v=n.squeeze([0]),w=r.reshape([1,m,-1]),x=new dU(y,v.shape,o),_=this.compileAndRun(x,[v]).reshape([1,y[0],y[1]]),S=i!=null,R=s!=null,C=a?of(a,!0):null,E=new jv(_.shape,[1,g,o.outChannels],!0,!1,S,C,R),I=[_,w];i&&I.push(i),R&&I.push(s);var T=this.compileAndRun(E,I);return d?T.reshape([1,f,h,o.outChannels]):T.reshape([1,o.outChannels,f,h])},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(Q().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,h=s?of(s,!1):null,f=new G2(i,l,h,c),d=[r,o];return a&&d.push(a),u&&d.push(u),this.compileAndRun(f,d)},e.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(Q().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new G2(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerInput=function(n,r,o){var i=new A$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv2dDerFilter=function(n,r,o){var i=new R$(o);return this.compileAndRun(i,[n,r])},e.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=Q().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,h=u?of(u,c):null,f=[o,i],d=s!=null,m=l!=null;return d&&f.push(s),m&&f.push(l),c?(r=new K2(a,d,h,m),this.compileAndRun(r,f)):(r=new q2(a,d,h,m),this.compileAndRun(r,f))},e.prototype.depthwiseConv2D=function(n,r,o){var i;return Q().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new K2(o),this.compileAndRun(i,[n,r])):(i=new q2(o),this.compileAndRun(i,[n,r]))},e.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new N$(o);return this.compileAndRun(i,[n,r])},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new D$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3d=function(n,r,o){var i=new M$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerInput=function(n,r,o){var i=new P$(o);return this.compileAndRun(i,[n,r])},e.prototype.conv3dDerFilter=function(n,r,o){var i=new k$(o);return this.compileAndRun(i,[n,r])},e.prototype.maxPool=function(n,r){var o=new Hv(r,"max",!1);return this.compileAndRun(o,[n])},e.prototype.avgPool=function(n,r){var o=new Hv(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPoolBackprop=function(n,r,o,i){var a=new Hv(i,"max",!0),s=this.compileAndRun(a,[r]),u=new gU(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},e.prototype.avgPoolBackprop=function(n,r,o){var i=new g$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.cast=function(n,r){return WR(n,r,this)},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},e.prototype.avgPool3d=function(n,r){var o=new Gv(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.avgPool3dBackprop=function(n,r,o){var i=new y$(o);return this.compileAndRun(i,[n],r.dtype)},e.prototype.maxPool3d=function(n,r){var o=new Gv(r,"max",!1);return this.compileAndRun(o,[n],"float32")},e.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Gv(i,"max",!0),s=this.compileAndRun(a,[r]),u=new yU(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},e.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!ef(n.shape,r)&&(o.texture===null||!ef(o.shape,r))){var i=this.packedReshape(n,r);return B.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Fy(n,r)},e.prototype.resizeBilinear=function(n,r,o,i){var a=Q().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new RU(n.shape,r,o,i):new TU(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},e.prototype.resizeBilinearBackprop=function(n,r,o){var i=new IU(n,r,o);return this.compileAndRun(i,[n])},e.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new kU(n.shape,r,o,i);return this.compileAndRun(a,[n])},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new AU(n,r,o);return this.compileAndRun(i,[n])},e.prototype.multinomial=function(n,r,o,i){var a=r?n:vi(n),s=a.shape[0],u=a.shape[1],l=new wU(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},e.prototype.oneHot=function(n,r,o,i){var a=new xU(n.size,r,o,i);return this.compileAndRun(a,[n])},e.prototype.diag=function(n){var r=new $$(n.size);return this.compileAndRun(r,[n])},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return Td("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Y1(n.dataSync(),r.dataSync(),o,i,a)},e.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new O$(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},e.prototype.depthToSpace=function(n,r,o){O(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,h=u/(r*r),f=new B$(o==="NHWC"?[i,l,c,h]:[i,h,l,c],r,o);return this.compileAndRun(f,[n])},e.prototype.split=function(n,r,o){return GR(n,r,o)},e.prototype.scatterND=function(n,r,o){var i=Nd(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,h=[c/u,u],f=n.reshape([s,a]),d=r.reshape([s,u]);if(c===0)return Fy(gn([]),o);var m=ae(0),g=new J2(s,a,f.rank,d.rank,l,h);return this.compileAndRun(g,[d,f,m]).reshape(o)},e.prototype.sparseToDense=function(n,r,o,i){var a=Nd(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,h=new J2(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(h,[r,n,i]).reshape(o)},e.prototype.fft=function(n){return this.fftImpl(n,!1)},e.prototype.ifft=function(n){return this.fftImpl(n,!0)},e.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new Q2(H$,n.shape,r),a=new Q2(G$,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=FR(n,r),s=a[0],u=a[1],l=a[2],c=a[3],h=r.reshape([u,i]),f=n.reshape([n.size/l,l]),d=new X$(i,c,[u,l]);return this.compileAndRun(d,[f,h]).reshape(s)},e.prototype.fill=function(n,r,o){if((o=o||Zc(r))==="string"){var i=Ed(o,pe(n));return i.fill(r),B.makeTensor(i,n,o,this)}var a=new q$(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},e.prototype.linspace=function(n,r,o){return jR(n,r,o)},e.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},e.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return B.makeTensorFromDataId(o,n,r,this)},e.prototype.unpackTensor=function(n){var r=new ZU(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},e.prototype.packTensor=function(n){var r=new _U(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},e.prototype.packedReshape=function(n,r){var o=[Sd(n.shape)].concat(Id(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[Sd(r)].concat(Id(r)),s=new SU(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},e.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=$v(a);return r=i?new V$(u):new L$(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},e.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Cc.DENSE){var c=jl(n.outputShape);l.texShape=c.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),pe(u.shape)===0)return l.values=bc(u.dtype,0),u;var h=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var _=s.texData.get(x.dataId);if(_.texture==null){if(!n.packedInputs&&pe(x.shape)<=Q().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:_.values};n.packedInputs&&(_.isPacked=!0,_.shape=x.shape)}else if(!!_.isPacked!=!!n.packedInputs)x=_.isPacked?s.unpackTensor(x):s.packTensor(x),h.push(x),_=s.texData.get(x.dataId);else if(_.isPacked&&!ef(_.shape,x.shape)){var S=x,R=x.shape;x.shape=_.shape,x=s.packedReshape(x,R),h.push(x),_=s.texData.get(x.dataId),S.shape=R}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:_,isUniform:!1}});this.uploadToGPU(u.dataId);var d,m={shape:u.shape,texData:l,isUniform:!1},g=function(x,_,S){var R="";_.concat(S).forEach(function(I){var T=I.texData!=null&&I.texData.slice!=null&&I.texData.slice.flatOffset>0,k=I.isUniform?"uniform":I.texData.texShape;R+=I.shape+"_"+k+"_"+T});var C=x.userCode,E=x.constructor.name;return E+="_"+R+"_"+C}(n,f,m),y=this.getAndSaveBinary(g,function(){return function(x,_,S,R){var C=_.userCode,E=S.map(function(V,W){var H={logicalShape:V.shape,texShape:V.isUniform?null:V.texData.texShape,isUniform:V.isUniform,isPacked:!V.isUniform&&V.texData.isPacked,flatOffset:null};return V.texData!=null&&V.texData.slice!=null&&V.texData.slice.flatOffset>0&&(H.flatOffset=V.texData.slice.flatOffset),{name:_.variableNames[W],shapeInfo:H}}),I=E.map(function(V){return V.shapeInfo}),T={logicalShape:R.shape,texShape:R.texData.texShape,isUniform:!1,isPacked:R.texData.isPacked,flatOffset:null},k=h$(E,T,C,_.packedInputs),P=x.createProgram(k),D=null,$=x.getUniformLocation(P,"NAN",!1);Q().getNumber("WEBGL_VERSION")===1&&(D=x.getUniformLocation(P,"INFINITY",!1));for(var U={},K=0;K<_.variableNames.length;K++){var X=_.variableNames[K];U[X]=x.getUniformLocation(P,X,!1),U["offset"+X]=x.getUniformLocation(P,"offset"+X,!1)}return{program:_,source:k,webGLProgram:P,uniformLocations:U,inShapeInfos:I,outShapeInfo:T,infLoc:D,nanLoc:$}}(s.gpgpu,n,f,m)}),v=this.activeTimers!=null;if(v&&(d=this.startTimer()),function(x,_,S,R,C){Y2(_.inShapeInfos,S),Y2([_.outShapeInfo],[R]);var E=R.texData.texture,I=R.texData.texShape;R.texData.isPacked?x.setOutputPackedMatrixTexture(E,I[0],I[1]):x.setOutputMatrixTexture(E,I[0],I[1]),x.setProgram(_.webGLProgram),Q().getNumber("WEBGL_VERSION")===1&&_.infLoc!==null&&x.gl.uniform1f(_.infLoc,1/0),_.nanLoc!==null&&x.gl.uniform1f(_.nanLoc,NaN),S.forEach(function(T,k){var P=_.program.variableNames[k],D=_.uniformLocations[P],$=_.uniformLocations["offset"+P];if(D!=null)if(T.isUniform)if(pe(T.shape)<2)x.gl.uniform1f(D,T.uniformValues[0]);else{var U=T.uniformValues;U instanceof Float32Array||(U=new Float32Array(U)),x.gl.uniform1fv(D,U)}else T.texData.slice!=null&&$!=null&&x.gl.uniform1i($,T.texData.slice.flatOffset),x.setInputMatrixTexture(T.texData.texture,D,k)}),C!=null&&C(x,_.webGLProgram),x.executeProgram()}(this.gpgpu,y,f,m,i),h.forEach(function(x){return s.disposeData(x.dataId)}),v&&(d=this.endTimer(d),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(d)})),!Q().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var w=this.unpackTensor(u);return this.disposeData(u.dataId),w}return u},e.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return B.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},e.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var n=this;this.disposed||(Q().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=le(function(){if(!Q().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=Q().getBool("DEBUG");Q().set("DEBUG",!1);var o=n.abs(ae(1e-8)).dataSync()[0];if(Q().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var h,f=this.activeTimers!=null;f&&(h=wo());var d=o.texShape;if(d==null&&(d=s6(i,c),o.texShape=d),s!=null){var m=$v(i),g=void 0,y=d[1],v=d[0],w=s instanceof Uint8Array;c?(y=(r=th(d[0],d[1]))[0],v=r[1],g=new j$(m,[v,y],w)):g=new W$(m,[v,y],w);var x=this.makeTensorInfo([v,y],a);this.texData.get(x.dataId).usage=w?pr.PIXELS:pr.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),y,v,s);var _=this.runWebGLProgram(g,[x],a,null,!0),S=this.texData.get(_.dataId);o.texture=S.texture,o.texShape=S.texShape,o.isPacked=S.isPacked,o.usage=S.usage,this.disposeData(x.dataId),this.texData.delete(_.dataId),o.values=null,f&&(this.uploadWaitMs+=wo()-h)}else{var R=this.acquireTexture(d,l,a,c);o.texture=R}}},e.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},e.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},e.prototype.computeBytes=function(n,r){return n[0]*n[1]*yR(r)},e}(UR);SR()&&B.registerBackend("webgl",function(){return new tz},2);var nz=L({square_:function(t){var e=N(t,"x","square"),n=[e];return B.runKernelFunc(function(r,o){return o([e]),r.square(e)},{x:e},null,"Square",{},n,[])}}),Ic="SquaredDifference",aA=L({squaredDifference_:function(t,e){var n,r=N(t,"a","squaredDifference"),o=N(e,"b","squaredDifference");n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return B.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],h=ae(2);return{a:function(){return s.mul(l.sub(c).mul(h))},b:function(){return s.mul(c.sub(l).mul(h))}}},Ic,{},a,[])}}),rz=L({abs_:function(t){var e=N(t,"x","abs");return e.dtype==="complex64"?B.runKernelFunc(function(n){return n.complexAbs(e)},{$x:e}):B.runKernelFunc(function(n,r){var o=n.abs(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),oz=L({acos_:function(t){var e=N(t,"x","acos");return B.runKernelFunc(function(n,r){var o=n.acos(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),iz=L({acosh_:function(t){var e=N(t,"x","acosh");return B.runKernelFunc(function(n,r){var o=n.acosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),az=L({asin_:function(t){var e=N(t,"x","asin");return B.runKernelFunc(function(n,r){var o=n.asin(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).sub(o.toFloat().square()).sqrt())}}})}}),sz=L({asinh_:function(t){var e=N(t,"x","asinh");return B.runKernelFunc(function(n,r){var o=n.asinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ae(1).add(o.toFloat().square()).sqrt())}}})}}),uz=L({atan_:function(t){var e=N(t,"x","atan");return B.runKernelFunc(function(n,r){var o=n.atan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),lz=L({atanh_:function(t){var e=N(t,"x","atanh");return B.runKernelFunc(function(n,r){var o=n.atanh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(ae(1).sub(o.toFloat().square()))}}})}}),cz=L({ceil_:function(t){var e=N(t,"x","ceil");return B.runKernelFunc(function(n){return n.ceil(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),rw=L({clipByValue_:function(t,e,n){var r=N(t,"x","clipByValue");O(e<=n,function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."});var o=[r],i={min:e,max:n};return B.runKernelFunc(function(a,s){var u=a.clip(r,e,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(e).logicalAnd(u.lessEqual(n)),We(a))}}},"ClipByValue",i,o)}}),hz=L({cos_:function(t){var e=N(t,"x","cos"),n=[e];return B.runKernelFunc(function(r,o){var i=r.cos(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),fz=L({cosh_:function(t){var e=N(t,"x","cosh");return B.runKernelFunc(function(n,r){var o=n.cosh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),dz=L({erf_:function(t){var e=N(t,"x","erf");return O(e.dtype==="int32"||e.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),e.dtype==="int32"&&(e=e.toFloat()),B.runKernelFunc(function(n,r){var o=n.erf(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Vy=L({exp_:function(t){var e=N(t,"x","exp");return B.runKernelFunc(function(n,r){var o=n.exp(e);return r([o]),o},{x:e},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),pz=L({expm1_:function(t){var e=N(t,"x","expm1");return B.runKernelFunc(function(n,r){var o=n.expm1(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),mz=L({floor_:function(t){var e=N(t,"x","floor");return B.runKernelFunc(function(n){return n.floor(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),vz=L({log_:function(t){var e=N(t,"x","log"),n=[e];return B.runKernelFunc(function(r,o){var i=r.log(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),gz=L({log1p_:function(t){var e=N(t,"x","log1p");return B.runKernelFunc(function(n,r){var o=n.log1p(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),yz=L({logSigmoid_:function(t){var e=N(t,"x","logSigmoid");return B.runKernelFunc(function(n,r){var o=n.softplus(e.neg()).neg();return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Ld=L({neg_:function(t){var e=N(t,"x","neg"),n=[e];return B.runKernelFunc(function(r){return r.neg(e)},{x:e},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),wz=L({reciprocal_:function(t){var e=N(t,"x","reciprocal");return B.runKernelFunc(function(n,r){var o=n.reciprocal(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),xz=L({round_:function(t){var e=N(t,"x","round");return B.runKernelFunc(function(n){return n.round(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),sA=L({rsqrt_:function(t){var e=N(t,"x","rsqrt"),n=[e];return B.runKernelFunc(function(r,o){var i=r.rsqrt(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),uA=L({sigmoid_:function(t){var e=N(t,"x","sigmoid");return B.runKernelFunc(function(n,r){var o=n.sigmoid(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ae(1).sub(o)))}}},"Sigmoid")}}),_z=L({sign_:function(t){var e=N(t,"x","sign");return B.runKernelFunc(function(n){return n.sign(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),bz=L({isNaN_:function(t){var e=N(t,"x","isNaN");return B.runKernelFunc(function(n){return n.isNaN(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),Ez=L({isInf_:function(t){var e=N(t,"x","isInf");return B.runKernelFunc(function(n){return n.isInf(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),Cz=L({isFinite_:function(t){var e=N(t,"x","isFinite");return B.runKernelFunc(function(n){return n.isFinite(e)},{$x:e},function(n){return{$x:function(){return We(n)}}})}}),Sz=L({sin_:function(t){var e=N(t,"x","sin"),n=[e];return B.runKernelFunc(function(r,o){var i=r.sin(e);return o([e]),i},{x:e},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),Iz=L({sinh_:function(t){var e=N(t,"x","sinh");return B.runKernelFunc(function(n,r){var o=n.sinh(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),Tz=L({softplus_:function(t){var e=N(t,"x","softplus");return B.runKernelFunc(function(n,r){var o=n.softplus(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),Rz=L({sqrt_:function(t){var e=N(t,"x","sqrt");return B.runKernelFunc(function(n,r){var o=n.sqrt(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),Az=L({step_:function(t,e){e===void 0&&(e=0);var n=N(t,"x","step");return B.runKernelFunc(function(r){return r.step(n,e)},{$x:n},function(r){return{$x:function(){return We(r)}}})}}),kz=L({tan_:function(t){var e=N(t,"x","tan");return B.runKernelFunc(function(n,r){var o=n.tan(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),Pz=L({tanh_:function(t){var e=N(t,"x","tanh");return B.runKernelFunc(function(n,r){var o=n.tanh(e);return r([o]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return ae(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function lA(t,e,n,r,o,i){var a,s,u=N(t,"x","batchNorm"),l=N(e,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),O(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),O(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),O(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),rh(u,l,c,s,a,i)}function cA(t,e,n,r,o,i){var a,s,u=N(t,"x","batchNorm"),l=N(e,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),O(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),O(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),O(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),rh(u,l,c,s,a,i)}function hA(t,e,n,r,o,i){var a,s,u=N(t,"x","batchNorm"),l=N(e,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),O(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),O(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),O(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&O(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&O(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),rh(u,l,c,s,a,i)}function rh(t,e,n,r,o,i){i==null&&(i=.001);var a,s,u,l=N(t,"x","batchNorm"),c=N(e,"mean","batchNorm"),h=N(n,"variance","batchNorm");o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),O(c.rank===h.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),O(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),O(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,h,a];return B.runKernelFunc(function(d,m){var g=d.batchNormalization(u,af(c),af(h),i,af(a),af(s));return m([l,c,h,a]),g},{x:l,mean:c,variance:h,scale:a,offset:s},function(d,m){var g=m,y=g[0],v=g[1],w=g[2],x=g[3],_=x??ae(1),S=Zt(v.shape,u.shape),R=[];if(v.rank===1){for(var C=0;C<u.shape.length-1;++C)R.push(u.shape[C]);R.push(1)}var E=y.sub(v),I=d.mul(_),T=sA(w.add(ae(i))),k=T.mul(T).mul(T).mul(ae(-.5));return{x:function(){return v.rank===1?d.mul(nu(T.as4D(1,1,1,v.shape[0]),R)).mul(_).reshape(y.shape):d.mul(T).mul(_).reshape(y.shape)},mean:function(){var P=T.mul(ae(-1)).mul(I);return v.rank===1&&(P=P.sum(S)),P.reshape(v.shape)},variance:function(){var P=k.mul(E).mul(I);return v.rank===1&&(P=P.sum(S)),P.reshape(v.shape)},scale:function(){var P=E.mul(T),D=d.mul(P);return v.rank===1&&(D=D.sum(S)),D.reshape(v.shape)},offset:function(){var P=d;return v.rank===1&&(P=P.sum(S)),P.reshape(v.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(l.shape)}function af(t){return t==null?null:t.rank===0?t.as1D():t.rank===1?t:t.rank===2?t.as4D(1,1,t.shape[0],t.shape[1]):t.rank===3?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function um(){IR("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Dz=L({batchNormalization2d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),um(),lA(t,e,n,i,o,r)}}),Nz=L({batchNormalization3d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),um(),cA(t,e,n,i,o,r)}}),Mz=L({batchNormalization4d_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),um(),hA(t,e,n,i,o,r)}}),Oz=L({batchNormalization_:function(t,e,n,r,o,i){return r===void 0&&(r=.001),um(),rh(t,e,n,i,o,r)}}),fA=L({batchNorm_:rh}),Fz=L({batchNorm2d_:lA}),Lz=L({batchNorm3d_:cA}),Vz=L({batchNorm4d_:hA}),lm=L({logicalAnd_:function(t,e){var n=N(t,"a","logicalAnd","bool"),r=N(e,"b","logicalAnd","bool");return Le(n.shape,r.shape),B.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),Bz=L({logicalNot_:function(t){var e=N(t,"x","logicalNot","bool");return B.runKernelFunc(function(n){return n.logicalNot(e)},{$x:e})}}),dA=L({logicalOr_:function(t,e){var n=N(t,"a","logicalOr","bool"),r=N(e,"b","logicalOr","bool");return Le(n.shape,r.shape),B.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),$z=L({logicalXor_:function(t,e){var n=N(t,"a","logicalXor","bool"),r=N(e,"b","logicalXor","bool");return Le(n.shape,r.shape),dA(t,e).logicalAnd(lm(t,e).logicalNot())}}),Ja=L({where_:function(t,e,n){var r=N(e,"a","where"),o=N(n,"b","where"),i=N(t,"condition","where","bool");return Ye(r.shape,o.shape,"Error in where: "),i.rank===1?O(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ye(i.shape,o.shape,"Error in where: "),B.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return We(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),pA=function(t){return he(this,void 0,void 0,function(){var e,n,r;return fe(this,function(o){switch(o.label){case 0:return[4,(e=N(t,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Z1(e.shape,n),t!==e&&e.dispose(),[2,r]}})})},Oe=L({add_:function(t,e){var n,r=N(t,"a","add"),o=N(e,"b","add");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Zt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Zt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),Uz=L({addN_:function(t){O(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),O(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var e=t.map(function(o,i){return N(o,"tensors"+i,"addN")}),n=e[0];e.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(function(o){if(!ln(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=e;return B.runKernelFunc(function(o){return o.addN(e)},r,function(o){var i={};return e.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),zz=L({addStrict_:function(t,e){var n=N(t,"a","addStrict"),r=N(e,"b","addStrict");return Ye(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Wz=L({atan2_:function(t,e){var n,r=N(t,"a","atan2"),o=N(e,"b","atan2");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Oe(u.square(),l.square()),h=a.mul(l.div(c)),f=Zt(u.shape,i);return f.length>0&&(h=h.sum(f)),h.reshape(u.shape)},$b:function(){var c=Oe(u.square(),l.square()),h=Ld(a.mul(u.div(c))),f=Zt(l.shape,i);return f.length>0&&(h=h.sum(f)),h.reshape(l.shape)}}})}}),Qr=L({div_:function(t,e){var n,r=N(t,"a","div"),o=N(e,"b","div");if(n=St(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return mA(r,o);var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),h=Zt(u.shape,i);return h.length>0?c.sum(h).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),h=Zt(l.shape,i);h.length>0&&(c=c.sum(h).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),jz=L({divNoNan_:function(t,e){var n,r=N(t,"a","div"),o=N(e,"b","div");r=(n=St(r,o))[0],o=n[1];var i=Qr(r,o),a=We(i),s=o.equal(a);return Ja(s,a,i)}}),Hz=L({divStrict_:function(t,e){var n=N(t,"a","div"),r=N(e,"b","div");return Ye(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),mA=L({floorDiv_:function(t,e){var n,r=N(t,"a","floorDiv"),o=N(e,"b","floorDiv");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),h=Zt(u.shape,i);return h.length>0?c.sum(h).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),h=Zt(l.shape,i);h.length>0&&(c=c.sum(h).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),ow=L({maximum_:function(t,e){var n,r=N(t,"a","maximum"),o=N(e,"b","maximum");return n=St(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Le(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),Gz=L({maximumStrict_:function(t,e){var n=N(t,"a","maximumStrict"),r=N(e,"b","maximumStrict");return Ye(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),vA=L({minimum_:function(t,e){var n,r=N(t,"a","minimum"),o=N(e,"b","minimum");return n=St(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Le(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),qz=L({minimumStrict_:function(t,e){var n=N(t,"a","minimumStrict"),r=N(e,"b","minimumStrict");return Ye(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Kz=L({mod_:function(t,e){var n,r=N(t,"a","mod"),o=N(e,"b","mod");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Zt(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),h=Zt(l.shape,i);return h.length>0?c.sum(h).reshape(l.shape):c}}})}}),Xz=L({modStrict_:function(t,e){var n=N(t,"a","modStrict"),r=N(e,"b","modStrict");return Ye(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),On=L({mul_:function(t,e){var n,r=N(t,"a","mul"),o=N(e,"b","mul");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),h=Zt(u.shape,i);return h.length>0?c.sum(h).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),h=Zt(l.shape,i);return h.length>0?c.sum(h).reshape(l.shape):c}}},"Mul")}}),Qz=L({mulStrict_:function(t,e){var n=N(t,"a","mul"),r=N(e,"b","mul");return Ye(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Vd=L({pow_:function(t,e){var n,r=N(t,"base","pow"),o=N(e,"exp","pow");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape),a=[r,o];return B.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],h=u[2];return{a:function(){var f=c.toFloat(),d=s.mul(f.mul(l.pow(f.sub(ae(1))))),m=Zt(l.shape,i);return m.length>0&&(d=d.sum(m)),d.reshape(l.shape)},b:function(){var f=l.greater(0),d=l.log().where(f,We(l)),m=s.mul(h.mul(d)),g=Zt(c.shape,i);return g.length>0&&(m=m.sum(g)),m.reshape(c.shape)}}},"Pow",{},a,[!0])}}),Yz=L({powStrict_:function(t,e){return Ye(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Jz=L({squaredDifferenceStrict_:function(t,e){var n=N(t,"a","squaredDifferenceStrict"),r=N(e,"b","squaredDifferenceStrict");return Ye(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),en=L({sub_:function(t,e){var n,r=N(t,"a","sub"),o=N(e,"b","sub");n=St(r,o),r=n[0],o=n[1];var i=Le(r.shape,o.shape);return B.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Zt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Zt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),Zz=L({subStrict_:function(t,e){var n=N(t,"a","subStrict"),r=N(e,"b","subStrict");return Ye(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),gA=L({equal_:function(t,e){var n,r=N(t,"a","equal"),o=N(e,"b","equal");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),eW=L({equalStrict_:function(t,e){var n=N(t,"a","equalStrict"),r=N(e,"b","equalStrict");return Ye(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),tW=L({greater_:function(t,e){var n,r=N(t,"a","greater"),o=N(e,"b","greater");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),yA=L({greaterEqual_:function(t,e){var n,r=N(t,"a","greaterEqual"),o=N(e,"b","greaterEqual");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return We(s)},b:function(){return We(u)}}},"GreaterEqual")}}),nW=L({greaterEqualStrict_:function(t,e){var n=N(t,"a","greaterEqualStrict"),r=N(e,"b","greaterEqualStrict");return Ye(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),rW=L({greaterStrict_:function(t,e){var n=N(t,"a","greaterStrict"),r=N(e,"b","greaterStrict");return Ye(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),oW=L({less_:function(t,e){var n,r=N(t,"a","less"),o=N(e,"b","less");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),iW=L({lessEqual_:function(t,e){var n,r=N(t,"a","lessEqual"),o=N(e,"b","lessEqual");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),aW=L({lessEqualStrict_:function(t,e){var n=N(t,"a","lessEqualStrict"),r=N(e,"b","lessEqualStrict");return Ye(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),sW=L({lessStrict_:function(t,e){var n=N(t,"a","lessStrict"),r=N(e,"b","lessStrict");return Ye(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),uW=L({notEqual_:function(t,e){var n,r=N(t,"a","notEqual"),o=N(e,"b","notEqual");return n=St(r,o),r=n[0],o=n[1],Le(r.shape,o.shape),B.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),lW=L({notEqualStrict_:function(t,e){var n=N(t,"a","notEqualStrict"),r=N(e,"b","notEqualStrict");return Ye(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function sE(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function uE(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var iw=L({gather_:function(t,e,n){n===void 0&&(n=0);var r=N(t,"x","gather"),o=N(e,"indices","gather","int32");n=tn(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],h=1,f=1,d=0;d<u;d++)c.push(a.shape[d]),h*=a.shape[d];for(d=0;d<s.rank;d++)c.push(s.shape[d]);for(d=u+1;d<a.rank;d++)c.push(a.shape[d]),f*=a.shape[d];return{batchSize:h,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return B.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,h=l.slice(0,n),f=h.length,d=l.slice(n,l.length).slice(1),m=d.length,g=sE(0,f),y=sE(f+1,f+1+m),v=uE([h,[c],d]),w=a.reshape(v),x=u.reshape([c]),_=uE([[f],g,y]),S=w.transpose(_),R=wA(S,x,r.shape[n]),C=H1(_);return R=R.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),wA=L({unsortedSegmentSum_:function(t,e,n){var r=N(t,"x","unsortedSegmentSum"),o=N(e,"segmentIds","unsortedSegmentSum","int32");return O(Ft(n),function(){return"numSegments must be of dtype int"}),B.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=ow(l,We(l)),h=iw(u,c),f=yA(l,ae(0,"int32")),d=h.rank-f.rank,m=0;m<d;++m)f=Dr(f,m+1);f=lm(f,Wu(h.shape,"bool"));var g=We(h);return Ja(f,h,g)}(i,s)}}})}}),cW=function(t,e,n){return he(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,h,f,d,m,g;return fe(this,function(y){switch(y.label){case 0:for(r=N(t,"tensor","boolMask"),o=N(e,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,O(a>0,function(){return"mask cannot be scalar"}),Ye(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),h=r.reshape(c),f=o.reshape([-1]),[4,pA(f)];case 1:return d=y.sent(),m=d.squeeze([1]),g=iw(h,m,i),t!==r&&r.dispose(),e!==o&&o.dispose(),m.dispose(),h.dispose(),f.dispose(),d.dispose(),[2,g]}})})};function xA(t,e,n,r,o,i,a){i===void 0&&(i="NHWC"),O(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var s=t,u=e,l=!1;e.rank===3&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),O(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),O(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),O(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],h=i==="NHWC"?u.shape[3]:u.shape[1];O(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),O(h===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&O(Ft(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Q1(i),d=as(s,n.shape,r,1,o,a,!1,f),m=B.runKernelFunc(function(g,y){var v=g.conv2dDerInput(u,n,d);return y([n,u]),v},{dy4D:u,filter:n},function(g,y){var v=y[0],w=y[1];return{dy4D:function(){return jr(g,v,r,o,i,1,a)},filter:function(){return aw(g,w,v.shape,r,o,i,a)}}});return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function Kv(t){var e=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(t),n=e[0],r=e[1],o=e[2];return n===1&&r===1&&o===1}function _A(t,e,n,r,o){O(t.length===e.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"});var i=t,a=e,s=!1;e.rank===4&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],l=a.shape[4];O(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),O(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),O(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),O(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),O(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Od(i,n.shape,r,1,o),h=B.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var hW=L({conv1d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=N(t,"x","conv1d"),u=N(e,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),O(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),O(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&O(Ft(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),O(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),O(ir(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),O(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),d=jr(f,h,[1,n],r,"NHWC",[1,i],a);return c?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),jr=L({conv2d_:function(t,e,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=N(t,"x","conv2d"),u=N(e,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),O(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),O(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&O(Ft(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=o==="NHWC"?l.shape[3]:l.shape[1];O(h===u.shape[2],function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."}),O(ir(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=Q1(o),d=as(l.shape,u.shape,n,i,r,a,!1,f),m=[u,l],g=B.runKernelFunc(function(y,v){var w=y.conv2d(l,u,d);return v([u,l]),w},{x:l,filter:u},function(y,v){var w=v,x=w[0],_=w[1];return O(Eu(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return bA(_.shape,y,x,n,r,o)},filter:function(){return aw(_,y,x.shape,n,r,o)}}},"Conv2D",d,m);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),fW=L({conv3d_:function(t,e,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=N(t,"x","conv3d"),s=N(e,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),O(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),O(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),O(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),O(function(f,d){return Kv(f)||Kv(d)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),O(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Od(u.shape,s.shape,n,i,r),h=B.runKernelFunc(function(f,d){var m=f.conv3d(u,s,c);return d([u,s]),m},{x:u,$filter:s},function(f,d){O(Kv(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var m=d[0],g=d[1];return{x:function(){return _A(m.shape,f,g,n,r)},$filter:function(){return function(y,v,w,x,_){var S=y;y.rank===4&&(S=y.as5D(1,y.shape[0],y.shape[1],y.shape[2],y.shape[3]));var R=v;R.rank===4&&(R=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),O(S.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+S.shape+"."}),O(R.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+R.shape+"."}),O(w.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+w+"."}),O(S.shape[4]===w[3],function(){return"Error in conv3dDerFilter: depth of input "+S.shape[4]+") must match input depth in filter ("+w[3]+"."}),O(R.shape[4]===w[4],function(){return"Error in conv3dDerFilter: depth of dy ("+R.shape[4]+") must match output depth for filter ("+w[4]+")."});var C=Od(S.shape,w,x,1,_);return B.runKernelFunc(function(E){return E.conv3dDerFilter(S,R,C)},{x5D:S,dy5D:R})}(m,f,g.shape,n,r)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),aw=L({conv2dDerFilter_:function(t,e,n,r,o,i,a){i===void 0&&(i="NHWC");var s=t;t.rank===3&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;u.rank===3&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),O(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),O(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),O(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];O(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),O(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&O(Ft(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var h=Q1(i),f=as(s.shape,n,r,1,o,a,!1,h);return B.runKernelFunc(function(d){return d.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),bA=L({conv2dDerInput_:xA}),cm=L({depthwiseConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=N(t,"x","depthwiseConv2d"),u=N(e,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),O(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),O(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),O(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),O(ir(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&O(Ft(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var h=as(l.shape,u.shape,n,i,r,a,!0),f=[l,u],d=B.runKernelFunc(function(m,g){var y=m.depthwiseConv2D(l,u,h);return g([l,u]),y},{x:l,filter:u},function(m,g){O(Eu(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var y=g[0],v=g[1];return{x:function(){return EA(y.shape,m,v,h)},filter:function(){return CA(y,m,v.shape,h)}}},"DepthwiseConv2dNative",h,f);return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),EA=L({depthwiseConv2dDerInput_:function(t,e,n,r){var o=e,i=!1;e.rank===3&&(i=!0,o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=B.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),CA=L({depthwiseConv2dDerFilter_:function(t,e,n,r){var o=t;t.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return i.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),B.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),sw=L({separableConv2d_:function(t,e,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=N(t,"x","separableConv2d"),u=N(e,"depthwiseFilter","separableConv2d"),l=N(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(s.rank===3&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),O(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),O(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),O(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),O(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],d=u.shape[3];O(l.shape[2]===f*d,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*d+", but got "+l.shape[2]+"."});var m=cm(c,u,r,o,a,i),g=jr(m,l,1,"valid",a);return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),dW=L({conv2dTranspose_:function(t,e,n,r,o,i){return xA(n,N(t,"x","conv2dTranspose"),N(e,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),pW=L({conv3dTranspose_:function(t,e,n,r,o){return _A(n,N(t,"x","conv3dTranspose"),N(e,"filter","conv3dTranspose"),r,o)}}),hm=L({matMul_:function(t,e,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=N(t,"a","matMul"),a=N(e,"b","matMul");o=St(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=i.shape.slice(0,-2),f=a.shape.slice(0,-2),d=pe(h),m=pe(f);O(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),O(ln(h,f),function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),O(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=i.shape.slice(0,-2).concat([l,c]),y=n?i.as3D(d,s,l):i.as3D(d,l,s),v=r?a.as3D(m,c,u):a.as3D(m,u,c),w={transposeA:n,transposeB:r};return B.runKernelFunc(function(x,_){var S=x.batchMatMul(y,v,n,r);return _([y,v]),S},{a:y,b:v},function(x,_){var S=_,R=S[0],C=S[1];return n||r?!n&&r?{a:function(){return x.matMul(C,!1,!1)},b:function(){return x.matMul(R,!0,!1)}}:n&&!r?{a:function(){return C.matMul(x,!1,!0)},b:function(){return R.matMul(x,!1,!1)}}:{a:function(){return C.matMul(x,!0,!0)},b:function(){return x.matMul(R,!0,!0)}}:{a:function(){return x.matMul(C,!1,!0)},b:function(){return R.matMul(x,!0,!1)}}},"BatchMatMul",w).reshape(g)}}),mW=L({dot_:function(t,e){var n=N(t,"t1","dot"),r=N(e,"t2","dot");O(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return O(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),vW=L({outerProduct_:function(t,e){var n=N(t,"v1","outerProduct"),r=N(e,"v2","outerProduct");return O(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),oh=L({reverse_:function(t,e){var n=N(t,"x","reverse");if(n.rank===0)return n.clone();var r=tn(e,n.shape);return B.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),gW=L({reverse1d_:function(t){var e=N(t,"x","reverse");return O(e.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."}),oh(e,0)}}),yW=L({reverse2d_:function(t,e){var n=N(t,"x","reverse");return O(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),oh(n,e)}}),wW=L({reverse3d_:function(t,e){var n=N(t,"x","reverse");return O(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),oh(n,e)}}),xW=L({reverse4d_:function(t,e){var n=N(t,"x","reverse");return O(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),oh(n,e)}});function SA(t,e,n,r,o,i){var a=N(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),O(ir(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&O(Ft(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Sc(s.shape,e,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&ln(l.inShape,l.outShape))return a.clone();var c=[s],h=B.runKernelFunc(function(f,d){var m=f.maxPool(s,l);return d([s,m]),m},{x:s},function(f,d){var m=d[0],g=d[1];return{x:function(){return function(y,v,w,x,_,S,R,C){var E=N(y,"dy","maxPoolBackprop"),I=N(v,"input","maxPoolBackprop"),T=N(w,"output","maxPoolBackprop");O(I.rank===E.rank,function(){return"Rank of input ("+I.rank+") does not match rank of dy ("+E.rank+")"}),O(ir(_,S),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+_+" and dilations '"+S+"'"}),O(E.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),O(I.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+I.rank+"."});var k=Sc(I.shape,x,_,S,R,C);return B.runKernelFunc(function(P){return P.maxPoolBackprop(E,I,T,k)},{$dy:E,$input:I})}(f,m,g,e,n,r,o)}}},"MaxPool",l,c);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function IA(t,e,n,r,o,i){var a=N(t,"x","avgPool","float32");O(ir(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&O(Ft(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Sc(s.shape,e,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&ln(l.inShape,l.outShape))return a.clone();var c=B.runKernelFunc(function(h){return h.avgPool(s,l)},{x:s},function(h){return{x:function(){return function(f,d,m,g,y,v){var w=N(f,"dy","avgPoolBackprop"),x=N(d,"input","avgPoolBackprop");O(x.rank===w.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+w.rank+")"}),O(ir(g,y),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+y+"'"});var _=x,S=w,R=!1;x.rank===3&&(R=!0,_=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),S=w.as4D(1,w.shape[0],w.shape[1],w.shape[2])),O(S.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),O(_.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+_.rank+"."});var C=Sc(_.shape,m,g,y,v),E=B.runKernelFunc(function(I){return I.avgPoolBackprop(S,_,C)},{dy4D:S,input4D:_});return R?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}(h,s,e,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var on=L({maxPool_:function(t,e,n,r,o){return SA(t,e,n,1,r,o)}}),ih=L({avgPool_:function(t,e,n,r,o){return IA(t,e,n,1,r,o)}}),_W=L({pool_:function(t,e,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=N(t,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),O(ir(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=Sc(s.shape,e,i,o,r),h=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(_,S){var R=_.map(function(I,T){return I+(I-1)*(S[T]-1)}).map(function(I){return I-1}),C=R.map(function(I){return Math.floor(I/2)}),E=R.map(function(I,T){return I-C[T]});return R.map(function(I,T){return[C[T],E[T]]})}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var f=h[0]===1&&h[1]===1,d=function(_,S,R){var C=R.map(function($){return $[0]}),E=R.map(function($){return $[1]}),I=_.concat(C,E),T=S.map(function($,U){return($-I[U]%$)%$}),k=E.map(function($,U){return $+T[U]}),P=S.map(function($,U){return[C[U],k[U]]}),D=S.map(function($,U){return[0,T[U]]});return[P,D]}([c.inHeight,c.inWidth],h,l),m=d[0],g=d[1],y=f?r:"valid",v=f?s:DR(s,h,m),w=(n==="avg"?function(){return IA(v,e,i,1,y)}:function(){return SA(v,e,i,1,y)})(),x=f?w:AR(w,h,g);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),bW=L({maxPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=N(t,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),O(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),O(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),O(ir(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&O(Ft(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Md(u.shape,e,n,a,r,o,i),h=B.runKernelFunc(function(f,d){var m=f.maxPool3d(u,c);return d([u,m]),m},{x:u},function(f,d){var m=d[0],g=d[1];return{x:function(){return function(y,v,w,x,_,S,R,C){var E=N(y,"dy","maxPool3dBackprop"),I=N(v,"input","maxPool3dBackprop"),T=N(w,"output","maxPool3dBackprop"),k=E,P=I,D=T,$=!1;I.rank===4&&($=!0,k=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),P=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),D=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3])),O(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),O(P.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),O(D.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+D.rank+"."}),S==null&&(S=[1,1,1]),O(ir(_,S),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+_+" and dilations '"+S+"'"}),C!=null&&O(Ft(R),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+R+"."});var U=Md(P.shape,x,_,S,R,C),K=B.runKernelFunc(function(X){return X.maxPool3dBackprop(k,P,D,U)},{dy5D:k,input5D:P});return $?K.as4D(K.shape[1],K.shape[2],K.shape[3],K.shape[4]):K}(f,m,g,e,n,a,r,o)}}});return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),EW=L({avgPool3d_:function(t,e,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=N(t,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),O(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),O(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),O(ir(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&O(Ft(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Md(u.shape,e,n,a,r,o,i),h=B.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(d,m,g,y,v,w,x){var _=N(d,"dy","avgPool3dBackprop"),S=N(m,"input","avgPool3dBackprop"),R=_,C=S,E=!1;S.rank===4&&(E=!0,R=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),C=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3])),O(R.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+R.rank+"."}),O(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),v==null&&(v=[1,1,1]),O(ir(y,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+v+"'"}),x!=null&&O(Ft(w),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+w+"."});var I=Md(C.shape,g,y,v,w,x),T=B.runKernelFunc(function(k){return k.avgPool3dBackprop(R,C,I)},{dy5D:R,input5D:C});return E?T.as4D(T.shape[1],T.shape[2],T.shape[3],T.shape[4]):T}(f,u,e,n,a,r,o)}}});return h=h.cast(u.dtype),l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Mo=L({slice_:function(t,e,n){var r,o,i=N(t,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof e=="number"?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach(function(u){O(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(O(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),Y6(i,r,o);var a=i.shape,s={begin:r,size:o};return B.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),CW=L({slice1d_:function(t,e,n){var r=N(t,"x","slice1d");return O(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,[e],[n])}}),SW=L({slice2d_:function(t,e,n){var r=N(t,"x","slice2d");return O(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,e,n)}}),TA=L({slice3d_:function(t,e,n){var r=N(t,"x","slice3d");return O(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,e,n)}}),IW=L({slice4d_:function(t,e,n){var r=N(t,"x","slice4d");return O(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Mo(r,e,n)}});function RA(t,e,n,r,o){return e.rank<n.rank&&(e=e.reshape(or(e.shape,r))),t.rank<n.rank&&(t=t.reshape(or(t.shape,r))),{x:function(){var i=t.mul(n.equal(e).cast(t.dtype));return o==null?i:i.transpose(o)}}}var TW=L({all_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","all","bool"),o=tn(e,r.shape),i=o,a=$o(i,r.rank);a!=null&&(r=r.transpose(a),i=Uo(i.length,r.rank));var s=B.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=or(s.shape,o);return s.reshape(u)}return s}}),RW=L({any_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","any","bool"),o=tn(e,r.shape),i=o,a=$o(i,r.rank);a!=null&&(r=r.transpose(a),i=Uo(i.length,r.rank));var s=B.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=or(s.shape,o);return s.reshape(u)}return s}}),AW=L({argMax_:function(t,e){e===void 0&&(e=0);var n=N(t,"x","argMax");e==null&&(e=0);var r=tn(e,n.shape),o=$o(r,n.rank);o!=null&&(n=n.transpose(o),r=Uo(r.length,n.rank));var i={axis:r[0]},a=[n];return B.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return We(l)}}},"ArgMax",i,a)}}),kW=L({argMin_:function(t,e){e===void 0&&(e=0);var n=N(t,"x","argMin");e==null&&(e=0);var r=tn(e,n.shape),o=$o(r,n.rank);return o!=null&&(n=n.transpose(o),r=Uo(r.length,n.rank)),B.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return We(s)}}})}}),PW=L({logSumExp_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","logSumExp"),o=tn(e,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=or(s.shape,o);return s.reshape(u)}return s}}),fm=L({max_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","max"),o=r,i=tn(e,r.shape),a=i,s=$o(a,r.rank);s!=null&&(r=r.transpose(s),a=Uo(a.length,r.rank));var u=[r],l=B.runKernelFunc(function(h,f){var d=h.max(r,a);return f([o,d]),d},{x:r},function(h,f){return RA(h,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=or(l.shape,i);l=l.reshape(c)}return l}}),DW=L({mean_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","mean"),o=tn(e,r.shape),i=pe(Rn(r.shape,o)[1]);return sm(function(a){var s=ae(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(e,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(Wu(a.shape,"float32")).div(i)}}})(r)}}),NW=L({min_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","min"),o=r,i=tn(e,r.shape),a=i,s=$o(a,r.rank);s!=null&&(r=r.transpose(s),a=Uo(a.length,r.rank));var u=[r],l=B.runKernelFunc(function(h,f){var d=h.min(r,a);return f([o,d]),d},{x:r},function(h,f){return RA(h,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=or(l.shape,i);l=l.reshape(c)}return l}}),MW=L({moments_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=tn(e,(t=N(t,"x","moments")).shape),o=t.mean(r,n),i=o.shape;n||(i=or(o.shape,r));var a=t.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),AA=L({sum_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=tn(e,r.shape);return sm(function(i){var a=$o(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Uo(s.length,i.rank));var l=function(d){var m=i.shape.slice();return o.forEach(function(g){m[g]=1}),d.reshape(m).mul(Wu(i.shape,"float32"))},c={axes:s},h=B.runKernelFunc(function(d){return d.sum(u,s)},{x:u},function(d){return{x:function(){return l(d)}}},"Sum",c);if(n){var f=or(h.shape,o);h=h.reshape(f)}return{value:h,gradFunc:l}})(r)}}),OW=L({prod_:function(t,e,n){e===void 0&&(e=null),n===void 0&&(n=!1);var r=N(t,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=tn(e,r.shape),i=$o(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Uo(a.length,r.rank));var u=B.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=or(u.shape,o);u=u.reshape(l)}return u}}),kA=L({elu_:function(t){var e=N(t,"x","elu");return B.runKernelFunc(function(n,r){var o=n.elu(e);return r([o]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){return B.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),FW=L({leakyRelu_:function(t,e){e===void 0&&(e=.2);var n=N(t,"x","leakyRelu");return ow(ae(e).mul(n),n)}}),PA=L({prelu_:function(t,e){var n=N(t,"x","prelu"),r=N(e,"alpha","prelu");return B.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Ja(u,o,o.mul(s))},alpha:function(){var l=Ja(u,We(o),o.mul(a)),c=Zt(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),bt=L({relu_:function(t){var e=N(t,"x","relu");return e.dtype==="bool"?e.toInt():B.runKernelFunc(function(n,r){var o=n.relu(e);return r([e]),o},{x:e},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),DA=L({relu6_:function(t){var e=N(t,"x","relu6");return e.dtype==="bool"?e.toInt():B.runKernelFunc(function(n,r){var o=n.relu6(e);return r([e]),o},{x:e},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),LW=L({selu_:function(t){var e=N(t,"x","selu");return B.runKernelFunc(function(n,r){var o=n.selu(e);return r([e]),o},{$x:e},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ae(0)),a=ae(tw),s=ae(nw),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return Ja(i,u,l)}}})}}),oa=L({transpose_:function(t,e){var n=N(t,"x","transpose");if(e==null&&(e=n.shape.map(function(o,i){return i}).reverse()),O(n.rank===e.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."}),e.forEach(function(o){O(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e})}),n.rank<=1)return n.clone();var r={perm:e};return B.runKernelFunc(function(o){return o.transpose(n,e)},{x:n},function(o){var i=H1(e);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),VW=L({localResponseNormalization_:function(t,e,n,r,o){e===void 0&&(e=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=N(t,"x","localResponseNormalization");O(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),O(Ft(e),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=B.runKernelFunc(function(l,c){var h=l.localResponseNormalization4D(a,e,n,r,o);return c([a,h]),h},{x4D:a},function(l,c){var h=c[0],f=c[1];return{x4D:function(){return B.runKernelFunc(function(d){return d.LRNGrad(l,h,f,e,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),NA=L({norm_:function(t,e,n,r){e===void 0&&(e="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ae(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(t=N(t,"x","norm"),e,n),i=o.shape;if(r){var a=tn(n,t.shape);i=or(o.shape,a)}return o.reshape(i)}}),BW=L({basicLSTMCell_:function(t,e,n,r,o,i){var a=N(t,"forgetBias","basicLSTMCell"),s=N(e,"lstmKernel","basicLSTMCell"),u=N(n,"lstmBias","basicLSTMCell"),l=N(r,"data","basicLSTMCell"),c=N(o,"c","basicLSTMCell"),h=N(i,"h","basicLSTMCell"),f=l.concat(h,1).matMul(s).add(u),d=f.shape[0],m=f.shape[1]/4,g=[d,m],y=f.slice([0,0],g),v=f.slice([0,m],g),w=f.slice([0,2*m],g),x=f.slice([0,3*m],g),_=y.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(a.add(w).sigmoid())),S=_.tanh().mulStrict(x.sigmoid());return[_,S]}}),$W=L({multiRNNCell_:function(t,e,n,r){for(var o=N(e,"data","multiRNNCell"),i=Rd(n,"c","multiRNNCell"),a=Rd(r,"h","multiRNNCell"),s=o,u=[],l=0;l<t.length;l++){var c=t[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var h=[],f=[];for(l=0;l<u.length;l+=2)h.push(u[l]),f.push(u[l+1]);return[h,f]}}),UW=L({movingAverage_:function(t,e,n,r,o){o===void 0&&(o=!0);var i=N(t,"v","movingAverage"),a=N(e,"x","movingAverage"),s=N(n,"decay","movingAverage");V5(i,a),O(ln(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ae(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){O(r!=null,function(){return"When using zeroDebias: true, step is required."});var h=N(r,"step","movingAverage");c=c.div(u.sub(Vd(s,h)))}return i.add(c)}}),zW=L({stridedSlice_:function(t,e,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(e.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=N(t,"x","stridedSlice"),c=U2(s),h=l.shape.slice();c.forEach(function(y){e[y]=0,n[y]=1,h.splice(y,0,1)}),l=l.reshape(h);for(var f=0;f<l.rank;f++)e[f]=J6(o,e,r,l.shape,f),n[f]=Z6(i,n,r,l.shape,f),r[f]=r[f]||1;var d=U2(u);d.forEach(function(y){n[y]=e[y]+1,r[y]=1});var m=X1(e,n,r),g=m.filter(function(y,v){return d.indexOf(v)===-1});return r.every(function(y){return y===1})?Mo(l,e,m).reshape(g):B.runKernelFunc(function(y){return y.stridedSlice(l,e,n,r)},{$x:l}).reshape(g)}}),WW=L({topk_:function(t,e,n){e===void 0&&(e=1),n===void 0&&(n=!0);var r=N(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(e>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+e);var i=B.runKernelFunc(function(a){return a.topk(r,e,n)},{$x:r});return{values:i[0],indices:i[1]}}}),jW=L({scatterND_:function(t,e,n){var r=N(t,"indices","scatterND","int32"),o=N(e,"updates","scatterND");return Q6(o,r,n),B.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),uw=L({fft_:function(t){O(t.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return B.runKernelFunc(function(o){return o.fft(r)},{input:t}).reshape(t.shape)}}),Bd=L({ifft_:function(t){O(t.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return B.runKernelFunc(function(o){return o.ifft(r)},{input:t}).reshape(t.shape)}}),lw=L({rfft_:function(t,e){O(t.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+t.dtype});var n,r=t.shape[t.shape.length-1],o=t.size/r;if(e!=null&&e<r){var i=t.shape.map(function(v){return 0}),a=t.shape.map(function(v){return v});a[t.shape.length-1]=e,n=t.slice(i,a),r=e}else if(e!=null&&e>r){var s=t.shape.map(function(v){return v});s[t.shape.length-1]=e-r,n=t.concat(dt(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),l=dn(n,u).as2D(o,r),c=uw(l),h=Math.floor(r/2)+1,f=Nr(c),d=bo(c),m=f.split([h,r-h],f.shape.length-1),g=d.split([h,r-h],d.shape.length-1),y=n.shape.slice();return y[n.shape.length-1]=h,dn(m[0],g[0]).reshape(y)}}),MA=L({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),o=Bd(r);return Nr(o)}var i=[n,2*(e-1)],a=Nr(t).as2D(n,e),s=bo(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),l=s.slice([0,1],[n,e-2]).reverse(1).mul(ae(-1)),c=a.concat(u,1),h=s.concat(l,1);return r=dn(c,h).as2D(i[0],i[1]),o=Bd(r),Nr(o)}}),HW=Object.freeze({fft:uw,ifft:Bd,rfft:lw,irfft:MA}),GW=L({sparseToDense_:function(t,e,n,r){r===void 0&&(r=0);var o=N(t,"sparseIndices","sparseToDense","int32"),i=N(e,"sparseValues","sparseToDense"),a=N(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var h=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var d=u.size;if(u.rank!==0&&(u.rank!==1||d!==h))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+h+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),B.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),qW=L({gatherND_:function(t,e){var n=N(e,"indices","gatherND","int32"),r=N(t,"x","gatherND");return B.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),KW=L({diag_:function(t){var e=N(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return B.runKernelFunc(function(r){return r.diag(e)},{$x:e}).reshape(n)}}),XW=L({dropout_:function(t,e,n,r){var o=N(t,"x","dropout");if(O(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),O(e>=0&&e<1,function(){return"rate must be a float in the range [0, 1), but got "+e+"."}),e===0)return t instanceof _t?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(ln(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],h=0;h<u.shape.length;h++)l[h]==null&&u.shape[h]!=null?c.push(u.shape[h]):c.push(l[h]);return c}return l}(o,n),a=1-e,s=PR(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function OA(t,e,n){for(var r=1-t%2,o=new Float32Array(t),i=0;i<t;++i){var a=2*Math.PI*i/(t+r-1);o[i]=e-n*Math.cos(a)}return Wt(o,"float32")}var cw=L({hannWindow_:function(t){return OA(t,.5,.5)}}),FA=L({hammingWindow_:function(t){return OA(t,.54,.46)}}),hw=L({frame_:function(t,e,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+e<=t.size;)a.push(Mo(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=Qt([Mo(t,i,e-s),Ao([s],o)]);a.push(u),i+=n}return a.length===0?Xi([],[0,e]):Qt(a).as2D(a.length,e)}}),LA=L({stft_:function(t,e,n,r,o){var i;o===void 0&&(o=cw),r==null&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=hw(t,e,n),s=On(a,o(e)),u=[],l=0;l<a.shape[0];l++)u.push(lw(s.slice([l,0],[1,e]),r));return Qt(u)}}),QW=Object.freeze({hannWindow:cw,hammingWindow:FA,frame:hw,stft:LA}),Mn,YW=function(t,e,n){return n===void 0&&(n=1),he(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,h,f,d,m,g,y;return fe(this,function(v){switch(v.label){case 0:return r=N(t,"predictions","inTopK"),o=N(e,"targets","inTopK"),O(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),O(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Ye(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],O(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=v.sent(),[4,o.data()];case 2:for(s=v.sent(),u=[a.length/i,i],c=u[1],h=bc("bool",l=u[0]),f=0;f<l;f++){for(d=f*c,m=a.subarray(d,d+c),g=[],y=0;y<m.length;y++)g.push({value:m[y],index:y});for(g.sort(function(w,x){return x.value-w.value}),h[f]=0,y=0;y<n;y++)if(g[y].index===s[f]){h[f]=1;break}}return t!==r&&r.dispose(),e!==o&&o.dispose(),[2,gn(h,o.shape,"bool")]}})})};(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Mn||(Mn={}));var JW=L({absoluteDifference_:function(t,e,n,r){r===void 0&&(r=Mn.SUM_BY_NONZERO_WEIGHTS);var o=N(t,"labels","absoluteDifference"),i=N(e,"predictions","absoluteDifference"),a=null;n!=null&&(a=N(n,"weights","absoluteDifference")),Ye(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return gi(s,a,r)}}),gi=L({computeWeightedLoss_:function(t,e,n){n===void 0&&(n=Mn.SUM_BY_NONZERO_WEIGHTS);var r=N(t,"losses","computeWeightedLoss"),o=null;e!=null&&(o=N(e,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Mn.NONE)return i;if(n===Mn.SUM)return i.sum();if(n===Mn.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ae(a)):s}if(n===Mn.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ae(r.size));var u=o.mul(Wu(r.shape)).notEqual(ae(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),ZW=L({cosineDistance_:function(t,e,n,r,o){o===void 0&&(o=Mn.SUM_BY_NONZERO_WEIGHTS);var i=N(t,"labels","cosineDistance"),a=N(e,"predictions","cosineDistance"),s=null;r!=null&&(s=N(r,"weights","cosineDistance")),Ye(i.shape,a.shape,"Error in cosineDistance: ");var u=ae(1).sub(i.mul(a).sum(n,!0));return gi(u,s,o)}}),e9=L({hingeLoss_:function(t,e,n,r){r===void 0&&(r=Mn.SUM_BY_NONZERO_WEIGHTS);var o=N(t,"labels","hingeLoss"),i=N(e,"predictions","hingeLoss"),a=null;n!=null&&(a=N(n,"weights","hingeLoss")),Ye(o.shape,i.shape,"Error in hingeLoss: ");var s=ae(1);o=ae(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return gi(u,a,r)}}),t9=L({huberLoss_:function(t,e,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Mn.SUM_BY_NONZERO_WEIGHTS);var i=N(t,"labels","huberLoss"),a=N(e,"predictions","huberLoss"),s=null;n!=null&&(s=N(n,"weights","huberLoss")),Ye(i.shape,a.shape,"Error in huberLoss: ");var u=ae(r),l=a.sub(i).abs(),c=vA(l,u),h=l.sub(c),f=ae(.5).mul(c.square()).add(u.mul(h));return gi(f,s,o)}}),n9=L({logLoss_:function(t,e,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Mn.SUM_BY_NONZERO_WEIGHTS);var i=N(t,"labels","logLoss"),a=N(e,"predictions","logLoss"),s=null;n!=null&&(s=N(n,"weights","logLoss")),Ye(i.shape,a.shape,"Error in logLoss: ");var u=ae(1),l=ae(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return gi(c,s,o)}}),r9=L({meanSquaredError_:function(t,e,n,r){r===void 0&&(r=Mn.SUM_BY_NONZERO_WEIGHTS);var o=N(t,"labels","meanSquaredError"),i=N(e,"predictions","meanSquaredError"),a=null;n!=null&&(a=N(n,"weights","meanSquaredError")),Ye(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return gi(s,a,r)}}),o9=L({sigmoidCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Mn.SUM_BY_NONZERO_WEIGHTS);var i=N(t,"multiClassLabels","sigmoidCrossEntropy"),a=N(e,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=N(n,"weights","sigmoidCrossEntropy")),Ye(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ae(r),l=ae(1),c=ae(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var h=function(f,d){var m=N(f,"labels","sigmoidCrossEntropyWithLogits"),g=N(d,"logits","sigmoidCrossEntropyWithLogits");Ye(m.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var y=g.relu(),v=g.mul(m),w=g.abs().neg().exp().log1p();return y.sub(v).add(w)}(i,a);return gi(h,s,o)}}),i9=L({softmaxCrossEntropy_:function(t,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Mn.SUM_BY_NONZERO_WEIGHTS);var i=N(t,"onehotLabels","softmaxCrossEntropy"),a=N(e,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=N(n,"weights","softmaxCrossEntropy")),Ye(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ae(r),l=ae(1),c=ae(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var h=function(f,d,m){if(m===void 0&&(m=-1),m===-1&&(m=d.rank-1),m!==d.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+d.rank+" and dim was "+m);return sm(function(g,y,v){var w=y.logSumExp([m],!0),x=y.toFloat().sub(w);return v([g,x]),{value:x.mul(g).neg().sum([m]),gradFunc:function(_,S){var R=S[0],C=S[1],E=or(_.shape,[m]);return[_.reshape(E).mul(R.toFloat().sub(C.exp())),_.reshape(E).mul(C.exp().sub(R.toFloat()))]}}})(f,d)}(i,a);return gi(h,s,o)}}),a9=Object.freeze({get Reduction(){return Mn},absoluteDifference:JW,computeWeightedLoss:gi,cosineDistance:ZW,hingeLoss:e9,huberLoss:t9,logLoss:n9,meanSquaredError:r9,sigmoidCrossEntropy:o9,softmaxCrossEntropy:i9});function lE(t,e){return e===void 0&&(e=!1),B.tidy(function(){if(t.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],o=kR(n),i=t.clone(),a=Xi([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(h){var f,d=i,m=s,g=o;f=B.tidy(function(){var y=i.slice([h,h],[n-h,1]),v=y.norm(),w=i.slice([h,h],[1,1]),x=Xi([[-1]]).where(w.greater(0),Xi([[1]])),_=w.sub(x.mul(v)),S=y.div(_);s=S.shape[0]===1?a.clone():a.concat(S.slice([1,0],[S.shape[0]-1,S.shape[1]]),0);var R=x.matMul(_).div(v).neg(),C=i.slice([h,0],[n-h,r]),E=R.mul(s);if(h===0)i=C.sub(E.matMul(s.transpose().matMul(C)));else{var I=C.sub(E.matMul(s.transpose().matMul(C)));i=i.slice([0,0],[h,r]).concat(I,0)}var T=o.slice([0,h],[n,o.shape[1]-h]);if(h===0)o=T.sub(T.matMul(s).matMul(E.transpose()));else{var k=T.sub(T.matMul(s).matMul(E.transpose()));o=o.slice([0,0],[n,h]).concat(k,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],nr([d,m,g])},c=0;c<u;++c)l(c);return!e&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var s9=L({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=N(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(e<=a))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=a),n<0&&(n=s);var u=Ad(0,a,1,"int32").reshape([-1,1]),l=Ad(0,s,1,"int32"),c=en(u,l),h=lm(c.lessEqual(ae(+e,"int32")),c.greaterEqual(ae(-n,"int32"))),f=dt([a,s],r.dtype);return xr(Yt(r.reshape([-1,a,s])).map(function(d){return Ja(h,d,f)})).reshape(o)}}),u9=L({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,O(t!=null&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=t[0].shape[0],r=function(u){O(t[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+n+")"})},o=1;o<t.length;++o)r(o)}else e=!0,t=q1(t,t.shape[0],0).map(function(u){return NR(u,[0])});O(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var i=[],a=t,s=function(u){i.push(B.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var h=AA(i[c].mulStrict(l)).mul(i[c]);l=l.sub(h)}return l.div(NA(l,"euclidean"))}))};for(o=0;o<t.length;++o)s(o);return e?xr(i,0):i}}),l9=L({qr_:function(t,e){if(e===void 0&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(t.rank===2)return lE(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=Yt(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=lE(a,e),u=s[0],l=s[1];o.push(u),i.push(l)}),[xr(o,0).reshape(t.shape),xr(i,0).reshape(t.shape)]}}),c9=Object.freeze({bandPart:s9,gramSchmidt:u9,qr:l9});function dm(t,e,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=t.shape[0];return n=Math.min(n,a),O(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),O(t.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),O(t.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),O(e.rank===1,function(){return"scores must be a 1D tensor"}),O(e.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+e.shape[0]}),O(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var h9=L({resizeBilinear_:function(t,e,n){n===void 0&&(n=!1);var r=N(t,"images","resizeBilinear");O(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),O(e.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=B.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return B.runKernelFunc(function(h){return h.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),f9=L({resizeNearestNeighbor_:function(t,e,n){n===void 0&&(n=!1);var r=N(t,"images","resizeNearestNeighbor");O(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),O(e.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."}),O(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=B.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return B.runKernelFunc(function(h){return h.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),d9=L({nonMaxSuppression_:function(t,e,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=N(t,"boxes","nonMaxSuppression"),a=N(e,"scores","nonMaxSuppression"),s=dm(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return B.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),p9=function(t,e,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),he(this,void 0,void 0,function(){var i,a,s,u,l,c,h;return fe(this,function(f){switch(f.label){case 0:return i=N(t,"boxes","nonMaxSuppressionAsync"),a=N(e,"scores","nonMaxSuppressionAsync"),s=dm(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],h=Y1(l,c,n,r,o),i!==t&&i.dispose(),a!==e&&a.dispose(),[2,h]}})})},m9=L({nonMaxSuppressionWithScore_:function(t,e,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=N(t,"boxes","nonMaxSuppression"),s=N(e,"scores","nonMaxSuppression"),u=dm(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=B.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),v9=function(t,e,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),he(this,void 0,void 0,function(){var a,s,u,l,c,h,f;return fe(this,function(d){switch(d.label){case 0:return a=N(t,"boxes","nonMaxSuppressionAsync"),s=N(e,"scores","nonMaxSuppressionAsync"),u=dm(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=d.sent(),c=l[0],h=l[1],f=J1(c,h,n,r,o,i),a!==t&&a.dispose(),s!==e&&s.dispose(),[2,f]}})})},g9=L({cropAndResize_:function(t,e,n,r,o,i){var a=N(t,"image","cropAndResize"),s=N(e,"boxes","cropAndResize","float32"),u=N(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return O(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),O(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),O(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),O(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),O(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),O(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),B.runKernelFunc(function(c,h){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),fw=Object.freeze({resizeBilinear:h9,resizeNearestNeighbor:f9,nonMaxSuppression:d9,nonMaxSuppressionAsync:p9,nonMaxSuppressionWithScore:m9,nonMaxSuppressionWithScoreAsync:v9,cropAndResize:g9}),dw=function(t,e){return!(t>0)||e==="linear"},pw=function(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},mw=function(t,e){var n=e,r=Zt(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},vw=function(t,e,n){if(e==="linear")return t;if(e==="relu")return bt(t);if(e==="elu")return kA(t);if(e==="relu6")return DA(t);if(e==="prelu")return PA(t,n);throw new Error("Unknown fused activation "+e+".")},y9=L({fusedMatMul_:function(t){var e,n=t.a,r=t.b,o=t.transposeA,i=o!==void 0&&o,a=t.transposeB,s=a!==void 0&&a,u=t.bias,l=t.activation,c=l===void 0?"linear":l,h=t.preluActivationWeights;if(dw(B.state.gradientDepth,c)===!1){var f=hm(n,r,i,s);return u!=null&&(f=Oe(f,u)),vw(f,c,h)}var d=N(n,"a","fused matMul"),m=N(r,"b","fused matMul");e=St(d,m),d=e[0],m=e[1];var g=i?d.shape[d.rank-2]:d.shape[d.rank-1],y=s?m.shape[m.rank-1]:m.shape[m.rank-2],v=i?d.shape[d.rank-1]:d.shape[d.rank-2],w=s?m.shape[m.rank-2]:m.shape[m.rank-1],x=d.shape.slice(0,-2),_=m.shape.slice(0,-2),S=pe(x),R=pe(_);O(d.rank>=2&&m.rank>=2&&d.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+d.rank+" and "+m.rank+"."}),O(ln(x,_),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+_+") of Tensors with shapes "+d.shape+" and "+m.shape+" must match."}),O(g===y,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+y+") of Tensors with shapes "+d.shape+" and "+m.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var C,E,I=d.shape.slice(0,-2).concat([v,w]),T=i?d.as3D(S,g,v):d.as3D(S,v,g),k=s?m.as3D(R,w,y):m.as3D(R,y,w);u!=null&&Le(I,(C=St(C=N(u,"bias","fused matMul"),d)[0]).shape),h!=null&&(E=N(h,"prelu weights","fused matMul"));var P={a:T,b:k};u!=null&&(P.bias=C),h!=null&&(P.preluActivationWeights=E);var D=[T,k];return B.runKernelFunc(function($,U){var K=$.fusedBatchMatMul({a:T,b:k,transposeA:i,transposeB:s,bias:C,activation:c,preluActivationWeights:E});return U([T,k,K]),K},P,function($,U){var K=U[0],X=U[1],V=U[2],W=pw($,V,c),H={};return u!=null&&(H={bias:function(){return mw(C,W)}}),Object.assign(i||s?!i&&s?{a:function(){return W.matMul(X,!1,!1)},b:function(){return W.matMul(K,!0,!1)}}:i&&!s?{a:function(){return X.matMul(W,!1,!0)},b:function(){return K.matMul(W,!1,!1)}}:{a:function(){return X.matMul(W,!0,!0)},b:function(){return W.matMul(K,!0,!0)}}:{a:function(){return W.matMul(X,!1,!0)},b:function(){return K.matMul(W,!0,!1)}},H)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},D,[!0]).reshape(I)}}),w9=L({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,h=t.activation,f=h===void 0?"linear":h,d=t.preluActivationWeights;if(f=f||"linear",dw(B.state.gradientDepth,f)===!1){var m=jr(e,n,r,o,a,u,l);return c!=null&&(m=Oe(m,c)),vw(m,f,d)}var g=N(e,"x","conv2d"),y=N(n,"filter","conv2d"),v=g,w=!1;g.rank===3&&(w=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),O(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),O(y.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."}),l!=null&&O(Ft(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),O(v.shape[3]===y.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+y.shape[2]+"."}),O(ir(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),O(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,_,S=as(v.shape,y.shape,r,u,o,l);c!=null&&(x=St(x=N(c,"bias","fused conv2d"),g)[0],Le(S.outShape,x.shape)),d!=null&&(_=N(d,"prelu weights","fused conv2d"));var R={x:v,filter:y};c!=null&&(R.bias=x),d!=null&&(R.preluActivationWeights=_);var C=[y,v],E=B.runKernelFunc(function(I,T){var k=I.fusedConv2d({input:v,filter:y,convInfo:S,bias:x,activation:f,preluActivationWeights:_});return T([y,v,k]),k},R,function(I,T){var k=T,P=k[0],D=k[1],$=k[2],U=pw(I,$,f);O(Eu(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var K={};return c!=null&&(K={bias:function(){return mw(x,U)}}),Object.assign({x:function(){return bA(D.shape,U,P,r,o)},filter:function(){return aw(D,U,P.shape,r,o)}},K)},"FusedConv2D",{convInfo:S,activation:f},C,[!0]);return w?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),x9=L({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=i===void 0?"NHWC":i,s=t.dilations,u=s===void 0?[1,1]:s,l=t.dimRoundingMode,c=t.bias,h=t.activation,f=h===void 0?"linear":h,d=t.preluActivationWeights;if(dw(B.state.gradientDepth,f)===!1){var m=cm(e,n,r,o,a,u,l);return c!=null&&(m=Oe(m,c)),vw(m,f,d)}var g=N(e,"x","depthwiseConv2d"),y=N(n,"filter","depthwiseConv2d"),v=g,w=!1;g.rank===3&&(w=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),O(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),O(y.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+y.rank+"."}),O(v.shape[3]===y.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+y.shape[2]+"."}),u==null&&(u=[1,1]),O(ir(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&O(Ft(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var x,_,S=as(v.shape,y.shape,r,u,o,l,!0);c!=null&&(x=St(x=N(c,"bias","fused conv2d"),g)[0],Le(S.outShape,x.shape)),d!=null&&(_=N(d,"prelu weights","fused depthwiseConv2d"));var R={x:v,filter:y};c!=null&&(R.bias=x),d!=null&&(R.preluActivationWeights=_);var C=[y,v],E=B.runKernelFunc(function(I,T){var k=I.fusedDepthwiseConv2D({input:v,filter:y,convInfo:S,bias:x,activation:f,preluActivationWeights:_});return T([y,v,k]),k},R,function(I,T){O(Eu(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=T[0],P=T[1],D=T[2],$=pw(I,D,f),U={};return c!=null&&(U={bias:function(){return mw(x,$)}}),Object.assign({x:function(){return EA(P.shape,$,k,S)},filter:function(){return CA(P,$,k.shape,S)}},U)},"FusedDepthwiseConv2D",{convInfo:S,activation:f},C,[!0]);return w?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),_9=Object.freeze({matMul:y9,conv2d:w9,depthwiseConv2d:x9}),b9=Object.freeze({image:fw,linalg:c9,losses:a9,spectral:HW,fused:_9,signal:QW,square:nz,squaredDifference:aA,conv1d:hW,conv2d:jr,conv3d:fW,depthwiseConv2d:cm,separableConv2d:sw,conv2dTranspose:dW,conv3dTranspose:pW,op:L,batchNormalization2d:Dz,batchNormalization3d:Nz,batchNormalization4d:Mz,batchNormalization:Oz,batchNorm:fA,batchNorm2d:Fz,batchNorm3d:Lz,batchNorm4d:Vz,booleanMaskAsync:cW,complex:dn,real:Nr,imag:bo,concat:Qt,concat1d:_6,concat2d:b6,concat3d:E6,concat4d:C6,split:q1,matMul:hm,dot:mW,outerProduct:vW,reverse:oh,reverse1d:gW,reverse2d:yW,reverse3d:wW,reverse4d:xW,maxPool:on,avgPool:ih,pool:_W,maxPool3d:bW,avgPool3d:EW,slice:Mo,slice1d:CW,slice2d:SW,slice3d:TA,slice4d:IW,abs:rz,acos:oz,acosh:iz,asin:az,asinh:sz,atan:uz,atanh:lz,ceil:cz,clipByValue:rw,cos:hz,cosh:fz,erf:dz,exp:Vy,expm1:pz,floor:mz,log:vz,log1p:gz,logSigmoid:yz,neg:Ld,reciprocal:wz,round:xz,rsqrt:sA,sigmoid:uA,sign:_z,isNaN:bz,isInf:Ez,isFinite:Cz,sin:Sz,sinh:Iz,softplus:Tz,sqrt:Rz,step:Az,tan:kz,tanh:Pz,all:TW,any:RW,argMax:AW,argMin:kW,logSumExp:PW,max:fm,mean:DW,min:NW,moments:MW,sum:AA,prod:OW,equal:gA,equalStrict:eW,greater:tW,greaterEqual:yA,greaterEqualStrict:nW,greaterStrict:rW,less:oW,lessEqual:iW,lessEqualStrict:aW,lessStrict:sW,notEqual:uW,notEqualStrict:lW,add:Oe,addN:Uz,addStrict:zz,atan2:Wz,div:Qr,divNoNan:jz,divStrict:Hz,floorDiv:mA,maximum:ow,maximumStrict:Gz,minimum:vA,minimumStrict:qz,mod:Kz,modStrict:Xz,mul:On,mulStrict:Qz,pow:Vd,powStrict:Yz,squaredDifferenceStrict:Jz,sub:en,subStrict:Zz,elu:kA,leakyRelu:FW,prelu:PA,relu:bt,relu6:DA,selu:LW,logicalAnd:lm,logicalNot:Bz,logicalOr:dA,logicalXor:$z,where:Ja,whereAsync:pA,buffer:Ae,print:N6,batchToSpaceND:AR,broadcastTo:M6,cast:O6,clone:F6,cumsum:L6,depthToSpace:V6,expandDims:Dr,eye:kR,multinomial:B6,oneHot:My,pad:is,pad1d:$6,pad2d:U6,pad3d:z6,pad4d:W6,rand:j6,randomNormal:H6,randomGamma:G6,randomUniform:PR,reshape:Yr,spaceToBatchND:DR,squeeze:NR,stack:xr,tile:nu,truncatedNormal:q6,unstack:Yt,setdiff1dAsync:K6,fill:Ao,linspace:x6,ones:Wu,range:Ad,scalar:ae,tensor:gn,tensor1d:Wt,tensor2d:Xi,tensor3d:G1,tensor4d:Xn,tensor5d:g6,tensor6d:y6,variable:w6,zeros:dt,onesLike:RR,zerosLike:We,transpose:oa,softmax:vi,logSoftmax:t$,localResponseNormalization:VW,norm:NA,gather:iw,unsortedSegmentSum:wA,basicLSTMCell:BW,multiRNNCell:$W,movingAverage:UW,stridedSlice:zW,topk:WW,scatterND:jW,fft:uw,ifft:Bd,rfft:lw,irfft:MA,sparseToDense:GW,gatherND:qW,diag:KW,dropout:XW,hannWindow:cw,hammingWindow:FA,frame:hw,stft:LA,inTopKAsync:YW});function Z(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(n){n!=null&&O(n.dtype!=="complex64",function(){return e+" does not support complex64 tensors."})})}function Xv(t,e,n,r){if(n==="linear")return t.linear(e);if(n==="relu")return t.relu(e);if(n==="elu")return t.elu(e);if(n==="relu6")return t.relu6(e);if(n==="prelu")return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var E9=function(t){function e(){var n=t.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new $R(n,B),n}return ao(e,t),e.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,Q().get("IS_NODE")&&Td(`
============================
Hi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},e.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){return[2,this.readSync(n)]})})},e.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?Ly(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},e.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Cd(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ae(n.shape,n.dtype,o)},e.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return B.makeTensorFromDataId(i,r,o,this)},e.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},e.prototype.time=function(n){return he(this,void 0,void 0,function(){var r;return fe(this,function(o){return r=wo(),n(),[2,{kernelMs:wo()-r}]})})},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:B.keep(n.clone()),imag:B.keep(r.clone())},o},e.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},e.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},e.prototype.slice=function(n,r,o){if(Z(n,"slice"),VR(n.shape,r,o)){var i=BR(r,n.strides),a=pe(o);return gn(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Ae(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(h,f){return h+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},e.prototype.stridedSlice=function(n,r,o,i){Z(n,"stridedSlice");var a=X1(r,o,i);if(a.some(function(d){return d===0}))return gn([],a);for(var s=Ae(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),h=new Array(c.length),f=0;f<h.length;f++)h[f]=c[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,h)].concat(c))}return s.toTensor()},e.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Ae([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},e.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},e.prototype.reverse=function(n,r){Z(n,"reverse");for(var o=Ae(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(h){return c[h]=n.shape[h]-1-c[h]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},e.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(d){return Nr(d)}),a=n.map(function(d){return bo(d)});return dn(this.concat(i,r),this.concat(a,r))}var s=n.map(function(d){var m=pe(d.shape.slice(r));return d.as2D(-1,m)}),u=bu(s.map(function(d){return d.shape}),1),l=Ae(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(d){l.set(o.readSync(d.dataId),c),c+=d.size})}else{var h=0;s.forEach(function(d){for(var m=o.readSync(d.dataId),g=0,y=0;y<d.shape[0];++y)for(var v=y*u[1]+h,w=0;w<d.shape[1];++w)l[v+w]=m[g++];h+=d.shape[1]})}var f=bu(n.map(function(d){return d.shape}),r);return gn(l,f,n[0].dtype)},e.prototype.neg=function(n){return Z(n,"neg"),this.multiply(ae(-1),n)},e.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,pn(n.dtype,r.dtype),function(o,i){return o+i})},e.prototype.addN=function(n){var r=this;Z(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=Ae(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},e.prototype.softmax=function(n,r){var o=tn([r],n.shape),i=this.max(n,o),a=or(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},e.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,pn(n.dtype,r.dtype),function(o,i){return o-i})},e.prototype.pow=function(n,r){return Z([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},e.prototype.batchMatMul=function(n,r,o,i){Z([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),h=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],d=f[0],m=f[1],g=f[2],y=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=y[0],w=y[1],x=y[2],_=s*u,S=Ae([l,s,u],n.dtype),R=S.values,C=this.blockSize,E=0;E<l;E++)for(var I=0;I<s;I+=C)for(var T=0;T<u;T+=C)for(var k=0;k<a;k+=C)for(var P=Math.min(I+C,s),D=Math.min(T+C,u),$=Math.min(k+C,a),U=I;U<P;U++)for(var K=T;K<D;K++){for(var X=0,V=k;V<$;V++)X+=c[E*d+U*m+V*g]*h[V*v+K*w+E*x];R[E*_+(U*u+K)]+=X}return S.toTensor()},e.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=Xv(this,c,u,l)),c},e.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,pn(n.dtype,r.dtype),function(o,i){return o*i})},e.prototype.realDivide=function(n,r){return Z([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},e.prototype.floorDiv=function(n,r){return Z([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},e.prototype.sum=function(n,r){Z(n,"sum"),cr("sum",r,n.rank);for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,pn(n.dtype,"int32")),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=0,m=0;m<u;++m)d+=c[f+m];l[h]=d}return s},e.prototype.prod=function(n,r){Z(n,"sum");for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,pn(n.dtype,"int32")),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=1,m=0;m<u;++m)d*=c[f+m];l[h]=d}return s},e.prototype.unsortedSegmentSum=function(n,r,o){Z(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ae(s,"int32"),l=gA(u,r).asType("float32").mul(n).sum(0);i.push(l)}return xr(i)},e.prototype.argMin=function(n,r){Z(n,"argMin");var o=[r];cr("argMin",o,n.rank);for(var i=Rn(n.shape,o),a=i[0],s=i[1],u=dt(a,"int32"),l=pe(s),c=this.readSync(u.dataId),h=this.readSync(n.dataId),f=0;f<c.length;++f){for(var d=f*l,m=h[d],g=0,y=0;y<l;++y){var v=h[d+y];v<m&&(m=v,g=y)}c[f]=g}return u},e.prototype.argMax=function(n,r){Z(n,"argMax");var o=[r];cr("argMax",o,n.rank);for(var i=Rn(n.shape,o),a=i[0],s=i[1],u=dt(a,"int32"),l=pe(s),c=this.readSync(u.dataId),h=this.readSync(n.dataId),f=0;f<c.length;++f){for(var d=f*l,m=h[d],g=0,y=0;y<l;++y){var v=h[d+y];v>m&&(m=v,g=y)}c[f]=g}return u},e.prototype.cumsum=function(n,r,o,i){if(Z(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=pn(n.dtype,"int32"),s=dt(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],h=i?function(y,v){return y+c-v-1}:function(y,v){return y+v},f=0;f<l.length;f+=c)for(var d=0;d<c;d++){var m=h(f,d);if(d===0)u[m]=o?0:l[m];else{var g=h(f,d-1);u[m]=o?l[g]+u[g]:l[m]+u[g]}}return s},e.prototype.equal=function(n,r){return Z([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},e.prototype.notEqual=function(n,r){return Z([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},e.prototype.less=function(n,r){return Z([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},e.prototype.lessEqual=function(n,r){return Z([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},e.prototype.greater=function(n,r){return Z([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},e.prototype.greaterEqual=function(n,r){return Z([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},e.prototype.logicalNot=function(n){Z(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},e.prototype.logicalAnd=function(n,r){return Z([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},e.prototype.logicalOr=function(n,r){return Z([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},e.prototype.select=function(n,r,o){Z([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=dt(r.shape,pn(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,h=n.rank===0||n.rank>1||r.rank===1?1:pe(r.shape.slice(1)),f=0;f<i.length;f++)for(var d=0;d<h;d++)i[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},e.prototype.where=function(n){Z([n],"where");var r=this.readSync(n.dataId);return Z1(n.shape,r)},e.prototype.topk=function(n,r,o){return Z(n,"topk"),KR(this.readSync(n.dataId),n.shape,n.dtype,r)},e.prototype.min=function(n,r){Z(n,"min"),cr("min",r,n.rank);for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,n.dtype),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],m=0;m<u;++m){var g=c[f+m];g<d&&(d=g)}l[h]=d}return s},e.prototype.minimum=function(n,r){return Z([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},e.prototype.mod=function(n,r){return Z([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},e.prototype.max=function(n,r){Z(n,"max"),cr("max",r,n.rank);for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,n.dtype),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],m=0;m<u;++m){var g=c[f+m];g>d&&(d=g)}l[h]=d}return s},e.prototype.maximum=function(n,r){return Z([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},e.prototype.all=function(n,r){Z(n,"all"),cr("all",r,n.rank);for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,n.dtype),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],m=0;m<u;++m){var g=c[f+m];d=d&&g}l[h]=d}return s},e.prototype.any=function(n,r){Z(n,"any"),cr("any",r,n.rank);for(var o=Rn(n.shape,r),i=o[0],a=o[1],s=dt(i,n.dtype),u=pe(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),h=0;h<l.length;++h){for(var f=h*u,d=c[f],m=0;m<u;++m){var g=c[f+m];d=d||g}l[h]=d}return s},e.prototype.squaredDifference=function(n,r){return Z([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},e.prototype.ceil=function(n){Z(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.floor=function(n){Z(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.sign=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},e.prototype.isNaN=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isInf=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.isFinite=function(n){Z(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},e.prototype.round=function(n){Z(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},e.prototype.exp=function(n){Z(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.expm1=function(n){Z(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},e.prototype.log=function(n){Z(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.log1p=function(n){Z(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.sqrt=function(n){Z(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.rsqrt=function(n){Z(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},e.prototype.reciprocal=function(n){Z(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},e.prototype.linear=function(n){return n},e.prototype.relu=function(n){Z(n,"relu");for(var r=dt(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},e.prototype.relu6=function(n){Z(n,"relu");for(var r=dt(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},e.prototype.prelu=function(n,r){return Z([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},e.prototype.elu=function(n){Z(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},e.prototype.eluDer=function(n,r){Z([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},e.prototype.selu=function(n){Z(n,"selu");for(var r=tw,o=nw,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},e.prototype.clip=function(n,r,o){Z(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},e.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},e.prototype.int=function(n){Z(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},e.prototype.sigmoid=function(n){Z(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},e.prototype.softplus=function(n){Z(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},e.prototype.sin=function(n){Z(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cos=function(n){Z(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tan=function(n){Z(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asin=function(n){Z(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acos=function(n){Z(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan=function(n){Z(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atan2=function(n,r){return Z([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},e.prototype.sinh=function(n){Z(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.cosh=function(n){Z(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.tanh=function(n){Z(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=C5(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.asinh=function(n){Z(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.acosh=function(n){Z(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.atanh=function(n){Z(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},e.prototype.erf=function(n){Z(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},e.prototype.step=function(n,r){r===void 0&&(r=0),Z(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},e.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Xv(this,l,s,u)),l},e.prototype.conv2d=function(n,r,o){Z([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,h=o.dataFormat==="channelsLast",f=Ae(o.outShape,n.dtype),d=n.strides[0],m=h?n.strides[1]:n.strides[2],g=h?n.strides[2]:1,y=h?1:n.strides[1],v=f.strides[0],w=h?f.strides[1]:f.strides[2],x=h?f.strides[2]:1,_=h?1:f.strides[1],S=this.readSync(n.dataId),R=this.readSync(r.dataId),C=f.values,E=0;E<o.batchSize;++E)for(var I=E*d,T=E*v,k=0;k<o.outHeight;++k)for(var P=T+k*w,D=k*o.strideHeight-c,$=0;$<i;$++){var U=D+$*s;if(!(U<0||U>=o.inHeight))for(var K=$*r.strides[0],X=I+U*m,V=0;V<o.outWidth;++V)for(var W=P+V*x,H=V*o.strideWidth-l,ne=0;ne<a;ne++){var oe=H+ne*u;if(!(oe<0||oe>=o.inWidth))for(var de=X+oe*g,me=K+ne*r.strides[1],_e=0;_e<o.inChannels;++_e){for(var xe=S[de+_e*y],Ie=0;Ie<o.outChannels;++Ie)C[W+Ie*_]+=xe*R[me+Ie];me+=o.outChannels}}}return f.toTensor()},e.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,h=o.padInfo.front,f=o.padInfo.left,d=o.padInfo.top,m=Ae(o.outShape,n.dtype),g=this.readSync(n.dataId),y=this.readSync(r.dataId),v=m.values,w=0;w<o.batchSize;++w)for(var x=w*n.strides[0],_=w*m.strides[0],S=0;S<o.outDepth;++S)for(var R=_+S*m.strides[1],C=S*o.strideDepth-h,E=0;E<i;E++){var I=C+E*u;if(!(I<0||I>=o.inDepth))for(var T=E*r.strides[0],k=x+I*n.strides[1],P=0;P<o.outHeight;++P)for(var D=R+P*m.strides[2],$=P*o.strideHeight-d,U=0;U<a;U++){var K=$+U*l;if(!(K<0||K>=o.inHeight))for(var X=T+U*r.strides[1],V=k+K*n.strides[2],W=0;W<o.outWidth;++W)for(var H=D+W*o.outChannels,ne=W*o.strideWidth-f,oe=0;oe<s;oe++){var de=ne+oe*c;if(!(de<0||de>=o.inWidth))for(var me=X+oe*r.strides[2],_e=V+de*o.inChannels,xe=me,Ie=0;Ie<o.inChannels;++Ie){for(var Pe=g[_e+Ie],Ee=0;Ee<o.outChannels;++Ee)v[H+Ee]+=Pe*y[xe+Ee];xe+=o.outChannels}}}}return m.toTensor()},e.prototype.conv2dDerInput=function(n,r,o){Z([n,r],"conv2dDerInput");for(var i=Ae(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],h=l[1],f=l[2],d=o.batchSize,m=o.filterHeight,g=o.filterWidth,y=o.inChannels,v=o.inHeight,w=o.inWidth,x=o.outChannels,_=o.outHeight,S=o.outWidth,R=o.strideHeight,C=o.strideWidth,E=o.dataFormat,I=m-1-o.padInfo.top,T=g-1-o.padInfo.left,k=E==="channelsLast",P=i.strides[0],D=k?i.strides[1]:i.strides[2],$=k?i.strides[2]:1,U=k?1:i.strides[1],K=n.strides[0],X=k?n.strides[1]:n.strides[2],V=k?n.strides[2]:1,W=k?1:n.strides[1],H=0;H<d;++H)for(var ne=0;ne<y;++ne)for(var oe=0;oe<v;++oe)for(var de=oe-I,me=Math.max(0,Math.ceil(de/R)),_e=Math.min(_,(m+de)/R),xe=0;xe<w;++xe){for(var Ie=xe-T,Pe=Math.max(0,Math.ceil(Ie/C)),Ee=Math.min(S,(g+Ie)/C),ct=0,Me=me;Me<_e;++Me)for(var je=Me*R-de,Fe=Pe;Fe<Ee;++Fe)for(var tt=K*H+X*Me+V*Fe,nt=c*(m-1-je)+h*(g-1-(Fe*C-Ie))+f*ne,Je=0;Je<x;++Je)ct+=s[tt+W*Je]*u[nt+Je];a[P*H+D*oe+$*xe+U*ne]=ct}return i.toTensor()},e.prototype.conv3dDerInput=function(n,r,o){for(var i=Ae(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],h=s[3],f=this.readSync(n.dataId),d=n.strides,m=d[0],g=d[1],y=d[2],v=d[3],w=this.readSync(r.dataId),x=r.strides,_=x[0],S=x[1],R=x[2],C=x[3],E=o.batchSize,I=o.filterDepth,T=o.filterHeight,k=o.filterWidth,P=o.inChannels,D=o.inDepth,$=o.inHeight,U=o.inWidth,K=o.outChannels,X=o.outDepth,V=o.outHeight,W=o.outWidth,H=o.strideDepth,ne=o.strideHeight,oe=o.strideWidth,de=I-1-o.padInfo.front,me=T-1-o.padInfo.top,_e=k-1-o.padInfo.left,xe=0;xe<E;++xe)for(var Ie=0;Ie<P;++Ie)for(var Pe=0;Pe<D;++Pe)for(var Ee=Pe-de,ct=Math.max(0,Math.ceil(Ee/H)),Me=Math.min(X,(I+Ee)/H),je=0;je<$;++je)for(var Fe=je-me,tt=Math.max(0,Math.ceil(Fe/ne)),nt=Math.min(V,(T+Fe)/ne),Je=0;Je<U;++Je){for(var bn=Je-_e,Vn=Math.max(0,Math.ceil(bn/oe)),Ge=Math.min(W,(k+bn)/oe),it=0,nn=ct;nn<Me;++nn)for(var Sr=nn*H-Ee,Gn=tt;Gn<nt;++Gn)for(var ar=Gn*ne-Fe,Dt=Vn;Dt<Ge;++Dt)for(var _i=m*xe+g*nn+y*Gn+v*Dt,Ir=_*(I-1-Sr)+S*(T-1-ar)+R*(k-1-(Dt*oe-bn))+C*Ie,En=0;En<K;++En)it+=f[_i+En]*w[Ir+En];a[u*xe+l*Pe+c*je+h*Je+Ie]=it}return i.toTensor()},e.prototype.conv2dDerFilter=function(n,r,o){Z([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=Ae(o.filterShape,"float32"),h=o.padInfo.left,f=o.padInfo.top,d=this.bufferSync(n),m=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((f-g)/i)),v=Math.min(o.outHeight,(o.inHeight+f-g)/i),w=0;w<u;++w)for(var x=Math.max(0,Math.ceil((h-w)/a)),_=Math.min(o.outWidth,(o.inWidth+h-w)/a),S=0;S<o.inChannels;++S)for(var R=0;R<o.outChannels;++R){for(var C=0,E=0;E<o.batchSize;++E)for(var I=y;I<v;++I)for(var T=g+I*i-f,k=x;k<_;++k){var P=w+k*a-h;C+=l?d.get(E,T,P,S)*m.get(E,I,k,R):d.get(E,S,T,P)*m.get(E,R,I,k)}c.set(C,g,w,S,R)}return c.toTensor()},e.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,h=Ae(o.filterShape,"float32"),f=h.values,d=h.strides,m=d[0],g=d[1],y=d[2],v=d[3],w=this.readSync(r.dataId),x=r.strides,_=x[0],S=x[1],R=x[2],C=x[3],E=this.readSync(n.dataId),I=n.strides,T=I[0],k=I[1],P=I[2],D=I[3],$=o.padInfo.front,U=o.padInfo.left,K=o.padInfo.top,X=0;X<u;++X)for(var V=Math.max(0,Math.ceil(($-X)/i)),W=Math.min(o.outDepth,(o.inDepth+$-X)/i),H=X*m,ne=0;ne<l;++ne)for(var oe=Math.max(0,Math.ceil((K-ne)/a)),de=Math.min(o.outHeight,(o.inHeight+K-ne)/a),me=ne*g+H,_e=0;_e<c;++_e)for(var xe=Math.max(0,Math.ceil((U-_e)/s)),Ie=Math.min(o.outWidth,(o.inWidth+U-_e)/s),Pe=_e*y+me,Ee=0;Ee<o.inChannels;++Ee)for(var ct=Ee*v+Pe,Me=0;Me<o.outChannels;++Me){for(var je=0,Fe=0;Fe<o.batchSize;++Fe)for(var tt=Fe*T,nt=Fe*_,Je=V;Je<W;++Je)for(var bn=(X+Je*i-$)*k+tt,Vn=Je*S+nt,Ge=oe;Ge<de;++Ge)for(var it=(ne+Ge*a-K)*P+bn,nn=Ge*R+Vn,Sr=xe;Sr<Ie;++Sr){var Gn=Sr*C+nn;je+=E[(_e+Sr*s-U)*D+it+Ee]*w[Gn+Me]}f[ct+Me]=je}return h.toTensor()},e.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Xv(this,l,s,u)),l},e.prototype.depthwiseConv2D=function(n,r,o){Z([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,h=o.outChannels/o.inChannels,f=Ae(o.outShape,n.dtype),d=this.readSync(n.dataId),m=this.readSync(r.dataId),g=f.values,y=0;y<o.batchSize;++y)for(var v=y*n.strides[0],w=y*f.strides[0],x=0;x<o.outHeight;++x)for(var _=w+x*f.strides[1],S=x*o.strideHeight-l,R=0;R<i;++R){var C=S+R*s;if(!(C<0||C>=o.inHeight))for(var E=R*r.strides[0],I=v+C*n.strides[1],T=0;T<o.outWidth;++T)for(var k=_+T*f.strides[2],P=T*o.strideWidth-c,D=0;D<a;++D){var $=P+D*u;if(!($<0||$>=o.inWidth))for(var U=E+D*r.strides[1],K=I+$*o.inChannels,X=k,V=U,W=0;W<o.inChannels;++W){for(var H=d[K+W],ne=0;ne<h;++ne)g[X+ne]+=H*m[V+ne];X+=h,V+=h}}}return f.toTensor()},e.prototype.depthwiseConv2DDerInput=function(n,r,o){Z([n,r],"depthwiseConv2DDerInput");for(var i=Ae(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],h=this.readSync(n.dataId),f=n.strides,d=f[0],m=f[1],g=f[2],y=this.readSync(r.dataId),v=r.strides,w=v[0],x=v[1],_=v[2],S=o.batchSize,R=o.filterHeight,C=o.filterWidth,E=o.inChannels,I=o.inHeight,T=o.inWidth,k=o.outChannels,P=o.outHeight,D=o.outWidth,$=o.strideHeight,U=o.strideWidth,K=R-1-o.padInfo.top,X=C-1-o.padInfo.left,V=k/E,W=0;W<S;++W)for(var H=0;H<E;++H)for(var ne=0;ne<I;++ne)for(var oe=ne-K,de=Math.max(0,Math.ceil(oe/$)),me=Math.min(P,(R+oe)/$),_e=0;_e<T;++_e){for(var xe=_e-X,Ie=Math.max(0,Math.ceil(xe/U)),Pe=Math.min(D,(C+xe)/U),Ee=0,ct=de;ct<me;++ct)for(var Me=ct*$-oe,je=Ie;je<Pe;++je)for(var Fe=d*W+m*ct+g*je,tt=w*(R-1-Me)+x*(C-1-(je*U-xe))+_*H,nt=0;nt<V;++nt)Ee+=h[Fe+(H*V+nt)]*y[tt+nt];a[u*W+l*ne+c*_e+H]=Ee}return i.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(n,r,o){Z([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=Ae(o.filterShape,"float32"),c=o.padInfo.left,h=o.padInfo.top,f=o.outChannels/o.inChannels,d=this.bufferSync(n),m=this.bufferSync(r),g=0;g<s;++g)for(var y=Math.max(0,Math.ceil((h-g)/i)),v=Math.min(o.outHeight,(o.inHeight+h-g)/i),w=0;w<u;++w)for(var x=Math.max(0,Math.ceil((c-w)/a)),_=Math.min(o.outWidth,(o.inWidth+c-w)/a),S=0;S<o.outChannels;++S){for(var R=Math.trunc(S/f),C=S%f,E=0,I=0;I<o.batchSize;++I)for(var T=y;T<v;++T)for(var k=g+T*i-h,P=x;P<_;++P){var D=w+P*a-c;E+=d.get(I,k,D,R)*m.get(I,T,P,S)}l.set(E,g,w,R,C)}return l.toTensor()},e.prototype.tile=function(n,r){return Z(n,"tile"),qR(this.bufferSync(n),r)},e.prototype.pad=function(n,r,o){Z(n,"pad");var i=r.map(function(f,d){return f[0]+n.shape[d]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=Ae(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),h=c.map(function(f,d){return f+a[d]});u.set.apply(u,[s.get.apply(s,c)].concat(h))}return u.toTensor()},e.prototype.transpose=function(n,r){Z(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Ae(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),h=0;h<c.length;h++)c[h]=l[r[h]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},e.prototype.gather=function(n,r,o){Z([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Ae(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),h=c.slice();h[o]=a[c[o]];var f=u.locToIndex(h);s.values[l]=u.values[f]}return s.toTensor()},e.prototype.batchToSpaceND=function(n,r,o){Z([n],"batchToSpaceND");var i=r.reduce(function(h,f){return h*f}),a=kd(n.shape,r,i),s=Pd(a.length,r.length),u=Dd(n.shape,r,i),l=MR(o,r.length),c=OR(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},e.prototype.spaceToBatchND=function(n,r,o){Z([n],"spaceToBatchND");var i=r.reduce(function(f,d){return f*d}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=kd(u.shape,r,i,!1),c=Pd(l.length,r.length,!1),h=Dd(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(h)},e.prototype.pool=function(n,r,o){Z(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,d=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(n.dataId),g=Ae(r.outShape,n.dtype),y=g.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],w=r.outShape[2]*r.outShape[3],x=r.outShape[3],_=0;_<r.batchSize;++_)for(var S=_*v,R=_*n.strides[0],C=0;C<r.inChannels;++C)for(var E=0;E<r.outHeight;++E)for(var I=E*i-h,T=Math.max(0,I),k=Math.min(r.inHeight,l+I),P=S+E*w,D=0;D<r.outWidth;++D){for(var $=D*a-f,U=Math.max(0,$),K=Math.min(r.inWidth,c+$),X=d,V=0,W=0,H=T;H<k;H+=s){for(var ne=R+H*n.strides[1],oe=U;oe<K;oe+=u){var de=m[ne+oe*n.strides[2]+C];o==="max"&&de>X?X=de:o==="avg"&&(V+=de,W++)}if(isNaN(X))break}y[P+D*x+C]=o==="avg"?V/W:X}return g.toTensor()},e.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},e.prototype.maxPoolPositions=function(n,r){for(var o=Ae(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,d=this.bufferSync(n),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var v=y*i-h,w=v;w<0;)w+=s;for(var x=Math.min(r.inHeight,l+v),_=0;_<r.outWidth;++_){for(var S=_*a-f,R=S;R<0;)R+=u;for(var C=Math.min(r.inWidth,c+S),E=Number.NEGATIVE_INFINITY,I=-1,T=w;T<x;T+=s)for(var k=T-v,P=R;P<C;P+=u){var D=P-S,$=d.get(m,T,P,g);$>E&&(E=$,I=k*c+D)}o.set(I,m,y,_,g)}}return o.toTensor()},e.prototype.maxPoolBackprop=function(n,r,o,i){Z([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,h=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=f-1-i.padInfo.left,m=h-1-i.padInfo.top,g=Ae(r.shape,"float32"),y=this.bufferSync(a),v=this.bufferSync(n),w=0;w<i.batchSize;++w)for(var x=0;x<i.inChannels;++x)for(var _=0;_<i.inHeight;++_)for(var S=0;S<i.inWidth;++S){for(var R=_-m,C=S-d,E=0,I=0;I<h;I+=l){var T=(R+I)/s;if(!(T<0||T>=i.outHeight||Math.floor(T)!==T))for(var k=0;k<f;k+=c){var P=(C+k)/u;if(!(P<0||P>=i.outWidth||Math.floor(P)!==P)){var D=h*f-1-y.get(w,T,P,x)===I*f+k?1:0;D!==0&&(E+=v.get(w,T,P,x)*D)}}}g.set(E,w,_,S,x)}return g.toTensor()},e.prototype.avgPoolBackprop=function(n,r,o){Z([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,h=o.effectiveFilterHeight,f=o.effectiveFilterWidth,d=f-1-o.padInfo.left,m=h-1-o.padInfo.top,g=Ae(r.shape,"float32"),y=1/(s*u),v=this.bufferSync(n),w=0;w<o.batchSize;++w)for(var x=0;x<o.inChannels;++x)for(var _=0;_<o.inHeight;++_)for(var S=0;S<o.inWidth;++S){for(var R=_-m,C=S-d,E=0,I=0;I<h;I+=l){var T=(R+I)/i;if(!(T<0||T>=o.outHeight||Math.floor(T)!==T))for(var k=0;k<f;k+=c){var P=(C+k)/a;P<0||P>=o.outWidth||Math.floor(P)!==P||(E+=v.get(w,T,P,x))}}g.set(E*y,w,_,S,x)}return g.toTensor()},e.prototype.pool3d=function(n,r,o){Z(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=this.readSync(n.dataId),x=Ae(r.outShape,n.dtype),_=x.values,S=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],R=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],E=r.outShape[4],I=0;I<r.batchSize;++I)for(var T=I*S,k=I*n.strides[0],P=0;P<r.inChannels;++P)for(var D=0;D<r.outDepth;++D){for(var $=D*i-m,U=$;U<0;)U+=u;for(var K=Math.min(r.inDepth,h+$),X=T+D*R,V=0;V<r.outHeight;++V){for(var W=V*a-g,H=W;H<0;)H+=l;for(var ne=Math.min(r.inHeight,f+W),oe=X+V*C,de=0;de<r.outWidth;++de){for(var me=de*s-y,_e=me;_e<0;)_e+=c;for(var xe=Math.min(r.inWidth,d+me),Ie=oe+de*E,Pe=v,Ee=0,ct=0,Me=U;Me<K;Me+=u){for(var je=k+Me*n.strides[1],Fe=H;Fe<ne;Fe+=l){for(var tt=je+Fe*n.strides[2],nt=_e;nt<xe;nt+=c){var Je=w[tt+nt*n.strides[3]+P];if(o==="max"&&Je>Pe?Pe=Je:o==="avg"&&(Ee+=Je,ct++),isNaN(Pe))break}if(isNaN(Pe))break}if(isNaN(Pe))break}_[Ie+P]=o==="avg"?Ee/ct:Pe}}}return x.toTensor()},e.prototype.avgPool3d=function(n,r){return Z(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(n,r,o){Z([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,h=o.dilationDepth,f=o.dilationHeight,d=o.dilationWidth,m=o.effectiveFilterDepth,g=o.effectiveFilterHeight,y=o.effectiveFilterWidth,v=m-1-o.padInfo.front,w=y-1-o.padInfo.left,x=g-1-o.padInfo.top,_=Ae(r.shape,"float32"),S=1/(u*l*c),R=this.bufferSync(n),C=0;C<o.batchSize;++C)for(var E=0;E<o.inChannels;++E)for(var I=0;I<o.inDepth;++I)for(var T=0;T<o.inHeight;++T)for(var k=0;k<o.inWidth;++k){for(var P=I-v,D=T-x,$=k-w,U=0,K=0;K<m;K+=h){var X=(P+K)/i;if(!(X<0||X>=o.outDepth||Math.floor(X)!==X))for(var V=0;V<g;V+=f){var W=(D+V)/a;if(!(W<0||W>=o.outHeight||Math.floor(W)!==W))for(var H=0;H<y;H+=d){var ne=($+H)/s;ne<0||ne>=o.outWidth||Math.floor(ne)!==ne||(U+=R.get(C,X,W,ne,E))}}}_.set(U*S,C,I,T,k,E)}return _.toTensor()},e.prototype.maxPool3d=function(n,r){return Z(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},e.prototype.maxPool3dPositions=function(n,r){for(var o=Ae(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,v=this.bufferSync(n),w=0;w<r.batchSize;++w)for(var x=0;x<r.inChannels;++x)for(var _=0;_<r.outDepth;++_){for(var S=_*i-m,R=S;R<0;)R+=u;for(var C=Math.min(r.inDepth,h+S),E=0;E<r.outHeight;++E){for(var I=E*a-g,T=I;T<0;)T+=l;for(var k=Math.min(r.inHeight,f+I),P=0;P<r.outWidth;++P){for(var D=P*s-y,$=D;$<0;)$+=c;for(var U=Math.min(r.inWidth,d+D),K=Number.NEGATIVE_INFINITY,X=-1,V=R;V<C;V+=u)for(var W=V-S,H=T;H<k;H+=l)for(var ne=H-I,oe=$;oe<U;oe+=c){var de=oe-D,me=v.get(w,V,H,oe,x);me>=K&&(K=me,X=W*f*d+ne*f+de)}o.set(X,w,_,E,P,x)}}}return o.toTensor()},e.prototype.maxPool3dBackprop=function(n,r,o,i){Z([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,h=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterDepth,m=i.effectiveFilterHeight,g=i.effectiveFilterWidth,y=d-1-i.padInfo.front,v=g-1-i.padInfo.left,w=m-1-i.padInfo.top,x=Ae(r.shape,"float32"),_=this.bufferSync(a),S=this.bufferSync(n),R=0;R<i.batchSize;++R)for(var C=0;C<i.inChannels;++C)for(var E=0;E<i.inDepth;++E)for(var I=0;I<i.inHeight;++I)for(var T=0;T<i.inWidth;++T){for(var k=E-y,P=I-w,D=T-v,$=0,U=0;U<d;U+=c){var K=(k+U)/s;if(!(K<0||K>=i.outDepth||Math.floor(K)!==K))for(var X=0;X<m;X+=h){var V=(P+X)/u;if(!(V<0||V>=i.outHeight||Math.floor(V)!==V))for(var W=0;W<g;W+=f){var H=(D+W)/l;if(!(H<0||H>=i.outWidth||Math.floor(H)!==H)){var ne=d*m*g-1-_.get(R,K,V,H,C)===U*m*g+X*g+W?1:0;ne!==0&&($+=S.get(R,K,V,H,C)*ne)}}}}x.set($,R,E,I,T,C)}return x.toTensor()},e.prototype.cast=function(n,r){return WR(n,r,this)},e.prototype.reshape=function(n,r){return Fy(n,r)},e.prototype.avgPool=function(n,r){return Z(n,"avgPool"),this.pool(n,r,"avg").toFloat()},e.prototype.resizeBilinear=function(n,r,o,i){Z(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=this.readSync(n.dataId),f=new Float32Array(pe([s,r,o,c])),d=[i&&r>1?u-1:u,i&&o>1?l-1:l],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],g=0,y=d[0]/m[0],v=d[1]/m[1],w=0;w<s;w++)for(var x=0;x<r;x++)for(var _=y*x,S=Math.floor(_),R=_-S,C=Math.min(u-1,Math.ceil(_)),E=w*n.strides[0]+S*n.strides[1],I=w*n.strides[0]+C*n.strides[1],T=0;T<o;T++)for(var k=v*T,P=Math.floor(k),D=k-P,$=Math.min(l-1,Math.ceil(k)),U=E+P*n.strides[2],K=I+P*n.strides[2],X=E+$*n.strides[2],V=I+$*n.strides[2],W=0;W<c;W++){var H=h[U+W],ne=h[K+W],oe=H+(h[X+W]-H)*D,de=oe+(ne+(h[V+W]-ne)*D-oe)*R;f[g++]=de}return gn(f,[s,r,o,c])},e.prototype.resizeBilinearBackprop=function(n,r,o){Z([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,h=c[1],f=c[2],d=new Float32Array(a*s*u*l),m=[o&&h>1?s-1:s,o&&f>1?u-1:u],g=[o&&h>1?h-1:h,o&&f>1?f-1:f],y=m[0]/g[0],v=m[1]/g[1],w=this.readSync(n.dataId),x=0,_=0;_<a;_++)for(var S=_*r.strides[0],R=0;R<h;R++)for(var C=R*y,E=Math.floor(C),I=Math.min(Math.ceil(C),s-1),T=S+E*r.strides[1],k=S+I*r.strides[1],P=C-E,D=1-P,$=0;$<f;$++)for(var U=$*v,K=Math.floor(U),X=Math.min(Math.ceil(U),u-1),V=U-K,W=1-V,H=T+K*r.strides[2],ne=T+X*r.strides[2],oe=k+K*r.strides[2],de=k+X*r.strides[2],me=D*W,_e=D*V,xe=P*W,Ie=P*V,Pe=0;Pe<l;Pe++){var Ee=w[x++];d[H+Pe]+=Ee*me,d[ne+Pe]+=Ee*_e,d[oe+Pe]+=Ee*xe,d[de+Pe]+=Ee*Ie}return Xn(d,[a,u,s,l],r.dtype)},e.prototype.resizeNearestNeighbor=function(n,r,o,i){Z(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),d=[i&&r>1?u-1:u,i&&o>1?l-1:l],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],g=d[0]/m[0],y=d[1]/m[1],v=0,w=0;w<s;w++)for(var x=w*n.strides[0],_=0;_<r;_++)for(var S=g*_,R=x+Math.min(u-1,i?Math.round(S):Math.floor(S))*n.strides[1],C=0;C<o;C++)for(var E=y*C,I=R+Math.min(l-1,i?Math.round(E):Math.floor(E))*n.strides[2],T=0;T<c;T++){var k=h[I+T];f[v++]=k}return gn(f,[s,r,o,c],n.dtype)},e.prototype.resizeNearestNeighborBackprop=function(n,r,o){Z([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,h=c[1],f=c[2],d=new Float32Array(a*s*u*l),m=this.readSync(n.dataId),g=[o&&h>1?s-1:s,o&&f>1?u-1:u],y=[o&&h>1?h-1:h,o&&f>1?f-1:f],v=g[0]/y[0],w=g[1]/y[1],x=1/v,_=1/w,S=2*Math.ceil(x)+2,R=2*Math.ceil(_)+2,C=0;C<a;C++)for(var E=C*r.strides[0],I=0;I<s;I++)for(var T=E+I*r.strides[1],k=Math.floor(I*x),P=Math.floor(k-S/2),D=0;D<u;D++)for(var $=T+D*r.strides[2],U=Math.floor(D*_),K=Math.floor(U-R/2),X=0;X<l;X++){for(var V=0,W=0;W<S;W++){var H=W+P;if(!(H<0||H>=h)){var ne=E+H*n.strides[1],oe=H*v;if(I===Math.min(s-1,o?Math.round(oe):Math.floor(oe)))for(var de=0;de<R;de++){var me=de+K;if(!(me<0||me>=f)){var _e=ne+me*n.strides[2],xe=me*w;D===Math.min(u-1,o?Math.round(xe):Math.floor(xe))&&(V+=m[_e+X])}}}}d[$+X]=V}return Xn(d,r.shape,r.dtype)},e.prototype.batchNormalization=function(n,r,o,i,a,s){Z([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),h=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),d=new Float32Array(u.length),m=f.length,g=h.length,y=c.length,v=l.length,w=0,x=0,_=0,S=0,R=0;R<u.length;++R)d[R]=f[w++]+(u[R]-l[x++])*h[_++]/Math.sqrt(c[S++]+i),w>=m&&(w=0),x>=v&&(x=0),_>=g&&(_=0),S>=y&&(S=0);return Xn(d,n.shape)},e.prototype.localResponseNormalization4D=function(n,r,o,i,a){Z(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,h=new Float32Array(c);function f(y){for(var v=y%s,w=y-v+Math.max(0,v-r),x=y-v+Math.min(v+r,u),_=0;w<=x;w++){var S=l[w];_+=S*S}return _}for(var d=0;d<c;d++){var m=f(d),g=l[d]*Math.pow(o+i*m,-a);h[d]=g}return Xn(h,n.shape)},e.prototype.LRNGrad=function(n,r,o,i,a,s,u){Z(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),h=this.readSync(r.dataId),f=this.readSync(o.dataId),d=new Float32Array(n.size),m=n.size,g=0;g<m;g++){for(var y=g%l,v=g-y+Math.max(0,y-i),w=g-y+Math.min(l,y+i+1),x=0,_=v;_<w;_++)x+=Math.pow(h[_],2);for(x=s*x+a,_=v;_<w;_++){var S=-2*s*u*h[_]*f[g]/x;g===_&&(S+=Math.pow(x,-u)),S*=c[g],d[_]+=S}}return Xn(d,n.shape)},e.prototype.multinomial=function(n,r,o,i){Z(n,"multinomial");for(var a=r?n:vi(n),s=a.shape[0],u=a.shape[1],l=dt([s,o],"int32"),c=this.readSync(l.dataId),h=this.readSync(a.dataId),f=0;f<s;++f){var d=f*u,m=new Float32Array(u-1);m[0]=h[d];for(var g=1;g<m.length;++g)m[g]=m[g-1]+h[d+g];for(var y=am(i.toString()),v=f*o,w=0;w<o;++w){var x=y();c[v+w]=m.length;for(var _=0;_<m.length;_++)if(x<m[_]){c[v+w]=_;break}}}return l},e.prototype.oneHot=function(n,r,o,i){Z(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return Xi(a,[n.size,r],"int32")},e.prototype.nonMaxSuppression=function(n,r,o,i,a){return Z(n,"nonMaxSuppression"),Y1(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},e.prototype.fft=function(n){return this.fftBatch(n,!1)},e.prototype.ifft=function(n){return this.fftBatch(n,!0)},e.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Ae(n.shape,"float32"),s=Ae(n.shape,"float32"),u=Nr(n).as2D(o,i),l=bo(n).as2D(o,i),c=0;c<o;c++)for(var h=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),d=dn(h,f),m=this.readSync(this.fftImpl(d,r).dataId),g=0;g<i;g++){var y=z2(m,g);a.values[c*i+g]=y.real,s.values[c*i+g]=y.imag}return dn(a.toTensor(),s.toTensor()).as2D(o,i)},e.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=dn(Nr(a).div(ae(i)),bo(a).div(ae(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),h=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],h[f/2]=l[f+1];return{real:c,imag:h}}(this.fourierTransformByMatmul(s,i,r));return dn(u.real,u.imag).as2D(n.shape[0],n.shape[1])},e.prototype.isExponentOf2=function(n){return(n&n-1)==0},e.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(v){for(var w=Math.ceil(v.length/4),x=new Float32Array(w),_=new Float32Array(w),S=0;S<v.length;S+=4)x[Math.floor(S/4)]=v[S],_[Math.floor(S/4)]=v[S+1];return{real:x,imag:_}}(i),u=dn(s.real,s.imag).as1D(),l=function(v){for(var w=Math.floor(v.length/4),x=new Float32Array(w),_=new Float32Array(w),S=2;S<v.length;S+=4)x[Math.floor(S/4)]=v[S],_[Math.floor(S/4)]=v[S+1];return{real:x,imag:_}}(i),c=dn(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var h=function(v,w){for(var x=new Float32Array(v/2),_=new Float32Array(v/2),S=0;S<Math.ceil(v/2);S++){var R=(w?2:-2)*Math.PI*(S/v);x[S]=Math.cos(R),_[S]=Math.sin(R)}return{real:x,imag:_}}(r,o),f=dn(h.real,h.imag).mul(c),d=u.add(f),m=u.sub(f),g=Nr(d).concat(Nr(m)),y=bo(d).concat(bo(m));return dn(g,y).as1D()},e.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=r$(a*l,r,o),h=z2(n,l);s+=h.real*c.real-h.imag*c.imag,u+=h.real*c.imag+h.imag*c.real}o&&(s/=r,u/=r),n$(i,s,u,a)}return i},e.prototype.depthToSpace=function(n,r,o){O(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),O(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,h=u/(r*r),f=this.readSync(n.dataId),d=new Float32Array(i*l*c*h),m=0,g=0;g<i;++g)for(var y=0;y<l;++y)for(var v=Math.floor(y/r),w=y%r,x=0;x<c;++x)for(var _=Math.floor(x/r),S=(w*r+x%r)*h,R=0;R<h;++R){var C=R+S+u*(_+s*(v+a*g));d[m++]=f[C]}return Xn(d,[i,l,c,h])},e.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Le(n.shape,r.shape),s=Ae(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Vi(n.shape,a),h=Vi(r.shape,a),f=s.values;if(c.length+h.length===0)for(var d=0;d<f.length;++d)f[d]=i(u[d%u.length],l[d%l.length]);else{var m=this.bufferSync(n),g=this.bufferSync(r),y=function(v){var w=s.indexToLoc(v),x=w.slice(-n.rank);c.forEach(function(C){return x[C]=0});var _=m.locToIndex(x),S=w.slice(-r.rank);h.forEach(function(C){return S[C]=0});var R=g.locToIndex(S);f[v]=i(u[_],l[R])};for(d=0;d<f.length;++d)y(d)}return s.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Le(n.shape,r.shape),a=Ae(i,"float32"),s=Ae(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=Vi(n.shape,i),h=Vi(r.shape,i),f=a.values,d=s.values;if(c.length+h.length===0)for(var m=0;m<f.length;m++){var g=m%u.length,y=m%l.length,v=o(u[2*g],u[2*g+1],l[2*y],l[2*y+1]);f[m]=v.real,d[m]=v.imag}else{var w=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),_=function(S){var R=a.indexToLoc(S),C=R.slice(-n.rank);c.forEach(function(P){return C[P]=0});var E=w.locToIndex(C),I=R.slice(-r.rank);h.forEach(function(P){return I[P]=0});var T=x.locToIndex(I),k=o(u[2*E],u[2*E+1],l[2*T],l[2*T+1]);f[S]=k.real,d[S]=k.imag};for(m=0;m<f.length;m++)_(m)}return this.complex(a.toTensor(),s.toTensor())},e.prototype.split=function(n,r,o){return GR(n,r,o)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],h=u[2],f=u[3],d=r.shape[0],m=i[0],g=i[1],y=Ae([d,m,g,f],"float32"),v=this.readSync(r.dataId),w=this.readSync(o.dataId),x=this.readSync(n.dataId),_=n.strides,S=y.strides,R=0;R<d;R++){var C=4*R,E=v[C],I=v[C+1],T=v[C+2],k=v[C+3],P=w[R];if(!(P>=l))for(var D=m>1?(T-E)*(c-1)/(m-1):0,$=g>1?(k-I)*(h-1)/(g-1):0,U=0;U<m;U++){var K=m>1?E*(c-1)+U*D:.5*(E+T)*(c-1);if(K<0||K>c-1)for(var X=0;X<g;X++)for(var V=0;V<f;V++){var W=V+X*S[2]+U*S[1]+R*S[0];y.values[W]=s}else if(a==="bilinear"){var H=Math.floor(K),ne=Math.ceil(K),oe=K-H;for(X=0;X<g;X++)if((Me=g>1?I*(h-1)+X*$:.5*(I+k)*(h-1))<0||Me>h-1)for(V=0;V<f;V++)W=V+X*S[2]+U*S[1]+R*S[0],y.values[W]=s;else{var de=Math.floor(Me),me=Math.ceil(Me),_e=Me-de;for(V=0;V<f;V++){var xe=x[W=V+de*_[2]+H*_[1]+P*_[0]],Ie=x[W=V+me*_[2]+H*_[1]+P*_[0]],Pe=x[W=V+de*_[2]+ne*_[1]+P*_[0]],Ee=xe+(Ie-xe)*_e,ct=Pe+(x[W=V+me*_[2]+ne*_[1]+P*_[0]]-Pe)*_e;W=V+X*S[2]+U*S[1]+R*S[0],y.values[W]=Ee+(ct-Ee)*oe}}}else for(X=0;X<g;++X){var Me;if((Me=g>1?I*(h-1)+X*$:.5*(I+k)*(h-1))<0||Me>h-1)for(V=0;V<f;V++)W=V+X*S[2]+U*S[1]+R*S[0],y.values[W]=s;else{var je=Math.round(Me),Fe=Math.round(K);for(V=0;V<f;V++){var tt=V+je*_[2]+Fe*_[1]+P*_[0],nt=V+X*S[2]+U*S[1]+R*S[0];y.values[nt]=x[tt]}}}}}return y.toTensor()},e.prototype.sparseToDense=function(n,r,o,i){var a=Nd(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,h=a.outputSize;return this.scatter(n,r,o,h,l,u,s,c,i,!1)},e.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=FR(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return gn([],s,n.dtype);for(var h=new Ec([u,l],n.dtype),f=this.readSync(r.dataId),d=this.readSync(n.dataId),m=0;m<u;m++){for(var g=[],y=0,v=0;v<i;v++){var w=f[m*i+v];y+=w*c[v],g.push(w)}if(y<0||y>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var x=0;x<l;x++)h.values[m*l+x]=d[y*l+x]}return h.toTensor().reshape(s)},e.prototype.scatterND=function(n,r,o){var i=Nd(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,h=ae(0);return this.scatter(n,r,o,c,u,s,a,l,h,!0)},e.prototype.fill=function(n,r,o){var i=Ed(o=o||Zc(r),pe(n));return i.fill(r),B.makeTensor(i,n,o,this)},e.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},e.prototype.zerosLike=function(n){var r=Ed(n.dtype,pe(n.shape));return this.makeOutput(r,n.shape,n.dtype)},e.prototype.linspace=function(n,r,o){return jR(n,r,o)},e.prototype.scatter=function(n,r,o,i,a,s,u,l,c,h){var f=[i/a,a],d=this.readSync(n.dataId),m=this.readSync(r.dataId);if(i===0)return gn([],o,r.dtype);var g=new Ec(f,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var y=0;y<s;y++){for(var v=[],w=0,x=0;x<u;x++){var _=d[y*u+x];v.push(_),w+=_*l[x]}if(w<0||w>=i/a)throw new Error("Invalid indices: "+v+" does not index into "+o);for(var S=0;S<a;S++)h?g.values[w*a+S]+=m[y*a+S]:g.values[w*a+S]=r.rank===0?m[0]:m[y*a+S]}return g.toTensor().reshape(o)},e}(UR);B.registerBackend("cpu",function(){return new E9},1);for(var Qv=0,cE=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,h=s.softNmsSigma,f=n;Z(i,"NonMaxSuppressionWithScore");var d=J1(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,l,c,h);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n;Z(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Ic,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n;Z([o,i],Ic);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(f,d,m,g,y,v){var w=Le(f,d),x=w.length,_=Ro(w),S=bc(y,pe(w)),R=f.length,C=d.length,E=Ro(f),I=Ro(d),T=Vi(f,w),k=Vi(d,w);if(T.length+k.length===0)for(var P=0;P<S.length;++P)S[P]=v(m[P%m.length],g[P%g.length]);else{var D=function($){var U=N5($,x,_),K=U.slice(-R);T.forEach(function(H){return K[H]=0});var X=N2(K,R,E),V=U.slice(-C);k.forEach(function(H){return V[H]=0});var W=N2(V,C,I);S[$]=v(m[X],g[W])};for(P=0;P<S.length;++P)D(P)}return[S,w]}(o.shape,i.shape,s,u,o.dtype,function(f,d){var m=f-d;return m*m}),c=l[0],h=l[1];return{dataId:a.write(c,h,o.dtype),shape:h,dtype:o.dtype}}}];Qv<cE.length;Qv++)mR(cE[Qv]);var Es,C9=function(t){this.variableNames=["A"];var e=Nn(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+e.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},S9=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Nn(),n=t[0],r=t[1];this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+e.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+e.output+` = result;
      }
    `};for(var Yv=0,hE=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,o=e.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],h=[c,l],f=[c,l,i];(s||a)&&(Es==null&&(Es=document.createElement("canvas").getContext("2d")),Es.canvas.width=l,Es.canvas.height=c,Es.drawImage(o,0,0,l,c),o=Es.canvas);var d=n.makeTensorInfo(h,"int32");n.texData.get(d.dataId).usage=pr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),o);var m=Q().getBool("WEBGL_PACK")?new S9(f):new C9(f),g=n.runWebGLProgram(m,[d],"int32");return n.disposeData(d.dataId),g}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;Td("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=e,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,h=s.softNmsSigma,f=n,d=J1(f.readSync(i.dataId),f.readSync(a.dataId),u,l,c,h);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,o=n,i=new De(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Ic,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,o=r.a,i=r.b,a=n,s=Q().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new jo("return (a - b) * (a - b);",o.shape,i.shape):new Rt("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Yv<hE.length;Yv++)mR(hE[Yv]);for(var Jv=0,fE=[{kernelName:"Square",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Ic,gradFunc:function(t,e){var n=e[0],r=e[1],o=ae(2);return{a:function(){return On(t,On(o,en(n,r)))},b:function(){return On(t,On(o,en(r,n)))}}}}];Jv<fE.length;Jv++)b5(fE[Jv]);var I9=function(){function t(){}return t.prototype.fetch=function(e,n){return fetch(e,n)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return new TextDecoder(n).decode(e)},t}();Q().get("IS_BROWSER")&&Q().setPlatform("browser",new I9);var Zv,T9=function(){return require("node-fetch")},R9=function(){function t(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(e,n){return Q().global.fetch!=null?Q().global.fetch(e,n):(Zv==null&&(Zv=T9()),Zv(e,n))},t.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},t.prototype.encode=function(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(e)},t.prototype.decode=function(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)},t}();Q().get("IS_NODE")&&Q().setPlatform("node",new R9);var By={float32:4,int32:4,uint16:2,uint8:1,bool:1},$d=4;function VA(t,e){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,h=pe(c),f=void 0;if("quantization"in s){var d=s.quantization;if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+d.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=By[d.dtype],g=t.slice(r,r+h*m),y=d.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")f=Float32Array.from(y,function(R){return R*d.scale+d.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(y,function(R){return Math.round(R*d.scale+d.min)})}r+=h*m}else if(l==="string"){var v=pe(s.shape);f=[];for(var w=0;w<v;w++){var x=new Uint32Array(t.slice(r,r+$d))[0];r+=$d;var _=new Uint8Array(t.slice(r,r+x));f.push(_),r+=x}}else{var S=By[l];if(g=t.slice(r,r+h*S),l==="float32")f=new Float32Array(g);else if(l==="int32")f=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(g)}r+=h*S}n[u]=gn(f,c,l)},i=0,a=e;i<a.length;i++)o(a[i]);return n}function A9(t){if(t===null)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach(function(i){if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(e),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var $y=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function dE(t){return $y?Buffer.byteLength(t):new Blob([t]).size}function gw(t){var e=0;t.forEach(function(o){e+=o.byteLength});var n=new Uint8Array(e),r=0;return t.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function pE(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function ah(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:dE(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:dE(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}var mr=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var o=[];return(n==="load"?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(i){var a=i(e,r);a!==null&&o.push(a)}),o},t}(),ou="://",Qi=function(){function t(){this.managers={}}return t.getInstance=function(){return t.instance==null&&(t.instance=new t),t.instance},t.registerManager=function(e,n){O(e!=null,function(){return"scheme must not be undefined or null."}),e.endsWith(ou)&&(e=e.slice(0,e.indexOf(ou))),O(e.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();O(r.managers[e]==null,function(){return"A model store manager is already registered for scheme '"+e+"'."}),r.managers[e]=n},t.getManager=function(e){var n=this.getInstance().managers[e];if(n==null)throw new Error("Cannot find model manager for scheme '"+e+"'");return n},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function Lf(t){if(t.indexOf(ou)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Qi.getSchemes().join(","));return{scheme:t.split(ou)[0],path:t.split(ou)[1]}}function mE(t,e,n){return n===void 0&&(n=!1),he(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,h;return fe(this,function(f){switch(f.label){case 0:return O(t!==e,function(){return"Old path and new path are the same: '"+t+"'"}),O((r=mr.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),O(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),o=r[0],O((i=mr.getSaveHandlers(e)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+e+"."}),O(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."}),a=i[0],s=Lf(t).scheme,u=Lf(t).path,l=s===Lf(t).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,Qi.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return h=f.sent(),!n||l?[3,6]:[4,Qi.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,h.modelArtifactsInfo]}})})}var Ua="models_store",Bi="model_info_store";function BA(){if(!Q().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Uy(t){var e=t.result;e.createObjectStore(Ua,{keyPath:"modelPath"}),e.createObjectStore(Bi,{keyPath:"modelPath"})}var iu=function(){function t(e){if(this.indexedDB=BA(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return t.prototype.save=function(e){return he(this,void 0,void 0,function(){return fe(this,function(n){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]})})},t.prototype.load=function(){return he(this,void 0,void 0,function(){return fe(this,function(e){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(e,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return Uy(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(Ua,"readonly"),l=u.objectStore(Ua).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,h=ah(n),f=s.transaction(Bi,"readwrite"),d=f.objectStore(Bi),m=d.put({modelPath:r.modelPath,modelArtifactsInfo:h});m.onsuccess=function(){var g=(c=s.transaction(Ua,"readwrite")).objectStore(Ua).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:h});g.onsuccess=function(){return o({modelArtifactsInfo:h})},g.onerror=function(y){var v=(d=f.objectStore(Bi)).delete(r.modelPath);v.onsuccess=function(){return s.close(),i(g.error)},v.onerror=function(w){return s.close(),i(g.error)}}},m.onerror=function(g){return s.close(),i(m.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),vE=function(t){return Q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(iu.URL_SCHEME)?(e=t.slice(iu.URL_SCHEME.length),new iu(e)):null;var e};mr.registerSaveRouter(vE),mr.registerLoadRouter(vE);var k9=function(){function t(){this.indexedDB=BA()}return t.prototype.listModels=function(){return he(this,void 0,void 0,function(){var e=this;return fe(this,function(n){return[2,new Promise(function(r,o){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Uy(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Bi,"readonly"),u=s.objectStore(Bi).getAll();u.onsuccess=function(){for(var l={},c=0,h=u.result;c<h.length;c++){var f=h[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},t.prototype.removeModel=function(e){return he(this,void 0,void 0,function(){var n=this;return fe(this,function(r){var o;return e=(o=e).startsWith(iu.URL_SCHEME)?o.slice(iu.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Uy(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Bi,"readwrite"),h=c.objectStore(Bi),f=h.get(e);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var d=h.delete(e),m=function(){var g=(u=l.transaction(Ua,"readwrite")).objectStore(Ua).delete(e);g.onsuccess=function(){return i(f.result.modelArtifactsInfo)},g.onerror=function(y){return a(f.error)}};d.onsuccess=m,d.onerror=function(g){return m(),l.close(),a(f.error)}},f.onerror=function(d){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(Q().getBool("IS_BROWSER"))try{Qi.registerManager(iu.URL_SCHEME,new k9)}catch{}var Ko="/",As="tensorflowjs_models",$A="info",P9="model_topology",D9="weight_specs",N9="weight_data",M9="model_metadata";function UA(t){return{info:[As,t,$A].join(Ko),topology:[As,t,P9].join(Ko),weightSpecs:[As,t,D9].join(Ko),weightData:[As,t,N9].join(Ko),modelMetadata:[As,t,M9].join(Ko)}}function O9(t){var e=t.split(Ko);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(Ko)}var au=function(){function t(e){if(!Q().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=UA(this.modelPath)}return t.prototype.save=function(e){return he(this,void 0,void 0,function(){var n,r,o;return fe(this,function(i){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),o=ah(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if($y)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return he(this,void 0,void 0,function(){var e,n,r,o,i,a,s;return fe(this,function(u){if((e=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if($y){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var h=atob(l),f=new Uint8Array(h.length),d=0;d<h.length;++d)f.set([h.charCodeAt(d)],d);return f.buffer}(s),[2,n]})})},t.URL_SCHEME="localstorage://",t}(),gE=function(t){return Q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(au.URL_SCHEME)?(e=t.slice(au.URL_SCHEME.length),new au(e)):null;var e};mr.registerSaveRouter(gE),mr.registerLoadRouter(gE);var F9=function(){function t(){O(Q().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),O(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return he(this,void 0,void 0,function(){var e,n,r,o,i,a;return fe(this,function(s){for(e={},n=As+Ko,r=Ko+$A,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=O9(i),e[a]=JSON.parse(this.LS.getItem(i)));return[2,e]})})},t.prototype.removeModel=function(e){return he(this,void 0,void 0,function(){var n,r;return fe(this,function(o){var i;if(e=(i=e).startsWith(au.URL_SCHEME)?i.slice(au.URL_SCHEME.length):i,n=UA(e),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+e+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},t}();if(Q().getBool("IS_BROWSER"))try{Qi.registerManager(au.URL_SCHEME,new F9)}catch{}var L9="model",V9=".json",B9=".weights.bin";function yE(t){return new Promise(function(e){return setTimeout(e)}).then(t)}var eg=function(){function t(e){if(!Q().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),e!=null&&e.length!==0||(e=L9),this.modelTopologyFileName=e+V9,this.weightDataFileName=e+B9}return t.prototype.save=function(e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s;return fe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,yE(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),e.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,yE(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:ah(e)}]}})})},t.URL_SCHEME="downloads://",t}(),$9=function(){function t(e){if(e==null||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return t.prototype.load=function(){return he(this,void 0,void 0,function(){var e,n,r=this;return fe(this,function(o){return e=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var h=l.weightsManifest;if(h!=null){var f;try{f=r.checkManifestAndWeightFiles(h,n)}catch(y){return void a(y)}var d=[],m=[],g=[];h.forEach(function(y){y.paths.forEach(function(v){m.push(v),g.push(null)}),d.push.apply(d,y.weights)}),h.forEach(function(y){y.paths.forEach(function(v){var w=new FileReader;w.onload=function(x){var _=x.target.result,S=m.indexOf(v);g[S]=_,g.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:d,weightData:gw(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},w.onerror=function(x){return a("Failed to weights data from file of path '"+v+"'.")},w.readAsArrayBuffer(f[v])})})}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(e)})]})})},t.prototype.checkManifestAndWeightFiles=function(e,n){for(var r=[],o=n.map(function(u){return pE(u.name)}),i={},a=0,s=e;a<s.length;a++)s[a].paths.forEach(function(u){var l=pE(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},t}();function wE(t,e,n,r){(function(i){O(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(t),function(i,a){O(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),O(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),O(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(t.map(function(i){return i.then(function(a){var s=n+ ++o/t.length*(r-n);return e(s),a}),i}))}function zA(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return fe(this,function(h){switch(h.label){case 0:return e==null&&(e={}),n=e.fetchFunc==null?Q().platform.fetch:e.fetchFunc,r=t.map(function(f){return n(f,e.requestInit,{isBinary:!0})}),o=0,i=.5,e.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=h.sent(),[3,4];case 2:return[4,wE(r,e.onProgress,o,i)];case 3:a=h.sent(),h.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,e.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=h.sent(),[3,8];case 6:return[4,wE(s,e.onProgress,u,l)];case 7:c=h.sent(),h.label=8;case 8:return[2,c]}})})}function xE(t){var e=this;return function(n,r,o){return r===void 0&&(r=""),he(e,void 0,void 0,function(){var i,a,s,u,l,c,h,f,d,m;return fe(this,function(g){switch(g.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(y,v){var w=0;y.weights.forEach(function(x){var _="quantization"in x?x.quantization.dtype:x.dtype,S=By[_]*pe(x.shape),R=function(){i[v]=!0,a[v]==null&&(a[v]=[]),a[v].push({manifestEntry:x,groupOffset:w,sizeBytes:S})};o!=null?o.forEach(function(C,E){C===x.name&&(R(),s[E]=!0)}):R(),u.push(x.name),w+=S})}),!s.every(function(y){return y}))throw l=o.filter(function(y,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(y,v,w){return v&&y.push(w),y},[]),h=[],c.forEach(function(y){n[y].paths.forEach(function(v){var w=r+(r.endsWith("/")?"":"/")+v;h.push(w)})}),[4,t(h)];case 1:return f=g.sent(),d={},m=0,c.forEach(function(y){for(var v=n[y].paths.length,w=0,x=0;x<v;x++)w+=f[m+x].byteLength;for(var _=new ArrayBuffer(w),S=new Uint8Array(_),R=0,C=0;C<v;C++){var E=new Uint8Array(f[m+C]);S.set(E,R),R+=E.byteLength}a[y].forEach(function(I){var T=VA(_.slice(I.groupOffset,I.groupOffset+I.sizeBytes),[I.manifestEntry]);for(var k in T)d[k]=T[k]}),m+=v}),[2,d]}})})}}mr.registerSaveRouter(function(t){return Q().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(eg.URL_SCHEME)?function(e){return e===void 0&&(e="model"),new eg(e)}(t.slice(eg.URL_SCHEME.length)):null});var WA=function(){function t(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(O(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=Q().platform.fetch,O(e!=null&&e.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(e)&&O(e.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."}),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return t.prototype.save=function(e){return he(this,void 0,void 0,function(){var n,r,o,i;return fe(this,function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:ah(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},t.prototype.load=function(){return he(this,void 0,void 0,function(){var e,n,r,o,i,a,s,u,l,c,h,f;return fe(this,function(d){switch(d.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=d.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");d.label=2;case 2:return d.trys.push([2,4,,5]),[4,e.json()];case 3:return n=d.sent(),[3,5];case 4:throw d.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=d.sent(),c=f[0],h=f[1],d.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:h,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},t.prototype.loadWeights=function(e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,h,f;return fe(this,function(d){switch(d.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(m){var g=m.lastIndexOf("/"),y=m.lastIndexOf("?"),v=m.substring(0,g),w=y>g?m.substring(y):"";return[v+"/",w]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=e;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return h=[],e.forEach(function(m){m.paths.forEach(function(g){h.push(a+g+i)})}),[4,zA(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=d.sent(),[2,[s,gw(f)]]}})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function zy(t){return t.match(WA.URL_SCHEME_REGEX)!=null}var _E=function(t,e){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(n){return zy(n)}):zy(t))?Wy(t,{onProgress:e}):null};function Wy(t,e){return new WA(t,e)}mr.registerSaveRouter(_E),mr.registerLoadRouter(_E);var tg=function(){function t(e){this.modelArtifacts=e}return t.prototype.load=function(){return he(this,void 0,void 0,function(){return fe(this,function(e){return[2,this.modelArtifacts]})})},t}(),U9=function(){function t(e){this.saveHandler=e}return t.prototype.save=function(e){return he(this,void 0,void 0,function(){return fe(this,function(n){return[2,this.saveHandler(e)]})})},t}(),jA=Object.freeze({browserFiles:function(t){return new $9(t)},browserHTTPRequest:function(t,e){return Wy(t,e)},concatenateArrayBuffers:gw,decodeWeights:VA,encodeWeights:function(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return fe(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(t)?t.map(function(l){return l.name}):Object.keys(t),i=function(l){var c=o[l],h=Array.isArray(t)?t[l].tensor:t[c];if(h.dtype!=="float32"&&h.dtype!=="int32"&&h.dtype!=="bool"&&h.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+h.dtype);var f={name:c,shape:h.shape,dtype:h.dtype};if(h.dtype==="string"){var d=new Promise(function(m){return he(s,void 0,void 0,function(){var g,y,v,w,x,_,S;return fe(this,function(R){switch(R.label){case 0:return[4,h.bytes()];case 1:for(g=R.sent(),y=g.reduce(function(C,E){return C+E.length},0)+$d*g.length,v=new Uint8Array(y),w=0,x=0;x<g.length;x++)_=g[x],S=new Uint8Array(new Uint32Array([_.length]).buffer),v.set(S,w),w+=$d,v.set(_,w),w+=_.length;return m(v),[2]}})})});r.push(d)}else r.push(h.data());e!=null&&(f.group=e),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:A9(u.sent()),specs:n}]}})})},fromMemory:function(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new tg(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tg({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tg({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return mr.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:ah,getSaveHandlers:function(t){return mr.getSaveHandlers(t)},http:Wy,isHTTPScheme:zy,loadWeights:function(t,e,n,r){return e===void 0&&(e=""),he(this,void 0,void 0,function(){return fe(this,function(o){return[2,xE(function(i){return zA(i,{requestInit:r})})(t,e,n)]})})},registerLoadRouter:function(t){return mr.registerLoadRouter(t)},registerSaveRouter:function(t){return mr.registerSaveRouter(t)},weightsLoaderFactory:xE,withSaveHandler:function(t){return new U9(t)},copyModel:function(t,e){return he(this,void 0,void 0,function(){return fe(this,function(n){return[2,mE(t,e,!1)]})})},listModels:function(){return he(this,void 0,void 0,function(){var t,e,n,r,o,i,a;return fe(this,function(s){switch(s.label){case 0:t=Qi.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(o=r[n],[4,Qi.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())e[o+ou+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}})})},moveModel:function(t,e){return he(this,void 0,void 0,function(){return fe(this,function(n){return[2,mE(t,e,!0)]})})},removeModel:function(t){return he(this,void 0,void 0,function(){var e;return fe(this,function(n){return e=Lf(t),[2,Qi.getManager(e.scheme).removeModel(e.path)]})})}}),Cs;L({confusionMatrix_:function(t,e,n){var r=N(t,"labels","confusionMatrix"),o=N(e,"predictions","confusionMatrix");O(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),O(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),O(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),O(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),O(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=My(r.asType("int32"),n),a=My(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var z9=L({fromPixels_:function(t,e){if(e===void 0&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(t.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(o&&o&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(pR("FromPixels",B.backendName)!=null)return B.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,l=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=l[0],h=l[1];if(a?s=t.getContext("2d").getImageData(0,0,c,h).data:r||n?s=t.data:(i||o)&&(Cs==null&&(Cs=document.createElement("canvas").getContext("2d")),Cs.canvas.width=c,Cs.canvas.height=h,Cs.drawImage(t,0,0,c,h),s=Cs.getImageData(0,0,c,h).data),e===4)u=new Int32Array(s);else{var f=c*h;u=new Int32Array(f*e);for(var d=0;d<f;d++)for(var m=0;m<e;++m)u[d*e+m]=s[4*d+m]}return G1(u,[h,c,e],"int32")}}),yw=Object.freeze({toPixels:function(t,e){return he(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,h,f,d,m,g,y,v,w,x,_,S,R,C,E;return fe(this,function(I){switch(I.label){case 0:if(n=N(t,"img","toPixels"),t instanceof _t||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=I.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=I.sent(),h=c[0],f=c[1],d=h[0],m=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(d<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+m+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+m+"].")}for(g=n.dtype==="float32"?255:1,y=new Uint8ClampedArray(i*o*4),v=0;v<o*i;++v)w=void 0,x=void 0,_=void 0,S=void 0,a===1?(w=s[v]*g,x=s[v]*g,_=s[v]*g,S=255):a===3?(w=s[3*v]*g,x=s[3*v+1]*g,_=s[3*v+2]*g,S=255):a===4&&(w=s[4*v]*g,x=s[4*v+1]*g,_=s[4*v+2]*g,S=s[4*v+3]*g),y[(R=4*v)+0]=Math.round(w),y[R+1]=Math.round(x),y[R+2]=Math.round(_),y[R+3]=Math.round(S);return e!=null&&(e.width=i,e.height=o,C=e.getContext("2d"),E=new ImageData(y,i,o),C.putImageData(E,0,0)),n!==t&&n.dispose(),[2,y]}})})},fromPixels:z9}),W9=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(e,n){return new e(n)},t}(),j9=function(){function t(){this.classNameMap={}}return t.getMap=function(){return t.instance==null&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function ss(t){O(t.className!=null,function(){return"Class being registered does not have the static className property defined."}),O(typeof t.className=="string",function(){return"className is required to be a string, but got type "+typeof t.className}),O(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),j9.register(t)}var us=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return ao(e,t),e.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return nr(s),r?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(n,r){return e$(n,r)},e.prototype.dispose=function(){this.iterations_!=null&&nr(this.iterations_)},e.prototype.saveIterations=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ae(this.iterations_,"int32")}]})})},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},e.prototype.extractIterations=function(n){return he(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},e}(W9);Object.defineProperty(us,Symbol.hasInstance,{value:function(t){return t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null}});var H9=function(t){function e(n,r,o){o===void 0&&(o=null);var i=t.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=B.backend.epsilon()),i}return ao(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=B.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:le(function(){return We(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:le(function(){return We(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;le(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),h=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(h.square().mul(1-r.rho));u.assign(c),l.assign(f);var d=h.mul(-r.learningRate).add(a);a.assign(d)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedUpdates!=null&&(nr(this.accumulatedGrads.map(function(n){return n.variable})),nr(this.accumulatedUpdates.map(function(n){return n.variable})))},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},e.className="Adadelta",e}(us);ss(H9);var G9=function(t){function e(n,r){r===void 0&&(r=.1);var o=t.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return ao(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=B.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:le(function(){return Ao(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;le(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(B.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedGrads!=null&&nr(this.accumulatedGrads.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},e.className="Adagrad",e}(us);ss(G9);var q9=function(t){function e(n,r,o,i){i===void 0&&(i=null);var a=t.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],le(function(){a.accBeta1=ae(r).variable(),a.accBeta2=ae(o).variable()}),i==null&&(a.epsilon=B.backend.epsilon()),a}return ao(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);le(function(){var i=en(1,r.accBeta1),a=en(1,r.accBeta2);o.forEach(function(s,u){var l=B.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:le(function(){return We(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:le(function(){return We(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var h=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,d=h.mul(r.beta1).add(c.mul(1-r.beta1)),m=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=d.div(i),y=m.div(a);h.assign(d),f.assign(m);var v=g.div(y.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&nr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&nr(this.accumulatedSecondMoment.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){var r,o=this;return fe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),le(function(){o.accBeta1.assign(Vd(o.beta1,o.iterations_+1)),o.accBeta2.assign(Vd(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},e.className="Adam",e}(us);ss(q9);var K9=function(t){function e(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=t.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],le(function(){s.iteration=ae(0).variable(),s.accBeta1=ae(r).variable()}),i==null&&(s.epsilon=B.backend.epsilon()),s}return ao(e,t),e.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);le(function(){var i=en(1,r.accBeta1),a=Qr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=B.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:We(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:We(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var h=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,d=h.mul(r.beta1).add(c.mul(1-r.beta1)),m=f.mul(r.beta2),g=c.abs(),y=m.maximum(g);h.assign(d),f.assign(y);var v=a.div(i).mul(d.div(y.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&nr(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&nr(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},e.className="Adamax",e}(us);ss(K9);var HA=function(t){function e(n){var r=t.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return ao(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=B.registeredVariables[o];le(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},e.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=p6(ae(-n))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(n,r){return new n(r.learningRate)},e.className="SGD",e}(us);ss(HA);var X9=function(t){function e(n,r,o){o===void 0&&(o=!1);var i=t.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ae(i.momentum),i}return ao(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=B.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:le(function(){return We(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&le(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&nr(this.accumulations.map(function(n){return n.variable}))},e.prototype.setMomentum=function(n){this.momentum=n},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){return fe(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){return fe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},e.className="Momentum",e}(HA);ss(X9);var Q9=function(t){function e(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=t.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=B.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return ao(e,t),e.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=B.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:le(function(){return We(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:le(function(){return We(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:le(function(){return We(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;le(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var h=r.accumulatedMeanGrads[i].variable,f=h.mul(r.decay).add(s.mul(1-r.decay)),d=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),h.assign(f),l.assign(d);var m=a.sub(d);a.assign(m)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));d=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(d),m=a.sub(d),a.assign(m)}})}}),this.incrementIterations()},e.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&nr(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&nr(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&nr(this.accumulatedMoments.map(function(n){return n.variable}))},e.prototype.getWeights=function(){return he(this,void 0,void 0,function(){var n;return fe(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},e.prototype.setWeights=function(n){return he(this,void 0,void 0,function(){var r;return fe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},e.className="RMSProp",e}(us);ss(Q9);_t.prototype.squaredDifference=function(t){return aA(this,t)},q=b9;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var jy=function(t,e){return jy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},jy(t,e)};function Re(t,e){jy(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Pn=function(){return Pn=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Pn.apply(this,arguments)};function ge(t,e,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(h){a(h)}}function u(c){try{l(r.throw(c))}catch(h){a(h)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(t,[])).next())})}function ye(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Gl(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var su=function(){function t(e,n){if(!Ha(e)||!Ha(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:n}));this._width=e,this._height=n}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function pm(t,e){return t instanceof _t&&t.shape.length===e}function Y9(t){return pm(t,2)}function mm(t){return pm(t,3)}function Yi(t){return pm(t,4)}function J9(t){return t%1!==0}function bE(t){return t%2===0}function Z9(t,e){e===void 0&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function EE(t){return t&&t.width&&t.height}function ej(t,e){var n=t.width,r=t.height,o=e/Math.max(r,n);return new su(Math.round(n*o),Math.round(r*o))}function ww(t){return t.reduce(function(e,n){return e.add(n)},new Xe(0,0)).div(new Xe(t.length,t.length))}function Tc(t,e,n){return Array(t).fill(0).map(function(r,o){return e+o*n})}function Ha(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||t===0}function CE(t){return Ha(t)&&0<=t&&t<=1}var Xe=function(){function t(e,n){this._x=e,this._y=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),ia=function(){function t(e,n){n===void 0&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(Ha),i=[r.x,r.y,r.width,r.height].every(Ha);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];t.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return t.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(Ha)},t.assertIsValidBox=function(e,n,r){if(r===void 0&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new Xe(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new Xe(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new Xe(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new Xe(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=e[0],r=e[1],o=e[2],i=e[3];return new t({x:n,y:r,width:o,height:i})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,o=e.width,i=e.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:n,y:r,width:o,height:i})},t.prototype.rescale=function(e){var n=EE(e)?e.width:e,r=EE(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new t({x:o,y:i,width:a,height:s})},t.prototype.clipAtImageBorders=function(e,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,h=s-l,f=Math.min(c,e-u),d=Math.min(h,n-l);return new t({x:u,y:l,width:f,height:d}).floor()},t.prototype.shift=function(e,n){var r=this,o=r.width,i=r.height,a=this.x+e,s=this.y+n;return new t({x:a,y:s,width:o,height:i})},t.prototype.padAtBorders=function(e,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,h=this.right,f=this.bottom;return h>n&&(s=-h+n+r,h=n),f>e&&(u=-f+e+o,f=e),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:f,x:l,ex:h,w:r,h:o}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),vm=function(t){Re(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return e}(ia),GA=function(){function t(e,n,r,o,i){this._imageDims=new su(i.width,i.height),this._score=e,this._classScore=n,this._className=r,this._box=new ia(o).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new ia(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),zo=function(t){Re(e,t);function e(n,r,o){return t.call(this,n,n,"",r,o)||this}return e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new e(i,a,s)},e}(GA);function tj(t,e,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),o=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),i=r*o;return n?i/(t.area+e.area-i):i/Math.min(t.area,e.area)}function nj(t){var e=t.map(function(s){return s.x}),n=t.map(function(s){return s.y}),r=e.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=e.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new vm(r,o,i,a)}function Rc(t,e,n,r){r===void 0&&(r=!0);for(var o=e.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var h=u[c],f=t[s],d=t[h];l.push(tj(f,d,r))}o=o.filter(function(m,g){return l[g]<=n})};o.length>0;)a();return i}function sh(t,e){return le(function(){var n=e[0],r=e[1],o=e[2],i=Ao(Gl(t.shape.slice(0,3),[1]),n),a=Ao(Gl(t.shape.slice(0,3),[1]),r),s=Ao(Gl(t.shape.slice(0,3),[1]),o),u=Qt([i,a,s],3);return en(t,u)})}function rj(t,e){return e===void 0&&(e=!1),le(function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(e?.5:1)),s=r>o?2:1,u=function(d){var m=t.shape.slice();return m[s]=d,Ao(m,0)},l=u(a),c=i-l.shape[s],h=e&&c?u(c):null,f=[h,t,l].filter(function(d){return!!d}).map(function(d){return d.toFloat()});return Qt(f,s)})}function ng(t){return 1/(1+Math.exp(-t))}var xw=function(t){Re(e,t);function e(n,r,o,i,a){return a===void 0&&(a=!1),t.call(this,{x:n,y:r,width:o,height:i},a)||this}return e}(ia),oj=.5,ij=.43,aj=.45,Ud=function(){function t(e,n,r){r===void 0&&(r=new Xe(0,0));var o=n.width,i=n.height;this._imgDims=new su(o,i),this._shift=r,this._positions=e.map(function(a){return a.mul(new Xe(o,i)).add(r)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new Xe(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map(function(n){return n.sub(e._shift).div(new Xe(e.imageWidth,e.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new this.constructor(this.relativePositions,{width:e,height:n})},t.prototype.shiftBy=function(e,n){return new this.constructor(this.relativePositions,this._imgDims,new Xe(e,n))},t.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},t.prototype.align=function(e,n){if(n===void 0&&(n={}),e){var r=e instanceof zo?e.box.floor():new ia(e);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},t.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),n=e[0],r=e[1],o=e[2],i=function(h){return o.sub(h).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/aj),u=ww(e),l=Math.floor(Math.max(0,u.x-oj*s)),c=Math.floor(Math.max(0,u.y-ij*s));return new xw(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},t.prototype.alignMinBbox=function(e){var n=nj(this.positions);return n.pad(n.width*e,n.height*e)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),sj=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],ww([n[3],n[4]])]},e}(Ud),uj=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(ww)},e}(Ud),SE=function(){function t(e,n){this._label=e,this._distance=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){return e===void 0&&(e=!0),""+this.label+(e?" ("+Z9(this.distance)+")":"")},t}(),IE=function(t){Re(e,t);function e(n,r){var o=t.call(this,n)||this;return o._label=r,o}return e.assertIsValidLabeledBox=function(n,r){if(ia.assertIsValidBox(n,r),!Ha(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(ia),sf=function(){function t(e,n){if(typeof e!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=n}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(e){return Array.from(e)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(r){return new Float32Array(r)});return new t(e.label,n)},t}();(function(t){Re(e,t);function e(n,r,o,i){var a=t.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return e.assertIsValidPredictedBox=function(n,r){if(IE.assertIsValidLabeledBox(n,r),!CE(n.score)||!CE(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),e})(IE);function lj(t){return t.detection instanceof zo}function _w(t,e){var n={detection:e};return Object.assign({},t,n)}function qA(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}function KA(t){var e="";if(!t)try{t=require("fs")}catch(r){e=r.toString()}var n=t?function(r){return new Promise(function(o,i){t.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:n}}function XA(){var t=global.Canvas||global.HTMLCanvasElement,e=global.Image||global.HTMLImageElement,n=function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(e)return new e;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=KA();return Pn({Canvas:t||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:e||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function QA(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function YA(){return typeof global=="object"&&typeof require=="function"&&typeof module<"u"&&typeof process<"u"&&!!process.version}var qt;function cj(){if(!qt)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return qt}function Hy(t){qt=t}function bw(){QA()&&Hy(qA()),YA()&&Hy(XA())}function hj(t){if(qt||bw(),!qt)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=e===void 0?qt.Canvas:e,r=t.Image,o=r===void 0?qt.Image:r;qt.Canvas=n,qt.Image=o,qt.createCanvasElement=t.createCanvasElement||function(){return new n},qt.createImageElement=t.createImageElement||function(){return new o},qt.ImageData=t.ImageData||qt.ImageData,qt.Video=t.Video||qt.Video,qt.fetch=t.fetch||qt.fetch,qt.readFile=t.readFile||qt.readFile}var Ln={getEnv:cj,setEnv:Hy,initialize:bw,createBrowserEnv:qA,createFileSystem:KA,createNodejsEnv:XA,monkeyPatch:hj,isBrowser:QA,isNodejs:YA};bw();function JA(t){return!Ln.isNodejs()&&typeof t=="string"?document.getElementById(t):t}function Za(t){var e=Ln.getEnv(),n=e.Canvas,r=e.CanvasRenderingContext2D;if(t instanceof r)return t;var o=JA(t);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var TE;(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"})(TE||(TE={}));function ZA(t){var e=Ln.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function fj(t){return new Promise(function(e,n){if(t instanceof Ln.getEnv().Canvas||ZA(t))return e();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}t.addEventListener("load",r),t.addEventListener("error",o)})}function ek(t){var e=Ln.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new su(t.naturalWidth,t.naturalHeight):t instanceof r?new su(t.videoWidth,t.videoHeight):new su(t.width,t.height)}function gm(t){var e=t.width,n=t.height,r=Ln.getEnv().createCanvasElement,o=r();return o.width=e,o.height=n,o}function Ew(t,e){var n=Ln.getEnv().ImageData;if(!(t instanceof n)&&!ZA(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=ek(t),o=r.width,i=r.height,a=gm({width:o,height:i});return t instanceof n?Za(a).putImageData(t,0,0):Za(a).drawImage(t,0,0,o,i),a}function dj(t,e){return ge(this,void 0,void 0,function(){var n,r,o,i,a,s;return ye(this,function(u){switch(u.label){case 0:return n=Ln.getEnv().createCanvasElement(),r=t.shape.slice(Yi(t)?1:0),o=r[0],i=r[1],a=r[2],s=le(function(){return t.as3D(o,i,a).toInt()}),[4,yw.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function RE(t){var e=Ln.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}function pj(t,e,n){n===void 0&&(n=!1);var r=Ln.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=ek(t),s=e/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=gm({width:e,height:e}),h=t instanceof i?t:Ew(t),f=Math.abs(u-l)/2,d=n&&u<l?f:0,m=n&&l<u?f:0;return Za(c).drawImage(h,d,m,u,l),c}var zd=function(){function t(e,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=n,this._batchSize=e.length,e.forEach(function(o,i){if(mm(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Yi(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Ln.getEnv().Canvas?o:Ew(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var e=this;return Tc(this.batchSize,0,1).map(function(n,r){return e.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},t.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},t.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},t.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},t.prototype.getReshapedInputDimensions=function(e){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(e),r=this.getInputHeight(e);return ej({width:n,height:r},this.inputSize)},t.prototype.toBatchTensor=function(e,n){var r=this;return n===void 0&&(n=!0),this._inputSize=e,le(function(){var o=Tc(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof _t){var u=Yi(s)?s:s.expandDims();return u=rj(u,n),(u.shape[1]!==e||u.shape[2]!==e)&&(u=fw.resizeBilinear(u,[e,e])),u.as3D(e,e,3)}if(s instanceof Ln.getEnv().Canvas)return yw.fromPixels(pj(s,e,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=xr(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,e,e,3);return i})},t}();function cn(t){return ge(this,void 0,void 0,function(){var e,n,r;return ye(this,function(o){switch(o.label){case 0:if(t instanceof zd)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(t)?" at input index "+i+":":""},r=e.map(JA),r.forEach(function(i,a){if(!RE(i)&&!mm(i)&&!Yi(i))throw typeof e[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+e[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Yi(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return RE(i)&&fj(i)}))];case 1:return o.sent(),[2,new zd(r,Array.isArray(t))]}})})}function Cw(t,e){return ge(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return ye(this,function(l){switch(l.label){case 0:return n=Ln.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,cn(t)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,dj(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=Za(r),u=e.map(function(c){return c instanceof zo?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var h=c.x,f=c.y,d=c.width,m=c.height,g=gm({width:d,height:m});return Za(g).putImageData(s.getImageData(h,f,d,m),0,0),g})]}})})}function Sw(t,e){return ge(this,void 0,void 0,function(){return ye(this,function(n){if(!mm(t)&&!Yi(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Yi(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,le(function(){var r=t.shape.slice(Yi(t)?1:0),o=r[0],i=r[1],a=r[2],s=e.map(function(l){return l instanceof zo?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,h=l.y,f=l.width,d=l.height;return TA(t.as3D(o,i,a),[h,c,0],[d,f,a])});return u})]})})}function mj(t,e){return ge(this,void 0,void 0,function(){var n,r;return ye(this,function(o){switch(o.label){case 0:return n=Ln.getEnv().fetch,[4,n(t,e)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function vj(t){return ge(this,void 0,void 0,function(){return ye(this,function(e){switch(e.label){case 0:return[4,mj(t)];case 1:return[2,e.sent().json()]}})})}function tk(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if(t==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(r,"");var o=t.split("/").filter(function(s){return s}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=t.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function gj(t,e){return ge(this,void 0,void 0,function(){var n,r,o,i;return ye(this,function(a){switch(a.label){case 0:return n=tk(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,vj(r)];case 1:return i=a.sent(),[2,jA.loadWeights(i,o)]}})})}var yi=function(){function t(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(e){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;return r[o]},t.prototype.reassignParamFromPath=function(e,n){var r=this.traversePropertyPath(e),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},t.prototype.getParamList=function(){var e=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:e.getParamFromPath(r)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(e){return e.tensor instanceof _u})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(e){return!(e.tensor instanceof _u)})},t.prototype.variable=function(){var e=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;e.reassignParamFromPath(r,o.variable())})},t.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=gn(o.dataSync());o.dispose(),e.reassignParamFromPath(r,i)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.getParamList().forEach(function(n){if(e&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(e){var n=e.tensor;return Array.from(n.dataSync())}).reduce(function(e,n){return e.concat(n)}))},t.prototype.load=function(e){return ge(this,void 0,void 0,function(){return ye(this,function(n){switch(n.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return n.sent(),[2]}})})},t.prototype.loadFromUri=function(e){return ge(this,void 0,void 0,function(){var n;return ye(this,function(r){switch(r.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,gj(e,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},t.prototype.loadFromDisk=function(e){return ge(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,h;return ye(this,function(f){switch(f.label){case 0:if(e&&typeof e!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Ln.getEnv().readFile,r=tk(e,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(d){return Promise.all(d.map(function(m){return n(m).then(function(g){return g.buffer})}))},s=jA.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,i)];case 2:return h=f.sent(),this.loadFromWeightMap(h),[2]}})})},t.prototype.loadFromWeightMap=function(e){var n=this.extractParamsFromWeigthMap(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.extractWeights=function(e){var n=this.extractParams(e),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},t.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=e.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+e);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof _t))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:r,objProp:o}},t}();function vr(t,e,n){return le(function(){var r=sw(t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=Oe(r,e.bias),r})}function rg(t,e,n){return n===void 0&&(n=!1),le(function(){var r=bt(n?Oe(jr(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):vr(t,e.conv0,[2,2])),o=vr(r,e.conv1,[1,1]),i=bt(Oe(r,o)),a=vr(i,e.conv2,[1,1]);return bt(Oe(r,Oe(o,a)))})}function uf(t,e,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),le(function(){var o=bt(n?Oe(jr(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):vr(t,e.conv0,r?[2,2]:[1,1])),i=vr(o,e.conv1,[1,1]),a=bt(Oe(o,i)),s=vr(a,e.conv2,[1,1]),u=bt(Oe(o,Oe(i,s))),l=vr(u,e.conv3,[1,1]);return bt(Oe(o,Oe(i,Oe(s,l))))})}function to(t,e,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),le(function(){var o=Oe(jr(t,e.filters,[1,1],n),e.bias);return r?bt(o):o})}function wi(t,e){Object.keys(t).forEach(function(n){e.some(function(r){return r.originalPath===n})||t[n].dispose()})}function ym(t,e){return function(n,r,o,i){var a=Xn(t(n*r*o*o),[o,o,n,r]),s=Wt(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function Iw(t,e){return function(n,r,o){var i=Xi(t(n*r),[n,r]),a=Wt(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var nk=function(){function t(e,n,r){this.depthwise_filter=e,this.pointwise_filter=n,this.bias=r}return t}();function Tw(t,e){return function(n,r,o){var i=Xn(t(9*n),[3,3,n,1]),a=Xn(t(n*r),[1,1,n,r]),s=Wt(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new nk(i,a,s)}}function Rw(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),o=t(e+"/bias",1);return new nk(n,r,o)}}function ya(t,e){return function(n,r,o){var i=t[n];if(!pm(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function xi(t){var e=t;function n(o){var i=e.slice(0,o);return e=e.slice(o),i}function r(){return e}return{extractWeights:n,getRemainingWeights:r}}function rk(t,e){var n=ym(t,e),r=Tw(t,e);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),h=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:h,conv2:f}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),h=c.conv0,f=c.conv1,d=c.conv2,m=r(s,s,u+"/conv3");return{conv0:h,conv1:f,conv2:d,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function yj(t){var e=[],n=xi(t),r=n.extractWeights,o=n.getRemainingWeights,i=rk(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function ok(t){return function(e){var n=t(e+"/filters",4),r=t(e+"/bias",1);return{filters:n,bias:r}}}function ik(t,e){var n=ya(t,e),r=ok(n),o=Rw(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),h=o(s+"/conv2");return{conv0:l,conv1:c,conv2:h}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),h=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:h,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function wj(t){var e=[],n=ik(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return wi(t,e),{params:r,paramMappings:e}}var ak=function(t){Re(e,t);function e(){return t.call(this,"FaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return le(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=sh(o,i).div(ae(255)),s=uf(a,r.dense0,!0);return s=uf(s,r.dense1),s=uf(s,r.dense2),s=uf(s,r.dense3),s=ih(s,[7,7],[2,2],"valid"),s})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(n){return wj(n)},e.prototype.extractParams=function(n){return yj(n)},e}(yi);function Eo(t,e){return le(function(){return Oe(hm(t,e.weights),e.bias)})}function xj(t,e,n){var r=[],o=xi(t),i=o.extractWeights,a=o.getRemainingWeights,s=Iw(i,r),u=s(e,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function _j(t){var e=[],n=ya(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return wi(t,e),{params:o,paramMappings:e}}function sk(t){var e={},n={};return Object.keys(t).forEach(function(r){var o=r.startsWith("fc")?n:e;o[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var uk=function(t){Re(e,t);function e(n,r){var o=t.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=n instanceof zd?r.faceFeatureExtractor.forwardInput(n):n;return Eo(i.as2D(i.shape[0],-1),o.fc)})},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return xj(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(n){var r=sk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),_j(i)},e.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},e}(yi),AE=["neutral","happy","sad","angry","fearful","disgusted","surprised"],bj=function(){function t(e){var n=this;if(e.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);AE.forEach(function(r,o){n[r]=e[o]})}return t.prototype.asSortedArray=function(){var e=this;return AE.map(function(n){return{expression:n,probability:e[n]}}).sort(function(n,r){return r.probability-n.probability})},t}(),Ej=function(t){Re(e,t);function e(n){return n===void 0&&(n=new ak),t.call(this,"FaceExpressionNet",n)||this}return e.prototype.forwardInput=function(n){var r=this;return le(function(){return vi(r.runNet(n))})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictExpressions=function(n){return ge(this,void 0,void 0,function(){var r,o,i,a,s=this;return ye(this,function(u){switch(u.label){case 0:return[4,cn(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Yt(o).map(function(l){return ge(s,void 0,void 0,function(){var c;return ye(this,function(h){switch(h.label){case 0:return[4,l.data()];case 1:return c=h.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new bj(l)}),[2,r.isBatchInput?a:a[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(uk);function lk(t,e){var n={expressions:e};return Object.assign({},t,n)}function Cj(t){return lj(t)&&t.landmarks instanceof Ud&&t.unshiftedLandmarks instanceof Ud&&t.alignedRect instanceof zo}function Aw(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new zo(t.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:e,alignedRect:a};return Object.assign({},t,s)}function Sj(t,e){var n=ym(t,e),r=Tw(t,e);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),h=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:h}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function Ij(t,e){var n=[],r=xi(t),o=r.extractWeights,i=r.getRemainingWeights,a=Sj(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,h=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),d=l(64,128,"entry_flow/reduction_block_1"),m={conv_in:h,reduction_block_0:f,reduction_block_1:d},g={};Tc(e,0,1).forEach(function(x){g["main_block_"+x]=c(128,"middle_flow/main_block_"+x)});var y=l(128,256,"exit_flow/reduction_block"),v=u(256,512,"exit_flow/separable_conv"),w={reduction_block:y,separable_conv:v};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:m,middle_flow:g,exit_flow:w}}}function Tj(t,e){var n=ya(t,e),r=ok(n),o=Rw(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function Rj(t,e){var n=[],r=Tj(t,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),h={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};Tc(e,0,1).forEach(function(y){f["main_block_"+y]=s("middle_flow/main_block_"+y)});var d=a("exit_flow/reduction_block"),m=i("exit_flow/separable_conv"),g={reduction_block:d,separable_conv:m};return wi(t,n),{params:{entry_flow:h,middle_flow:f,exit_flow:g},paramMappings:n}}function ck(t,e,n){return Oe(jr(t,e.filters,n,"same"),e.bias)}function og(t,e,n){n===void 0&&(n=!0);var r=n?bt(t):t;return r=vr(r,e.separable_conv0,[1,1]),r=vr(bt(r),e.separable_conv1,[1,1]),r=on(r,[3,3],[2,2],"same"),r=Oe(r,ck(t,e.expansion_conv,[2,2])),r}function Aj(t,e){var n=vr(bt(t),e.separable_conv0,[1,1]);return n=vr(bt(n),e.separable_conv1,[1,1]),n=vr(bt(n),e.separable_conv2,[1,1]),n=Oe(n,t),n}var kj=function(t){Re(e,t);function e(n){var r=t.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return e.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return le(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=sh(i,a).div(ae(256)),u=bt(ck(s,o.entry_flow.conv_in,[2,2]));return u=og(u,o.entry_flow.reduction_block_0,!1),u=og(u,o.entry_flow.reduction_block_1),Tc(r._numMainBlocks,0,1).forEach(function(l){u=Aj(u,o.middle_flow["main_block_"+l])}),u=og(u,o.exit_flow.reduction_block),u=bt(vr(u,o.exit_flow.separable_conv,[1,1])),u})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Rj(n,this._numMainBlocks)},e.prototype.extractParams=function(n){return Ij(n,this._numMainBlocks)},e}(yi);function Pj(t){var e=[],n=xi(t),r=n.extractWeights,o=n.getRemainingWeights,i=Iw(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}function Dj(t){var e=[],n=ya(t,e);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return wi(t,e),{params:o,paramMappings:e}}var Wd;(function(t){t.FEMALE="female",t.MALE="male"})(Wd||(Wd={}));var Nj=function(t){Re(e,t);function e(n){n===void 0&&(n=new kj(2));var r=t.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return le(function(){var i=n instanceof zd?r.faceFeatureExtractor.forwardInput(n):n,a=ih(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Eo(a,o.fc.age).as1D(),u=Eo(a,o.fc.gender);return{age:s,gender:u}})},e.prototype.forwardInput=function(n){var r=this;return le(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:vi(a)}})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.predictAgeAndGender=function(n){return ge(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return ye(this,function(c){switch(c.label){case 0:return[4,cn(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=Yt(o.age),a=Yt(o.gender),s=i.map(function(h,f){return{ageTensor:h,genderTensor:a[f]}}),[4,Promise.all(s.map(function(h){var f=h.ageTensor,d=h.genderTensor;return ge(l,void 0,void 0,function(){var m,g,y,v,w;return ye(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return m=x.sent()[0],[4,d.data()];case 2:return g=x.sent()[0],y=g>.5,v=y?Wd.MALE:Wd.FEMALE,w=y?g:1-g,f.dispose(),d.dispose(),[2,{age:m,gender:v,genderProbability:w}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),t.prototype.dispose.call(this,n)},e.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},e.prototype.extractClassifierParams=function(n){return Pj(n)},e.prototype.extractParamsFromWeigthMap=function(n){var r=sk(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),Dj(i)},e.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(yi),hk=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return le(function(){var s=function(f,d){return xr([Ao([68],f),Ao([68],d)],1).as2D(1,136).as1D()},u=function(f,d){var m=i[f],g=m.width,y=m.height;return d(g,y)?Math.abs(g-y)/2:0},l=function(f){return u(f,function(d,m){return d<m})},c=function(f){return u(f,function(d,m){return m<d})},h=n.mul(Ao([a,136],r)).sub(xr(Array.from(Array(a),function(f,d){return s(l(d),c(d))}))).div(xr(Array.from(Array(a),function(f,d){return s(i[d].width,i[d].height)})));return h})},e.prototype.forwardInput=function(n){var r=this;return le(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.detectLandmarks=function(n){return ge(this,void 0,void 0,function(){var r,o,i,a=this;return ye(this,function(s){switch(s.label){case 0:return[4,cn(n)];case 1:return r=s.sent(),o=le(function(){return Yt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return ge(a,void 0,void 0,function(){var c,h,f,d,m;return ye(this,function(g){switch(g.label){case 0:return f=(h=Array).from,[4,u.data()];case 1:return c=f.apply(h,[g.sent()]),d=c.filter(function(y,v){return bE(v)}),m=c.filter(function(y,v){return!bE(v)}),[2,new uj(Array(68).fill(0).map(function(y,v){return new Xe(d[v],m[v])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(uk),fk=function(t){Re(e,t);function e(n){return n===void 0&&(n=new ak),t.call(this,"FaceLandmark68Net",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(hk);function Mj(t){var e=[],n=ik(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return wi(t,e),{params:r,paramMappings:e}}function Oj(t){var e=[],n=xi(t),r=n.extractWeights,o=n.getRemainingWeights,i=rk(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}var Fj=function(t){Re(e,t);function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return le(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=sh(o,i).div(ae(255)),s=rg(a,r.dense0,!0);return s=rg(s,r.dense1),s=rg(s,r.dense2),s=ih(s,[14,14],[2,2],"valid"),s})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Mj(n)},e.prototype.extractParams=function(n){return Oj(n)},e}(yi),Lj=function(t){Re(e,t);function e(n){return n===void 0&&(n=new Fj),t.call(this,"FaceLandmark68TinyNet",n)||this}return e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(hk);(function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(fk);function Vj(t,e){return Oe(On(t,e.weights),e.biases)}function kw(t,e,n,r,o){o===void 0&&(o="same");var i=e.conv,a=i.filters,s=i.bias,u=jr(t,a,n,o);return u=Oe(u,s),u=Vj(u,e.scale),r?bt(u):u}function Bj(t,e){return kw(t,e,[1,1],!0)}function dk(t,e){return kw(t,e,[1,1],!1)}function pk(t,e){return kw(t,e,[2,2],!0,"valid")}function $j(t,e){function n(s,u,l){var c=t(s),h=c.length/(u*l*l);if(J9(h))throw new Error("depth has to be an integer: "+h+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return le(function(){return oa(Xn(c,[u,h,l,l]),[2,3,1,0])})}function r(s,u,l,c){var h=n(s,u,l),f=Wt(t(u));return e.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:h,bias:f}}function o(s,u){var l=Wt(t(s)),c=Wt(t(s));return e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var h=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:h,scale:f}}function a(s,u,l,c,h){h===void 0&&(h=!1);var f=i((h?.5:1)*s,u,l,c+"/conv1"),d=i(s,u,l,c+"/conv2");return{conv1:f,conv2:d}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function Uj(t){var e=xi(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=$j(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),m=s(36864,64,3,"conv64_2"),g=s(36864,64,3,"conv64_3"),y=s(147456,128,3,"conv128_down",!0),v=s(147456,128,3,"conv128_1"),w=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),_=s(589824,256,3,"conv256_1"),S=s(589824,256,3,"conv256_2"),R=s(589824,256,3,"conv256_down_out"),C=le(function(){return oa(Xi(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var E={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:h,conv64_down:f,conv64_1:d,conv64_2:m,conv64_3:g,conv128_down:y,conv128_1:v,conv128_2:w,conv256_down:x,conv256_1:_,conv256_2:S,conv256_down_out:R,fc:C};return{params:E,paramMappings:o}}function zj(t,e){var n=ya(t,e);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function Wj(t){var e=[],n=zj(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),h=o("conv64_2"),f=o("conv64_3"),d=o("conv128_down"),m=o("conv128_1"),g=o("conv128_2"),y=o("conv256_down"),v=o("conv256_1"),w=o("conv256_2"),x=o("conv256_down_out"),_=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!Y9(_))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+_);var S={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:h,conv64_3:f,conv128_down:d,conv128_1:m,conv128_2:g,conv256_down:y,conv256_1:v,conv256_2:w,conv256_down_out:x,fc:_};return wi(t,e),{params:S,paramMappings:e}}function fo(t,e){var n=Bj(t,e.conv1);return n=dk(n,e.conv2),n=Oe(n,t),n=bt(n),n}function lf(t,e){var n=pk(t,e.conv1);n=dk(n,e.conv2);var r=ih(t,2,2,"valid"),o=dt(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Gl(n.shape);s[1]=1;var u=dt(s);n=Qt([n,u],1);var l=Gl(n.shape);l[2]=1;var c=dt(l);n=Qt([n,c],2)}return r=i?Qt([r,o],3):r,n=Oe(r,n),n=bt(n),n}var jj=function(t){Re(e,t);function e(){return t.call(this,"FaceRecognitionNet")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return le(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=sh(o,i).div(ae(256)),s=pk(a,r.conv32_down);s=on(s,3,2,"valid"),s=fo(s,r.conv32_1),s=fo(s,r.conv32_2),s=fo(s,r.conv32_3),s=lf(s,r.conv64_down),s=fo(s,r.conv64_1),s=fo(s,r.conv64_2),s=fo(s,r.conv64_3),s=lf(s,r.conv128_down),s=fo(s,r.conv128_1),s=fo(s,r.conv128_2),s=lf(s,r.conv256_down),s=fo(s,r.conv256_1),s=fo(s,r.conv256_2),s=lf(s,r.conv256_down_out);var u=s.mean([1,2]),l=hm(u,r.fc);return l})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.computeFaceDescriptor=function(n){return ge(this,void 0,void 0,function(){var r,o,i,a=this;return ye(this,function(s){switch(s.label){case 0:return[4,cn(n)];case 1:return r=s.sent(),o=le(function(){return Yt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Wj(n)},e.prototype.extractParams=function(n){return Uj(n)},e}(yi);function mk(t,e){var n={descriptor:e};return Object.assign({},t,n)}function vk(t,e){var n={age:e};return Object.assign({},t,n)}function gk(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var yk=function(){function t(e){var n=e===void 0?{}:e,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function Hj(t,e){function n(u,l){var c=Xn(t(9*u),[3,3,u,1]),h=Wt(t(u)),f=Wt(t(u)),d=Wt(t(u)),m=Wt(t(u));return e.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:h,batch_norm_offset:f,batch_norm_mean:d,batch_norm_variance:m}}function r(u,l,c,h,f){var d=Xn(t(u*l*c*c),[c,c,u,l]),m=Wt(t(l));return e.push({paramPath:h+"/filters"},{paramPath:h+"/"+(f?"batch_norm_offset":"bias")}),{filters:d,bias:m}}function o(u,l,c,h){var f=r(u,l,c,h,!0),d=f.filters,m=f.bias;return{filters:d,batch_norm_offset:m}}function i(u,l,c){var h=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:h,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),h=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),d=i(256,256,"mobilenetv1/conv_5"),m=i(256,512,"mobilenetv1/conv_6"),g=i(512,512,"mobilenetv1/conv_7"),y=i(512,512,"mobilenetv1/conv_8"),v=i(512,512,"mobilenetv1/conv_9"),w=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),_=i(512,1024,"mobilenetv1/conv_12"),S=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:h,conv_4:f,conv_5:d,conv_6:m,conv_7:g,conv_8:y,conv_9:v,conv_10:w,conv_11:x,conv_12:_,conv_13:S}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),h=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),d=o(128,256,3,"prediction_layer/conv_5"),m=o(256,64,1,"prediction_layer/conv_6"),g=o(64,128,3,"prediction_layer/conv_7"),y=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),v=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),w=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),_=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),S=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),R=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),E=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),I=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),T=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),k=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),P={box_encoding_predictor:y,class_predictor:v},D={box_encoding_predictor:w,class_predictor:x},$={box_encoding_predictor:_,class_predictor:S},U={box_encoding_predictor:R,class_predictor:C},K={box_encoding_predictor:E,class_predictor:I},X={box_encoding_predictor:T,class_predictor:k};return{conv_0:u,conv_1:l,conv_2:c,conv_3:h,conv_4:f,conv_5:d,conv_6:m,conv_7:g,box_predictor_0:P,box_predictor_1:D,box_predictor_2:$,box_predictor_3:U,box_predictor_4:K,box_predictor_5:X}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function Gj(t){var e=[],n=xi(t),r=n.extractWeights,o=n.getRemainingWeights,i=Hj(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=G1(r(5118*4),[1,5118,4]),h={extra_dim:c};if(e.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:h},paramMappings:e}}function qj(t,e){var n=ya(t,e);function r(l,c,h){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,h+"/filters"),d=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,h+"/batch_norm_offset");return{filters:f,batch_norm_offset:d}}function o(l){var c="mobilenetv1/conv_"+l,h="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",d=c+"/pointwise_conv",m=n(h+"/depthwise_weights",4,f+"/filters"),g=n(h+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),y=n(h+"/BatchNorm/beta",1,f+"/batch_norm_offset"),v=n(h+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),w=n(h+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:m,batch_norm_scale:g,batch_norm_offset:y,batch_norm_mean:v,batch_norm_variance:w},pointwise_conv:r("MobilenetV1",l,d)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var h=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:h,bias:f}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),h=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:h}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function Kj(t){var e=[],n=qj(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!mm(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return wi(t,e),{params:a,paramMappings:e}}function mo(t,e,n){return le(function(){var r=jr(t,e.filters,n,"same");return r=Oe(r,e.batch_norm_offset),rw(r,0,6)})}var Xj=.0010000000474974513;function Qj(t,e,n){return le(function(){var r=cm(t,e.filters,n,"same");return r=fA(r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,Xj),rw(r,0,6)})}function Yj(t){return[2,4,6,12].some(function(e){return e===t})?[2,2]:[1,1]}function Jj(t,e){return le(function(){var n=null,r=mo(t,e.conv_0,[2,2]),o=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(o.forEach(function(i,a){var s=a+1,u=Yj(s);r=Qj(r,i.depthwise_conv,u),r=mo(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function Zj(t,e,n,r,o){var i=t.shape[0],a=Math.min(n,i),s=e.map(function(c,h){return{score:c,boxIndex:h}}).filter(function(c){return c.score>o}).sort(function(c,h){return h.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var h=c.score,f=l.length-1;f>=0;--f){var d=e8(t,c.boxIndex,l[f]);if(d!==0&&(c.score*=u(d),c.score<=o))break}h===c.score&&l.push(c.boxIndex)}}),l}function e8(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),d=(c-u)*(h-l);if(f<=0||d<=0)return 0;var m=Math.max(o,u),g=Math.max(i,l),y=Math.min(a,c),v=Math.min(s,h),w=Math.max(y-m,0)*Math.max(v-g,0);return w/(f+d-w)}function t8(t){var e=Yt(oa(t,[1,0])),n=[en(e[2],e[0]),en(e[3],e[1])],r=[Oe(e[0],Qr(n[0],ae(2))),Oe(e[1],Qr(n[1],ae(2)))];return{sizes:n,centers:r}}function n8(t,e){var n=t8(t),r=n.sizes,o=n.centers,i=Yt(oa(e,[1,0])),a=Qr(On(Vy(Qr(i[2],ae(5))),r[0]),ae(2)),s=Oe(On(Qr(i[0],ae(10)),r[0]),o[0]),u=Qr(On(Vy(Qr(i[3],ae(5))),r[1]),ae(2)),l=Oe(On(Qr(i[1],ae(10)),r[1]),o[1]);return oa(xr([en(s,a),en(l,u),Oe(s,a),Oe(l,u)]),[1,0])}function r8(t,e,n){return le(function(){var r=t.shape[0],o=n8(Yr(nu(n.extra_dim,[r,1,1]),[-1,4]),Yr(t,[-1,4]));o=Yr(o,[r,o.shape[0]/r,4]);var i=uA(Mo(e,[0,0,1],[-1,-1,-1])),a=Mo(i,[0,0,0],[-1,-1,1]);a=Yr(a,[r,a.shape[1]]);var s=Yt(o),u=Yt(a);return{boxes:s,scores:u}})}function Ss(t,e){return le(function(){var n=t.shape[0],r=Yr(to(t,e.box_encoding_predictor),[n,-1,1,4]),o=Yr(to(t,e.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function o8(t,e,n){return le(function(){var r=mo(t,n.conv_0,[1,1]),o=mo(r,n.conv_1,[2,2]),i=mo(o,n.conv_2,[1,1]),a=mo(i,n.conv_3,[2,2]),s=mo(a,n.conv_4,[1,1]),u=mo(s,n.conv_5,[2,2]),l=mo(u,n.conv_6,[1,1]),c=mo(l,n.conv_7,[2,2]),h=Ss(e,n.box_predictor_0),f=Ss(t,n.box_predictor_1),d=Ss(o,n.box_predictor_2),m=Ss(a,n.box_predictor_3),g=Ss(u,n.box_predictor_4),y=Ss(c,n.box_predictor_5),v=Qt([h.boxPredictionEncoding,f.boxPredictionEncoding,d.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding,y.boxPredictionEncoding],1),w=Qt([h.classPrediction,f.classPrediction,d.classPrediction,m.classPrediction,g.classPrediction,y.classPrediction],1);return{boxPredictions:v,classPredictions:w}})}var Pw=function(){function t(e){var n=e===void 0?{}:e,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),wk=function(t){Re(e,t);function e(){return t.call(this,"SsdMobilenetv1")||this}return e.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return le(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=en(On(o,ae(.007843137718737125)),ae(1)),a=Jj(i,r.mobilenetv1),s=o8(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return r8(u,l,r.output_layer)})},e.prototype.forward=function(n){return ge(this,void 0,void 0,function(){var r;return ye(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,cn(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},e.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var o,i,a,s,u,l,c,h,f,d,m,g,y,v,w,x,_,S,R,C,E;return ye(this,function(I){switch(I.label){case 0:return o=new Pw(r),i=o.maxResults,a=o.minConfidence,[4,cn(n)];case 1:for(s=I.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,h=l[0],f=c[0],d=1;d<l.length;d++)l[d].dispose(),c[d].dispose();return y=(g=Array).from,[4,f.data()];case 2:return m=y.apply(g,[I.sent()]),v=.5,w=Zj(h,m,i,v,a),x=s.getReshapedInputDimensions(0),_=s.inputSize,S=_/x.width,R=_/x.height,C=h.arraySync(),E=w.map(function(T){var k=[Math.max(0,C[T][0]),Math.min(1,C[T][2])].map(function(X){return X*R}),P=k[0],D=k[1],$=[Math.max(0,C[T][1]),Math.min(1,C[T][3])].map(function(X){return X*S}),U=$[0],K=$[1];return new zo(m[T],new xw(U,P,K-U,D-P),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),h.dispose(),f.dispose(),[2,E]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(n){return Kj(n)},e.prototype.extractParams=function(n){return Gj(n)},e}(yi);(function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(wk);var i8=.4,a8=[new Xe(.738768,.874946),new Xe(2.42204,2.65704),new Xe(4.30971,7.04493),new Xe(10.246,4.59428),new Xe(12.6868,11.8741)],s8=[new Xe(1.603231,2.094468),new Xe(6.041143,7.080126),new Xe(2.882459,3.518061),new Xe(4.266906,5.178857),new Xe(9.041765,10.66308)],u8=[117.001,114.697,97.404],l8="tiny_yolov2_model",c8="tiny_yolov2_separable_conv_model",cf=function(t){return typeof t=="number"};function h8(t){if(!t)throw new Error("invalid config: "+t);if(typeof t.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!cf(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(e){return typeof e=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(e){return e||{}}).every(function(e){return cf(e.x)&&cf(e.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||t.meanRgb.length!==3||!t.meanRgb.every(cf)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function Dw(t){return le(function(){var e=On(t,ae(.10000000149011612));return Oe(bt(en(t,e)),e)})}function ki(t,e){return le(function(){var n=is(t,[[0,0],[1,1],[1,1],[0,0]]);return n=jr(n,e.conv.filters,[1,1],"valid"),n=en(n,e.bn.sub),n=On(n,e.bn.truediv),n=Oe(n,e.conv.bias),Dw(n)})}function Pi(t,e){return le(function(){var n=is(t,[[0,0],[1,1],[1,1],[0,0]]);return n=sw(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),n=Oe(n,e.bias),Dw(n)})}function f8(t,e){var n=ym(t,e);function r(a,s){var u=Wt(t(a)),l=Wt(t(a));return e.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=Tw(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function d8(t,e,n,r){var o=xi(t),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=f8(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,h=u.extractSeparableConvParams,f;if(e.withSeparableConvs){var d=r[0],m=r[1],g=r[2],y=r[3],v=r[4],w=r[5],x=r[6],_=r[7],S=r[8],R=e.isFirstLayerConv2d?l(d,m,3,"conv0"):h(d,m,"conv0"),C=h(m,g,"conv1"),E=h(g,y,"conv2"),I=h(y,v,"conv3"),T=h(v,w,"conv4"),k=h(w,x,"conv5"),P=_?h(x,_,"conv6"):void 0,D=S?h(_,S,"conv7"):void 0,$=l(S||_||x,5*n,1,"conv8");f={conv0:R,conv1:C,conv2:E,conv3:I,conv4:T,conv5:k,conv6:P,conv7:D,conv8:$}}else{var d=r[0],m=r[1],g=r[2],y=r[3],v=r[4],w=r[5],x=r[6],_=r[7],S=r[8],R=c(d,m,"conv0"),C=c(m,g,"conv1"),E=c(g,y,"conv2"),I=c(y,v,"conv3"),T=c(v,w,"conv4"),k=c(w,x,"conv5"),P=c(x,_,"conv6"),D=c(_,S,"conv7"),$=l(S,5*n,1,"conv8");f={conv0:R,conv1:C,conv2:E,conv3:I,conv4:T,conv5:k,conv6:P,conv7:D,conv8:$}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function p8(t,e){var n=ya(t,e);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=Rw(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function m8(t,e){var n=[],r=p8(t,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;s={conv0:e.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return wi(t,n),{params:s,paramMappings:n}}var kE;(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"})(kE||(kE={}));var Nw=function(){function t(e){var n=e===void 0?{}:e,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),xk=function(t){Re(e,t);function e(n){var r=t.call(this,"TinyYolov2")||this;return h8(n),r._config=n,r}return Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(n,r){var o=ki(n,r.conv0);return o=on(o,[2,2],[2,2],"same"),o=ki(o,r.conv1),o=on(o,[2,2],[2,2],"same"),o=ki(o,r.conv2),o=on(o,[2,2],[2,2],"same"),o=ki(o,r.conv3),o=on(o,[2,2],[2,2],"same"),o=ki(o,r.conv4),o=on(o,[2,2],[2,2],"same"),o=ki(o,r.conv5),o=on(o,[2,2],[1,1],"same"),o=ki(o,r.conv6),o=ki(o,r.conv7),to(o,r.conv8,"valid",!1)},e.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?Dw(to(n,r.conv0,"valid",!1)):Pi(n,r.conv0);return o=on(o,[2,2],[2,2],"same"),o=Pi(o,r.conv1),o=on(o,[2,2],[2,2],"same"),o=Pi(o,r.conv2),o=on(o,[2,2],[2,2],"same"),o=Pi(o,r.conv3),o=on(o,[2,2],[2,2],"same"),o=Pi(o,r.conv4),o=on(o,[2,2],[2,2],"same"),o=Pi(o,r.conv5),o=on(o,[2,2],[1,1],"same"),o=r.conv6?Pi(o,r.conv6):o,o=r.conv7?Pi(o,r.conv7):o,to(o,r.conv8,"valid",!1)},e.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return le(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?sh(a,o.config.meanRgb):a,a=a.div(ae(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},e.prototype.forward=function(n,r){return ge(this,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,cn(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},e.prototype.detect=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var o,i,a,s,u,l,c,h,f,d,m,g,y,v,w=this;return ye(this,function(x){switch(x.label){case 0:return o=new Nw(r),i=o.inputSize,a=o.scoreThreshold,[4,cn(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),l=le(function(){return Yt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return h=x.sent(),u.dispose(),l.dispose(),f=h.map(function(_){return _.box}),d=h.map(function(_){return _.score}),m=h.map(function(_){return _.classScore}),g=h.map(function(_){return w.config.classes[_.label]}),y=Rc(f.map(function(_){return _.rescale(i)}),d,this.config.iouThreshold,!0),v=y.map(function(_){return new GA(d[_],m[_],g[_],f[_],c)}),[2,v]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(n){return m8(n,this.config)},e.prototype.extractParams=function(n){var r=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return d8(n,this.config,this.boxEncodingSize,r)},e.prototype.extractBoxes=function(n,r,o){return ge(this,void 0,void 0,function(){var i,a,s,u,l,c,h,f,d,m,g,y,v,w,x,_,S,R,C,E,I,T,k,P,D,$,U,K,X,V=this;return ye(this,function(W){switch(W.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],h=this.config.anchors.length,f=le(function(){var H=n.reshape([c,c,h,V.boxEncodingSize]),ne=H.slice([0,0,0,0],[c,c,h,4]),oe=H.slice([0,0,0,4],[c,c,h,1]),de=V.withClassScores?vi(H.slice([0,0,0,5],[c,c,h,V.config.classes.length]),3):ae(0);return[ne,oe,de]}),d=f[0],m=f[1],g=f[2],y=[],[4,m.array()];case 1:return v=W.sent(),[4,d.array()];case 2:w=W.sent(),x=0,W.label=3;case 3:if(!(x<c))return[3,12];_=0,W.label=4;case 4:if(!(_<c))return[3,11];S=0,W.label=5;case 5:return S<h?(R=ng(v[x][_][S][0]),!o||R>o?(C=(_+ng(w[x][_][S][0]))/c*u,E=(x+ng(w[x][_][S][1]))/c*l,I=Math.exp(w[x][_][S][2])*this.config.anchors[S].x/c*u,T=Math.exp(w[x][_][S][3])*this.config.anchors[S].y/c*l,k=C-I/2,P=E-T/2,D={row:x,col:_,anchor:S},this.withClassScores?[4,this.extractPredictedClass(g,D)]:[3,7]):[3,9]):[3,10];case 6:return X=W.sent(),[3,8];case 7:X={classScore:1,label:0},W.label=8;case 8:$=X,U=$.classScore,K=$.label,y.push(Pn({box:new vm(k,P,k+I,P+T),score:R,classScore:R*U,label:K},D)),W.label=9;case 9:return S++,[3,5];case 10:return _++,[3,4];case 11:return x++,[3,3];case 12:return d.dispose(),m.dispose(),g.dispose(),[2,y]}})})},e.prototype.extractPredictedClass=function(n,r){return ge(this,void 0,void 0,function(){var o,i,a,s;return ye(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(yi),v8=function(t){Re(e,t);function e(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:i8,classes:["face"]},n?{anchors:s8,meanRgb:u8}:{anchors:a8,withClassScores:!0});return r=t.call(this,o)||this,r}return Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return ge(this,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new zo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?c8:l8},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(xk),g8=function(t){Re(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return e}(Nw),uh=function(){function t(){}return t.prototype.then=function(e){return ge(this,void 0,void 0,function(){var n;return ye(this,function(r){switch(r.label){case 0:return n=e,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},t.prototype.run=function(){return ge(this,void 0,void 0,function(){return ye(this,function(e){throw new Error("ComposableTask - run is not implemented")})})},t}();function wm(t,e,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),ge(this,void 0,void 0,function(){var i,a,s,u,l;return ye(this,function(c){switch(c.label){case 0:return i=t.map(function(h){return Cj(h)?o(h):h.detection}),s=r,s?[3,5]:e instanceof _t?[4,Sw(e,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,Cw(e,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(h){return h instanceof _t&&h.dispose()}),[2,l]}})})}function Mw(t,e,n,r,o){return ge(this,void 0,void 0,function(){var i=this;return ye(this,function(a){return[2,wm([t],e,function(s){return ge(i,void 0,void 0,function(){return ye(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function y8(t){return le(function(){return xr(Yt(t,3).reverse(),3)})}var hf=2,jd=12;function w8(t,e){var n=ym(t,e),r=Iw(t,e);function o(l,c){var h=Wt(t(l));return e.push({paramPath:c}),h}function i(l,c,h){h===void 0&&(h=!1);var f=n(l[0],l[1],3,c+"/conv1"),d=o(l[1],c+"/prelu1_alpha"),m=n(l[1],l[2],3,c+"/conv2"),g=o(l[2],c+"/prelu2_alpha"),y=n(l[2],l[3],h?2:3,c+"/conv3"),v=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:d,conv2:m,prelu2_alpha:g,conv3:y,prelu3_alpha:v}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),h=n(32,4,1,"pnet/conv4_2");return Pn(Pn({},l),{conv4_1:c,conv4_2:h})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),h=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),d=r(128,4,"rnet/fc2_2");return Pn(Pn({},l),{fc1:c,prelu4_alpha:h,fc2_1:f,fc2_2:d})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),h=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),d=o(256,"onet/prelu5_alpha"),m=r(256,2,"onet/fc2_1"),g=r(256,4,"onet/fc2_2"),y=r(256,10,"onet/fc2_3");return Pn(Pn({},l),{conv4:c,prelu4_alpha:h,fc1:f,prelu5_alpha:d,fc2_1:m,fc2_2:g,fc2_3:y})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function x8(t){var e=xi(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=w8(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),h=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:h},paramMappings:o}}function _8(t,e){var n=ya(t,e);function r(c){var h=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:h,bias:f}}function o(c){var h=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:h,bias:f}}function i(c){return n(c,1)}function a(c){var h=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),d=r(c+"/conv2"),m=i(c+"/prelu2_alpha"),g=r(c+"/conv3"),y=i(c+"/prelu3_alpha");return{conv1:h,prelu1_alpha:f,conv2:d,prelu2_alpha:m,conv3:g,prelu3_alpha:y}}function s(){var c=a("pnet"),h=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Pn(Pn({},c),{conv4_1:h,conv4_2:f})}function u(){var c=a("rnet"),h=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),d=o("rnet/fc2_1"),m=o("rnet/fc2_2");return Pn(Pn({},c),{fc1:h,prelu4_alpha:f,fc2_1:d,fc2_2:m})}function l(){var c=a("onet"),h=r("onet/conv4"),f=i("onet/prelu4_alpha"),d=o("onet/fc1"),m=i("onet/prelu5_alpha"),g=o("onet/fc2_1"),y=o("onet/fc2_2"),v=o("onet/fc2_3");return Pn(Pn({},c),{conv4:h,prelu4_alpha:f,fc1:d,prelu5_alpha:m,fc2_1:g,fc2_2:y,fc2_3:v})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function b8(t){var e=[],n=_8(t,e),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return wi(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}function Gy(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}function E8(t,e,n){for(var r=n[0],o=n[1],i=jd/t,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(e,u)),s=s*e,u+=1;return a}var Ow=function(t){Re(e,t);function e(n,r,o,i){return t.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return e}(ia);function _k(t){return le(function(){return On(en(t,ae(127.5)),ae(.0078125))})}function uu(t,e){return le(function(){return Oe(bt(t),On(e,Ld(bt(Ld(t)))))})}function Fw(t,e,n){return n===void 0&&(n=!1),le(function(){var r=to(t,e.conv1,"valid");return r=uu(r,e.prelu1_alpha),r=on(r,n?[2,2]:[3,3],[2,2],"same"),r=to(r,e.conv2,"valid"),r=uu(r,e.prelu2_alpha),r=n?r:on(r,[3,3],[2,2],"valid"),r=to(r,e.conv3,"valid"),r=uu(r,e.prelu3_alpha),r})}function C8(t,e){return le(function(){var n=Fw(t,e,!0),r=to(n,e.conv4_1,"valid"),o=Dr(fm(r,3),3),i=vi(en(r,o),3),a=to(n,e.conv4_2,"valid");return{prob:i,regions:a}})}function S8(t,e){return le(function(){var n=Gy(e,t.shape.slice(1)),r=n.height,o=n.width,i=fw.resizeBilinear(t,[r,o]),a=_k(i);return oa(a,[0,2,1,3])})}function I8(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new Xe(s,a));var u=o.map(function(l){var c=new vm(Math.round((l.y*hf+1)/n),Math.round((l.x*hf+1)/n),Math.round((l.y*hf+jd)/n),Math.round((l.x*hf+jd)/n)),h=i[l.y][l.x],f=e.arraySync(),d=new Ow(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:h,region:d}});return u}function T8(t,e,n,r,o){o.stage1=[];var i=e.map(function(f){return le(function(){var d={scale:f},m=S8(t,f),g=Date.now(),y=C8(m,r),v=y.prob,w=y.regions;d.pnet=Date.now()-g;var x=Yt(Yt(v,3)[1])[0],_=Yt(w)[0];return{scoresTensor:x,regionsTensor:_,scale:f,statsForScale:d}})}),a=i.map(function(f){var d=f.scoresTensor,m=f.regionsTensor,g=f.scale,y=f.statsForScale,v=I8(d,m,g,n);if(d.dispose(),m.dispose(),!v.length)return o.stage1.push(y),[];var w=Date.now(),x=Rc(v.map(function(_){return _.cell}),v.map(function(_){return _.score}),.5);return y.nms=Date.now()-w,y.numBoxes=x.length,o.stage1.push(y),x.map(function(_){return v[_]})}),s=a.reduce(function(f,d){return f.concat(d)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),h=Rc(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=h.map(function(f){return s[f].score}),u=h.map(function(f){return s[f]}).map(function(f){var d=f.cell,m=f.region;return new vm(d.left+m.left*d.width,d.top+m.top*d.height,d.right+m.right*d.width,d.bottom+m.bottom*d.height).toSquare().round()})}return{boxes:u,scores:l}}function bk(t,e,n){var r=n.width,o=n.height;return ge(this,void 0,void 0,function(){var i,a,s,u=this;return ye(this,function(l){switch(l.label){case 0:return i=Za(t),[4,Promise.all(e.map(function(c){return ge(u,void 0,void 0,function(){var h,f,d,m,g,y,v,w;return ye(this,function(x){return h=c.padAtBorders(t.height,t.width),f=h.y,d=h.ey,m=h.x,g=h.ex,y=m-1,v=f-1,w=i.getImageData(y,v,g-y,d-v),[2,Ln.isNodejs()?Ew(w):createImageBitmap(w)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var h=gm({width:r,height:o}),f=Za(h);f.drawImage(c,0,0,r,o);for(var d=f.getImageData(0,0,r,o).data,m=[],g=0;g<d.length;g+=4)m.push(d[g+2]),m.push(d[g+1]),m.push(d[g]);s.push(m)}),[2,s.map(function(c){var h=le(function(){var f=oa(Xn(c,[1,r,o,3]),[0,2,1,3]).toFloat();return _k(f)});return h})]}})})}function R8(t,e){return le(function(){var n=Fw(t,e),r=Yr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Eo(r,e.fc1),i=uu(o,e.prelu4_alpha),a=Eo(i,e.fc2_1),s=Dr(fm(a,1),1),u=vi(en(a,s),1),l=Eo(i,e.fc2_2),c=Yt(u,1)[1];return{scores:c,regions:l}})}function A8(t,e,n,r,o){return ge(this,void 0,void 0,function(){var i,a,s,u,l,c,h,f,d,m,g,y,v,w;return ye(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,bk(t,e,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(_){var S=R8(_,r);return _.dispose(),S}),o.stage2_rnet=Date.now()-i,u=s.length>1?Qt(s.map(function(_){return _.scores})):s[0].scores,h=(c=Array).from,[4,u.data()];case 2:return l=h.apply(c,[x.sent()]),u.dispose(),f=l.map(function(_,S){return{score:_,idx:S}}).filter(function(_){return _.score>n}).map(function(_){var S=_.idx;return S}),d=f.map(function(_){return e[_]}),m=f.map(function(_){return l[_]}),g=[],y=[],d.length>0&&(i=Date.now(),v=Rc(d,m,.7),o.stage2_nms=Date.now()-i,w=v.map(function(_){var S=s[f[_]].regions.arraySync();return new Ow(S[0][0],S[0][1],S[0][2],S[0][3])}),y=v.map(function(_){return m[_]}),g=v.map(function(_,S){return d[_].calibrate(w[S])})),s.forEach(function(_){_.regions.dispose(),_.scores.dispose()}),[2,{boxes:g,scores:y}]}})})}function k8(t,e){return le(function(){var n=Fw(t,e);n=on(n,[2,2],[2,2],"same"),n=to(n,e.conv4,"valid"),n=uu(n,e.prelu4_alpha);var r=Yr(n,[n.shape[0],e.fc1.weights.shape[0]]),o=Eo(r,e.fc1),i=uu(o,e.prelu5_alpha),a=Eo(i,e.fc2_1),s=Dr(fm(a,1),1),u=vi(en(a,s),1),l=Eo(i,e.fc2_2),c=Eo(i,e.fc2_3),h=Yt(u,1)[1];return{scores:h,regions:l,points:c}})}function P8(t,e,n,r,o){return ge(this,void 0,void 0,function(){var i,a,s,u,l,c,h,f,d,m,g,y,v,w,x;return ye(this,function(_){switch(_.label){case 0:return i=Date.now(),[4,bk(t,e,{width:48,height:48})];case 1:return a=_.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(S){var R=k8(S,r);return S.dispose(),R}),o.stage3_onet=Date.now()-i,u=s.length>1?Qt(s.map(function(S){return S.scores})):s[0].scores,h=(c=Array).from,[4,u.data()];case 2:return l=h.apply(c,[_.sent()]),u.dispose(),f=l.map(function(S,R){return{score:S,idx:R}}).filter(function(S){return S.score>n}).map(function(S){var R=S.idx;return R}),d=f.map(function(S){var R=s[S].regions.arraySync();return new Ow(R[0][0],R[0][1],R[0][2],R[0][3])}),m=f.map(function(S,R){return e[S].calibrate(d[R])}),g=f.map(function(S){return l[S]}),y=[],v=[],w=[],m.length>0&&(i=Date.now(),x=Rc(m,g,.7,!1),o.stage3_nms=Date.now()-i,y=x.map(function(S){return m[S]}),v=x.map(function(S){return g[S]}),w=x.map(function(S,R){return Array(5).fill(0).map(function(C,E){var I=s[S].points.arraySync();return new Xe(I[0][E]*(y[R].width+1)+y[R].left,I[0][E+5]*(y[R].height+1)+y[R].top)})})),s.forEach(function(S){S.regions.dispose(),S.scores.dispose(),S.points.dispose()}),[2,{boxes:y,scores:v,points:w}]}})})}var D8=function(t){Re(e,t);function e(){return t.call(this,"Mtcnn")||this}return e.prototype.load=function(n){return ge(this,void 0,void 0,function(){return ye(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,n)]})})},e.prototype.loadFromDisk=function(n){return ge(this,void 0,void 0,function(){return ye(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,n)]})})},e.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var o,i,a,s,u,l,c,h,f,d,m,g,y,v,w,x,_,S,R,C,E;return ye(this,function(I){switch(I.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=le(function(){return y8(Dr(yw.fromPixels(i)).toFloat())}),l=function(T){return u.dispose(),a.total=Date.now()-s,T},c=u.shape.slice(1),h=c[0],f=c[1],d=new yk(r),m=d.minFaceSize,g=d.scaleFactor,y=d.maxNumScales,v=d.scoreThresholds,w=d.scaleSteps,x=(w||E8(m,g,[h,f])).filter(function(T){var k=Gy(T,[h,f]);return Math.min(k.width,k.height)>jd}).slice(0,y),a.scales=x,a.pyramid=x.map(function(T){return Gy(T,[h,f])}),_=Date.now(),[4,T8(u,x,v[0],o.pnet,a)];case 1:return S=I.sent(),a.total_stage1=Date.now()-_,S.boxes.length?(a.stage2_numInputBoxes=S.boxes.length,_=Date.now(),[4,A8(i,S.boxes,v[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return R=I.sent(),a.total_stage2=Date.now()-_,R.boxes.length?(a.stage3_numInputBoxes=R.boxes.length,_=Date.now(),[4,P8(i,R.boxes,v[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return C=I.sent(),a.total_stage3=Date.now()-_,E=C.boxes.map(function(T,k){return Aw(_w({},new zo(C.scores[k],new xw(T.left/f,T.top/h,T.width/f,T.height/h),{height:h,width:f})),new sj(C.points[k].map(function(P){return P.sub(new Xe(T.left,T.top)).div(new Xe(T.width,T.height))}),{width:T.width,height:T.height}))}),[2,l({results:E,stats:a})]}})})},e.prototype.forward=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,cn(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},e.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),ge(this,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,cn(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(n){return b8(n)},e.prototype.extractParams=function(n){return x8(n)},e}(yi),N8=.4,M8=[new Xe(1.603231,2.094468),new Xe(6.041143,7.080126),new Xe(2.882459,3.518061),new Xe(4.266906,5.178857),new Xe(9.041765,10.66308)],O8=[117.001,114.697,97.404],F8=function(t){Re(e,t);function e(){var n=this,r={withSeparableConvs:!0,iouThreshold:N8,classes:["face"],anchors:M8,meanRgb:O8,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=t.call(this,r)||this,n}return Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(n,r){return ge(this,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new zo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(n){return t.prototype.extractParamsFromWeigthMap.call(this,n)},e}(xk),Un={ssdMobilenetv1:new wk,tinyFaceDetector:new F8,tinyYolov2:new v8,mtcnn:new D8,faceLandmark68Net:new fk,faceLandmark68TinyNet:new Lj,faceRecognitionNet:new jj,faceExpressionNet:new Ej,ageGenderNet:new Nj},Ek=function(t){Re(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(uh),Lw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o=this;return ye(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,wm(n,this.input,function(a){return ge(o,void 0,void 0,function(){return ye(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Un.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return lk(a,r[s])})]}})})},e.prototype.withAgeAndGender=function(){return new Uw(this,this.input)},e}(Ek),Vw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return ye(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,Mw(n,this.input,function(i){return Un.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,lk(n,r)]}})})},e.prototype.withAgeAndGender=function(){return new zw(this,this.input)},e}(Ek),Bw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Hw(this,this.input)},e}(Lw),$w=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withAgeAndGender=function(){return new jw(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Gw(this,this.input)},e}(Vw),Ck=function(t){Re(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return e}(uh),Uw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o=this;return ye(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,wm(n,this.input,function(a){return ge(o,void 0,void 0,function(){return ye(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Un.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,h=u.genderProbability;return vk(gk(a,c,h),l)})]}})})},e.prototype.withFaceExpressions=function(){return new Lw(this,this.input)},e}(Ck),zw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o,i,a;return ye(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,Mw(n,this.input,function(u){return Un.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,vk(gk(n,i,a),o)]}})})},e.prototype.withFaceExpressions=function(){return new Vw(this,this.input)},e}(Ck),Ww=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new Bw(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Hw(this,this.input)},e}(Uw),jw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.withFaceExpressions=function(){return new $w(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Gw(this,this.input)},e}(zw),Sk=function(t){Re(e,t);function e(n,r){var o=t.call(this)||this;return o.parentTask=n,o.input=r,o}return e}(uh),Hw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return ye(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,wm(n,this.input,function(i){return Promise.all(i.map(function(a){return Un.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return mk(n[a],i)})]}})})},e.prototype.withFaceExpressions=function(){return new Bw(this,this.input)},e.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},e}(Sk),Gw=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return ye(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,Mw(n,this.input,function(i){return Un.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,mk(n,r)]}})})},e.prototype.withFaceExpressions=function(){return new $w(this,this.input)},e.prototype.withAgeAndGender=function(){return new jw(this,this.input)},e}(Sk),Ik=function(t){Re(e,t);function e(n,r,o){var i=t.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Un.faceLandmark68TinyNet:Un.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(uh),L8=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ye(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof _t?[4,Sw(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,Cw(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof _t&&l.dispose()}),[2,n.map(function(l,c){return Aw(l,a[c])})]}})})},e.prototype.withFaceExpressions=function(){return new Bw(this,this.input)},e.prototype.withAgeAndGender=function(){return new Ww(this,this.input)},e.prototype.withFaceDescriptors=function(){return new Hw(this,this.input)},e}(Ik),V8=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o,i,a;return ye(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof _t?[4,Sw(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,Cw(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof _t&&u.dispose()}),[2,Aw(n,a)]}})})},e.prototype.withFaceExpressions=function(){return new $w(this,this.input)},e.prototype.withAgeAndGender=function(){return new jw(this,this.input)},e.prototype.withFaceDescriptor=function(){return new Gw(this,this.input)},e}(Ik),Tk=function(t){Re(e,t);function e(n,r){r===void 0&&(r=new Pw);var o=t.call(this)||this;return o.input=n,o.options=r,o}return e}(uh),B8=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r,o,i;return ye(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof yk?[4,Un.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof g8?function(s){return Un.tinyFaceDetector.locateFaces(s,o)}:o instanceof Pw?function(s){return Un.ssdMobilenetv1.locateFaces(s,o)}:o instanceof Nw?function(s){return Un.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return ge(n,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return _w({},a)}))]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new L8(this.runAndExtendWithFaceDetections(),this.input,n)},e.prototype.withFaceExpressions=function(){return new Lw(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new Uw(this.runAndExtendWithFaceDetections(),this.input)},e}(Tk),oX=function(t){Re(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.run=function(){return ge(this,void 0,void 0,function(){var n,r;return ye(this,function(o){switch(o.label){case 0:return[4,new B8(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return ge(n,void 0,void 0,function(){var o;return ye(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?_w({},o):void 0)]}})})})},e.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new V8(this.runAndExtendWithFaceDetection(),this.input,n)},e.prototype.withFaceExpressions=function(){return new Vw(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new zw(this.runAndExtendWithFaceDetection(),this.input)},e}(Tk);function $8(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}var iX=function(){function t(e,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(e)?e:[e];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof sf)return a;if(a instanceof Float32Array)return new sf(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new sf(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(e,n){return n.map(function(r){return $8(r,e)}).reduce(function(r,o){return r+o},0)/(n.length||1)},t.prototype.matchDescriptor=function(e){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new SE(i,n.computeMeanDistance(e,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},t.prototype.findBestMatch=function(e){var n=this.matchDescriptor(e);return n.distance<this.distanceThreshold?n:new SE("unknown",n.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(e){return e.toJSON()})}},t.fromJSON=function(e){var n=e.labeledDescriptors.map(function(r){return sf.fromJSON(r)});return new t(n,e.distanceThreshold)},t}();const U8=async(t,e,n)=>{const r="/models",o={startTime:null,start(){this.startTime=performance.now()},end(i){const a=performance.now()-this.startTime;return console.log(`${i} took ${a.toFixed(2)}ms`),a}};try{o.start(),await Promise.all([Un.ssdMobilenetv1.loadFromUri(r),Un.faceLandmark68Net.loadFromUri(r),Un.faceRecognitionNet.loadFromUri(r)]),t(!0),e(null),n(null),o.end("Initial Model Load"),console.log("Face-API models loaded successfully from local public/models!")}catch(i){console.error("Model loading failed:",i),t(!1),i instanceof TypeError&&i.message.includes("Failed to fetch")?e("Failed to fetch model files. Ensure they are in 'public/models' and correctly named."):e(i.message||"Failed to load face recognition models"),n("Model files might be missing or corrupted.")}},z8=F.createContext({isAuthenticated:!1,currentUser:null,login:()=>{},logout:()=>{}}),W8=()=>{};var PE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},j8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const i=t[n++];e[r++]=String.fromCharCode((o&31)<<6|i&63)}else if(o>239&&o<365){const i=t[n++],a=t[n++],s=t[n++],u=((o&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Ak={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<t.length;o+=3){const i=t[o],a=o+1<t.length,s=a?t[o+1]:0,u=o+2<t.length,l=u?t[o+2]:0,c=i>>2,h=(i&3)<<4|s>>4;let f=(s&15)<<2|l>>6,d=l&63;u||(d=64,a||(f=64)),r.push(n[c],n[h],n[f],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):j8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<t.length;){const i=n[t.charAt(o++)],s=o<t.length?n[t.charAt(o)]:0;++o;const l=o<t.length?n[t.charAt(o)]:64;++o;const h=o<t.length?n[t.charAt(o)]:64;if(++o,i==null||s==null||l==null||h==null)throw new H8;const f=i<<2|s>>4;if(r.push(f),l!==64){const d=s<<4&240|l>>2;if(r.push(d),h!==64){const m=l<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class H8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const G8=function(t){const e=Rk(t);return Ak.encodeByteArray(e,!0)},Hd=function(t){return G8(t).replace(/\./g,"")},q8=function(t){try{return Ak.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X8=()=>K8().__FIREBASE_DEFAULTS__,Q8=()=>{if(typeof process>"u"||typeof PE>"u")return;const t=PE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Y8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q8(t[1]);return e&&JSON.parse(e)},qw=()=>{try{return W8()||X8()||Q8()||Y8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},J8=t=>{var e,n;return(n=(e=qw())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Z8=t=>{const e=J8(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},kk=()=>{var t;return(t=qw())==null?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function t7(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n7(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",o=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Hd(JSON.stringify(n)),Hd(JSON.stringify(a)),""].join(".")}const ql={};function r7(){const t={prod:[],emulator:[]};for(const e of Object.keys(ql))ql[e]?t.emulator.push(e):t.prod.push(e);return t}function o7(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let DE=!1;function i7(t,e){if(typeof window>"u"||typeof document>"u"||!Kw(window.location.host)||ql[t]===e||ql[t]||DE)return;ql[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=r7().prod.length>0;function a(){const f=document.getElementById(r);f&&f.remove()}function s(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function u(f,d){f.setAttribute("width","24"),f.setAttribute("id",d),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function l(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{DE=!0,a()},f}function c(f,d){f.setAttribute("id",d),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=o7(r),d=n("text"),m=document.getElementById(d)||document.createElement("span"),g=n("learnmore"),y=document.getElementById(g)||document.createElement("a"),v=n("preprendIcon"),w=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const x=f.element;s(x),c(y,g);const _=l();u(w,v),x.append(w,m,y,_),document.body.appendChild(x)}i?(m.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",d)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a7(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function s7(){var e;const t=(e=qw())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function u7(){return!s7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l7(){try{return typeof indexedDB=="object"}catch{return!1}}function c7(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var i;e(((i=o.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h7="FirebaseError";class ju extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=h7,Object.setPrototypeOf(this,ju.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pk.prototype.create)}}class Pk{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},o=`${this.service}/${e}`,i=this.errors[e],a=i?f7(i,r):"Error",s=`${this.serviceName}: ${a} (${o}).`;return new ju(o,s,r)}}function f7(t,e){return t.replace(d7,(n,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const d7=/\{\$([^}]+)}/g;function Gd(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const o of n){if(!r.includes(o))return!1;const i=t[o],a=e[o];if(NE(i)&&NE(a)){if(!Gd(i,a))return!1}else if(i!==a)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function NE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(t){return t&&t._delegate?t._delegate:t}class Ac{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p7{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new e7;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v7(e))try{this.getOrInitializeService({instanceIdentifier:Ma})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:o});r.resolve(i)}catch{}}}}clearInstance(e=Ma){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ma){return this.instances.has(e)}getOptions(e=Ma){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(i);r===s&&a.resolve(o)}return o}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const i=this.instances.get(r);return i&&e(i,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const o of r)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:m7(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ma){return this.component?this.component.multipleInstances?e:Ma:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function m7(t){return t===Ma?void 0:t}function v7(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new p7(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ze||(ze={}));const y7={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},w7=ze.INFO,x7={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},_7=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),o=x7[e];if(o)console[o](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Dk{constructor(e){this.name=e,this._logLevel=w7,this._logHandler=_7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?y7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const b7=(t,e)=>e.some(n=>t instanceof n);let ME,OE;function E7(){return ME||(ME=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C7(){return OE||(OE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nk=new WeakMap,qy=new WeakMap,Mk=new WeakMap,ig=new WeakMap,Xw=new WeakMap;function S7(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Ji(t.result)),o()},a=()=>{r(t.error),o()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&Nk.set(n,t)}).catch(()=>{}),Xw.set(e,t),e}function I7(t){if(qy.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),o()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});qy.set(t,e)}let Ky={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qy.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Mk.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ji(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function T7(t){Ky=t(Ky)}function R7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ag(this),e,...n);return Mk.set(r,e.sort?e.sort():[e]),Ji(r)}:C7().includes(t)?function(...e){return t.apply(ag(this),e),Ji(Nk.get(this))}:function(...e){return Ji(t.apply(ag(this),e))}}function A7(t){return typeof t=="function"?R7(t):(t instanceof IDBTransaction&&I7(t),b7(t,E7())?new Proxy(t,Ky):t)}function Ji(t){if(t instanceof IDBRequest)return S7(t);if(ig.has(t))return ig.get(t);const e=A7(t);return e!==t&&(ig.set(t,e),Xw.set(e,t)),e}const ag=t=>Xw.get(t);function k7(t,e,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(t,e),s=Ji(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Ji(a.result),u.oldVersion,u.newVersion,Ji(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),s.then(u=>{i&&u.addEventListener("close",()=>i()),o&&u.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),s}const P7=["get","getKey","getAll","getAllKeys","count"],D7=["put","add","delete","clear"],sg=new Map;function FE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(sg.get(e))return sg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=D7.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||P7.includes(n)))return;const i=async function(a,...s){const u=this.transaction(a,o?"readwrite":"readonly");let l=u.store;return r&&(l=l.index(s.shift())),(await Promise.all([l[n](...s),o&&u.done]))[0]};return sg.set(e,i),i}T7(t=>({...t,get:(e,n,r)=>FE(e,n)||t.get(e,n,r),has:(e,n)=>!!FE(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(M7(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function M7(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xy="@firebase/app",LE="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new Dk("@firebase/app"),O7="@firebase/app-compat",F7="@firebase/analytics-compat",L7="@firebase/analytics",V7="@firebase/app-check-compat",B7="@firebase/app-check",$7="@firebase/auth",U7="@firebase/auth-compat",z7="@firebase/database",W7="@firebase/data-connect",j7="@firebase/database-compat",H7="@firebase/functions",G7="@firebase/functions-compat",q7="@firebase/installations",K7="@firebase/installations-compat",X7="@firebase/messaging",Q7="@firebase/messaging-compat",Y7="@firebase/performance",J7="@firebase/performance-compat",Z7="@firebase/remote-config",eH="@firebase/remote-config-compat",tH="@firebase/storage",nH="@firebase/storage-compat",rH="@firebase/firestore",oH="@firebase/ai",iH="@firebase/firestore-compat",aH="firebase",sH="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy="[DEFAULT]",uH={[Xy]:"fire-core",[O7]:"fire-core-compat",[L7]:"fire-analytics",[F7]:"fire-analytics-compat",[B7]:"fire-app-check",[V7]:"fire-app-check-compat",[$7]:"fire-auth",[U7]:"fire-auth-compat",[z7]:"fire-rtdb",[W7]:"fire-data-connect",[j7]:"fire-rtdb-compat",[H7]:"fire-fn",[G7]:"fire-fn-compat",[q7]:"fire-iid",[K7]:"fire-iid-compat",[X7]:"fire-fcm",[Q7]:"fire-fcm-compat",[Y7]:"fire-perf",[J7]:"fire-perf-compat",[Z7]:"fire-rc",[eH]:"fire-rc-compat",[tH]:"fire-gcs",[nH]:"fire-gcs-compat",[rH]:"fire-fst",[iH]:"fire-fst-compat",[oH]:"fire-vertex","fire-js":"fire-js",[aH]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd=new Map,lH=new Map,Yy=new Map;function VE(t,e){try{t.container.addComponent(e)}catch(n){si.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Kd(t){const e=t.name;if(Yy.has(e))return si.debug(`There were multiple attempts to register component ${e}.`),!1;Yy.set(e,t);for(const n of qd.values())VE(n,t);for(const n of lH.values())VE(n,t);return!0}function cH(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function hH(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fH={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zi=new Pk("app","Firebase",fH);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dH{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ac("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pH=sH;function mH(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Qy,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw Zi.create("bad-app-name",{appName:String(o)});if(n||(n=kk()),!n)throw Zi.create("no-options");const i=qd.get(o);if(i){if(Gd(n,i.options)&&Gd(r,i.config))return i;throw Zi.create("duplicate-app",{appName:o})}const a=new g7(o);for(const u of Yy.values())a.addComponent(u);const s=new dH(n,r,a);return qd.set(o,s),s}function vH(t=Qy){const e=qd.get(t);if(!e&&t===Qy&&kk())return mH();if(!e)throw Zi.create("no-app",{appName:t});return e}function lu(t,e,n){let r=uH[t]??t;n&&(r+=`-${n}`);const o=r.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const a=[`Unable to register library "${r}" with version "${e}":`];o&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),si.warn(a.join(" "));return}Kd(new Ac(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gH="firebase-heartbeat-database",yH=1,kc="firebase-heartbeat-store";let ug=null;function Ok(){return ug||(ug=k7(gH,yH,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(kc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Zi.create("idb-open",{originalErrorMessage:t.message})})),ug}async function wH(t){try{const n=(await Ok()).transaction(kc),r=await n.objectStore(kc).get(Fk(t));return await n.done,r}catch(e){if(e instanceof ju)si.warn(e.message);else{const n=Zi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});si.warn(n.message)}}}async function BE(t,e){try{const r=(await Ok()).transaction(kc,"readwrite");await r.objectStore(kc).put(e,Fk(t)),await r.done}catch(n){if(n instanceof ju)si.warn(n.message);else{const r=Zi.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});si.warn(r.message)}}}function Fk(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xH=1024,_H=30;class bH{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new CH(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=$E();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:o}),this._heartbeatsCache.heartbeats.length>_H){const a=SH(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){si.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=$E(),{heartbeatsToSend:r,unsentEntries:o}=EH(this._heartbeatsCache.heartbeats),i=Hd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return si.warn(n),""}}}function $E(){return new Date().toISOString().substring(0,10)}function EH(t,e=xH){const n=[];let r=t.slice();for(const o of t){const i=n.find(a=>a.agent===o.agent);if(i){if(i.dates.push(o.date),UE(n)>e){i.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),UE(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class CH{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l7()?c7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await wH(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return BE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return BE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function UE(t){return Hd(JSON.stringify({version:2,heartbeats:t})).length}function SH(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IH(t){Kd(new Ac("platform-logger",e=>new N7(e),"PRIVATE")),Kd(new Ac("heartbeat",e=>new bH(e),"PRIVATE")),lu(Xy,LE,t),lu(Xy,LE,"esm2020"),lu("fire-js","")}IH("");var TH="firebase",RH="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lu(TH,RH,"app");var zE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ea,Lk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,E){function I(){}I.prototype=E.prototype,C.F=E.prototype,C.prototype=new I,C.prototype.constructor=C,C.D=function(T,k,P){for(var D=Array(arguments.length-2),$=2;$<arguments.length;$++)D[$-2]=arguments[$];return E.prototype[k].apply(T,D)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(C,E,I){I||(I=0);const T=Array(16);if(typeof E=="string")for(var k=0;k<16;++k)T[k]=E.charCodeAt(I++)|E.charCodeAt(I++)<<8|E.charCodeAt(I++)<<16|E.charCodeAt(I++)<<24;else for(k=0;k<16;++k)T[k]=E[I++]|E[I++]<<8|E[I++]<<16|E[I++]<<24;E=C.g[0],I=C.g[1],k=C.g[2];let P=C.g[3],D;D=E+(P^I&(k^P))+T[0]+3614090360&4294967295,E=I+(D<<7&4294967295|D>>>25),D=P+(k^E&(I^k))+T[1]+3905402710&4294967295,P=E+(D<<12&4294967295|D>>>20),D=k+(I^P&(E^I))+T[2]+606105819&4294967295,k=P+(D<<17&4294967295|D>>>15),D=I+(E^k&(P^E))+T[3]+3250441966&4294967295,I=k+(D<<22&4294967295|D>>>10),D=E+(P^I&(k^P))+T[4]+4118548399&4294967295,E=I+(D<<7&4294967295|D>>>25),D=P+(k^E&(I^k))+T[5]+1200080426&4294967295,P=E+(D<<12&4294967295|D>>>20),D=k+(I^P&(E^I))+T[6]+2821735955&4294967295,k=P+(D<<17&4294967295|D>>>15),D=I+(E^k&(P^E))+T[7]+4249261313&4294967295,I=k+(D<<22&4294967295|D>>>10),D=E+(P^I&(k^P))+T[8]+1770035416&4294967295,E=I+(D<<7&4294967295|D>>>25),D=P+(k^E&(I^k))+T[9]+2336552879&4294967295,P=E+(D<<12&4294967295|D>>>20),D=k+(I^P&(E^I))+T[10]+4294925233&4294967295,k=P+(D<<17&4294967295|D>>>15),D=I+(E^k&(P^E))+T[11]+2304563134&4294967295,I=k+(D<<22&4294967295|D>>>10),D=E+(P^I&(k^P))+T[12]+1804603682&4294967295,E=I+(D<<7&4294967295|D>>>25),D=P+(k^E&(I^k))+T[13]+4254626195&4294967295,P=E+(D<<12&4294967295|D>>>20),D=k+(I^P&(E^I))+T[14]+2792965006&4294967295,k=P+(D<<17&4294967295|D>>>15),D=I+(E^k&(P^E))+T[15]+1236535329&4294967295,I=k+(D<<22&4294967295|D>>>10),D=E+(k^P&(I^k))+T[1]+4129170786&4294967295,E=I+(D<<5&4294967295|D>>>27),D=P+(I^k&(E^I))+T[6]+3225465664&4294967295,P=E+(D<<9&4294967295|D>>>23),D=k+(E^I&(P^E))+T[11]+643717713&4294967295,k=P+(D<<14&4294967295|D>>>18),D=I+(P^E&(k^P))+T[0]+3921069994&4294967295,I=k+(D<<20&4294967295|D>>>12),D=E+(k^P&(I^k))+T[5]+3593408605&4294967295,E=I+(D<<5&4294967295|D>>>27),D=P+(I^k&(E^I))+T[10]+38016083&4294967295,P=E+(D<<9&4294967295|D>>>23),D=k+(E^I&(P^E))+T[15]+3634488961&4294967295,k=P+(D<<14&4294967295|D>>>18),D=I+(P^E&(k^P))+T[4]+3889429448&4294967295,I=k+(D<<20&4294967295|D>>>12),D=E+(k^P&(I^k))+T[9]+568446438&4294967295,E=I+(D<<5&4294967295|D>>>27),D=P+(I^k&(E^I))+T[14]+3275163606&4294967295,P=E+(D<<9&4294967295|D>>>23),D=k+(E^I&(P^E))+T[3]+4107603335&4294967295,k=P+(D<<14&4294967295|D>>>18),D=I+(P^E&(k^P))+T[8]+1163531501&4294967295,I=k+(D<<20&4294967295|D>>>12),D=E+(k^P&(I^k))+T[13]+2850285829&4294967295,E=I+(D<<5&4294967295|D>>>27),D=P+(I^k&(E^I))+T[2]+4243563512&4294967295,P=E+(D<<9&4294967295|D>>>23),D=k+(E^I&(P^E))+T[7]+1735328473&4294967295,k=P+(D<<14&4294967295|D>>>18),D=I+(P^E&(k^P))+T[12]+2368359562&4294967295,I=k+(D<<20&4294967295|D>>>12),D=E+(I^k^P)+T[5]+4294588738&4294967295,E=I+(D<<4&4294967295|D>>>28),D=P+(E^I^k)+T[8]+2272392833&4294967295,P=E+(D<<11&4294967295|D>>>21),D=k+(P^E^I)+T[11]+1839030562&4294967295,k=P+(D<<16&4294967295|D>>>16),D=I+(k^P^E)+T[14]+4259657740&4294967295,I=k+(D<<23&4294967295|D>>>9),D=E+(I^k^P)+T[1]+2763975236&4294967295,E=I+(D<<4&4294967295|D>>>28),D=P+(E^I^k)+T[4]+1272893353&4294967295,P=E+(D<<11&4294967295|D>>>21),D=k+(P^E^I)+T[7]+4139469664&4294967295,k=P+(D<<16&4294967295|D>>>16),D=I+(k^P^E)+T[10]+3200236656&4294967295,I=k+(D<<23&4294967295|D>>>9),D=E+(I^k^P)+T[13]+681279174&4294967295,E=I+(D<<4&4294967295|D>>>28),D=P+(E^I^k)+T[0]+3936430074&4294967295,P=E+(D<<11&4294967295|D>>>21),D=k+(P^E^I)+T[3]+3572445317&4294967295,k=P+(D<<16&4294967295|D>>>16),D=I+(k^P^E)+T[6]+76029189&4294967295,I=k+(D<<23&4294967295|D>>>9),D=E+(I^k^P)+T[9]+3654602809&4294967295,E=I+(D<<4&4294967295|D>>>28),D=P+(E^I^k)+T[12]+3873151461&4294967295,P=E+(D<<11&4294967295|D>>>21),D=k+(P^E^I)+T[15]+530742520&4294967295,k=P+(D<<16&4294967295|D>>>16),D=I+(k^P^E)+T[2]+3299628645&4294967295,I=k+(D<<23&4294967295|D>>>9),D=E+(k^(I|~P))+T[0]+4096336452&4294967295,E=I+(D<<6&4294967295|D>>>26),D=P+(I^(E|~k))+T[7]+1126891415&4294967295,P=E+(D<<10&4294967295|D>>>22),D=k+(E^(P|~I))+T[14]+2878612391&4294967295,k=P+(D<<15&4294967295|D>>>17),D=I+(P^(k|~E))+T[5]+4237533241&4294967295,I=k+(D<<21&4294967295|D>>>11),D=E+(k^(I|~P))+T[12]+1700485571&4294967295,E=I+(D<<6&4294967295|D>>>26),D=P+(I^(E|~k))+T[3]+2399980690&4294967295,P=E+(D<<10&4294967295|D>>>22),D=k+(E^(P|~I))+T[10]+4293915773&4294967295,k=P+(D<<15&4294967295|D>>>17),D=I+(P^(k|~E))+T[1]+2240044497&4294967295,I=k+(D<<21&4294967295|D>>>11),D=E+(k^(I|~P))+T[8]+1873313359&4294967295,E=I+(D<<6&4294967295|D>>>26),D=P+(I^(E|~k))+T[15]+4264355552&4294967295,P=E+(D<<10&4294967295|D>>>22),D=k+(E^(P|~I))+T[6]+2734768916&4294967295,k=P+(D<<15&4294967295|D>>>17),D=I+(P^(k|~E))+T[13]+1309151649&4294967295,I=k+(D<<21&4294967295|D>>>11),D=E+(k^(I|~P))+T[4]+4149444226&4294967295,E=I+(D<<6&4294967295|D>>>26),D=P+(I^(E|~k))+T[11]+3174756917&4294967295,P=E+(D<<10&4294967295|D>>>22),D=k+(E^(P|~I))+T[2]+718787259&4294967295,k=P+(D<<15&4294967295|D>>>17),D=I+(P^(k|~E))+T[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(k+(D<<21&4294967295|D>>>11))&4294967295,C.g[2]=C.g[2]+k&4294967295,C.g[3]=C.g[3]+P&4294967295}r.prototype.v=function(C,E){E===void 0&&(E=C.length);const I=E-this.blockSize,T=this.C;let k=this.h,P=0;for(;P<E;){if(k==0)for(;P<=I;)o(this,C,P),P+=this.blockSize;if(typeof C=="string"){for(;P<E;)if(T[k++]=C.charCodeAt(P++),k==this.blockSize){o(this,T),k=0;break}}else for(;P<E;)if(T[k++]=C[P++],k==this.blockSize){o(this,T),k=0;break}}this.h=k,this.o+=E},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;E=this.o*8;for(var I=C.length-8;I<C.length;++I)C[I]=E&255,E/=256;for(this.v(C),C=Array(16),E=0,I=0;I<4;++I)for(let T=0;T<32;T+=8)C[E++]=this.g[I]>>>T&255;return C};function i(C,E){var I=s;return Object.prototype.hasOwnProperty.call(I,C)?I[C]:I[C]=E(C)}function a(C,E){this.h=E;const I=[];let T=!0;for(let k=C.length-1;k>=0;k--){const P=C[k]|0;T&&P==E||(I[k]=P,T=!1)}this.g=I}var s={};function u(C){return-128<=C&&C<128?i(C,function(E){return new a([E|0],E<0?-1:0)}):new a([C|0],C<0?-1:0)}function l(C){if(isNaN(C)||!isFinite(C))return h;if(C<0)return y(l(-C));const E=[];let I=1;for(let T=0;C>=I;T++)E[T]=C/I|0,I*=4294967296;return new a(E,0)}function c(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return y(c(C.substring(1),E));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=l(Math.pow(E,8));let T=h;for(let P=0;P<C.length;P+=8){var k=Math.min(8,C.length-P);const D=parseInt(C.substring(P,P+k),E);k<8?(k=l(Math.pow(E,k)),T=T.j(k).add(l(D))):(T=T.j(I),T=T.add(l(D)))}return T}var h=u(0),f=u(1),d=u(16777216);t=a.prototype,t.m=function(){if(g(this))return-y(this).m();let C=0,E=1;for(let I=0;I<this.g.length;I++){const T=this.i(I);C+=(T>=0?T:4294967296+T)*E,E*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(m(this))return"0";if(g(this))return"-"+y(this).toString(C);const E=l(Math.pow(C,6));var I=this;let T="";for(;;){const k=_(I,E).g;I=v(I,k.j(E));let P=((I.g.length>0?I.g[0]:I.h)>>>0).toString(C);if(I=k,m(I))return P+T;for(;P.length<6;)P="0"+P;T=P+T}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function m(C){if(C.h!=0)return!1;for(let E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function g(C){return C.h==-1}t.l=function(C){return C=v(this,C),g(C)?-1:m(C)?0:1};function y(C){const E=C.g.length,I=[];for(let T=0;T<E;T++)I[T]=~C.g[T];return new a(I,~C.h).add(f)}t.abs=function(){return g(this)?y(this):this},t.add=function(C){const E=Math.max(this.g.length,C.g.length),I=[];let T=0;for(let k=0;k<=E;k++){let P=T+(this.i(k)&65535)+(C.i(k)&65535),D=(P>>>16)+(this.i(k)>>>16)+(C.i(k)>>>16);T=D>>>16,P&=65535,D&=65535,I[k]=D<<16|P}return new a(I,I[I.length-1]&-2147483648?-1:0)};function v(C,E){return C.add(y(E))}t.j=function(C){if(m(this)||m(C))return h;if(g(this))return g(C)?y(this).j(y(C)):y(y(this).j(C));if(g(C))return y(this.j(y(C)));if(this.l(d)<0&&C.l(d)<0)return l(this.m()*C.m());const E=this.g.length+C.g.length,I=[];for(var T=0;T<2*E;T++)I[T]=0;for(T=0;T<this.g.length;T++)for(let k=0;k<C.g.length;k++){const P=this.i(T)>>>16,D=this.i(T)&65535,$=C.i(k)>>>16,U=C.i(k)&65535;I[2*T+2*k]+=D*U,w(I,2*T+2*k),I[2*T+2*k+1]+=P*U,w(I,2*T+2*k+1),I[2*T+2*k+1]+=D*$,w(I,2*T+2*k+1),I[2*T+2*k+2]+=P*$,w(I,2*T+2*k+2)}for(C=0;C<E;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=E;C<2*E;C++)I[C]=0;return new a(I,0)};function w(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function x(C,E){this.g=C,this.h=E}function _(C,E){if(m(E))throw Error("division by zero");if(m(C))return new x(h,h);if(g(C))return E=_(y(C),E),new x(y(E.g),y(E.h));if(g(E))return E=_(C,y(E)),new x(y(E.g),E.h);if(C.g.length>30){if(g(C)||g(E))throw Error("slowDivide_ only works with positive integers.");for(var I=f,T=E;T.l(C)<=0;)I=S(I),T=S(T);var k=R(I,1),P=R(T,1);for(T=R(T,2),I=R(I,2);!m(T);){var D=P.add(T);D.l(C)<=0&&(k=k.add(I),P=D),T=R(T,1),I=R(I,1)}return E=v(C,k.j(E)),new x(k,E)}for(k=h;C.l(E)>=0;){for(I=Math.max(1,Math.floor(C.m()/E.m())),T=Math.ceil(Math.log(I)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),P=l(I),D=P.j(E);g(D)||D.l(C)>0;)I-=T,P=l(I),D=P.j(E);m(P)&&(P=f),k=k.add(P),C=v(C,D)}return new x(k,C)}t.B=function(C){return _(this,C).h},t.and=function(C){const E=Math.max(this.g.length,C.g.length),I=[];for(let T=0;T<E;T++)I[T]=this.i(T)&C.i(T);return new a(I,this.h&C.h)},t.or=function(C){const E=Math.max(this.g.length,C.g.length),I=[];for(let T=0;T<E;T++)I[T]=this.i(T)|C.i(T);return new a(I,this.h|C.h)},t.xor=function(C){const E=Math.max(this.g.length,C.g.length),I=[];for(let T=0;T<E;T++)I[T]=this.i(T)^C.i(T);return new a(I,this.h^C.h)};function S(C){const E=C.g.length+1,I=[];for(let T=0;T<E;T++)I[T]=C.i(T)<<1|C.i(T-1)>>>31;return new a(I,C.h)}function R(C,E){const I=E>>5;E%=32;const T=C.g.length-I,k=[];for(let P=0;P<T;P++)k[P]=E>0?C.i(P+I)>>>E|C.i(P+I+1)<<32-E:C.i(P+I);return new a(k,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Lk=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=c,ea=a}).apply(typeof zE<"u"?zE:typeof self<"u"?self:typeof window<"u"?window:{});var ff=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vk,kl,Bk,Vf,Jy,$k,Uk,zk;(function(){var t,e=Object.defineProperty;function n(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof ff=="object"&&ff];for(var b=0;b<p.length;++b){var A=p[b];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=n(this);function o(p,b){if(b)e:{var A=r;p=p.split(".");for(var M=0;M<p.length-1;M++){var z=p[M];if(!(z in A))break e;A=A[z]}p=p[p.length-1],M=A[p],b=b(M),b!=M&&b!=null&&e(A,p,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(p){return p||function(b){var A=[],M;for(M in b)Object.prototype.hasOwnProperty.call(b,M)&&A.push([M,b[M]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},a=this||self;function s(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function u(p,b,A){return p.call.apply(p.bind,arguments)}function l(p,b,A){return l=u,l.apply(null,arguments)}function c(p,b){var A=Array.prototype.slice.call(arguments,1);return function(){var M=A.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function h(p,b){function A(){}A.prototype=b.prototype,p.Z=b.prototype,p.prototype=new A,p.prototype.constructor=p,p.Ob=function(M,z,G){for(var ie=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)ie[Ne-2]=arguments[Ne];return b.prototype[z].apply(M,ie)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function d(p){const b=p.length;if(b>0){const A=Array(b);for(let M=0;M<b;M++)A[M]=p[M];return A}return[]}function m(p,b){for(let M=1;M<arguments.length;M++){const z=arguments[M];var A=typeof z;if(A=A!="object"?A:z?Array.isArray(z)?"array":A:"null",A=="array"||A=="object"&&typeof z.length=="number"){A=p.length||0;const G=z.length||0;p.length=A+G;for(let ie=0;ie<G;ie++)p[A+ie]=z[ie]}else p.push(z)}}class g{constructor(b,A){this.i=b,this.j=A,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function y(p){a.setTimeout(()=>{throw p},0)}function v(){var p=C;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class w{constructor(){this.h=this.g=null}add(b,A){const M=x.get();M.set(b,A),this.h?this.h.next=M:this.g=M,this.h=M}}var x=new g(()=>new _,p=>p.reset());class _{constructor(){this.next=this.g=this.h=null}set(b,A){this.h=b,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let S,R=!1,C=new w,E=()=>{const p=Promise.resolve(void 0);S=()=>{p.then(I)}};function I(){for(var p;p=v();){try{p.h.call(p.g)}catch(A){y(A)}var b=x;b.j(p),b.h<100&&(b.h++,p.next=b.g,b.g=p)}R=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const A=()=>{};a.addEventListener("test",A,b),a.removeEventListener("test",A,b)}catch{}return p}();function D(p){return/^[\s\xa0]*$/.test(p)}function $(p,b){k.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,b)}h($,k),$.prototype.init=function(p,b){const A=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget,b||(A=="mouseover"?b=p.fromElement:A=="mouseout"&&(b=p.toElement)),this.relatedTarget=b,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&$.Z.h.call(this)},$.prototype.h=function(){$.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),K=0;function X(p,b,A,M,z){this.listener=p,this.proxy=null,this.src=b,this.type=A,this.capture=!!M,this.ha=z,this.key=++K,this.da=this.fa=!1}function V(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function W(p,b,A){for(const M in p)b.call(A,p[M],M,p)}function H(p,b){for(const A in p)b.call(void 0,p[A],A,p)}function ne(p){const b={};for(const A in p)b[A]=p[A];return b}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(p,b){let A,M;for(let z=1;z<arguments.length;z++){M=arguments[z];for(A in M)p[A]=M[A];for(let G=0;G<oe.length;G++)A=oe[G],Object.prototype.hasOwnProperty.call(M,A)&&(p[A]=M[A])}}function me(p){this.src=p,this.g={},this.h=0}me.prototype.add=function(p,b,A,M,z){const G=p.toString();p=this.g[G],p||(p=this.g[G]=[],this.h++);const ie=xe(p,b,M,z);return ie>-1?(b=p[ie],A||(b.fa=!1)):(b=new X(b,this.src,G,!!M,z),b.fa=A,p.push(b)),b};function _e(p,b){const A=b.type;if(A in p.g){var M=p.g[A],z=Array.prototype.indexOf.call(M,b,void 0),G;(G=z>=0)&&Array.prototype.splice.call(M,z,1),G&&(V(b),p.g[A].length==0&&(delete p.g[A],p.h--))}}function xe(p,b,A,M){for(let z=0;z<p.length;++z){const G=p[z];if(!G.da&&G.listener==b&&G.capture==!!A&&G.ha==M)return z}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),Pe={};function Ee(p,b,A,M,z){if(Array.isArray(b)){for(let G=0;G<b.length;G++)Ee(p,b[G],A,M,z);return null}return A=Vn(A),p&&p[U]?p.J(b,A,s(M)?!!M.capture:!1,z):ct(p,b,A,!1,M,z)}function ct(p,b,A,M,z,G){if(!b)throw Error("Invalid event type");const ie=s(z)?!!z.capture:!!z;let Ne=Je(p);if(Ne||(p[Ie]=Ne=new me(p)),A=Ne.add(b,A,M,ie,G),A.proxy)return A;if(M=Me(),A.proxy=M,M.src=p,M.listener=A,p.addEventListener)P||(z=ie),z===void 0&&(z=!1),p.addEventListener(b.toString(),M,z);else if(p.attachEvent)p.attachEvent(tt(b.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Me(){function p(A){return b.call(p.src,p.listener,A)}const b=nt;return p}function je(p,b,A,M,z){if(Array.isArray(b))for(var G=0;G<b.length;G++)je(p,b[G],A,M,z);else M=s(M)?!!M.capture:!!M,A=Vn(A),p&&p[U]?(p=p.i,G=String(b).toString(),G in p.g&&(b=p.g[G],A=xe(b,A,M,z),A>-1&&(V(b[A]),Array.prototype.splice.call(b,A,1),b.length==0&&(delete p.g[G],p.h--)))):p&&(p=Je(p))&&(b=p.g[b.toString()],p=-1,b&&(p=xe(b,A,M,z)),(A=p>-1?b[p]:null)&&Fe(A))}function Fe(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[U])_e(b.i,p);else{var A=p.type,M=p.proxy;b.removeEventListener?b.removeEventListener(A,M,p.capture):b.detachEvent?b.detachEvent(tt(A),M):b.addListener&&b.removeListener&&b.removeListener(M),(A=Je(b))?(_e(A,p),A.h==0&&(A.src=null,b[Ie]=null)):V(p)}}}function tt(p){return p in Pe?Pe[p]:Pe[p]="on"+p}function nt(p,b){if(p.da)p=!0;else{b=new $(b,this);const A=p.listener,M=p.ha||p.src;p.fa&&Fe(p),p=A.call(M,b)}return p}function Je(p){return p=p[Ie],p instanceof me?p:null}var bn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Vn(p){return typeof p=="function"?p:(p[bn]||(p[bn]=function(b){return p.handleEvent(b)}),p[bn])}function Ge(){T.call(this),this.i=new me(this),this.M=this,this.G=null}h(Ge,T),Ge.prototype[U]=!0,Ge.prototype.removeEventListener=function(p,b,A,M){je(this,p,b,A,M)};function it(p,b){var A,M=p.G;if(M)for(A=[];M;M=M.G)A.push(M);if(p=p.M,M=b.type||b,typeof b=="string")b=new k(b,p);else if(b instanceof k)b.target=b.target||p;else{var z=b;b=new k(M,p),de(b,z)}z=!0;let G,ie;if(A)for(ie=A.length-1;ie>=0;ie--)G=b.g=A[ie],z=nn(G,M,!0,b)&&z;if(G=b.g=p,z=nn(G,M,!0,b)&&z,z=nn(G,M,!1,b)&&z,A)for(ie=0;ie<A.length;ie++)G=b.g=A[ie],z=nn(G,M,!1,b)&&z}Ge.prototype.N=function(){if(Ge.Z.N.call(this),this.i){var p=this.i;for(const b in p.g){const A=p.g[b];for(let M=0;M<A.length;M++)V(A[M]);delete p.g[b],p.h--}}this.G=null},Ge.prototype.J=function(p,b,A,M){return this.i.add(String(p),b,!1,A,M)},Ge.prototype.K=function(p,b,A,M){return this.i.add(String(p),b,!0,A,M)};function nn(p,b,A,M){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();let z=!0;for(let G=0;G<b.length;++G){const ie=b[G];if(ie&&!ie.da&&ie.capture==A){const Ne=ie.listener,Gt=ie.ha||ie.src;ie.fa&&_e(p.i,ie),z=Ne.call(Gt,M)!==!1&&z}}return z&&!M.defaultPrevented}function Sr(p,b){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=l(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:a.setTimeout(p,b||0)}function Gn(p){p.g=Sr(()=>{p.g=null,p.i&&(p.i=!1,Gn(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class ar extends T{constructor(b,A){super(),this.m=b,this.l=A,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Gn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(p){T.call(this),this.h=p,this.g={}}h(Dt,T);var _i=[];function Ir(p){W(p.g,function(b,A){this.g.hasOwnProperty(A)&&Fe(b)},p),p.g={}}Dt.prototype.N=function(){Dt.Z.N.call(this),Ir(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var En=a.JSON.stringify,Se=a.JSON.parse,hs=class{stringify(p){return a.JSON.stringify(p,void 0)}parse(p){return a.JSON.parse(p,void 0)}};function fs(){}function _a(){}var uo={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ba(){k.call(this,"d")}h(ba,k);function Ea(){k.call(this,"c")}h(Ea,k);var Ca={},Dx=null;function vh(){return Dx=Dx||new Ge}Ca.Ia="serverreachability";function Nx(p){k.call(this,Ca.Ia,p)}h(Nx,k);function Yu(p){const b=vh();it(b,new Nx(b))}Ca.STAT_EVENT="statevent";function Mx(p,b){k.call(this,Ca.STAT_EVENT,p),this.stat=b}h(Mx,k);function Bn(p){const b=vh();it(b,new Mx(b,p))}Ca.Ja="timingevent";function Ox(p,b){k.call(this,Ca.Ja,p),this.size=b}h(Ox,k);function Ju(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){p()},b)}function Zu(){this.g=!0}Zu.prototype.ua=function(){this.g=!1};function pD(p,b,A,M,z,G){p.info(function(){if(p.g)if(G){var ie="",Ne=G.split("&");for(let rt=0;rt<Ne.length;rt++){var Gt=Ne[rt].split("=");if(Gt.length>1){const rn=Gt[0];Gt=Gt[1];const co=rn.split("_");ie=co.length>=2&&co[1]=="type"?ie+(rn+"="+Gt+"&"):ie+(rn+"=redacted&")}}}else ie=null;else ie=G;return"XMLHTTP REQ ("+M+") [attempt "+z+"]: "+b+`
`+A+`
`+ie})}function mD(p,b,A,M,z,G,ie){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+z+"]: "+b+`
`+A+`
`+G+" "+ie})}function ds(p,b,A,M){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+gD(p,A)+(M?" "+M:"")})}function vD(p,b){p.info(function(){return"TIMEOUT: "+b})}Zu.prototype.info=function(){};function gD(p,b){if(!p.g)return b;if(!b)return null;try{const G=JSON.parse(b);if(G){for(p=0;p<G.length;p++)if(Array.isArray(G[p])){var A=G[p];if(!(A.length<2)){var M=A[1];if(Array.isArray(M)&&!(M.length<1)){var z=M[0];if(z!="noop"&&z!="stop"&&z!="close")for(let ie=1;ie<M.length;ie++)M[ie]=""}}}}return En(G)}catch{return b}}var gh={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fx={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Lx;function Fm(){}h(Fm,fs),Fm.prototype.g=function(){return new XMLHttpRequest},Lx=new Fm;function el(p){return encodeURIComponent(String(p))}function yD(p){var b=1;p=p.split(":");const A=[];for(;b>0&&p.length;)A.push(p.shift()),b--;return p.length&&A.push(p.join(":")),A}function bi(p,b,A,M){this.j=p,this.i=b,this.l=A,this.S=M||1,this.V=new Dt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Vx}function Vx(){this.i=null,this.g="",this.h=!1}var Bx={},Lm={};function Vm(p,b,A){p.M=1,p.A=wh(lo(b)),p.u=A,p.R=!0,$x(p,null)}function $x(p,b){p.F=Date.now(),yh(p),p.B=lo(p.A);var A=p.B,M=p.S;Array.isArray(M)||(M=[String(M)]),Zx(A.i,"t",M),p.C=0,A=p.j.L,p.h=new Vx,p.g=g_(p.j,A?b:null,!p.u),p.P>0&&(p.O=new ar(l(p.Y,p,p.g),p.P)),b=p.V,A=p.g,M=p.ba;var z="readystatechange";Array.isArray(z)||(z&&(_i[0]=z.toString()),z=_i);for(let G=0;G<z.length;G++){const ie=Ee(A,z[G],M||b.handleEvent,!1,b.h||b);if(!ie)break;b.g[ie.key]=ie}b=p.J?ne(p.J):{},p.u?(p.v||(p.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,b)):(p.v="GET",p.g.ea(p.B,p.v,null,b)),Yu(),pD(p.i,p.v,p.B,p.l,p.S,p.u)}bi.prototype.ba=function(p){p=p.target;const b=this.O;b&&Si(p)==3?b.j():this.Y(p)},bi.prototype.Y=function(p){try{if(p==this.g)e:{const Ne=Si(this.g),Gt=this.g.ya(),rt=this.g.ca();if(!(Ne<3)&&(Ne!=3||this.g&&(this.h.h||this.g.la()||a_(this.g)))){this.K||Ne!=4||Gt==7||(Gt==8||rt<=0?Yu(3):Yu(2)),Bm(this);var b=this.g.ca();this.X=b;var A=wD(this);if(this.o=b==200,mD(this.i,this.v,this.B,this.l,this.S,Ne,b),this.o){if(this.U&&!this.L){t:{if(this.g){var M,z=this.g;if((M=z.g?z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(M)){var G=M;break t}}G=null}if(p=G)ds(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$m(this,p);else{this.o=!1,this.m=3,Bn(12),Sa(this),tl(this);break e}}if(this.R){p=!0;let rn;for(;!this.K&&this.C<A.length;)if(rn=xD(this,A),rn==Lm){Ne==4&&(this.m=4,Bn(14),p=!1),ds(this.i,this.l,null,"[Incomplete Response]");break}else if(rn==Bx){this.m=4,Bn(15),ds(this.i,this.l,A,"[Invalid Chunk]"),p=!1;break}else ds(this.i,this.l,rn,null),$m(this,rn);if(Ux(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ne!=4||A.length!=0||this.h.h||(this.m=1,Bn(16),p=!1),this.o=this.o&&p,!p)ds(this.i,this.l,A,"[Invalid Chunked Response]"),Sa(this),tl(this);else if(A.length>0&&!this.W){this.W=!0;var ie=this.j;ie.g==this&&ie.aa&&!ie.P&&(ie.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Km(ie),ie.P=!0,Bn(11))}}else ds(this.i,this.l,A,null),$m(this,A);Ne==4&&Sa(this),this.o&&!this.K&&(Ne==4?d_(this.j,this):(this.o=!1,yh(this)))}else MD(this.g),b==400&&A.indexOf("Unknown SID")>0?(this.m=3,Bn(12)):(this.m=0,Bn(13)),Sa(this),tl(this)}}}catch{}finally{}};function wD(p){if(!Ux(p))return p.g.la();const b=a_(p.g);if(b==="")return"";let A="";const M=b.length,z=Si(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Sa(p),tl(p),"";p.h.i=new a.TextDecoder}for(let G=0;G<M;G++)p.h.h=!0,A+=p.h.i.decode(b[G],{stream:!(z&&G==M-1)});return b.length=0,p.h.g+=A,p.C=0,p.h.g}function Ux(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function xD(p,b){var A=p.C,M=b.indexOf(`
`,A);return M==-1?Lm:(A=Number(b.substring(A,M)),isNaN(A)?Bx:(M+=1,M+A>b.length?Lm:(b=b.slice(M,M+A),p.C=M+A,b)))}bi.prototype.cancel=function(){this.K=!0,Sa(this)};function yh(p){p.T=Date.now()+p.H,zx(p,p.H)}function zx(p,b){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Ju(l(p.aa,p),b)}function Bm(p){p.D&&(a.clearTimeout(p.D),p.D=null)}bi.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(vD(this.i,this.B),this.M!=2&&(Yu(),Bn(17)),Sa(this),this.m=2,tl(this)):zx(this,this.T-p)};function tl(p){p.j.I==0||p.K||d_(p.j,p)}function Sa(p){Bm(p);var b=p.O;b&&typeof b.dispose=="function"&&b.dispose(),p.O=null,Ir(p.V),p.g&&(b=p.g,p.g=null,b.abort(),b.dispose())}function $m(p,b){try{var A=p.j;if(A.I!=0&&(A.g==p||Um(A.h,p))){if(!p.L&&Um(A.h,p)&&A.I==3){try{var M=A.Ba.g.parse(b)}catch{M=null}if(Array.isArray(M)&&M.length==3){var z=M;if(z[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<p.F)Ch(A),bh(A);else break e;qm(A),Bn(18)}}else A.xa=z[1],0<A.xa-A.K&&z[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=Ju(l(A.Va,A),6e3));Hx(A.h)<=1&&A.ta&&(A.ta=void 0)}else Ta(A,11)}else if((p.L||A.g==p)&&Ch(A),!D(b))for(z=A.Ba.g.parse(b),b=0;b<z.length;b++){let rt=z[b];const rn=rt[0];if(!(rn<=A.K))if(A.K=rn,rt=rt[1],A.I==2)if(rt[0]=="c"){A.M=rt[1],A.ba=rt[2];const co=rt[3];co!=null&&(A.ka=co,A.j.info("VER="+A.ka));const Ra=rt[4];Ra!=null&&(A.za=Ra,A.j.info("SVER="+A.za));const Ii=rt[5];Ii!=null&&typeof Ii=="number"&&Ii>0&&(M=1.5*Ii,A.O=M,A.j.info("backChannelRequestTimeoutMs_="+M)),M=A;const Ti=p.g;if(Ti){const Ih=Ti.g?Ti.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ih){var G=M.h;G.g||Ih.indexOf("spdy")==-1&&Ih.indexOf("quic")==-1&&Ih.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(zm(G,G.h),G.h=null))}if(M.G){const Xm=Ti.g?Ti.g.getResponseHeader("X-HTTP-Session-Id"):null;Xm&&(M.wa=Xm,ht(M.J,M.G,Xm))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-p.F,A.j.info("Handshake RTT: "+A.T+"ms")),M=A;var ie=p;if(M.na=v_(M,M.L?M.ba:null,M.W),ie.L){Gx(M.h,ie);var Ne=ie,Gt=M.O;Gt&&(Ne.H=Gt),Ne.D&&(Bm(Ne),yh(Ne)),M.g=ie}else h_(M);A.i.length>0&&Eh(A)}else rt[0]!="stop"&&rt[0]!="close"||Ta(A,7);else A.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Ta(A,7):Gm(A):rt[0]!="noop"&&A.l&&A.l.qa(rt),A.A=0)}}Yu(4)}catch{}}var _D=class{constructor(p,b){this.g=p,this.map=b}};function Wx(p){this.l=p||10,a.PerformanceNavigationTiming?(p=a.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function jx(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Hx(p){return p.h?1:p.g?p.g.size:0}function Um(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function zm(p,b){p.g?p.g.add(b):p.h=b}function Gx(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}Wx.prototype.cancel=function(){if(this.i=qx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function qx(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const A of p.g.values())b=b.concat(A.G);return b}return d(p.i)}var Kx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bD(p,b){if(p){p=p.split("&");for(let A=0;A<p.length;A++){const M=p[A].indexOf("=");let z,G=null;M>=0?(z=p[A].substring(0,M),G=p[A].substring(M+1)):z=p[A],b(z,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function Ei(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;p instanceof Ei?(this.l=p.l,nl(this,p.j),this.o=p.o,this.g=p.g,rl(this,p.u),this.h=p.h,Wm(this,e_(p.i)),this.m=p.m):p&&(b=String(p).match(Kx))?(this.l=!1,nl(this,b[1]||"",!0),this.o=ol(b[2]||""),this.g=ol(b[3]||"",!0),rl(this,b[4]),this.h=ol(b[5]||"",!0),Wm(this,b[6]||"",!0),this.m=ol(b[7]||"")):(this.l=!1,this.i=new al(null,this.l))}Ei.prototype.toString=function(){const p=[];var b=this.j;b&&p.push(il(b,Xx,!0),":");var A=this.g;return(A||b=="file")&&(p.push("//"),(b=this.o)&&p.push(il(b,Xx,!0),"@"),p.push(el(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&p.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&p.push("/"),p.push(il(A,A.charAt(0)=="/"?SD:CD,!0))),(A=this.i.toString())&&p.push("?",A),(A=this.m)&&p.push("#",il(A,TD)),p.join("")},Ei.prototype.resolve=function(p){const b=lo(this);let A=!!p.j;A?nl(b,p.j):A=!!p.o,A?b.o=p.o:A=!!p.g,A?b.g=p.g:A=p.u!=null;var M=p.h;if(A)rl(b,p.u);else if(A=!!p.h){if(M.charAt(0)!="/")if(this.g&&!this.h)M="/"+M;else{var z=b.h.lastIndexOf("/");z!=-1&&(M=b.h.slice(0,z+1)+M)}if(z=M,z==".."||z==".")M="";else if(z.indexOf("./")!=-1||z.indexOf("/.")!=-1){M=z.lastIndexOf("/",0)==0,z=z.split("/");const G=[];for(let ie=0;ie<z.length;){const Ne=z[ie++];Ne=="."?M&&ie==z.length&&G.push(""):Ne==".."?((G.length>1||G.length==1&&G[0]!="")&&G.pop(),M&&ie==z.length&&G.push("")):(G.push(Ne),M=!0)}M=G.join("/")}else M=z}return A?b.h=M:A=p.i.toString()!=="",A?Wm(b,e_(p.i)):A=!!p.m,A&&(b.m=p.m),b};function lo(p){return new Ei(p)}function nl(p,b,A){p.j=A?ol(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function rl(p,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);p.u=b}else p.u=null}function Wm(p,b,A){b instanceof al?(p.i=b,RD(p.i,p.l)):(A||(b=il(b,ID)),p.i=new al(b,p.l))}function ht(p,b,A){p.i.set(b,A)}function wh(p){return ht(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function ol(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function il(p,b,A){return typeof p=="string"?(p=encodeURI(p).replace(b,ED),A&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function ED(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Xx=/[#\/\?@]/g,CD=/[#\?:]/g,SD=/[#\?]/g,ID=/[#\?@]/g,TD=/#/g;function al(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function Ia(p){p.g||(p.g=new Map,p.h=0,p.i&&bD(p.i,function(b,A){p.add(decodeURIComponent(b.replace(/\+/g," ")),A)}))}t=al.prototype,t.add=function(p,b){Ia(this),this.i=null,p=ps(this,p);let A=this.g.get(p);return A||this.g.set(p,A=[]),A.push(b),this.h+=1,this};function Qx(p,b){Ia(p),b=ps(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function Yx(p,b){return Ia(p),b=ps(p,b),p.g.has(b)}t.forEach=function(p,b){Ia(this),this.g.forEach(function(A,M){A.forEach(function(z){p.call(b,z,M,this)},this)},this)};function Jx(p,b){Ia(p);let A=[];if(typeof b=="string")Yx(p,b)&&(A=A.concat(p.g.get(ps(p,b))));else for(p=Array.from(p.g.values()),b=0;b<p.length;b++)A=A.concat(p[b]);return A}t.set=function(p,b){return Ia(this),this.i=null,p=ps(this,p),Yx(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},t.get=function(p,b){return p?(p=Jx(this,p),p.length>0?String(p[0]):b):b};function Zx(p,b,A){Qx(p,b),A.length>0&&(p.i=null,p.g.set(ps(p,b),d(A)),p.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(let M=0;M<b.length;M++){var A=b[M];const z=el(A);A=Jx(this,A);for(let G=0;G<A.length;G++){let ie=z;A[G]!==""&&(ie+="="+el(A[G])),p.push(ie)}}return this.i=p.join("&")};function e_(p){const b=new al;return b.i=p.i,p.g&&(b.g=new Map(p.g),b.h=p.h),b}function ps(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function RD(p,b){b&&!p.j&&(Ia(p),p.i=null,p.g.forEach(function(A,M){const z=M.toLowerCase();M!=z&&(Qx(this,M),Zx(this,z,A))},p)),p.j=b}function AD(p,b){const A=new Zu;if(a.Image){const M=new Image;M.onload=c(Ci,A,"TestLoadImage: loaded",!0,b,M),M.onerror=c(Ci,A,"TestLoadImage: error",!1,b,M),M.onabort=c(Ci,A,"TestLoadImage: abort",!1,b,M),M.ontimeout=c(Ci,A,"TestLoadImage: timeout",!1,b,M),a.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else b(!1)}function kD(p,b){const A=new Zu,M=new AbortController,z=setTimeout(()=>{M.abort(),Ci(A,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:M.signal}).then(G=>{clearTimeout(z),G.ok?Ci(A,"TestPingServer: ok",!0,b):Ci(A,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(z),Ci(A,"TestPingServer: error",!1,b)})}function Ci(p,b,A,M,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),M(A)}catch{}}function PD(){this.g=new hs}function jm(p){this.i=p.Sb||null,this.h=p.ab||!1}h(jm,fs),jm.prototype.g=function(){return new xh(this.i,this.h)};function xh(p,b){Ge.call(this),this.H=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(xh,Ge),t=xh.prototype,t.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=b,this.readyState=1,ul(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(b.body=p),(this.H||a).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,sl(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ul(this)),this.g&&(this.readyState=3,ul(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;t_(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function t_(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?sl(this):ul(this),this.readyState==3&&t_(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,sl(this))},t.Na=function(p){this.g&&(this.response=p,sl(this))},t.ga=function(){this.g&&sl(this)};function sl(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ul(p)}t.setRequestHeader=function(p,b){this.A.append(p,b)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var A=b.next();!A.done;)A=A.value,p.push(A[0]+": "+A[1]),A=b.next();return p.join(`\r
`)};function ul(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(xh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function n_(p){let b="";return W(p,function(A,M){b+=M,b+=":",b+=A,b+=`\r
`}),b}function Hm(p,b,A){e:{for(M in A){var M=!1;break e}M=!0}M||(A=n_(A),typeof p=="string"?A!=null&&el(A):ht(p,b,A))}function Tt(p){Ge.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Tt,Ge);var DD=/^https?$/i,ND=["POST","PUT"];t=Tt.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,b,A,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Lx.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch(G){r_(this,G);return}if(p=A||"",A=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var z in M)A.set(z,M[z]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const G of M.keys())A.set(G,M.get(G));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(A.keys()).find(G=>G.toLowerCase()=="content-type"),z=a.FormData&&p instanceof a.FormData,!(Array.prototype.indexOf.call(ND,b,void 0)>=0)||M||z||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,ie]of A)this.g.setRequestHeader(G,ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(G){r_(this,G)}};function r_(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.o=5,o_(p),_h(p)}function o_(p){p.A||(p.A=!0,it(p,"complete"),it(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,it(this,"complete"),it(this,"abort"),_h(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_h(this,!0)),Tt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?i_(this):this.Xa())},t.Xa=function(){i_(this)};function i_(p){if(p.h&&typeof i<"u"){if(p.v&&Si(p)==4)setTimeout(p.Ca.bind(p),0);else if(it(p,"readystatechange"),Si(p)==4){p.h=!1;try{const G=p.ca();e:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var A;if(!(A=b)){var M;if(M=G===0){let ie=String(p.D).match(Kx)[1]||null;!ie&&a.self&&a.self.location&&(ie=a.self.location.protocol.slice(0,-1)),M=!DD.test(ie?ie.toLowerCase():"")}A=M}if(A)it(p,"complete"),it(p,"success");else{p.o=6;try{var z=Si(p)>2?p.g.statusText:""}catch{z=""}p.l=z+" ["+p.ca()+"]",o_(p)}}finally{_h(p)}}}}function _h(p,b){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const A=p.g;p.g=null,b||it(p,"ready");try{A.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Si(p){return p.g?p.g.readyState:0}t.ca=function(){try{return Si(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),Se(b)}};function a_(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function MD(p){const b={};p=(p.g&&Si(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(D(p[M]))continue;var A=yD(p[M]);const z=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const G=b[z]||[];b[z]=G,G.push(A)}H(b,function(M){return M.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ll(p,b,A){return A&&A.internalChannelParams&&A.internalChannelParams[p]||b}function s_(p){this.za=0,this.i=[],this.j=new Zu,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ll("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ll("baseRetryDelayMs",5e3,p),this.Za=ll("retryDelaySeedMs",1e4,p),this.Ta=ll("forwardChannelMaxRetries",2,p),this.va=ll("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Wx(p&&p.concurrentRequestLimit),this.Ba=new PD,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=s_.prototype,t.ka=8,t.I=1,t.connect=function(p,b,A,M){Bn(0),this.W=p,this.H=b||{},A&&M!==void 0&&(this.H.OSID=A,this.H.OAID=M),this.F=this.X,this.J=v_(this,null,this.W),Eh(this)};function Gm(p){if(u_(p),p.I==3){var b=p.V++,A=lo(p.J);if(ht(A,"SID",p.M),ht(A,"RID",b),ht(A,"TYPE","terminate"),cl(p,A),b=new bi(p,p.j,b),b.M=2,b.A=wh(lo(A)),A=!1,a.navigator&&a.navigator.sendBeacon)try{A=a.navigator.sendBeacon(b.A.toString(),"")}catch{}!A&&a.Image&&(new Image().src=b.A,A=!0),A||(b.g=g_(b.j,null),b.g.ea(b.A)),b.F=Date.now(),yh(b)}m_(p)}function bh(p){p.g&&(Km(p),p.g.cancel(),p.g=null)}function u_(p){bh(p),p.v&&(a.clearTimeout(p.v),p.v=null),Ch(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&a.clearTimeout(p.m),p.m=null)}function Eh(p){if(!jx(p.h)&&!p.m){p.m=!0;var b=p.Ea;S||E(),R||(S(),R=!0),C.add(b,p),p.D=0}}function OD(p,b){return Hx(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=b.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Ju(l(p.Ea,p,b),p_(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const z=new bi(this,this.j,p);let G=this.o;if(this.U&&(G?(G=ne(G),de(G,this.U)):G=this.U),this.u!==null||this.R||(z.J=G,G=null),this.S)e:{for(var b=0,A=0;A<this.i.length;A++){t:{var M=this.i[A];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(b+=M,b>4096){b=A;break e}if(b===4096||A===this.i.length-1){b=A+1;break e}}b=1e3}else b=1e3;b=c_(this,z,b),A=lo(this.J),ht(A,"RID",p),ht(A,"CVER",22),this.G&&ht(A,"X-HTTP-Session-Id",this.G),cl(this,A),G&&(this.R?b="headers="+el(n_(G))+"&"+b:this.u&&Hm(A,this.u,G)),zm(this.h,z),this.Ra&&ht(A,"TYPE","init"),this.S?(ht(A,"$req",b),ht(A,"SID","null"),z.U=!0,Vm(z,A,null)):Vm(z,A,b),this.I=2}}else this.I==3&&(p?l_(this,p):this.i.length==0||jx(this.h)||l_(this))};function l_(p,b){var A;b?A=b.l:A=p.V++;const M=lo(p.J);ht(M,"SID",p.M),ht(M,"RID",A),ht(M,"AID",p.K),cl(p,M),p.u&&p.o&&Hm(M,p.u,p.o),A=new bi(p,p.j,A,p.D+1),p.u===null&&(A.J=p.o),b&&(p.i=b.G.concat(p.i)),b=c_(p,A,1e3),A.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),zm(p.h,A),Vm(A,M,b)}function cl(p,b){p.H&&W(p.H,function(A,M){ht(b,M,A)}),p.l&&W({},function(A,M){ht(b,M,A)})}function c_(p,b,A){A=Math.min(p.i.length,A);const M=p.l?l(p.l.Ka,p.l,p):null;e:{var z=p.i;let Ne=-1;for(;;){const Gt=["count="+A];Ne==-1?A>0?(Ne=z[0].g,Gt.push("ofs="+Ne)):Ne=0:Gt.push("ofs="+Ne);let rt=!0;for(let rn=0;rn<A;rn++){var G=z[rn].g;const co=z[rn].map;if(G-=Ne,G<0)Ne=Math.max(0,z[rn].g-100),rt=!1;else try{G="req"+G+"_"||"";try{var ie=co instanceof Map?co:Object.entries(co);for(const[Ra,Ii]of ie){let Ti=Ii;s(Ii)&&(Ti=En(Ii)),Gt.push(G+Ra+"="+encodeURIComponent(Ti))}}catch(Ra){throw Gt.push(G+"type="+encodeURIComponent("_badmap")),Ra}}catch{M&&M(co)}}if(rt){ie=Gt.join("&");break e}}ie=void 0}return p=p.i.splice(0,A),b.G=p,ie}function h_(p){if(!p.g&&!p.v){p.Y=1;var b=p.Da;S||E(),R||(S(),R=!0),C.add(b,p),p.A=0}}function qm(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Ju(l(p.Da,p),p_(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,f_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Ju(l(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Bn(10),bh(this),f_(this))};function Km(p){p.B!=null&&(a.clearTimeout(p.B),p.B=null)}function f_(p){p.g=new bi(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var b=lo(p.na);ht(b,"RID","rpc"),ht(b,"SID",p.M),ht(b,"AID",p.K),ht(b,"CI",p.F?"0":"1"),!p.F&&p.ia&&ht(b,"TO",p.ia),ht(b,"TYPE","xmlhttp"),cl(p,b),p.u&&p.o&&Hm(b,p.u,p.o),p.O&&(p.g.H=p.O);var A=p.g;p=p.ba,A.M=1,A.A=wh(lo(b)),A.u=null,A.R=!0,$x(A,p)}t.Va=function(){this.C!=null&&(this.C=null,bh(this),qm(this),Bn(19))};function Ch(p){p.C!=null&&(a.clearTimeout(p.C),p.C=null)}function d_(p,b){var A=null;if(p.g==b){Ch(p),Km(p),p.g=null;var M=2}else if(Um(p.h,b))A=b.G,Gx(p.h,b),M=1;else return;if(p.I!=0){if(b.o)if(M==1){A=b.u?b.u.length:0,b=Date.now()-b.F;var z=p.D;M=vh(),it(M,new Ox(M,A)),Eh(p)}else h_(p);else if(z=b.m,z==3||z==0&&b.X>0||!(M==1&&OD(p,b)||M==2&&qm(p)))switch(A&&A.length>0&&(b=p.h,b.i=b.i.concat(A)),z){case 1:Ta(p,5);break;case 4:Ta(p,10);break;case 3:Ta(p,6);break;default:Ta(p,2)}}}function p_(p,b){let A=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(A*=2),A*b}function Ta(p,b){if(p.j.info("Error code "+b),b==2){var A=l(p.bb,p),M=p.Ua;const z=!M;M=new Ei(M||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||nl(M,"https"),wh(M),z?AD(M.toString(),A):kD(M.toString(),A)}else Bn(2);p.I=0,p.l&&p.l.pa(b),m_(p),u_(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),Bn(2)):(this.j.info("Failed to ping google.com"),Bn(1))};function m_(p){if(p.I=0,p.ja=[],p.l){const b=qx(p.h);(b.length!=0||p.i.length!=0)&&(m(p.ja,b),m(p.ja,p.i),p.h.i.length=0,d(p.i),p.i.length=0),p.l.oa()}}function v_(p,b,A){var M=A instanceof Ei?lo(A):new Ei(A);if(M.g!="")b&&(M.g=b+"."+M.g),rl(M,M.u);else{var z=a.location;M=z.protocol,b=b?b+"."+z.hostname:z.hostname,z=+z.port;const G=new Ei(null);M&&nl(G,M),b&&(G.g=b),z&&rl(G,z),A&&(G.h=A),M=G}return A=p.G,b=p.wa,A&&b&&ht(M,A,b),ht(M,"VER",p.ka),cl(p,M),M}function g_(p,b,A){if(b&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Aa&&!p.ma?new Tt(new jm({ab:A})):new Tt(p.ma),b.Fa(p.L),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function y_(){}t=y_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Sh(){}Sh.prototype.g=function(p,b){return new sr(p,b)};function sr(p,b){Ge.call(this),this.g=new s_(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(p?p["X-WebChannel-Client-Profile"]=b.sa:p={"X-WebChannel-Client-Profile":b.sa}),this.g.U=p,(p=b&&b.Qb)&&!D(p)&&(this.g.u=p),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.g.G=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new ms(this)}h(sr,Ge),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){Gm(this.g)},sr.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var A={};A.__data__=p,p=A}else this.v&&(A={},A.__data__=En(p),p=A);b.i.push(new _D(b.Ya++,p)),b.I==3&&Eh(b)},sr.prototype.N=function(){this.g.l=null,delete this.j,Gm(this.g),delete this.g,sr.Z.N.call(this)};function w_(p){ba.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){e:{for(const A in b){p=A;break e}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}h(w_,ba);function x_(){Ea.call(this),this.status=1}h(x_,Ea);function ms(p){this.g=p}h(ms,y_),ms.prototype.ra=function(){it(this.g,"a")},ms.prototype.qa=function(p){it(this.g,new w_(p))},ms.prototype.pa=function(p){it(this.g,new x_)},ms.prototype.oa=function(){it(this.g,"b")},Sh.prototype.createWebChannel=Sh.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,zk=function(){return new Sh},Uk=function(){return vh()},$k=Ca,Jy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},gh.NO_ERROR=0,gh.TIMEOUT=8,gh.HTTP_ERROR=6,Vf=gh,Fx.COMPLETE="complete",Bk=Fx,_a.EventType=uo,uo.OPEN="a",uo.CLOSE="b",uo.ERROR="c",uo.MESSAGE="d",Ge.prototype.listen=Ge.prototype.J,kl=_a,Tt.prototype.listenOnce=Tt.prototype.K,Tt.prototype.getLastError=Tt.prototype.Ha,Tt.prototype.getLastErrorCode=Tt.prototype.ya,Tt.prototype.getStatus=Tt.prototype.ca,Tt.prototype.getResponseJson=Tt.prototype.La,Tt.prototype.getResponseText=Tt.prototype.la,Tt.prototype.send=Tt.prototype.ea,Tt.prototype.setWithCredentials=Tt.prototype.Fa,Vk=Tt}).apply(typeof ff<"u"?ff:typeof self<"u"?self:typeof window<"u"?window:{});const WE="@firebase/firestore",jE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es=new Dk("@firebase/firestore");function ks(){return es.logLevel}function ue(t,...e){if(es.logLevel<=ze.DEBUG){const n=e.map(Qw);es.debug(`Firestore (${Hu}): ${t}`,...n)}}function ui(t,...e){if(es.logLevel<=ze.ERROR){const n=e.map(Qw);es.error(`Firestore (${Hu}): ${t}`,...n)}}function Cu(t,...e){if(es.logLevel<=ze.WARN){const n=e.map(Qw);es.warn(`Firestore (${Hu}): ${t}`,...n)}}function Qw(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Wk(t,r,n)}function Wk(t,e,n){let r=`FIRESTORE (${Hu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw ui(r),new Error(r)}function Qe(t,e,n,r){let o="Unexpected state";typeof n=="string"?o=n:r=n,t||Wk(e,o,r)}function ke(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends ju{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(An.UNAUTHENTICATED))}shutdown(){}}class kH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class PH{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Qe(this.o===void 0,42304);let r=this.i;const o=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Zo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zo,e.enqueueRetryable(()=>o(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await o(this.currentUser)})},s=u=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>s(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?s(u):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zo)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Qe(typeof r.accessToken=="string",31837,{l:r}),new jk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qe(e===null||typeof e=="string",2055,{h:e}),new An(e)}}class DH{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=An.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class NH{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new DH(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(An.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class HE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MH{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,hH(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Qe(this.o===void 0,3512);const r=i=>{i.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.m;return this.m=i.token,ue("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const o=i=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>o(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?o(i):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new HE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Qe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new HE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OH(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=OH(40);for(let i=0;i<o.length;++i)r.length<20&&o[i]<n&&(r+=e.charAt(o[i]%62))}return r}}function Be(t,e){return t<e?-1:t>e?1:0}function Zy(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const o=t.charAt(r),i=e.charAt(r);if(o!==i)return lg(o)===lg(i)?Be(o,i):lg(o)?1:-1}return Be(t.length,e.length)}const FH=55296,LH=57343;function lg(t){const e=t.charCodeAt(0);return e>=FH&&e<=LH}function Su(t,e,n){return t.length===e.length&&t.every((r,o)=>n(r,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE="__name__";class vo{constructor(e,n,r){n===void 0?n=0:n>e.length&&be(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&be(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return vo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof vo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let o=0;o<r;o++){const i=vo.compareSegments(e.get(o),n.get(o));if(i!==0)return i}return Be(e.length,n.length)}static compareSegments(e,n){const r=vo.isNumericId(e),o=vo.isNumericId(n);return r&&!o?-1:!r&&o?1:r&&o?vo.extractNumericId(e).compare(vo.extractNumericId(n)):Zy(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ea.fromString(e.substring(4,e.length-2))}}class at extends vo{construct(e,n,r){return new at(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(o=>o.length>0))}return new at(n)}static emptyPath(){return new at([])}}const VH=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends vo{construct(e,n,r){return new yn(e,n,r)}static isValidIdentifier(e){return VH.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===GE}static keyField(){return new yn([GE])}static fromServerFormat(e){const n=[];let r="",o=0;const i=()=>{if(r.length===0)throw new se(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;o<e.length;){const s=e[o];if(s==="\\"){if(o+1===e.length)throw new se(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[o+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new se(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,o+=2}else s==="`"?(a=!a,o++):s!=="."||a?(r+=s,o++):(i(),o++)}if(i(),a)throw new se(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(n)}static emptyPath(){return new yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(at.fromString(e))}static fromName(e){return new we(at.fromString(e).popFirst(5))}static empty(){return new we(at.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&at.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return at.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new at(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t,e,n){if(!n)throw new se(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BH(t,e,n,r){if(e===!0&&r===!0)throw new se(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qE(t){if(!we.isDocumentKey(t))throw new se(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function KE(t){if(we.isDocumentKey(t))throw new se(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Gk(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function xm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":be(12329,{type:typeof t})}function Oo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xm(t);throw new se(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,e){const n={typeString:t};return e&&(n.value=e),n}function lh(t,e){if(!Gk(t))throw new se(Y.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const o=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const a=t[r];if(o&&typeof a!==o){n=`JSON field '${r}' must be a ${o}.`;break}if(i!==void 0&&a!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new se(Y.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=-62135596800,QE=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*QE);return new pt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<XE)throw new se(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/QE}_compareTo(e){return this.seconds===e.seconds?Be(this.nanoseconds,e.nanoseconds):Be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(lh(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-XE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Ht("string",pt._jsonSchemaVersion),seconds:Ht("number"),nanoseconds:Ht("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{static fromTimestamp(e){return new Te(e)}static min(){return new Te(new pt(0,0))}static max(){return new Te(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc=-1;function $H(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,o=Te.fromTimestamp(r===1e9?new pt(n+1,0):new pt(n,r));return new aa(o,we.empty(),e)}function UH(t){return new aa(t.readTime,t.key,Pc)}class aa{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new aa(Te.min(),we.empty(),Pc)}static max(){return new aa(Te.max(),we.empty(),Pc)}}function zH(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=we.comparator(t.documentKey,e.documentKey),n!==0?n:Be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WH="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jH{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gu(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==WH)throw t;ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new J((r,o)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,o)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,o)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof J?n:J.resolve(n)}catch(n){return J.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):J.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):J.reject(n)}static resolve(e){return new J((n,r)=>{n(e)})}static reject(e){return new J((n,r)=>{r(e)})}static waitFor(e){return new J((n,r)=>{let o=0,i=0,a=!1;e.forEach(s=>{++o,s.next(()=>{++i,a&&i===o&&n()},u=>r(u))}),a=!0,i===o&&n()})}static or(e){let n=J.resolve(!1);for(const r of e)n=n.next(o=>o?J.resolve(o):r());return n}static forEach(e,n){const r=[];return e.forEach((o,i)=>{r.push(n.call(this,o,i))}),this.waitFor(r)}static mapArray(e,n){return new J((r,o)=>{const i=e.length,a=new Array(i);let s=0;for(let u=0;u<i;u++){const l=u;n(e[l]).next(c=>{a[l]=c,++s,s===i&&r(a)},c=>o(c))}})}static doWhile(e,n){return new J((r,o)=>{const i=()=>{e()===!0?n().next(()=>{i()},o):r()};i()})}}function HH(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function qu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}_m.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw=-1;function bm(t){return t==null}function Xd(t){return t===0&&1/t==-1/0}function GH(t){return typeof t=="number"&&Number.isInteger(t)&&!Xd(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk="";function qH(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=YE(e)),e=KH(t.get(n),e);return YE(e)}function KH(t,e){let n=e;const r=t.length;for(let o=0;o<r;o++){const i=t.charAt(o);switch(i){case"\0":n+="";break;case qk:n+="";break;default:n+=i}}return n}function YE(t){return t+qk+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){this.comparator=e,this.root=n||mn.EMPTY}insert(e,n){return new It(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return n+r.left.size;o<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new df(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new df(this.root,e,this.comparator,!1)}getReverseIterator(){return new df(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new df(this.root,e,this.comparator,!0)}}class df{constructor(e,n,r,o){this.isReverse=o,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&o&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,n,r,o,i){this.key=e,this.value=n,this.color=r??mn.RED,this.left=o??mn.EMPTY,this.right=i??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,o,i){return new mn(e??this.key,n??this.value,r??this.color,o??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let o=this;const i=r(e,o.key);return o=i<0?o.copy(null,null,null,o.left.insert(e,n,r),null):i===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return mn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw be(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw be(57766)}get value(){throw be(16141)}get color(){throw be(16727)}get left(){throw be(29726)}get right(){throw be(36894)}copy(e,n,r,o,i){return this}insert(e,n,r){return new mn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ZE(this.data.getIterator())}getIteratorFrom(e){return new ZE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Jt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,i=r.getNext().key;if(this.comparator(o,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Jt(this.comparator);return n.data=e,n}}class ZE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new gr([])}unionWith(e){let n=new Jt(yn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Su(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(o){try{return atob(o)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Xk("Invalid base64 string: "+i):i}}(e);return new _n(n)}static fromUint8Array(e){const n=function(o){let i="";for(let a=0;a<o.length;++a)i+=String.fromCharCode(o[a]);return i}(e);return new _n(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const XH=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sa(t){if(Qe(!!t,39018),typeof t=="string"){let e=0;const n=XH.exec(t);if(Qe(!!n,46558,{timestamp:t}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Nt(t.seconds),nanos:Nt(t.nanos)}}function Nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ua(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk="server_timestamp",Yk="__type__",Jk="__previous_value__",Zk="__local_write_time__";function Zw(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Yk])==null?void 0:r.stringValue)===Qk}function Em(t){const e=t.mapValue.fields[Jk];return Zw(e)?Em(e):e}function Dc(t){const e=sa(t.mapValue.fields[Zk].timestampValue);return new pt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QH{constructor(e,n,r,o,i,a,s,u,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=o,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=u,this.useFetchStreams=l,this.isUsingEmulator=c}}const Qd="(default)";class Nc{constructor(e,n){this.projectId=e,this.database=n||Qd}static empty(){return new Nc("","")}get isDefaultDatabase(){return this.database===Qd}isEqual(e){return e instanceof Nc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP="__type__",YH="__max__",pf={mapValue:{}},tP="__vector__",Yd="value";function la(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zw(t)?4:ZH(t)?9007199254740991:JH(t)?10:11:be(28295,{value:t})}function Fo(t,e){if(t===e)return!0;const n=la(t);if(n!==la(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Dc(t).isEqual(Dc(e));case 3:return function(o,i){if(typeof o.timestampValue=="string"&&typeof i.timestampValue=="string"&&o.timestampValue.length===i.timestampValue.length)return o.timestampValue===i.timestampValue;const a=sa(o.timestampValue),s=sa(i.timestampValue);return a.seconds===s.seconds&&a.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(o,i){return ua(o.bytesValue).isEqual(ua(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(o,i){return Nt(o.geoPointValue.latitude)===Nt(i.geoPointValue.latitude)&&Nt(o.geoPointValue.longitude)===Nt(i.geoPointValue.longitude)}(t,e);case 2:return function(o,i){if("integerValue"in o&&"integerValue"in i)return Nt(o.integerValue)===Nt(i.integerValue);if("doubleValue"in o&&"doubleValue"in i){const a=Nt(o.doubleValue),s=Nt(i.doubleValue);return a===s?Xd(a)===Xd(s):isNaN(a)&&isNaN(s)}return!1}(t,e);case 9:return Su(t.arrayValue.values||[],e.arrayValue.values||[],Fo);case 10:case 11:return function(o,i){const a=o.mapValue.fields||{},s=i.mapValue.fields||{};if(JE(a)!==JE(s))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(s[u]===void 0||!Fo(a[u],s[u])))return!1;return!0}(t,e);default:return be(52216,{left:t})}}function Mc(t,e){return(t.values||[]).find(n=>Fo(n,e))!==void 0}function Iu(t,e){if(t===e)return 0;const n=la(t),r=la(e);if(n!==r)return Be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Be(t.booleanValue,e.booleanValue);case 2:return function(i,a){const s=Nt(i.integerValue||i.doubleValue),u=Nt(a.integerValue||a.doubleValue);return s<u?-1:s>u?1:s===u?0:isNaN(s)?isNaN(u)?0:-1:1}(t,e);case 3:return eC(t.timestampValue,e.timestampValue);case 4:return eC(Dc(t),Dc(e));case 5:return Zy(t.stringValue,e.stringValue);case 6:return function(i,a){const s=ua(i),u=ua(a);return s.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const s=i.split("/"),u=a.split("/");for(let l=0;l<s.length&&l<u.length;l++){const c=Be(s[l],u[l]);if(c!==0)return c}return Be(s.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const s=Be(Nt(i.latitude),Nt(a.latitude));return s!==0?s:Be(Nt(i.longitude),Nt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return tC(t.arrayValue,e.arrayValue);case 10:return function(i,a){var f,d,m,g;const s=i.fields||{},u=a.fields||{},l=(f=s[Yd])==null?void 0:f.arrayValue,c=(d=u[Yd])==null?void 0:d.arrayValue,h=Be(((m=l==null?void 0:l.values)==null?void 0:m.length)||0,((g=c==null?void 0:c.values)==null?void 0:g.length)||0);return h!==0?h:tC(l,c)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===pf.mapValue&&a===pf.mapValue)return 0;if(i===pf.mapValue)return 1;if(a===pf.mapValue)return-1;const s=i.fields||{},u=Object.keys(s),l=a.fields||{},c=Object.keys(l);u.sort(),c.sort();for(let h=0;h<u.length&&h<c.length;++h){const f=Zy(u[h],c[h]);if(f!==0)return f;const d=Iu(s[u[h]],l[c[h]]);if(d!==0)return d}return Be(u.length,c.length)}(t.mapValue,e.mapValue);default:throw be(23264,{he:n})}}function eC(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Be(t,e);const n=sa(t),r=sa(e),o=Be(n.seconds,r.seconds);return o!==0?o:Be(n.nanos,r.nanos)}function tC(t,e){const n=t.values||[],r=e.values||[];for(let o=0;o<n.length&&o<r.length;++o){const i=Iu(n[o],r[o]);if(i)return i}return Be(n.length,r.length)}function Tu(t){return e0(t)}function e0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=sa(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ua(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return we.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",o=!0;for(const i of n.values||[])o?o=!1:r+=",",r+=e0(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let o="{",i=!0;for(const a of r)i?i=!1:o+=",",o+=`${a}:${e0(n.fields[a])}`;return o+"}"}(t.mapValue):be(61005,{value:t})}function Bf(t){switch(la(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Em(t);return e?16+Bf(e):16;case 5:return 2*t.stringValue.length;case 6:return ua(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((o,i)=>o+Bf(i),0)}(t.arrayValue);case 10:case 11:return function(r){let o=0;return wa(r.fields,(i,a)=>{o+=i.length+Bf(a)}),o}(t.mapValue);default:throw be(13486,{value:t})}}function nC(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function t0(t){return!!t&&"integerValue"in t}function ex(t){return!!t&&"arrayValue"in t}function rC(t){return!!t&&"nullValue"in t}function oC(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $f(t){return!!t&&"mapValue"in t}function JH(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[eP])==null?void 0:r.stringValue)===tP}function Kl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return wa(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Kl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Kl(t.arrayValue.values[n]);return e}return{...t}}function ZH(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===YH}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.value=e}static empty(){return new Yn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$f(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kl(n)}setAll(e){let n=yn.emptyPath(),r={},o=[];e.forEach((a,s)=>{if(!n.isImmediateParentOf(s)){const u=this.getFieldsMap(n);this.applyChanges(u,r,o),r={},o=[],n=s.popLast()}a?r[s.lastSegment()]=Kl(a):o.push(s.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,o)}delete(e){const n=this.field(e.popLast());$f(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=n.mapValue.fields[e.get(r)];$f(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,r){wa(n,(o,i)=>e[o]=i);for(const o of r)delete e[o]}clone(){return new Yn(Kl(this.value))}}function nP(t){const e=[];return wa(t.fields,(n,r)=>{const o=new yn([n]);if($f(r)){const i=nP(r.mapValue).fields;if(i.length===0)e.push(o);else for(const a of i)e.push(o.child(a))}else e.push(o)}),new gr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n,r,o,i,a,s){this.key=e,this.documentType=n,this.version=r,this.readTime=o,this.createTime=i,this.data=a,this.documentState=s}static newInvalidDocument(e){return new Dn(e,0,Te.min(),Te.min(),Te.min(),Yn.empty(),0)}static newFoundDocument(e,n,r,o){return new Dn(e,1,n,Te.min(),r,o,0)}static newNoDocument(e,n){return new Dn(e,2,n,Te.min(),Te.min(),Yn.empty(),0)}static newUnknownDocument(e,n){return new Dn(e,3,n,Te.min(),Te.min(),Yn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,n){this.position=e,this.inclusive=n}}function iC(t,e,n){let r=0;for(let o=0;o<t.position.length;o++){const i=e[o],a=t.position[o];if(i.field.isKeyField()?r=we.comparator(we.fromName(a.referenceValue),n.key):r=Iu(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function aC(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fo(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,n="asc"){this.field=e,this.dir=n}}function eG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{}class jt extends rP{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new nG(e,n,r):n==="array-contains"?new iG(e,r):n==="in"?new aG(e,r):n==="not-in"?new sG(e,r):n==="array-contains-any"?new uG(e,r):new jt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new rG(e,r):new oG(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Iu(n,this.value)):n!==null&&la(this.value)===la(n)&&this.matchesComparison(Iu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oo extends rP{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new oo(e,n)}matches(e){return oP(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function oP(t){return t.op==="and"}function iP(t){return tG(t)&&oP(t)}function tG(t){for(const e of t.filters)if(e instanceof oo)return!1;return!0}function n0(t){if(t instanceof jt)return t.field.canonicalString()+t.op.toString()+Tu(t.value);if(iP(t))return t.filters.map(e=>n0(e)).join(",");{const e=t.filters.map(n=>n0(n)).join(",");return`${t.op}(${e})`}}function aP(t,e){return t instanceof jt?function(r,o){return o instanceof jt&&r.op===o.op&&r.field.isEqual(o.field)&&Fo(r.value,o.value)}(t,e):t instanceof oo?function(r,o){return o instanceof oo&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce((i,a,s)=>i&&aP(a,o.filters[s]),!0):!1}(t,e):void be(19439)}function sP(t){return t instanceof jt?function(n){return`${n.field.canonicalString()} ${n.op} ${Tu(n.value)}`}(t):t instanceof oo?function(n){return n.op.toString()+" {"+n.getFilters().map(sP).join(" ,")+"}"}(t):"Filter"}class nG extends jt{constructor(e,n,r){super(e,n,r),this.key=we.fromName(r.referenceValue)}matches(e){const n=we.comparator(e.key,this.key);return this.matchesComparison(n)}}class rG extends jt{constructor(e,n){super(e,"in",n),this.keys=uP("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class oG extends jt{constructor(e,n){super(e,"not-in",n),this.keys=uP("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function uP(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>we.fromName(r.referenceValue))}class iG extends jt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ex(n)&&Mc(n.arrayValue,this.value)}}class aG extends jt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Mc(this.value.arrayValue,n)}}class sG extends jt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Mc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Mc(this.value.arrayValue,n)}}class uG extends jt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ex(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Mc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lG{constructor(e,n=null,r=[],o=[],i=null,a=null,s=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=o,this.limit=i,this.startAt=a,this.endAt=s,this.Te=null}}function sC(t,e=null,n=[],r=[],o=null,i=null,a=null){return new lG(t,e,n,r,o,i,a)}function tx(t){const e=ke(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>n0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),bm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Tu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Tu(r)).join(",")),e.Te=n}return e.Te}function nx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!eG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!aP(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!aC(t.startAt,e.startAt)&&aC(t.endAt,e.endAt)}function r0(t){return we.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,n=null,r=[],o=[],i=null,a="F",s=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=o,this.limit=i,this.limitType=a,this.startAt=s,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function cG(t,e,n,r,o,i,a,s){return new ch(t,e,n,r,o,i,a,s)}function rx(t){return new ch(t)}function uC(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lP(t){return t.collectionGroup!==null}function Xl(t){const e=ke(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let s=new Jt(yn.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(s=s.add(l.field))})}),s})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Zd(i,r))}),n.has(yn.keyField().canonicalString())||e.Ie.push(new Zd(yn.keyField(),r))}return e.Ie}function ko(t){const e=ke(t);return e.Ee||(e.Ee=hG(e,Xl(t))),e.Ee}function hG(t,e){if(t.limitType==="F")return sC(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(o=>{const i=o.dir==="desc"?"asc":"desc";return new Zd(o.field,i)});const n=t.endAt?new Jd(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Jd(t.startAt.position,t.startAt.inclusive):null;return sC(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function o0(t,e){const n=t.filters.concat([e]);return new ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function i0(t,e,n){return new ch(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cm(t,e){return nx(ko(t),ko(e))&&t.limitType===e.limitType}function cP(t){return`${tx(ko(t))}|lt:${t.limitType}`}function Ps(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(o=>sP(o)).join(", ")}]`),bm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(o=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(o)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(o=>Tu(o)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(o=>Tu(o)).join(",")),`Target(${r})`}(ko(t))}; limitType=${t.limitType})`}function Sm(t,e){return e.isFoundDocument()&&function(r,o){const i=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):we.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,o){for(const i of Xl(r))if(!i.field.isKeyField()&&o.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,o){for(const i of r.filters)if(!i.matches(o))return!1;return!0}(t,e)&&function(r,o){return!(r.startAt&&!function(a,s,u){const l=iC(a,s,u);return a.inclusive?l<=0:l<0}(r.startAt,Xl(r),o)||r.endAt&&!function(a,s,u){const l=iC(a,s,u);return a.inclusive?l>=0:l>0}(r.endAt,Xl(r),o))}(t,e)}function fG(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hP(t){return(e,n)=>{let r=!1;for(const o of Xl(t)){const i=dG(o,e,n);if(i!==0)return i;r=r||o.field.isKeyField()}return 0}}function dG(t,e,n){const r=t.field.isKeyField()?we.comparator(e.key,n.key):function(i,a,s){const u=a.data.field(i),l=s.data.field(i);return u!==null&&l!==null?Iu(u,l):be(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return be(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[o,i]of r)if(this.equalsFn(o,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<o.length;i++)if(this.equalsFn(o[i][0],e))return void(o[i]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[n]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){wa(this.inner,(n,r)=>{for(const[o,i]of r)e(o,i)})}isEmpty(){return Kk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pG=new It(we.comparator);function li(){return pG}const fP=new It(we.comparator);function Pl(...t){let e=fP;for(const n of t)e=e.insert(n.key,n);return e}function dP(t){let e=fP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function za(){return Ql()}function pP(){return Ql()}function Ql(){return new ls(t=>t.toString(),(t,e)=>t.isEqual(e))}const mG=new It(we.comparator),vG=new Jt(we.comparator);function $e(...t){let e=vG;for(const n of t)e=e.add(n);return e}const gG=new Jt(Be);function yG(){return gG}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xd(e)?"-0":e}}function mP(t){return{integerValue:""+t}}function wG(t,e){return GH(e)?mP(e):ox(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(){this._=void 0}}function xG(t,e,n){return t instanceof ep?function(o,i){const a={fields:{[Yk]:{stringValue:Qk},[Zk]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return i&&Zw(i)&&(i=Em(i)),i&&(a.fields[Jk]=i),{mapValue:a}}(n,e):t instanceof Oc?gP(t,e):t instanceof Fc?yP(t,e):function(o,i){const a=vP(o,i),s=lC(a)+lC(o.Ae);return t0(a)&&t0(o.Ae)?mP(s):ox(o.serializer,s)}(t,e)}function _G(t,e,n){return t instanceof Oc?gP(t,e):t instanceof Fc?yP(t,e):n}function vP(t,e){return t instanceof tp?function(r){return t0(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ep extends Im{}class Oc extends Im{constructor(e){super(),this.elements=e}}function gP(t,e){const n=wP(e);for(const r of t.elements)n.some(o=>Fo(o,r))||n.push(r);return{arrayValue:{values:n}}}class Fc extends Im{constructor(e){super(),this.elements=e}}function yP(t,e){let n=wP(e);for(const r of t.elements)n=n.filter(o=>!Fo(o,r));return{arrayValue:{values:n}}}class tp extends Im{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function lC(t){return Nt(t.integerValue||t.doubleValue)}function wP(t){return ex(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function bG(t,e){return t.field.isEqual(e.field)&&function(r,o){return r instanceof Oc&&o instanceof Oc||r instanceof Fc&&o instanceof Fc?Su(r.elements,o.elements,Fo):r instanceof tp&&o instanceof tp?Fo(r.Ae,o.Ae):r instanceof ep&&o instanceof ep}(t.transform,e.transform)}class EG{constructor(e,n){this.version=e,this.transformResults=n}}class no{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new no}static exists(e){return new no(void 0,e)}static updateTime(e){return new no(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tm{}function xP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ix(t.key,no.none()):new hh(t.key,t.data,no.none());{const n=t.data,r=Yn.empty();let o=new Jt(yn.comparator);for(let i of e.fields)if(!o.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),o=o.add(i)}return new xa(t.key,r,new gr(o.toArray()),no.none())}}function CG(t,e,n){t instanceof hh?function(o,i,a){const s=o.value.clone(),u=hC(o.fieldTransforms,i,a.transformResults);s.setAll(u),i.convertToFoundDocument(a.version,s).setHasCommittedMutations()}(t,e,n):t instanceof xa?function(o,i,a){if(!Uf(o.precondition,i))return void i.convertToUnknownDocument(a.version);const s=hC(o.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(_P(o)),u.setAll(s),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(o,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Yl(t,e,n,r){return t instanceof hh?function(i,a,s,u){if(!Uf(i.precondition,a))return s;const l=i.value.clone(),c=fC(i.fieldTransforms,u,a);return l.setAll(c),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof xa?function(i,a,s,u){if(!Uf(i.precondition,a))return s;const l=fC(i.fieldTransforms,u,a),c=a.data;return c.setAll(_P(i)),c.setAll(l),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),s===null?null:s.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,a,s){return Uf(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):s}(t,e,n)}function SG(t,e){let n=null;for(const r of t.fieldTransforms){const o=e.data.field(r.field),i=vP(r.transform,o||null);i!=null&&(n===null&&(n=Yn.empty()),n.set(r.field,i))}return n||null}function cC(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Su(r,o,(i,a)=>bG(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hh extends Tm{constructor(e,n,r,o=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class xa extends Tm{constructor(e,n,r,o,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=o,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _P(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function hC(t,e,n){const r=new Map;Qe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let o=0;o<n.length;o++){const i=t[o],a=i.transform,s=e.data.field(i.field);r.set(i.field,_G(a,s,n[o]))}return r}function fC(t,e,n){const r=new Map;for(const o of t){const i=o.transform,a=n.data.field(o.field);r.set(o.field,xG(i,a,e))}return r}class ix extends Tm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IG extends Tm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TG{constructor(e,n,r,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const i=this.mutations[o];i.key.isEqual(e.key)&&CG(i,e,r[o])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Yl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Yl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=pP();return this.mutations.forEach(o=>{const i=e.get(o.key),a=i.overlayedDocument;let s=this.applyToLocalView(a,i.mutatedFields);s=n.has(o.key)?null:s;const u=xP(a,s);u!==null&&r.set(o.key,u),a.isValidDocument()||a.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$e())}isEqual(e){return this.batchId===e.batchId&&Su(this.mutations,e.mutations,(n,r)=>cC(n,r))&&Su(this.baseMutations,e.baseMutations,(n,r)=>cC(n,r))}}class ax{constructor(e,n,r,o){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=o}static from(e,n,r){Qe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let o=function(){return mG}();const i=e.mutations;for(let a=0;a<i.length;a++)o=o.insert(i[a].key,r[a].version);return new ax(e,n,r,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RG{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AG{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt,Ue;function kG(t){switch(t){case Y.OK:return be(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return be(15467,{code:t})}}function bP(t){if(t===void 0)return ui("GRPC error has no .code"),Y.UNKNOWN;switch(t){case Bt.OK:return Y.OK;case Bt.CANCELLED:return Y.CANCELLED;case Bt.UNKNOWN:return Y.UNKNOWN;case Bt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Bt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Bt.INTERNAL:return Y.INTERNAL;case Bt.UNAVAILABLE:return Y.UNAVAILABLE;case Bt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Bt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Bt.NOT_FOUND:return Y.NOT_FOUND;case Bt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Bt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Bt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Bt.ABORTED:return Y.ABORTED;case Bt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Bt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Bt.DATA_LOSS:return Y.DATA_LOSS;default:return be(39323,{code:t})}}(Ue=Bt||(Bt={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DG=new ea([4294967295,4294967295],0);function dC(t){const e=PG().encode(t),n=new Lk;return n.update(e),new Uint8Array(n.digest())}function pC(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ea([n,r],0),new ea([o,i],0)]}class sx{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Dl(`Invalid padding: ${n}`);if(r<0)throw new Dl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Dl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Dl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ea.fromNumber(this.ge)}ye(e,n,r){let o=e.add(n.multiply(ea.fromNumber(r)));return o.compare(DG)===1&&(o=new ea([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=dC(e),[r,o]=pC(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,o,i);if(!this.we(a))return!1}return!0}static create(e,n,r){const o=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new sx(i,o,n);return r.forEach(s=>a.insert(s)),a}insert(e){if(this.ge===0)return;const n=dC(e),[r,o]=pC(n);for(let i=0;i<this.hashCount;i++){const a=this.ye(r,o,i);this.Se(a)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Dl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,n,r,o,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const o=new Map;return o.set(e,fh.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Rm(Te.min(),o,new It(Be),li(),$e())}}class fh{constructor(e,n,r,o,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fh(r,n,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,n,r,o){this.be=e,this.removedTargetIds=n,this.key=r,this.De=o}}class EP{constructor(e,n){this.targetId=e,this.Ce=n}}class CP{constructor(e,n,r=_n.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=o}}class mC{constructor(){this.ve=0,this.Fe=vC(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=$e(),n=$e(),r=$e();return this.Fe.forEach((o,i)=>{switch(i){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:r=r.add(o);break;default:be(38017,{changeType:i})}}),new fh(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=vC()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Qe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class NG{constructor(e){this.Ge=e,this.ze=new Map,this.je=li(),this.Je=mf(),this.He=mf(),this.Ye=new It(Be)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:be(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,o)=>{this.rt(o)&&n(o)})}st(e){const n=e.targetId,r=e.Ce.count,o=this.ot(n);if(o){const i=o.target;if(r0(i))if(r===0){const a=new we(i.path);this.et(n,a,Dn.newNoDocument(a,Te.min()))}else Qe(r===1,20013,{expectedCount:r});else{const a=this._t(n);if(a!==r){const s=this.ut(e),u=s?this.ct(s,e,a):1;if(u!==0){this.it(n);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,l)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:i=0}=n;let a,s;try{a=ua(r).toUint8Array()}catch(u){if(u instanceof Xk)return Cu("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{s=new sx(a,o,i)}catch(u){return Cu(u instanceof Dl?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return s.ge===0?null:s}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let o=0;return r.forEach(i=>{const a=this.Ge.ht(),s=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(s)||(this.et(n,i,null),o++)}),o}Tt(e){const n=new Map;this.ze.forEach((i,a)=>{const s=this.ot(a);if(s){if(i.current&&r0(s.target)){const u=new we(s.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Dn.newNoDocument(u,e))}i.Be&&(n.set(a,i.ke()),i.qe())}});let r=$e();this.He.forEach((i,a)=>{let s=!0;a.forEachWhile(u=>{const l=this.ot(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(s=!1,!1)}),s&&(r=r.add(i))}),this.je.forEach((i,a)=>a.setReadTime(e));const o=new Rm(e,n,this.Ye,this.je,r);return this.je=li(),this.Je=mf(),this.He=mf(),this.Ye=new It(Be),o}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,n)?o.Qe(n,1):o.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new mC,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Jt(Be),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Jt(Be),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ue("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mC),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function mf(){return new It(we.comparator)}function vC(){return new It(we.comparator)}const MG={asc:"ASCENDING",desc:"DESCENDING"},OG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FG={and:"AND",or:"OR"};class LG{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function a0(t,e){return t.useProto3Json||bm(e)?e:{value:e}}function np(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function SP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VG(t,e){return np(t,e.toTimestamp())}function Po(t){return Qe(!!t,49232),Te.fromTimestamp(function(n){const r=sa(n);return new pt(r.seconds,r.nanos)}(t))}function ux(t,e){return s0(t,e).canonicalString()}function s0(t,e){const n=function(o){return new at(["projects",o.projectId,"databases",o.database])}(t).child("documents");return e===void 0?n:n.child(e)}function IP(t){const e=at.fromString(t);return Qe(PP(e),10190,{key:e.toString()}),e}function u0(t,e){return ux(t.databaseId,e.path)}function cg(t,e){const n=IP(e);if(n.get(1)!==t.databaseId.projectId)throw new se(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new we(RP(n))}function TP(t,e){return ux(t.databaseId,e)}function BG(t){const e=IP(t);return e.length===4?at.emptyPath():RP(e)}function l0(t){return new at(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function RP(t){return Qe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function gC(t,e,n){return{name:u0(t,e),fields:n.value.mapValue.fields}}function $G(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:be(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],i=function(l,c){return l.useProto3Json?(Qe(c===void 0||typeof c=="string",58123),_n.fromBase64String(c||"")):(Qe(c===void 0||c instanceof Buffer||c instanceof Uint8Array,16193),_n.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,s=a&&function(l){const c=l.code===void 0?Y.UNKNOWN:bP(l.code);return new se(c,l.message||"")}(a);n=new CP(r,o,i,s||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=cg(t,r.document.name),i=Po(r.document.updateTime),a=r.document.createTime?Po(r.document.createTime):Te.min(),s=new Yn({mapValue:{fields:r.document.fields}}),u=Dn.newFoundDocument(o,i,a,s),l=r.targetIds||[],c=r.removedTargetIds||[];n=new zf(l,c,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=cg(t,r.document),i=r.readTime?Po(r.readTime):Te.min(),a=Dn.newNoDocument(o,i),s=r.removedTargetIds||[];n=new zf([],s,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=cg(t,r.document),i=r.removedTargetIds||[];n=new zf([],i,o,null)}else{if(!("filter"in e))return be(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:i}=r,a=new AG(o,i),s=r.targetId;n=new EP(s,a)}}return n}function UG(t,e){let n;if(e instanceof hh)n={update:gC(t,e.key,e.value)};else if(e instanceof ix)n={delete:u0(t,e.key)};else if(e instanceof xa)n={update:gC(t,e.key,e.data),updateMask:QG(e.fieldMask)};else{if(!(e instanceof IG))return be(16599,{Vt:e.type});n={verify:u0(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const s=a.transform;if(s instanceof ep)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof Oc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof Fc)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof tp)return{fieldPath:a.field.canonicalString(),increment:s.Ae};throw be(20930,{transform:a.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(o,i){return i.updateTime!==void 0?{updateTime:VG(o,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:be(27497)}(t,e.precondition)),n}function zG(t,e){return t&&t.length>0?(Qe(e!==void 0,14353),t.map(n=>function(o,i){let a=o.updateTime?Po(o.updateTime):Po(i);return a.isEqual(Te.min())&&(a=Po(i)),new EG(a,o.transformResults||[])}(n,e))):[]}function WG(t,e){return{documents:[TP(t,e.path)]}}function jG(t,e){const n={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=TP(t,o);const i=function(l){if(l.length!==0)return kP(oo.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(l){if(l.length!==0)return l.map(c=>function(f){return{field:Ds(f.field),direction:qG(f.dir)}}(c))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const s=a0(t,e.limit);return s!==null&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:n,parent:o}}function HG(t){let e=BG(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let o=null;if(r>0){Qe(r===1,65062);const c=n.from[0];c.allDescendants?o=c.collectionId:e=e.child(c.collectionId)}let i=[];n.where&&(i=function(h){const f=AP(h);return f instanceof oo&&iP(f)?f.getFilters():[f]}(n.where));let a=[];n.orderBy&&(a=function(h){return h.map(f=>function(m){return new Zd(Ns(m.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(n.orderBy));let s=null;n.limit&&(s=function(h){let f;return f=typeof h=="object"?h.value:h,bm(f)?null:f}(n.limit));let u=null;n.startAt&&(u=function(h){const f=!!h.before,d=h.values||[];return new Jd(d,f)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const f=!h.before,d=h.values||[];return new Jd(d,f)}(n.endAt)),cG(e,o,a,i,s,"F",u,l)}function GG(t,e){const n=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return be(28987,{purpose:o})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function AP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ns(n.unaryFilter.field);return jt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=Ns(n.unaryFilter.field);return jt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ns(n.unaryFilter.field);return jt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ns(n.unaryFilter.field);return jt.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return be(61313);default:return be(60726)}}(t):t.fieldFilter!==void 0?function(n){return jt.create(Ns(n.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return be(58110);default:return be(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return oo.create(n.compositeFilter.filters.map(r=>AP(r)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return be(1026)}}(n.compositeFilter.op))}(t):be(30097,{filter:t})}function qG(t){return MG[t]}function KG(t){return OG[t]}function XG(t){return FG[t]}function Ds(t){return{fieldPath:t.canonicalString()}}function Ns(t){return yn.fromServerFormat(t.fieldPath)}function kP(t){return t instanceof jt?function(n){if(n.op==="=="){if(oC(n.value))return{unaryFilter:{field:Ds(n.field),op:"IS_NAN"}};if(rC(n.value))return{unaryFilter:{field:Ds(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(oC(n.value))return{unaryFilter:{field:Ds(n.field),op:"IS_NOT_NAN"}};if(rC(n.value))return{unaryFilter:{field:Ds(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ds(n.field),op:KG(n.op),value:n.value}}}(t):t instanceof oo?function(n){const r=n.getFilters().map(o=>kP(o));return r.length===1?r[0]:{compositeFilter:{op:XG(n.op),filters:r}}}(t):be(54877,{filter:t})}function QG(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function PP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n,r,o,i=Te.min(),a=Te.min(),s=_n.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=u}withSequenceNumber(e){return new $i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YG{constructor(e){this.yt=e}}function JG(t){const e=HG({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?i0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZG{constructor(){this.Cn=new eq}addToCollectionParentIndex(e,n){return this.Cn.add(n),J.resolve()}getCollectionParents(e,n){return J.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return J.resolve()}deleteFieldIndex(e,n){return J.resolve()}deleteAllFieldIndexes(e){return J.resolve()}createTargetIndexes(e,n){return J.resolve()}getDocumentsMatchingTarget(e,n){return J.resolve(null)}getIndexType(e,n){return J.resolve(0)}getFieldIndexes(e,n){return J.resolve([])}getNextCollectionGroupToUpdate(e){return J.resolve(null)}getMinOffset(e,n){return J.resolve(aa.min())}getMinOffsetFromCollectionGroup(e,n){return J.resolve(aa.min())}updateCollectionGroup(e,n,r){return J.resolve()}updateIndexEntries(e,n){return J.resolve()}}class eq{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n]||new Jt(at.comparator),i=!o.has(r);return this.index[n]=o.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),o=this.index[n];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Jt(at.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DP=41943040;class qn{static withCacheSize(e){return new qn(e,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qn.DEFAULT_COLLECTION_PERCENTILE=10,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qn.DEFAULT=new qn(DP,qn.DEFAULT_COLLECTION_PERCENTILE,qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qn.DISABLED=new qn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ru(0)}static cr(){return new Ru(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC="LruGarbageCollector",tq=1048576;function xC([t,e],[n,r]){const o=Be(t,n);return o===0?Be(e,r):o}class nq{constructor(e){this.Ir=e,this.buffer=new Jt(xC),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();xC(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rq{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ue(wC,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qu(n)?ue(wC,"Ignoring IndexedDB error during garbage collection: ",n):await Gu(n)}await this.Vr(3e5)})}}class oq{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return J.resolve(_m.ce);const r=new nq(n);return this.mr.forEachTarget(e,o=>r.Ar(o.sequenceNumber)).next(()=>this.mr.pr(e,o=>r.Ar(o))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ue("LruGarbageCollector","Garbage collection skipped; disabled"),J.resolve(yC)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yC):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,o,i,a,s,u,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),o=this.params.maximumSequenceNumbersToCollect):o=h,a=Date.now(),this.nthSequenceNumber(e,o))).next(h=>(r=h,s=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),ks()<=ze.DEBUG&&ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-c}ms
	Determined least recently used ${o} in `+(s-a)+`ms
	Removed ${i} targets in `+(u-s)+`ms
	Removed ${h} documents in `+(l-u)+`ms
Total Duration: ${l-c}ms`),J.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:i,documentsRemoved:h})))}}function iq(t,e){return new oq(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aq{constructor(){this.changes=new ls(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?J.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uq{constructor(e,n,r,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(o=>(r=o,this.remoteDocumentCache.getEntry(e,n))).next(o=>(r!==null&&Yl(r.mutation,o,gr.empty(),pt.now()),o))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,$e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=$e()){const o=za();return this.populateOverlays(e,o,n).next(()=>this.computeViews(e,n,o,r).next(i=>{let a=Pl();return i.forEach((s,u)=>{a=a.insert(s,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=za();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,$e()))}populateOverlays(e,n,r){const o=[];return r.forEach(i=>{n.has(i)||o.push(i)}),this.documentOverlayCache.getOverlays(e,o).next(i=>{i.forEach((a,s)=>{n.set(a,s)})})}computeViews(e,n,r,o){let i=li();const a=Ql(),s=function(){return Ql()}();return n.forEach((u,l)=>{const c=r.get(l.key);o.has(l.key)&&(c===void 0||c.mutation instanceof xa)?i=i.insert(l.key,l):c!==void 0?(a.set(l.key,c.mutation.getFieldMask()),Yl(c.mutation,l,c.mutation.getFieldMask(),pt.now())):a.set(l.key,gr.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((l,c)=>a.set(l,c)),n.forEach((l,c)=>s.set(l,new sq(c,a.get(l)??null))),s))}recalculateAndSaveOverlays(e,n){const r=Ql();let o=new It((a,s)=>a-s),i=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const s of a)s.keys().forEach(u=>{const l=n.get(u);if(l===null)return;let c=r.get(u)||gr.empty();c=s.applyToLocalView(l,c),r.set(u,c);const h=(o.get(s.batchId)||$e()).add(u);o=o.insert(s.batchId,h)})}).next(()=>{const a=[],s=o.getReverseIterator();for(;s.hasNext();){const u=s.getNext(),l=u.key,c=u.value,h=pP();c.forEach(f=>{if(!i.has(f)){const d=xP(n.get(f),r.get(f));d!==null&&h.set(f,d),i=i.add(f)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return J.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,o){return function(a){return we.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):lP(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,o):this.getDocumentsMatchingCollectionQuery(e,n,r,o)}getNextDocuments(e,n,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,o).next(i=>{const a=o-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,o-i.size):J.resolve(za());let s=Pc,u=i;return a.next(l=>J.forEach(l,(c,h)=>(s<h.largestBatchId&&(s=h.largestBatchId),i.get(c)?J.resolve():this.remoteDocumentCache.getEntry(e,c).next(f=>{u=u.insert(c,f)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,u,l,$e())).next(c=>({batchId:s,changes:dP(c)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new we(n)).next(r=>{let o=Pl();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})}getDocumentsMatchingCollectionGroupQuery(e,n,r,o){const i=n.collectionGroup;let a=Pl();return this.indexManager.getCollectionParents(e,i).next(s=>J.forEach(s,u=>{const l=function(h,f){return new ch(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r,o).next(c=>{c.forEach((h,f)=>{a=a.insert(h,f)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,o){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,o))).next(a=>{i.forEach((u,l)=>{const c=l.getKey();a.get(c)===null&&(a=a.insert(c,Dn.newInvalidDocument(c)))});let s=Pl();return a.forEach((u,l)=>{const c=i.get(u);c!==void 0&&Yl(c.mutation,l,gr.empty(),pt.now()),Sm(n,l)&&(s=s.insert(u,l))}),s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lq{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return J.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(o){return{id:o.id,version:o.version,createTime:Po(o.createTime)}}(n)),J.resolve()}getNamedQuery(e,n){return J.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(o){return{name:o.name,query:JG(o.bundledQuery),readTime:Po(o.readTime)}}(n)),J.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(){this.overlays=new It(we.comparator),this.qr=new Map}getOverlay(e,n){return J.resolve(this.overlays.get(n))}getOverlays(e,n){const r=za();return J.forEach(n,o=>this.getOverlay(e,o).next(i=>{i!==null&&r.set(o,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((o,i)=>{this.St(e,n,i)}),J.resolve()}removeOverlaysForBatchId(e,n,r){const o=this.qr.get(r);return o!==void 0&&(o.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),J.resolve()}getOverlaysForCollection(e,n,r){const o=za(),i=n.length+1,a=new we(n.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const u=s.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&u.largestBatchId>r&&o.set(u.getKey(),u)}return J.resolve(o)}getOverlaysForCollectionGroup(e,n,r,o){let i=new It((l,c)=>l-c);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let c=i.get(l.largestBatchId);c===null&&(c=za(),i=i.insert(l.largestBatchId,c)),c.set(l.getKey(),l)}}const s=za(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,c)=>s.set(l,c)),!(s.size()>=o)););return J.resolve(s)}St(e,n,r){const o=this.overlays.get(r.key);if(o!==null){const a=this.qr.get(o.largestBatchId).delete(r.key);this.qr.set(o.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new RG(n,r));let i=this.qr.get(n);i===void 0&&(i=$e(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hq{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return J.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,J.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(){this.Qr=new Jt(an.$r),this.Ur=new Jt(an.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new an(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new an(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new we(new at([])),r=new an(n,e),o=new an(n,e+1),i=[];return this.Ur.forEachInRange([r,o],a=>{this.Gr(a),i.push(a.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new we(new at([])),r=new an(n,e),o=new an(n,e+1);let i=$e();return this.Ur.forEachInRange([r,o],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new an(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class an{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return we.comparator(e.key,n.key)||Be(e.Yr,n.Yr)}static Kr(e,n){return Be(e.Yr,n.Yr)||we.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fq{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Jt(an.$r)}checkEmpty(e){return J.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,o){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new TG(i,n,r,o);this.mutationQueue.push(a);for(const s of o)this.Zr=this.Zr.add(new an(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return J.resolve(a)}lookupMutationBatch(e,n){return J.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,o=this.ei(r),i=o<0?0:o;return J.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return J.resolve(this.mutationQueue.length===0?Jw:this.tr-1)}getAllMutationBatches(e){return J.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new an(n,0),o=new an(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,o],a=>{const s=this.Xr(a.Yr);i.push(s)}),J.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Jt(Be);return n.forEach(o=>{const i=new an(o,0),a=new an(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,a],s=>{r=r.add(s.Yr)})}),J.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,o=r.length+1;let i=r;we.isDocumentKey(i)||(i=i.child(""));const a=new an(new we(i),0);let s=new Jt(Be);return this.Zr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===o&&(s=s.add(u.Yr)),!0)},a),J.resolve(this.ti(s))}ti(e){const n=[];return e.forEach(r=>{const o=this.Xr(r);o!==null&&n.push(o)}),n}removeMutationBatch(e,n){Qe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return J.forEach(n.mutations,o=>{const i=new an(o.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new an(n,0),o=this.Zr.firstAfterOrEqual(r);return J.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,J.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dq{constructor(e){this.ri=e,this.docs=function(){return new It(we.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,o=this.docs.get(r),i=o?o.size:0,a=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return J.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(n))}getEntries(e,n){let r=li();return n.forEach(o=>{const i=this.docs.get(o);r=r.insert(o,i?i.document.mutableCopy():Dn.newInvalidDocument(o))}),J.resolve(r)}getDocumentsMatchingQuery(e,n,r,o){let i=li();const a=n.path,s=new we(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(s);for(;u.hasNext();){const{key:l,value:{document:c}}=u.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||zH(UH(c),r)<=0||(o.has(c.key)||Sm(n,c))&&(i=i.insert(c.key,c.mutableCopy()))}return J.resolve(i)}getAllFromCollectionGroup(e,n,r,o){be(9500)}ii(e,n){return J.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pq(this)}getSize(e){return J.resolve(this.size)}}class pq extends aq{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,o)=>{o.isValidDocument()?n.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(r)}),J.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(e){this.persistence=e,this.si=new ls(n=>tx(n),nx),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.oi=0,this._i=new lx,this.targetCount=0,this.ai=Ru.ur()}forEachTarget(e,n){return this.si.forEach((r,o)=>n(o)),J.resolve()}getLastRemoteSnapshotVersion(e){return J.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return J.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),J.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),J.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ru(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,J.resolve()}updateTargetData(e,n){return this.Pr(n),J.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,J.resolve()}removeTargets(e,n,r){let o=0;const i=[];return this.si.forEach((a,s)=>{s.sequenceNumber<=n&&r.get(s.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),o++)}),J.waitFor(i).next(()=>o)}getTargetCount(e){return J.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return J.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),J.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const o=this.persistence.referenceDelegate,i=[];return o&&n.forEach(a=>{i.push(o.markPotentiallyOrphaned(e,a))}),J.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),J.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return J.resolve(r)}containsKey(e,n){return J.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,n){this.ui={},this.overlays={},this.ci=new _m(0),this.li=!1,this.li=!0,this.hi=new hq,this.referenceDelegate=e(this),this.Pi=new mq(this),this.indexManager=new ZG,this.remoteDocumentCache=function(o){return new dq(o)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new YG(n),this.Ii=new lq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new cq,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new fq(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ue("MemoryPersistence","Starting transaction:",e);const o=new vq(this.ci.next());return this.referenceDelegate.Ei(),r(o).next(i=>this.referenceDelegate.di(o).next(()=>i)).toPromise().then(i=>(o.raiseOnCommittedEvent(),i))}Ai(e,n){return J.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class vq extends jH{constructor(e){super(),this.currentSequenceNumber=e}}class cx{constructor(e){this.persistence=e,this.Ri=new lx,this.Vi=null}static mi(e){return new cx(e)}get fi(){if(this.Vi)return this.Vi;throw be(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),J.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),J.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),J.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(o=>this.fi.add(o.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(o=>{o.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return J.forEach(this.fi,r=>{const o=we.fromPath(r);return this.gi(e,o).next(i=>{i||n.removeEntry(o,Te.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return J.or([()=>J.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class rp{constructor(e,n){this.persistence=e,this.pi=new ls(r=>qH(r.path),(r,o)=>r.isEqual(o)),this.garbageCollector=iq(this,n)}static mi(e,n){return new rp(e,n)}Ei(){}di(e){return J.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(o=>r+o))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return J.forEach(this.pi,(r,o)=>this.br(e,r,o).next(i=>i?J.resolve():n(o)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const o=this.persistence.getRemoteDocumentCache(),i=o.newChangeBuffer();return o.ii(e,a=>this.br(e,a,n).next(s=>{s||(r++,i.removeEntry(a,Te.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),J.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),J.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),J.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),J.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Bf(e.data.value)),n}br(e,n,r){return J.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.pi.get(n);return J.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,n,r,o){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=o}static As(e,n){let r=$e(),o=$e();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:o=o.add(i.doc.key)}return new hx(e,n.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gq{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yq{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return u7()?8:HH(a7())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,o){const i={result:null};return this.ys(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.ws(e,n,o,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new gq;return this.Ss(e,n,a).next(s=>{if(i.result=s,this.Vs)return this.bs(e,n,a,s.size)})}).next(()=>i.result)}bs(e,n,r,o){return r.documentReadCount<this.fs?(ks()<=ze.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",Ps(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),J.resolve()):(ks()<=ze.DEBUG&&ue("QueryEngine","Query:",Ps(n),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.gs*o?(ks()<=ze.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",Ps(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ko(n))):J.resolve())}ys(e,n){if(uC(n))return J.resolve(null);let r=ko(n);return this.indexManager.getIndexType(e,r).next(o=>o===0?null:(n.limit!==null&&o===1&&(n=i0(n,null,"F"),r=ko(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=$e(...i);return this.ps.getDocuments(e,a).next(s=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Ds(n,s);return this.Cs(n,l,a,u.readTime)?this.ys(e,i0(n,null,"F")):this.vs(e,l,n,u)}))})))}ws(e,n,r,o){return uC(n)||o.isEqual(Te.min())?J.resolve(null):this.ps.getDocuments(e,r).next(i=>{const a=this.Ds(n,i);return this.Cs(n,a,r,o)?J.resolve(null):(ks()<=ze.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ps(n)),this.vs(e,a,n,$H(o,Pc)).next(s=>s))})}Ds(e,n){let r=new Jt(hP(e));return n.forEach((o,i)=>{Sm(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,o){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(o)>0)}Ss(e,n,r){return ks()<=ze.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",Ps(n)),this.ps.getDocumentsMatchingQuery(e,n,aa.min(),r)}vs(e,n,r,o){return this.ps.getDocumentsMatchingQuery(e,r,o).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="LocalStore",wq=3e8;class xq{constructor(e,n,r,o){this.persistence=e,this.Fs=n,this.serializer=o,this.Ms=new It(Be),this.xs=new ls(i=>tx(i),nx),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uq(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function _q(t,e,n,r){return new xq(t,e,n,r)}async function MP(t,e){const n=ke(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let o;return n.mutationQueue.getAllMutationBatches(r).next(i=>(o=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],s=[];let u=$e();for(const l of o){a.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}for(const l of i){s.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}return n.localDocuments.getDocuments(r,u).next(l=>({Ls:l,removedBatchIds:a,addedBatchIds:s}))})})}function bq(t,e){const n=ke(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const o=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(s,u,l,c){const h=l.batch,f=h.keys();let d=J.resolve();return f.forEach(m=>{d=d.next(()=>c.getEntry(u,m)).next(g=>{const y=l.docVersions.get(m);Qe(y!==null,48541),g.version.compareTo(y)<0&&(h.applyToRemoteDocument(g,l),g.isValidDocument()&&(g.setReadTime(l.commitVersion),c.addEntry(g)))})}),d.next(()=>s.mutationQueue.removeMutationBatch(u,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(s){let u=$e();for(let l=0;l<s.mutationResults.length;++l)s.mutationResults[l].transformResults.length>0&&(u=u.add(s.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,o))})}function OP(t){const e=ke(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Eq(t,e){const n=ke(t),r=e.snapshotVersion;let o=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});o=n.Ms;const s=[];e.targetChanges.forEach((c,h)=>{const f=o.get(h);if(!f)return;s.push(n.Pi.removeMatchingKeys(i,c.removedDocuments,h).next(()=>n.Pi.addMatchingKeys(i,c.addedDocuments,h)));let d=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?d=d.withResumeToken(_n.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):c.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(c.resumeToken,r)),o=o.insert(h,d),function(g,y,v){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=wq?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,d,c)&&s.push(n.Pi.updateTargetData(i,d))});let u=li(),l=$e();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(i,c))}),s.push(Cq(i,a,e.documentUpdates).next(c=>{u=c.ks,l=c.qs})),!r.isEqual(Te.min())){const c=n.Pi.getLastRemoteSnapshotVersion(i).next(h=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));s.push(c)}return J.waitFor(s).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,l)).next(()=>u)}).then(i=>(n.Ms=o,i))}function Cq(t,e,n){let r=$e(),o=$e();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=li();return n.forEach((s,u)=>{const l=i.get(s);u.isFoundDocument()!==l.isFoundDocument()&&(o=o.add(s)),u.isNoDocument()&&u.version.isEqual(Te.min())?(e.removeEntry(s,u.readTime),a=a.insert(s,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),a=a.insert(s,u)):ue(fx,"Ignoring outdated watch update for ",s,". Current version:",l.version," Watch version:",u.version)}),{ks:a,qs:o}})}function Sq(t,e){const n=ke(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Jw),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Iq(t,e){const n=ke(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let o;return n.Pi.getTargetData(r,e).next(i=>i?(o=i,J.resolve(o)):n.Pi.allocateTargetId(r).next(a=>(o=new $i(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,o).next(()=>o))))}).then(r=>{const o=n.Ms.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function c0(t,e,n){const r=ke(t),o=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,o))}catch(a){if(!qu(a))throw a;ue(fx,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ms=r.Ms.remove(e),r.xs.delete(o.target)}function _C(t,e,n){const r=ke(t);let o=Te.min(),i=$e();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,l,c){const h=ke(u),f=h.xs.get(c);return f!==void 0?J.resolve(h.Ms.get(f)):h.Pi.getTargetData(l,c)}(r,a,ko(e)).next(s=>{if(s)return o=s.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(a,s.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(a,e,n?o:Te.min(),n?i:$e())).next(s=>(Tq(r,fG(e),s),{documents:s,Qs:i})))}function Tq(t,e,n){let r=t.Os.get(e)||Te.min();n.forEach((o,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class bC{constructor(){this.activeTargetIds=yG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rq{constructor(){this.Mo=new bC,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new bC,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aq{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC="ConnectivityMonitor";class CC{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ue(EC,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ue(EC,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf=null;function h0(){return vf===null?vf=function(){return 268435456+Math.round(2147483648*Math.random())}():vf++,"0x"+vf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg="RestConnection",kq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Pq{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${o}`,this.Wo=this.databaseId.database===Qd?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Go(e,n,r,o,i){const a=h0(),s=this.zo(e,n.toUriEncodedString());ue(hg,`Sending RPC '${e}' ${a}:`,s,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,o,i);const{host:l}=new URL(s),c=Kw(l);return this.Jo(e,s,u,r,c).then(h=>(ue(hg,`Received RPC '${e}' ${a}: `,h),h),h=>{throw Cu(hg,`RPC '${e}' ${a} failed with error: `,h,"url: ",s,"request:",r),h})}Ho(e,n,r,o,i,a){return this.Go(e,n,r,o,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Hu}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((o,i)=>e[i]=o),r&&r.headers.forEach((o,i)=>e[i]=o)}zo(e,n){const r=kq[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dq{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="WebChannelConnection";class Nq extends Pq{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,o,i){const a=h0();return new Promise((s,u)=>{const l=new Vk;l.setWithCredentials(!0),l.listenOnce(Bk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Vf.NO_ERROR:const h=l.getResponseJson();ue(In,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(h)),s(h);break;case Vf.TIMEOUT:ue(In,`RPC '${e}' ${a} timed out`),u(new se(Y.DEADLINE_EXCEEDED,"Request time out"));break;case Vf.HTTP_ERROR:const f=l.getStatus();if(ue(In,`RPC '${e}' ${a} failed with status:`,f,"response text:",l.getResponseText()),f>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const g=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(w)>=0?w:Y.UNKNOWN}(m.status);u(new se(g,m.message))}else u(new se(Y.UNKNOWN,"Server responded with status "+l.getStatus()))}else u(new se(Y.UNAVAILABLE,"Connection failed."));break;default:be(9055,{l_:e,streamId:a,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{ue(In,`RPC '${e}' ${a} completed.`)}});const c=JSON.stringify(o);ue(In,`RPC '${e}' ${a} sending request:`,o),l.send(n,"POST",c,r,15)})}T_(e,n,r){const o=h0(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=zk(),s=Uk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const c=i.join("");ue(In,`Creating RPC '${e}' stream ${o}: ${c}`,u);const h=a.createWebChannel(c,u);this.I_(h);let f=!1,d=!1;const m=new Dq({Yo:y=>{d?ue(In,`Not sending because RPC '${e}' stream ${o} is closed:`,y):(f||(ue(In,`Opening RPC '${e}' stream ${o} transport.`),h.open(),f=!0),ue(In,`RPC '${e}' stream ${o} sending:`,y),h.send(y))},Zo:()=>h.close()}),g=(y,v,w)=>{y.listen(v,x=>{try{w(x)}catch(_){setTimeout(()=>{throw _},0)}})};return g(h,kl.EventType.OPEN,()=>{d||(ue(In,`RPC '${e}' stream ${o} transport opened.`),m.o_())}),g(h,kl.EventType.CLOSE,()=>{d||(d=!0,ue(In,`RPC '${e}' stream ${o} transport closed`),m.a_(),this.E_(h))}),g(h,kl.EventType.ERROR,y=>{d||(d=!0,Cu(In,`RPC '${e}' stream ${o} transport errored. Name:`,y.name,"Message:",y.message),m.a_(new se(Y.UNAVAILABLE,"The operation could not be completed")))}),g(h,kl.EventType.MESSAGE,y=>{var v;if(!d){const w=y.data[0];Qe(!!w,16349);const x=w,_=(x==null?void 0:x.error)||((v=x[0])==null?void 0:v.error);if(_){ue(In,`RPC '${e}' stream ${o} received error:`,_);const S=_.status;let R=function(I){const T=Bt[I];if(T!==void 0)return bP(T)}(S),C=_.message;R===void 0&&(R=Y.INTERNAL,C="Unknown error status: "+S+" with message "+_.message),d=!0,m.a_(new se(R,C)),h.close()}else ue(In,`RPC '${e}' stream ${o} received:`,w),m.u_(w)}}),g(s,$k.STAT_EVENT,y=>{y.stat===Jy.PROXY?ue(In,`RPC '${e}' stream ${o} detected buffering proxy`):y.stat===Jy.NOPROXY&&ue(In,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{m.__()},0),m}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function fg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t){return new LG(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,n,r=1e3,o=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=o,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,n-r);o>0&&ue("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC="PersistentStream";class LP{constructor(e,n,r,o,i,a,s,u){this.Mi=e,this.S_=r,this.b_=o,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new FP(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(ui(n.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,o])=>{this.D_===n&&this.G_(r,o)},r=>{e(()=>{const o=new se(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(o=>{r(()=>this.z_(o))}),this.stream.onMessage(o=>{r(()=>++this.F_==1?this.J_(o):this.onNext(o))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ue(SC,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ue(SC,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Mq extends LP{constructor(e,n,r,o,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,o,a),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=$G(this.serializer,e),r=function(i){if(!("targetChange"in i))return Te.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Te.min():a.readTime?Po(a.readTime):Te.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=l0(this.serializer),n.addTarget=function(i,a){let s;const u=a.target;if(s=r0(u)?{documents:WG(i,u)}:{query:jG(i,u).ft},s.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){s.resumeToken=SP(i,a.resumeToken);const l=a0(i,a.expectedCount);l!==null&&(s.expectedCount=l)}else if(a.snapshotVersion.compareTo(Te.min())>0){s.readTime=np(i,a.snapshotVersion.toTimestamp());const l=a0(i,a.expectedCount);l!==null&&(s.expectedCount=l)}return s}(this.serializer,e);const r=GG(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=l0(this.serializer),n.removeTarget=e,this.q_(n)}}class Oq extends LP{constructor(e,n,r,o,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,o,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Qe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Qe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Qe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=zG(e.writeResults,e.commitTime),r=Po(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=l0(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>UG(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fq{}class Lq extends Fq{constructor(e,n,r,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new se(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Go(e,s0(n,r),o,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new se(Y.UNKNOWN,i.toString())})}Ho(e,n,r,o,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Ho(e,s0(n,r),o,a,s,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new se(Y.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Vq{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(n),this.aa=!1):ue("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts="RemoteStore";class Bq{constructor(e,n,r,o,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(a=>{r.enqueueAndForget(async()=>{cs(this)&&(ue(ts,"Restarting streams for network reachability change."),await async function(u){const l=ke(u);l.Ea.add(4),await dh(l),l.Ra.set("Unknown"),l.Ea.delete(4),await km(l)}(this))})}),this.Ra=new Vq(r,o)}}async function km(t){if(cs(t))for(const e of t.da)await e(!0)}async function dh(t){for(const e of t.da)await e(!1)}function VP(t,e){const n=ke(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),vx(n)?mx(n):Ku(n).O_()&&px(n,e))}function dx(t,e){const n=ke(t),r=Ku(n);n.Ia.delete(e),r.O_()&&BP(n,e),n.Ia.size===0&&(r.O_()?r.L_():cs(n)&&n.Ra.set("Unknown"))}function px(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ku(t).Y_(e)}function BP(t,e){t.Va.Ue(e),Ku(t).Z_(e)}function mx(t){t.Va=new NG({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ku(t).start(),t.Ra.ua()}function vx(t){return cs(t)&&!Ku(t).x_()&&t.Ia.size>0}function cs(t){return ke(t).Ea.size===0}function $P(t){t.Va=void 0}async function $q(t){t.Ra.set("Online")}async function Uq(t){t.Ia.forEach((e,n)=>{px(t,e)})}async function zq(t,e){$P(t),vx(t)?(t.Ra.ha(e),mx(t)):t.Ra.set("Unknown")}async function Wq(t,e,n){if(t.Ra.set("Online"),e instanceof CP&&e.state===2&&e.cause)try{await async function(o,i){const a=i.cause;for(const s of i.targetIds)o.Ia.has(s)&&(await o.remoteSyncer.rejectListen(s,a),o.Ia.delete(s),o.Va.removeTarget(s))}(t,e)}catch(r){ue(ts,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await op(t,r)}else if(e instanceof zf?t.Va.Ze(e):e instanceof EP?t.Va.st(e):t.Va.tt(e),!n.isEqual(Te.min()))try{const r=await OP(t.localStore);n.compareTo(r)>=0&&await function(i,a){const s=i.Va.Tt(a);return s.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const c=i.Ia.get(l);c&&i.Ia.set(l,c.withResumeToken(u.resumeToken,a))}}),s.targetMismatches.forEach((u,l)=>{const c=i.Ia.get(u);if(!c)return;i.Ia.set(u,c.withResumeToken(_n.EMPTY_BYTE_STRING,c.snapshotVersion)),BP(i,u);const h=new $i(c.target,u,l,c.sequenceNumber);px(i,h)}),i.remoteSyncer.applyRemoteEvent(s)}(t,n)}catch(r){ue(ts,"Failed to raise snapshot:",r),await op(t,r)}}async function op(t,e,n){if(!qu(e))throw e;t.Ea.add(1),await dh(t),t.Ra.set("Offline"),n||(n=()=>OP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ue(ts,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await km(t)})}function UP(t,e){return e().catch(n=>op(t,n,e))}async function Pm(t){const e=ke(t),n=ca(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jw;for(;jq(e);)try{const o=await Sq(e.localStore,r);if(o===null){e.Ta.length===0&&n.L_();break}r=o.batchId,Hq(e,o)}catch(o){await op(e,o)}zP(e)&&WP(e)}function jq(t){return cs(t)&&t.Ta.length<10}function Hq(t,e){t.Ta.push(e);const n=ca(t);n.O_()&&n.X_&&n.ea(e.mutations)}function zP(t){return cs(t)&&!ca(t).x_()&&t.Ta.length>0}function WP(t){ca(t).start()}async function Gq(t){ca(t).ra()}async function qq(t){const e=ca(t);for(const n of t.Ta)e.ea(n.mutations)}async function Kq(t,e,n){const r=t.Ta.shift(),o=ax.from(r,e,n);await UP(t,()=>t.remoteSyncer.applySuccessfulWrite(o)),await Pm(t)}async function Xq(t,e){e&&ca(t).X_&&await async function(r,o){if(function(a){return kG(a)&&a!==Y.ABORTED}(o.code)){const i=r.Ta.shift();ca(r).B_(),await UP(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,o)),await Pm(r)}}(t,e),zP(t)&&WP(t)}async function IC(t,e){const n=ke(t);n.asyncQueue.verifyOperationInProgress(),ue(ts,"RemoteStore received new credentials");const r=cs(n);n.Ea.add(3),await dh(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await km(n)}async function Qq(t,e){const n=ke(t);e?(n.Ea.delete(2),await km(n)):e||(n.Ea.add(2),await dh(n),n.Ra.set("Unknown"))}function Ku(t){return t.ma||(t.ma=function(n,r,o){const i=ke(n);return i.sa(),new Mq(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:$q.bind(null,t),t_:Uq.bind(null,t),r_:zq.bind(null,t),H_:Wq.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),vx(t)?mx(t):t.Ra.set("Unknown")):(await t.ma.stop(),$P(t))})),t.ma}function ca(t){return t.fa||(t.fa=function(n,r,o){const i=ke(n);return i.sa(),new Oq(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,o)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Gq.bind(null,t),r_:Xq.bind(null,t),ta:qq.bind(null,t),na:Kq.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Pm(t)):(await t.fa.stop(),t.Ta.length>0&&(ue(ts,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,n,r,o,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=o,this.removalCallback=i,this.deferred=new Zo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,o,i){const a=Date.now()+r,s=new gx(e,n,a,o,i);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yx(t,e){if(ui("AsyncQueue",`${e}: ${t}`),qu(t))return new se(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{static emptySet(e){return new cu(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||we.comparator(n.key,r.key):(n,r)=>we.comparator(n.key,r.key),this.keyedMap=Pl(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,i=r.getNext().key;if(!o.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new cu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(){this.ga=new It(we.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):be(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Au{constructor(e,n,r,o,i,a,s,u,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,o,i){const a=[];return n.forEach(s=>{a.push({type:0,doc:s})}),new Au(e,n,cu.emptySet(n),a,r,o,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==r[o].type||!n[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Jq{constructor(){this.queries=RC(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const o=ke(n),i=o.queries;o.queries=RC(),i.forEach((a,s)=>{for(const u of s.Sa)u.onError(r)})})(this,new se(Y.ABORTED,"Firestore shutting down"))}}function RC(){return new ls(t=>cP(t),Cm)}async function jP(t,e){const n=ke(t);let r=3;const o=e.query;let i=n.queries.get(o);i?!i.ba()&&e.Da()&&(r=2):(i=new Yq,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(o,!0);break;case 1:i.wa=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(a){const s=yx(a,`Initialization of query '${Ps(e.query)}' failed`);return void e.onError(s)}n.queries.set(o,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&wx(n)}async function HP(t,e){const n=ke(t),r=e.query;let o=3;const i=n.queries.get(r);if(i){const a=i.Sa.indexOf(e);a>=0&&(i.Sa.splice(a,1),i.Sa.length===0?o=e.Da()?0:1:!i.ba()&&e.Da()&&(o=2))}switch(o){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Zq(t,e){const n=ke(t);let r=!1;for(const o of e){const i=o.query,a=n.queries.get(i);if(a){for(const s of a.Sa)s.Fa(o)&&(r=!0);a.wa=o}}r&&wx(n)}function eK(t,e,n){const r=ke(t),o=r.queries.get(e);if(o)for(const i of o.Sa)i.onError(n);r.queries.delete(e)}function wx(t){t.Ca.forEach(e=>{e.next()})}var f0,AC;(AC=f0||(f0={})).Ma="default",AC.Cache="cache";class GP{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new Au(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Au.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==f0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e){this.key=e}}class KP{constructor(e){this.key=e}}class tK{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=$e(),this.mutatedKeys=$e(),this.eu=hP(e),this.tu=new cu(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new TC,o=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,a=o,s=!1;const u=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,l=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((c,h)=>{const f=o.get(c),d=Sm(this.query,h)?h:null,m=!!f&&this.mutatedKeys.has(f.key),g=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let y=!1;f&&d?f.data.isEqual(d.data)?m!==g&&(r.track({type:3,doc:d}),y=!0):this.su(f,d)||(r.track({type:2,doc:d}),y=!0,(u&&this.eu(d,u)>0||l&&this.eu(d,l)<0)&&(s=!0)):!f&&d?(r.track({type:0,doc:d}),y=!0):f&&!d&&(r.track({type:1,doc:f}),y=!0,(u||l)&&(s=!0)),y&&(d?(a=a.add(d),i=g?i.add(c):i.delete(c)):(a=a.delete(c),i=i.delete(c)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const c=this.query.limitType==="F"?a.last():a.first();a=a.delete(c.key),i=i.delete(c.key),r.track({type:1,doc:c})}return{tu:a,iu:r,Cs:s,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,o){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((c,h)=>function(d,m){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return be(20277,{Rt:y})}};return g(d)-g(m)}(c.type,h.type)||this.eu(c.doc,h.doc)),this.ou(r),o=o??!1;const s=n&&!o?this._u():[],u=this.Xa.size===0&&this.current&&!o?1:0,l=u!==this.Za;return this.Za=u,a.length!==0||l?{snapshot:new Au(this.query,e.tu,i,a,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:s}:{au:s}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new TC,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=$e(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new KP(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new qP(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=$e();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Au.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const xx="SyncEngine";class nK{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class rK{constructor(e){this.key=e,this.hu=!1}}class oK{constructor(e,n,r,o,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=o,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new ls(s=>cP(s),Cm),this.Iu=new Map,this.Eu=new Set,this.du=new It(we.comparator),this.Au=new Map,this.Ru=new lx,this.Vu={},this.mu=new Map,this.fu=Ru.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function iK(t,e,n=!0){const r=eD(t);let o;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),o=i.view.lu()):o=await XP(r,e,n,!0),o}async function aK(t,e){const n=eD(t);await XP(n,e,!0,!1)}async function XP(t,e,n,r){const o=await Iq(t.localStore,ko(e)),i=o.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let s;return r&&(s=await sK(t,e,i,a==="current",o.resumeToken)),t.isPrimaryClient&&n&&VP(t.remoteStore,o),s}async function sK(t,e,n,r,o){t.pu=(h,f,d)=>async function(g,y,v,w){let x=y.view.ru(v);x.Cs&&(x=await _C(g.localStore,y.query,!1).then(({documents:C})=>y.view.ru(C,x)));const _=w&&w.targetChanges.get(y.targetId),S=w&&w.targetMismatches.get(y.targetId)!=null,R=y.view.applyChanges(x,g.isPrimaryClient,_,S);return PC(g,y.targetId,R.au),R.snapshot}(t,h,f,d);const i=await _C(t.localStore,e,!0),a=new tK(e,i.Qs),s=a.ru(i.documents),u=fh.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",o),l=a.applyChanges(s,t.isPrimaryClient,u);PC(t,n,l.au);const c=new nK(e,n,a);return t.Tu.set(e,c),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),l.snapshot}async function uK(t,e,n){const r=ke(t),o=r.Tu.get(e),i=r.Iu.get(o.targetId);if(i.length>1)return r.Iu.set(o.targetId,i.filter(a=>!Cm(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await c0(r.localStore,o.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(o.targetId),n&&dx(r.remoteStore,o.targetId),d0(r,o.targetId)}).catch(Gu)):(d0(r,o.targetId),await c0(r.localStore,o.targetId,!0))}async function lK(t,e){const n=ke(t),r=n.Tu.get(e),o=n.Iu.get(r.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),dx(n.remoteStore,r.targetId))}async function cK(t,e,n){const r=gK(t);try{const o=await function(a,s){const u=ke(a),l=pt.now(),c=s.reduce((d,m)=>d.add(m.key),$e());let h,f;return u.persistence.runTransaction("Locally write mutations","readwrite",d=>{let m=li(),g=$e();return u.Ns.getEntries(d,c).next(y=>{m=y,m.forEach((v,w)=>{w.isValidDocument()||(g=g.add(v))})}).next(()=>u.localDocuments.getOverlayedDocuments(d,m)).next(y=>{h=y;const v=[];for(const w of s){const x=SG(w,h.get(w.key).overlayedDocument);x!=null&&v.push(new xa(w.key,x,nP(x.value.mapValue),no.exists(!0)))}return u.mutationQueue.addMutationBatch(d,l,v,s)}).next(y=>{f=y;const v=y.applyToLocalDocumentSet(h,g);return u.documentOverlayCache.saveOverlays(d,y.batchId,v)})}).then(()=>({batchId:f.batchId,changes:dP(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),function(a,s,u){let l=a.Vu[a.currentUser.toKey()];l||(l=new It(Be)),l=l.insert(s,u),a.Vu[a.currentUser.toKey()]=l}(r,o.batchId,n),await ph(r,o.changes),await Pm(r.remoteStore)}catch(o){const i=yx(o,"Failed to persist write");n.reject(i)}}async function QP(t,e){const n=ke(t);try{const r=await Eq(n.localStore,e);e.targetChanges.forEach((o,i)=>{const a=n.Au.get(i);a&&(Qe(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?a.hu=!0:o.modifiedDocuments.size>0?Qe(a.hu,14607):o.removedDocuments.size>0&&(Qe(a.hu,42227),a.hu=!1))}),await ph(n,r,e)}catch(r){await Gu(r)}}function kC(t,e,n){const r=ke(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const o=[];r.Tu.forEach((i,a)=>{const s=a.view.va(e);s.snapshot&&o.push(s.snapshot)}),function(a,s){const u=ke(a);u.onlineState=s;let l=!1;u.queries.forEach((c,h)=>{for(const f of h.Sa)f.va(s)&&(l=!0)}),l&&wx(u)}(r.eventManager,e),o.length&&r.Pu.H_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function hK(t,e,n){const r=ke(t);r.sharedClientState.updateQueryState(e,"rejected",n);const o=r.Au.get(e),i=o&&o.key;if(i){let a=new It(we.comparator);a=a.insert(i,Dn.newNoDocument(i,Te.min()));const s=$e().add(i),u=new Rm(Te.min(),new Map,new It(Be),a,s);await QP(r,u),r.du=r.du.remove(i),r.Au.delete(e),_x(r)}else await c0(r.localStore,e,!1).then(()=>d0(r,e,n)).catch(Gu)}async function fK(t,e){const n=ke(t),r=e.batch.batchId;try{const o=await bq(n.localStore,e);JP(n,r,null),YP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ph(n,o)}catch(o){await Gu(o)}}async function dK(t,e,n){const r=ke(t);try{const o=await function(a,s){const u=ke(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return u.mutationQueue.lookupMutationBatch(l,s).next(h=>(Qe(h!==null,37113),c=h.keys(),u.mutationQueue.removeMutationBatch(l,h))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,c,s)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>u.localDocuments.getDocuments(l,c))})}(r.localStore,e);JP(r,e,n),YP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ph(r,o)}catch(o){await Gu(o)}}function YP(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function JP(t,e,n){const r=ke(t);let o=r.Vu[r.currentUser.toKey()];if(o){const i=o.get(e);i&&(n?i.reject(n):i.resolve(),o=o.remove(e)),r.Vu[r.currentUser.toKey()]=o}}function d0(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||ZP(t,r)})}function ZP(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(dx(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),_x(t))}function PC(t,e,n){for(const r of n)r instanceof qP?(t.Ru.addReference(r.key,e),pK(t,r)):r instanceof KP?(ue(xx,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||ZP(t,r.key)):be(19791,{wu:r})}function pK(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ue(xx,"New document in limbo: "+n),t.Eu.add(r),_x(t))}function _x(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new we(at.fromString(e)),r=t.fu.next();t.Au.set(r,new rK(n)),t.du=t.du.insert(n,r),VP(t.remoteStore,new $i(ko(rx(n.path)),r,"TargetPurposeLimboResolution",_m.ce))}}async function ph(t,e,n){const r=ke(t),o=[],i=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((s,u)=>{a.push(r.pu(u,e,n).then(l=>{var c;if((l||n)&&r.isPrimaryClient){const h=l?!l.fromCache:(c=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:c.current;r.sharedClientState.updateQueryState(u.targetId,h?"current":"not-current")}if(l){o.push(l);const h=hx.As(u.targetId,l);i.push(h)}}))}),await Promise.all(a),r.Pu.H_(o),await async function(u,l){const c=ke(u);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>J.forEach(l,f=>J.forEach(f.Es,d=>c.persistence.referenceDelegate.addReference(h,f.targetId,d)).next(()=>J.forEach(f.ds,d=>c.persistence.referenceDelegate.removeReference(h,f.targetId,d)))))}catch(h){if(!qu(h))throw h;ue(fx,"Failed to update sequence numbers: "+h)}for(const h of l){const f=h.targetId;if(!h.fromCache){const d=c.Ms.get(f),m=d.snapshotVersion,g=d.withLastLimboFreeSnapshotVersion(m);c.Ms=c.Ms.insert(f,g)}}}(r.localStore,i))}async function mK(t,e){const n=ke(t);if(!n.currentUser.isEqual(e)){ue(xx,"User change. New user:",e.toKey());const r=await MP(n.localStore,e);n.currentUser=e,function(i,a){i.mu.forEach(s=>{s.forEach(u=>{u.reject(new se(Y.CANCELLED,a))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ph(n,r.Ls)}}function vK(t,e){const n=ke(t),r=n.Au.get(e);if(r&&r.hu)return $e().add(r.key);{let o=$e();const i=n.Iu.get(e);if(!i)return o;for(const a of i){const s=n.Tu.get(a);o=o.unionWith(s.view.nu)}return o}}function eD(t){const e=ke(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vK.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hK.bind(null,e),e.Pu.H_=Zq.bind(null,e.eventManager),e.Pu.yu=eK.bind(null,e.eventManager),e}function gK(t){const e=ke(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dK.bind(null,e),e}class ip{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Am(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return _q(this.persistence,new yq,e.initialUser,this.serializer)}Cu(e){return new NP(cx.mi,this.serializer)}Du(e){return new Rq}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ip.provider={build:()=>new ip};class yK extends ip{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Qe(this.persistence.referenceDelegate instanceof rp,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new rq(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?qn.withCacheSize(this.cacheSizeBytes):qn.DEFAULT;return new NP(r=>rp.mi(r,n),this.serializer)}}class p0{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kC(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=mK.bind(null,this.syncEngine),await Qq(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Jq}()}createDatastore(e){const n=Am(e.databaseInfo.databaseId),r=function(i){return new Nq(i)}(e.databaseInfo);return function(i,a,s,u){return new Lq(i,a,s,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,o,i,a,s){return new Bq(r,o,i,a,s)}(this.localStore,this.datastore,e.asyncQueue,n=>kC(this.syncEngine,n,0),function(){return CC.v()?new CC:new Aq}())}createSyncEngine(e,n){return function(o,i,a,s,u,l,c){const h=new oK(o,i,a,s,u,l);return c&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(o){const i=ke(o);ue(ts,"RemoteStore shutting down."),i.Ea.add(5),await dh(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}p0.provider={build:()=>new p0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="FirestoreClient";class wK{constructor(e,n,r,o,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=o,this.user=An.UNAUTHENTICATED,this.clientId=Yw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{ue(ha,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ue(ha,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=yx(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function dg(t,e){t.asyncQueue.verifyOperationInProgress(),ue(ha,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async o=>{r.isEqual(o)||(await MP(e.localStore,o),r=o)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function DC(t,e){t.asyncQueue.verifyOperationInProgress();const n=await xK(t);ue(ha,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>IC(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,o)=>IC(e.remoteStore,o)),t._onlineComponents=e}async function xK(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ue(ha,"Using user provided OfflineComponentProvider");try{await dg(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(o){return o.name==="FirebaseError"?o.code===Y.FAILED_PRECONDITION||o.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(n))throw n;Cu("Error using user provided cache. Falling back to memory cache: "+n),await dg(t,new ip)}}else ue(ha,"Using default OfflineComponentProvider"),await dg(t,new yK(void 0));return t._offlineComponents}async function nD(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ue(ha,"Using user provided OnlineComponentProvider"),await DC(t,t._uninitializedComponentsProvider._online)):(ue(ha,"Using default OnlineComponentProvider"),await DC(t,new p0))),t._onlineComponents}function _K(t){return nD(t).then(e=>e.syncEngine)}async function rD(t){const e=await nD(t),n=e.eventManager;return n.onListen=iK.bind(null,e.syncEngine),n.onUnlisten=uK.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=aK.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=lK.bind(null,e.syncEngine),n}function bK(t,e,n={}){const r=new Zo;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,s,u,l){const c=new tD({next:f=>{c.Nu(),a.enqueueAndForget(()=>HP(i,h));const d=f.docs.has(s);!d&&f.fromCache?l.reject(new se(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&f.fromCache&&u&&u.source==="server"?l.reject(new se(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new GP(rx(s.path),c,{includeMetadataChanges:!0,qa:!0});return jP(i,h)}(await rD(t),t.asyncQueue,e,n,r)),r.promise}function EK(t,e,n={}){const r=new Zo;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,s,u,l){const c=new tD({next:f=>{c.Nu(),a.enqueueAndForget(()=>HP(i,h)),f.fromCache&&u.source==="server"?l.reject(new se(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(f)},error:f=>l.reject(f)}),h=new GP(s,c,{includeMetadataChanges:!0,qa:!0});return jP(i,h)}(await rD(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="firestore.googleapis.com",MC=!0;class OC{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new se(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iD,this.ssl=MC}else this.host=e.host,this.ssl=e.ssl??MC;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tq)throw new se(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oD(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new se(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,o){return r.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dm{constructor(e,n,r,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new OC({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new OC(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new AH;switch(r.type){case"firstParty":return new NH(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=NC.get(n);r&&(ue("ComponentProvider","Removing Datastore"),NC.delete(n),r.terminate())}(this),Promise.resolve()}}function CK(t,e,n,r={}){var l;t=Oo(t,Dm);const o=Kw(e),i=t._getSettings(),a={...i,emulatorOptions:t._getEmulatorOptions()},s=`${e}:${n}`;o&&(t7(`https://${s}`),i7("Firestore",!0)),i.host!==iD&&i.host!==s&&Cu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:s,ssl:o,emulatorOptions:r};if(!Gd(u,a)&&(t._setSettings(u),r.mockUserToken)){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=An.MOCK_USER;else{c=n7(r.mockUserToken,(l=t._app)==null?void 0:l.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new se(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new An(f)}t._authCredentials=new kH(new jk(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xu(this.firestore,e,this._query)}}class Ot{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ta(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ot(this.firestore,e,this._key)}toJSON(){return{type:Ot._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(lh(n,Ot._jsonSchema))return new Ot(e,r||null,new we(at.fromString(n.referencePath)))}}Ot._jsonSchemaVersion="firestore/documentReference/1.0",Ot._jsonSchema={type:Ht("string",Ot._jsonSchemaVersion),referencePath:Ht("string")};class ta extends Xu{constructor(e,n,r){super(e,n,rx(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ot(this.firestore,null,new we(e))}withConverter(e){return new ta(this.firestore,e,this._path)}}function sX(t,e,...n){if(t=ai(t),Hk("collection","path",e),t instanceof Dm){const r=at.fromString(e,...n);return KE(r),new ta(t,null,r)}{if(!(t instanceof Ot||t instanceof ta))throw new se(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(at.fromString(e,...n));return KE(r),new ta(t.firestore,null,r)}}function uX(t,e,...n){if(t=ai(t),arguments.length===1&&(e=Yw.newId()),Hk("doc","path",e),t instanceof Dm){const r=at.fromString(e,...n);return qE(r),new Ot(t,null,new we(r))}{if(!(t instanceof Ot||t instanceof ta))throw new se(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(at.fromString(e,...n));return qE(r),new Ot(t.firestore,t instanceof ta?t.converter:null,new we(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC="AsyncQueue";class LC{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new FP(this,"async_queue_retry"),this._c=()=>{const r=fg();r&&ue(FC,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=fg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=fg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Zo;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qu(e))throw e;ue(FC,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",VC(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const o=gx.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(o),o}uc(){this.nc&&be(47125,{Pc:VC(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function VC(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Qu extends Dm{constructor(e,n,r,o){super(e,n,r,o),this.type="firestore",this._queue=new LC,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new LC(e),this._firestoreClient=void 0,await e}}}function lX(t,e){const n=typeof t=="object"?t:vH(),r=typeof t=="string"?t:Qd,o=cH(n,"firestore").getImmediate({identifier:r});if(!o._initialized){const i=Z8("firestore");i&&CK(o,...i)}return o}function bx(t){if(t._terminated)throw new se(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||SK(t),t._firestoreClient}function SK(t){var r,o,i;const e=t._freezeSettings(),n=function(s,u,l,c){return new QH(s,u,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,oD(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new wK(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(s){const u=s==null?void 0:s._online.build();return{_offline:s==null?void 0:s._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(_n.fromBase64String(e))}catch(n){throw new se(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Mr(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(lh(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:Ht("string",Mr._jsonSchemaVersion),bytes:Ht("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Be(this._lat,e._lat)||Be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Do._jsonSchemaVersion}}static fromJSON(e){if(lh(e,Do._jsonSchema))return new Do(e.latitude,e.longitude)}}Do._jsonSchemaVersion="firestore/geoPoint/1.0",Do._jsonSchema={type:Ht("string",Do._jsonSchemaVersion),latitude:Ht("number"),longitude:Ht("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,o){if(r.length!==o.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==o[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:No._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(lh(e,No._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new No(e.vectorValues);throw new se(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}No._jsonSchemaVersion="firestore/vectorValue/1.0",No._jsonSchema={type:Ht("string",No._jsonSchemaVersion),vectorValues:Ht("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IK=/^__.*__$/;class TK{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new xa(e,this.data,this.fieldMask,n,this.fieldTransforms):new hh(e,this.data,n,this.fieldTransforms)}}class aD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new xa(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function sD(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw be(40011,{Ac:t})}}class Cx{constructor(e,n,r,o,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=o,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Cx({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const n=(o=this.path)==null?void 0:o.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var o;const n=(o=this.path)==null?void 0:o.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ap(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sD(this.Ac)&&IK.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class RK{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Am(e)}Cc(e,n,r,o=!1){return new Cx({Ac:e,methodName:n,Dc:r,path:yn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Sx(t){const e=t._freezeSettings(),n=Am(t._databaseId);return new RK(t._databaseId,!!e.ignoreUndefinedProperties,n)}function AK(t,e,n,r,o,i={}){const a=t.Cc(i.merge||i.mergeFields?2:0,e,n,o);Ix("Data must be an object, but it was:",a,r);const s=uD(r,a);let u,l;if(i.merge)u=new gr(a.fieldMask),l=a.fieldTransforms;else if(i.mergeFields){const c=[];for(const h of i.mergeFields){const f=m0(e,h,n);if(!a.contains(f))throw new se(Y.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);cD(c,f)||c.push(f)}u=new gr(c),l=a.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,l=a.fieldTransforms;return new TK(new Yn(s),u,l)}class Mm extends Ex{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mm}}function kK(t,e,n,r){const o=t.Cc(1,e,n);Ix("Data must be an object, but it was:",o,r);const i=[],a=Yn.empty();wa(r,(u,l)=>{const c=Tx(e,u,n);l=ai(l);const h=o.yc(c);if(l instanceof Mm)i.push(c);else{const f=mh(l,h);f!=null&&(i.push(c),a.set(c,f))}});const s=new gr(i);return new aD(a,s,o.fieldTransforms)}function PK(t,e,n,r,o,i){const a=t.Cc(1,e,n),s=[m0(e,r,n)],u=[o];if(i.length%2!=0)throw new se(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)s.push(m0(e,i[f])),u.push(i[f+1]);const l=[],c=Yn.empty();for(let f=s.length-1;f>=0;--f)if(!cD(l,s[f])){const d=s[f];let m=u[f];m=ai(m);const g=a.yc(d);if(m instanceof Mm)l.push(d);else{const y=mh(m,g);y!=null&&(l.push(d),c.set(d,y))}}const h=new gr(l);return new aD(c,h,a.fieldTransforms)}function DK(t,e,n,r=!1){return mh(n,t.Cc(r?4:3,e))}function mh(t,e){if(lD(t=ai(t)))return Ix("Unsupported field value:",e,t),uD(t,e);if(t instanceof Ex)return function(r,o){if(!sD(o.Ac))throw o.Sc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(o);i&&o.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,o){const i=[];let a=0;for(const s of r){let u=mh(s,o.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,o){if((r=ai(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wG(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=pt.fromDate(r);return{timestampValue:np(o.serializer,i)}}if(r instanceof pt){const i=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:np(o.serializer,i)}}if(r instanceof Do)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mr)return{bytesValue:SP(o.serializer,r._byteString)};if(r instanceof Ot){const i=o.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw o.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ux(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof No)return function(a,s){return{mapValue:{fields:{[eP]:{stringValue:tP},[Yd]:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw s.Sc("VectorValues must only contain numeric values.");return ox(s.serializer,l)})}}}}}}(r,o);throw o.Sc(`Unsupported field value: ${xm(r)}`)}(t,e)}function uD(t,e){const n={};return Kk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wa(t,(r,o)=>{const i=mh(o,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function lD(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof pt||t instanceof Do||t instanceof Mr||t instanceof Ot||t instanceof Ex||t instanceof No)}function Ix(t,e,n){if(!lD(n)||!Gk(n)){const r=xm(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function m0(t,e,n){if((e=ai(e))instanceof Nm)return e._internalPath;if(typeof e=="string")return Tx(t,e);throw ap("Field path arguments must be of type string or ",t,!1,void 0,n)}const NK=new RegExp("[~\\*/\\[\\]]");function Tx(t,e,n){if(e.search(NK)>=0)throw ap(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Nm(...e.split("."))._internalPath}catch{throw ap(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ap(t,e,n,r,o){const i=r&&!r.isEmpty(),a=o!==void 0;let s=`Function ${e}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${o}`),u+=")"),new se(Y.INVALID_ARGUMENT,s+t+u)}function cD(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n,r,o,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=o,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MK(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MK extends hD{data(){return super.data()}}function Rx(t,e){return typeof e=="string"?Tx(t,e):e instanceof Nm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OK(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ax{}class FK extends Ax{}function cX(t,e,...n){let r=[];e instanceof Ax&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof kx).length,s=i.filter(u=>u instanceof Om).length;if(a>1||a>0&&s>0)throw new se(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const o of r)t=o._apply(t);return t}class Om extends FK{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Om(e,n,r)}_apply(e){const n=this._parse(e);return fD(e._query,n),new Xu(e.firestore,e.converter,o0(e._query,n))}_parse(e){const n=Sx(e.firestore);return function(i,a,s,u,l,c,h){let f;if(l.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new se(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){$C(h,c);const m=[];for(const g of h)m.push(BC(u,i,g));f={arrayValue:{values:m}}}else f=BC(u,i,h)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||$C(h,c),f=DK(s,a,h,c==="in"||c==="not-in");return jt.create(l,c,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function hX(t,e,n){const r=e,o=Rx("where",t);return Om._create(o,r,n)}class kx extends Ax{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new kx(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:oo.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(o,i){let a=o;const s=i.getFlattenedFilters();for(const u of s)fD(a,u),a=o0(a,u)}(e._query,n),new Xu(e.firestore,e.converter,o0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function BC(t,e,n){if(typeof(n=ai(n))=="string"){if(n==="")throw new se(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lP(e)&&n.indexOf("/")!==-1)throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(at.fromString(n));if(!we.isDocumentKey(r))throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return nC(t,new we(r))}if(n instanceof Ot)return nC(t,n._key);throw new se(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xm(n)}.`)}function $C(t,e){if(!Array.isArray(t)||t.length===0)throw new se(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function fD(t,e){const n=function(o,i){for(const a of o)for(const s of a.getFlattenedFilters())if(i.indexOf(s.op)>=0)return s.op;return null}(t.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new se(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class LK{convertValue(e,n="none"){switch(la(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ua(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw be(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return wa(e,(o,i)=>{r[o]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,o,i;const n=(i=(o=(r=e.fields)==null?void 0:r[Yd].arrayValue)==null?void 0:o.values)==null?void 0:i.map(a=>Nt(a.doubleValue));return new No(n)}convertGeoPoint(e){return new Do(Nt(e.latitude),Nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Em(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Dc(e));default:return null}}convertTimestamp(e){const n=sa(e);return new pt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=at.fromString(e);Qe(PP(r),9688,{name:e});const o=new Nc(r.get(1),r.get(3)),i=new we(r.popFirst(5));return o.isEqual(n)||ui(`Document ${i} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VK(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class Nl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ga extends hD{constructor(e,n,r,o,i,a){super(e,n,r,o,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Wf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rx("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ga._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ga._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ga._jsonSchema={type:Ht("string",Ga._jsonSchemaVersion),bundleSource:Ht("string","DocumentSnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class Wf extends Ga{data(e={}){return super.data(e)}}class hu{constructor(e,n,r,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new Nl(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wf(this._firestore,this._userDataWriter,r.key,r,new Nl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(o,i){if(o._snapshot.oldDocs.isEmpty()){let a=0;return o._snapshot.docChanges.map(s=>{const u=new Wf(o._firestore,o._userDataWriter,s.doc.key,s.doc,new Nl(o._snapshot.mutatedKeys.has(s.doc.key),o._snapshot.fromCache),o.query.converter);return s.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(s=>i||s.type!==3).map(s=>{const u=new Wf(o._firestore,o._userDataWriter,s.doc.key,s.doc,new Nl(o._snapshot.mutatedKeys.has(s.doc.key),o._snapshot.fromCache),o.query.converter);let l=-1,c=-1;return s.type!==0&&(l=a.indexOf(s.doc.key),a=a.delete(s.doc.key)),s.type!==1&&(a=a.add(s.doc),c=a.indexOf(s.doc.key)),{type:BK(s.type),doc:u,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Yw.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],o=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),o.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BK(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return be(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fX(t){t=Oo(t,Ot);const e=Oo(t.firestore,Qu);return bK(bx(e),t._key).then(n=>$K(e,t,n))}hu._jsonSchemaVersion="firestore/querySnapshot/1.0",hu._jsonSchema={type:Ht("string",hu._jsonSchemaVersion),bundleSource:Ht("string","QuerySnapshot"),bundleName:Ht("string"),bundle:Ht("string")};class dD extends LK{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ot(this.firestore,null,n)}}function dX(t){t=Oo(t,Xu);const e=Oo(t.firestore,Qu),n=bx(e),r=new dD(e);return OK(t._query),EK(n,t._query).then(o=>new hu(e,r,t,o))}function pX(t,e,n){t=Oo(t,Ot);const r=Oo(t.firestore,Qu),o=VK(t.converter,e);return Px(r,[AK(Sx(r),"setDoc",t._key,o,t.converter!==null,n).toMutation(t._key,no.none())])}function mX(t,e,n,...r){t=Oo(t,Ot);const o=Oo(t.firestore,Qu),i=Sx(o);let a;return a=typeof(e=ai(e))=="string"||e instanceof Nm?PK(i,"updateDoc",t._key,e,n,r):kK(i,"updateDoc",t._key,e),Px(o,[a.toMutation(t._key,no.exists(!0))])}function vX(t){return Px(Oo(t.firestore,Qu),[new ix(t._key,no.none())])}function Px(t,e){return function(r,o){const i=new Zo;return r.asyncQueue.enqueueAndForget(async()=>cK(await _K(r),o,i)),i.promise}(bx(t),e)}function $K(t,e,n){const r=n.docs.get(e._key),o=new dD(t);return new Ga(t,o,e._key,r,new Nl(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(o){Hu=o})(pH),Kd(new Ac("firestore",(r,{instanceIdentifier:o,options:i})=>{const a=r.getProvider("app").getImmediate(),s=new Qu(new PH(r.getProvider("auth-internal")),new MH(a,r.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new se(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nc(l.options.projectId,c)}(a,o),a);return i={useFetchStreams:n,...i},s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),lu(WE,jE,e),lu(WE,jE,"esm2020")})();const{DocumentScanner:UK,FaceAuthentication:zK,Header:WK,TeamPage:UC,HomePage:jK,AuthPage:HK,Dashboard:GK,QRVerification:qK,AdminDashboard:KK,AdminLogin:XK}={DocumentScanner:F.lazy(()=>Gr(()=>import("./DocumentScanner-DQODrtes.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),FaceAuthentication:F.lazy(()=>Gr(()=>import("./FaceAuthentication-D5Zq0sKI.js"),__vite__mapDeps([10,1,2,3,4,5,7,11,12,13,14,15,9]))),Header:F.lazy(()=>Gr(()=>import("./Header-BsdI_2uF.js"),__vite__mapDeps([16,7,11,17,3,18,19,14,15,9,20,4,21]))),TeamPage:F.lazy(()=>Gr(()=>import("./TeamPage-CqH-ppam.js"),__vite__mapDeps([22,7,23,12]))),HomePage:F.lazy(()=>Gr(()=>import("./HomePage-yv9pXsYx.js"),__vite__mapDeps([24,7,11,23,8,25,9,26,12,27]))),AuthPage:F.lazy(()=>Gr(()=>import("./AuthPage-Dy2cS24k.js"),__vite__mapDeps([28,29,7,30,31,3,4,20,17,5,9]))),Dashboard:F.lazy(()=>Gr(()=>import("./Dashboard-DjLt4MY3.js"),__vite__mapDeps([32,33,34,29,35,36,7,17,3,25,9,8,14,15,26,31,5,18,19]))),QRVerification:F.lazy(()=>Gr(()=>import("./QRVerification-C-He5awM.js"),__vite__mapDeps([37,33,34,29,35,7,27,12,13,14,15]))),AdminDashboard:F.lazy(()=>Gr(()=>import("./AdminDashboard-DyKqnmKi.js"),__vite__mapDeps([38,2,3,4,5,6,36,7,17,35,29,8,30,31,20,21,19,15,9,26,12,13]))),AdminLogin:F.lazy(()=>Gr(()=>import("./AdminLogin-JDy2ngLx.js"),__vite__mapDeps([39,29,7,30,31,3,4,20,17,5,9])))},pg=({children:t,isAuthenticated:e})=>{const n=Yc();return F.useEffect(()=>{e||n("/auth",{replace:!0})},[e,n]),e?t:null};function QK(){const[t,e]=F.useState(localStorage.getItem("darkMode")==="true"),n=N1({palette:{mode:t?"dark":"light",primary:{main:"#0ea5e9"},secondary:{main:"#10b981"},background:{default:t?"#0f172a":"#f8fafc",paper:t?"#1e293b":"#ffffff"},text:{primary:t?"#f8fafc":"#1e293b",secondary:t?"#cbd5e1":"#64748b"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',button:{textTransform:"none"}},custom:{gradient:"linear-gradient(135deg, #0ea5e9 0%, #10b981 100%)"},shape:{borderRadius:16},components:{MuiCssBaseline:{styleOverrides:{html:{height:"100%",width:"100%"},body:{margin:0,padding:0,minHeight:"100%",width:"100%",overflowX:"hidden",backgroundColor:t?"#0f172a":"#f8fafc",color:t?"#f8fafc":"#1e293b"},"#root":{minHeight:"100%",width:"100%",display:"flex",flexDirection:"column"}}},MuiButton:{styleOverrides:{root:{borderRadius:"16px",padding:"12px 24px",boxShadow:"none",fontWeight:600,fontSize:"0.95rem",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:t?"0 8px 25px rgba(0, 0, 0, 0.3)":"0 8px 25px rgba(14, 165, 233, 0.2)"}}}},MuiPaper:{styleOverrides:{root:{borderRadius:"20px",boxShadow:t?"0 8px 32px rgba(0, 0, 0, 0.3)":"0 8px 32px rgba(0, 0, 0, 0.08)"}}},MuiCard:{styleOverrides:{root:{borderRadius:"20px",boxShadow:t?"0 8px 32px rgba(0, 0, 0, 0.3)":"0 8px 32px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:t?"0 12px 40px rgba(0, 0, 0, 0.4)":"0 12px 40px rgba(14, 165, 233, 0.15)"}}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:"16px",transition:"all 0.2s ease-in-out","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#0ea5e9"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderWidth:"2px"}}}}}}}),[r,o]=F.useState(!1),[i,a]=F.useState(null),[s,u]=F.useState(null),[l,c]=F.useState(null),[h,f]=F.useState(null),[d,m]=F.useState(null),[g,y]=F.useState(null),[v,w]=F.useState(!1),[x,_]=F.useState(null),[S,R]=F.useState(null),C=Yc(),E=()=>{const $=!t;e($),localStorage.setItem("darkMode",$)},I=$=>{o(!0),a({username:$}),localStorage.setItem("isAuthenticated","true"),localStorage.setItem("currentUser",JSON.stringify({username:$}))},T=()=>{o(!1),a(null),u(null),c(null),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("currentUser"),f(null),m(null),y(null),C("/")};F.useEffect(()=>{const $=localStorage.getItem("isAuthenticated"),U=localStorage.getItem("currentUser");if($==="true"&&U){o(!0);try{a(JSON.parse(U))}catch{a({username:U})}}U8(w,_,R)},[]);const k=($,U,K)=>{f($),m(U),y(K),C("/face-authentication")},P=async($,U)=>{if($&&U){if(u($),c(U),U.documentData&&i)try{console.log("Saving document data to database:",U.documentData);const{documentDB:K}=await Gr(async()=>{const{documentDB:V}=await import("./documentDatabase-BelqUvD4.js");return{documentDB:V}},__vite__mapDeps([34,29])),X={name:U.documentData.name||"Not found",dob:U.documentData.dob||"Not found",address:U.documentData.address||"Not found",mobile:U.documentData.mobile||"Not found",aadhaar:U.documentData.aadharNumber||"Not found",gender:U.documentData.gender||"Not found",documentType:U.documentData.documentType||"unknown",bloodGroup:U.documentData.bloodGroup||null,fatherName:U.documentData.fatherName||null,pinCode:U.documentData.pinCode||null,state:U.documentData.state||null,panNumber:U.documentData.panNumber||null,dlNumber:U.documentData.dlNumber||null,issueDate:U.documentData.issueDate||null,validity:U.documentData.validity||null,uploadedAt:new Date().toISOString()};await K.storeDocument(i.username,X),console.log("Document data saved successfully to database")}catch(K){console.error("Error saving document data to database:",K)}C("/dashboard")}},D=localStorage.getItem("isAdmin")==="true";return x||S?te.jsx(Av,{maxWidth:"lg",children:te.jsxs(Xh,{sx:{my:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:[te.jsx(RV,{severity:"error",sx:{mb:2},children:x||S}),te.jsx(Kh,{variant:"body1",sx:{mt:1,textAlign:"center"},children:"There was an issue loading the necessary models. Please ensure your network is stable and try again."})]})}):v?te.jsxs(kL,{theme:n,children:[te.jsx(XV,{}),te.jsx(Xh,{sx:{minHeight:"100vh",bgcolor:"background.default",color:"text.primary"},children:te.jsx(z8.Provider,{value:{isAuthenticated:r,currentUser:i,login:I,logout:T,darkMode:t,toggleDarkMode:E},children:te.jsx(Av,{maxWidth:!1,disableGutters:!0,sx:{minHeight:"100vh",display:"flex",flexDirection:"column",width:"100%"},children:te.jsx(Xh,{component:"main",sx:{flexGrow:1,display:"flex",flexDirection:"column",width:"100%",px:0,py:{xs:4,md:6},boxSizing:"border-box"},children:te.jsxs(F.Suspense,{fallback:te.jsx(E2,{sx:{display:"block",margin:"auto",mt:5}}),children:[te.jsx(WK,{darkMode:t,toggleDarkMode:E}),te.jsxs(BB,{children:[te.jsx(ur,{path:"/",element:te.jsx(jK,{})}),te.jsx(ur,{path:"/auth",element:te.jsx(HK,{})}),te.jsx(ur,{path:"/scan-id",element:te.jsx(pg,{isAuthenticated:r,children:te.jsx(UK,{onFaceScanned:k,modelsLoaded:v,loadingError:x,hashVerificationError:S})})}),te.jsx(ur,{path:"/face-authentication",element:te.jsx(pg,{isAuthenticated:r,children:te.jsx(zK,{onAuthenticated:P,scannedIdFaceDescriptor:h,scannedIdFaceImage:d,extractedDocumentData:g,modelsLoaded:v,loadingError:x,hashVerificationError:S})})}),te.jsx(ur,{path:"/dashboard",element:te.jsx(pg,{isAuthenticated:r,children:te.jsx(GK,{})})}),te.jsx(ur,{path:"/admin-login",element:te.jsx(XK,{})}),te.jsx(ur,{path:"/admin",element:D?te.jsx(KK,{}):te.jsx(R2,{to:"/admin-login",replace:!0})}),te.jsx(ur,{path:"/team",element:te.jsx(UC,{})}),te.jsx(ur,{path:"/TeamPage",element:te.jsx(R2,{to:"/team",replace:!0})}),te.jsx(ur,{path:"/qr-verification",element:te.jsx(qK,{})}),te.jsx(ur,{path:"/help",element:te.jsx(UC,{})}),te.jsx(ur,{path:"*",element:te.jsx(Kh,{variant:"h4",sx:{textAlign:"center",mt:10},children:"404 - Page Not Found"})})]})]})})})})})]}):te.jsx(Av,{maxWidth:"lg",children:te.jsxs(Xh,{sx:{my:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"20px"},children:[te.jsx(E2,{}),te.jsx(Kh,{variant:"h6",sx:{mt:2},children:"Loading Face Recognition Models..."}),te.jsx(Kh,{variant:"body2",sx:{mt:1,color:"text.secondary",textAlign:"center"},children:"This might take a moment depending on your connection."})]})})}function YK(){return te.jsx(l5,{children:te.jsx(QK,{})})}nT(document.getElementById("root")).render(te.jsx(F.StrictMode,{children:te.jsx(YK,{})}));export{qc as $,RV as A,Xh as B,E2 as C,B8 as D,Ou as E,iX as F,S1 as G,FO as H,gV as I,Lp as J,yd as K,cR as L,eF as M,cV as N,tF as O,GL as P,OO as Q,T1 as R,Pw as S,Kh as T,LO as U,oi as V,tX as W,IT as X,eo as Y,eX as Z,ut as _,oX as a,Hc as a0,rX as a1,Ms as a2,PT as a3,$O as a4,zO as a5,ci as a6,OV as a7,vc as a8,TL as a9,GO as aa,iF as ab,oF as ac,nF as ad,OL as ae,ZK as af,l2 as ag,rF as ah,gd as ai,I1 as aj,gc as ak,XT as al,mH as am,lX as an,sX as ao,cX as ap,hX as aq,dX as ar,uX as as,vX as at,mX as au,pX as av,fX as aw,fi as b,JK as c,di as d,ee as e,$t as f,zC as g,vt as h,zT as i,te as j,ma as k,Xc as l,c2 as m,dy as n,nX as o,RL as p,FT as q,F as r,Hn as s,Gh as t,Lo as u,tT as v,z8 as w,Yc as x,pi as y,Av as z};
